<strong>Project</strong>: fabric-ca<br><strong>Branch</strong>: master<br><strong>ID</strong>: 12063<br><strong>Subject</strong>: [FAB-5058] Auto generate TLS certificates<br><strong>Status</strong>: MERGED<br><strong>Owner</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Assignee</strong>:<br><strong>Created</strong>: 7/31/2017, 11:29:04 AM<br><strong>LastUpdated</strong>: 8/24/2017, 2:22:57 PM<br><strong>CommitMessage</strong>:<br><pre>[FAB-5058] Auto generate TLS certificates

Fabric-CA server should automatically generate
TLS certificate if TLS enabled is on the server
but no TLS certificate and key are provided.

Change-Id: I57dbd9c14e4100fde4af78a39c10495bba8b1fc2
Signed-off-by: Saad Karim <skarim@us.ibm.com>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Reviewed</strong>: 7/31/2017, 11:29:04 AM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 7/31/2017, 11:29:10 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1477/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 7/31/2017, 11:32:28 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1490/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 7/31/2017, 11:33:18 AM<br><strong>Message</strong>: <pre>Patch Set 1: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1477/ : FAILURE

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-ca-verify-s390x/1477

https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1490/ : FAILURE

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-ca-verify-x86_64/1490</pre><strong>Reviewer</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Reviewed</strong>: 7/31/2017, 11:59:53 AM<br><strong>Message</strong>: <pre>Patch Set 1:

reverify</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 7/31/2017, 12:00:00 PM<br><strong>Message</strong>: <pre>Patch Set 1: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1478/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 7/31/2017, 12:02:05 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1491/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 7/31/2017, 12:05:10 PM<br><strong>Message</strong>: <pre>Patch Set 1: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1478/ : FAILURE

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-ca-verify-s390x/1478

https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1491/ : FAILURE

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-ca-verify-x86_64/1491</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 7/31/2017, 12:19:47 PM<br><strong>Message</strong>: <pre>Patch Set 1: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1493/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 7/31/2017, 12:19:48 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1480/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 7/31/2017, 12:28:27 PM<br><strong>Message</strong>: <pre>Patch Set 1: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1493/ : FAILURE

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-ca-verify-x86_64/1493

https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1480/ : FAILURE

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-ca-verify-s390x/1480</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 7/31/2017, 1:44:17 PM<br><strong>Message</strong>: <pre>Patch Set 1: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1483/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 7/31/2017, 1:48:32 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1496/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 7/31/2017, 2:14:52 PM<br><strong>Message</strong>: <pre>Patch Set 1: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1483/ : FAILURE

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-ca-verify-s390x/1483

https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1496/ : FAILURE

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-ca-verify-x86_64/1496</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 7/31/2017, 2:44:25 PM<br><strong>Message</strong>: <pre>Patch Set 1: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1485/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 7/31/2017, 2:47:18 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1497/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 7/31/2017, 3:07:40 PM<br><strong>Message</strong>: <pre>Patch Set 1: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1485/ : FAILURE

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-ca-verify-s390x/1485

https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1497/ : FAILURE

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-ca-verify-x86_64/1497</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 7/31/2017, 8:21:09 PM<br><strong>Message</strong>: <pre>Patch Set 1: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1507/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 7/31/2017, 8:22:39 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1519/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 7/31/2017, 8:34:08 PM<br><strong>Message</strong>: <pre>Patch Set 1: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1519/ : FAILURE

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-ca-verify-x86_64/1519

https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1507/ : FAILURE

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-ca-verify-s390x/1507</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 7/31/2017, 9:29:44 PM<br><strong>Message</strong>: <pre>Patch Set 1: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1512/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 7/31/2017, 9:35:53 PM<br><strong>Message</strong>: <pre>Patch Set 1: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1519/ : FAILURE

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-ca-verify-x86_64/1519

https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1512/ : FAILURE

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-ca-verify-s390x/1512</pre><strong>Reviewer</strong>: Ry Jones - ry@linux.com<br><strong>Reviewed</strong>: 7/31/2017, 9:42:10 PM<br><strong>Message</strong>: <pre>Patch Set 1: Code-Review-1

01:35:42 --- FAIL: TestAutoTLSCertificateGeneration (1.16s)
01:35:42 	assertions.go:226: 
                          
	Error Trace:	server_test.go:1527
01:35:42 		
	Error:      	Received unexpected error:
01:35:42 		
	            	POST failure [Post https://localhost:7075/enroll: x509: certificate signed by unknown authority]; not sending
01:35:42 		
	            	POST https://localhost:7075/enroll
01:35:42 		
	            	Authorization: Basic YWRtaW46YWRtaW5wdw==
01:35:42 		
	            	{"hosts":null,"certificate_request":"-----BEGIN CERTIFICATE REQUEST-----\nMIH3MIGeAgEAMBAxDjAMBgNVBAMTBWFkbWluMFkwEwYHKoZIzj0CAQYIKoZIzj0D\nAQcDQgAErMtU+5Q0TnEMSVARGvqs3KsrtYqjD699HN2I95kO4PWYqkUGPp2sg9sm\neFyelXxw3QMBr1Xka49E2+ZXdkmgY6AsMCoGCSqGSIb3DQEJDjEdMBswGQYDVR0R\nBBIwEIIOaHlwZXJsZWRnZXItMTAwCgYIKoZIzj0EAwIDSAAwRQIhANX45TJPFWje\nX+SEqPJ4hpZ7gGldRnIpxgjcKWWyIR6lAiAa61ioJqFKDSrqR0L8JxHPzXkctQj3\nV1fano1krHTL/g==\n-----END CERTIFICATE REQUEST-----\n","profile":"","crl_override":"","label":"","CAName":""}
01:35:42 		
	Messages:   	Error occured during enrollment on TLS enabled fabric-ca server
01:35:42 FAIL
01:35:42 coverage: 78.9% of statements</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 7/31/2017, 9:49:02 PM<br><strong>Message</strong>: <pre>Patch Set 1: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1524/ (2/2)</pre><strong>Reviewer</strong>: Ry Jones - ry@linux.com<br><strong>Reviewed</strong>: 7/31/2017, 9:54:42 PM<br><strong>Message</strong>: <pre>Removed Code-Review-1 by Ry Jones <rjones@linuxfoundation.org>
</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 7/31/2017, 9:55:12 PM<br><strong>Message</strong>: <pre>Patch Set 1: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1491/ : FAILURE

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-ca-verify-x86_64/1491

https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1524/ : FAILURE

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-ca-verify-s390x/1524</pre><strong>Reviewer</strong>: Ry Jones - ry@linux.com<br><strong>Reviewed</strong>: 7/31/2017, 10:01:12 PM<br><strong>Message</strong>: <pre>Removed reviewer Ry Jones.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/1/2017, 12:21:03 AM<br><strong>Message</strong>: <pre>Patch Set 1: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1522/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/1/2017, 12:30:40 AM<br><strong>Message</strong>: <pre>Patch Set 1: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1524/ : FAILURE

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-ca-verify-s390x/1524

https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1522/ : FAILURE

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-ca-verify-x86_64/1522</pre><strong>Reviewer</strong>: Ry Jones - ry@linux.com<br><strong>Reviewed</strong>: 8/1/2017, 12:32:42 AM<br><strong>Message</strong>: <pre>Patch Set 1: Code-Review-1

Same error, both platforms


--- FAIL: TestAutoTLSCertificateGeneration (1.49s)
	assertions.go:226: 
                          
	Error Trace:	server_test.go:1527
		
	Error:      	Received unexpected error:
		
	            	POST failure [Post https://localhost:7075/enroll: x509: certificate signed by unknown authority]; not sending
		
	            	POST https://localhost:7075/enroll
		
	            	Authorization: Basic YWRtaW46YWRtaW5wdw==
		
	            	{"hosts":null,"certificate_request":"-----BEGIN CERTIFICATE REQUEST-----\nMIIBBTCBrAIBADAQMQ4wDAYDVQQDEwVhZG1pbjBZMBMGByqGSM49AgEGCCqGSM49\nAwEHA0IABKOgfVXM2nlw/VsFRlzhpnxkv85VSxjXhhKuOGYRVE0zfzGYGkcZ98Vx\nfl8ygXBW81+cgsAfio1NJdiMdWzBIOegOjA4BgkqhkiG9w0BCQ4xKzApMCcGA1Ud\nEQQgMB6CHHVidW50dTE2MDQteDg2LTY0LTRjLTRnLTgyMDUwCgYIKoZIzj0EAwID\nSAAwRQIhAM0G5jx7LolHIJecdCPfVy7OhBfirfEuS0zsHOWDf9s1AiAFY1igZX4g\nWm/ZlB09XrFjFujzJ2dE7VDQXZSjN79UmQ==\n-----END CERTIFICATE REQUEST-----\n","profile":"","crl_override":"","label":"","CAName":""}
		
	Messages:   	Error occured during enrollment on TLS enabled fabric-ca server
FAIL
coverage: 78.9% of statements
FAIL	github.com/hyperledger/fabric-ca/lib	122.352s</pre><strong>Reviewer</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Reviewed</strong>: 8/10/2017, 11:53:44 AM<br><strong>Message</strong>: <pre>Patch Set 1:

reverify</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/10/2017, 11:53:54 AM<br><strong>Message</strong>: <pre>Patch Set 1: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1555/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/10/2017, 11:58:37 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1551/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/10/2017, 12:12:49 PM<br><strong>Message</strong>: <pre>Patch Set 1: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1551/ : FAILURE

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-ca-verify-x86_64/1551

https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1555/ : FAILURE

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-ca-verify-s390x/1555</pre><strong>Reviewer</strong>: Ry Jones - ry@linux.com<br><strong>Reviewed</strong>: 8/10/2017, 1:50:36 PM<br><strong>Message</strong>: <pre>Removed reviewer Ry Jones with the following votes:

* Code-Review-1 by Ry Jones <rjones@linuxfoundation.org>
</pre><strong>Reviewer</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Reviewed</strong>: 8/14/2017, 12:56:32 PM<br><strong>Message</strong>: <pre>Uploaded patch set 2.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/14/2017, 12:56:41 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1580/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/14/2017, 12:58:38 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1576/ (2/2)</pre><strong>Reviewer</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Reviewed</strong>: 8/14/2017, 1:02:03 PM<br><strong>Message</strong>: <pre>Uploaded patch set 3.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/14/2017, 1:02:10 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1577/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/14/2017, 1:02:10 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1581/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/14/2017, 1:03:16 PM<br><strong>Message</strong>: <pre>Patch Set 2: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1576/ : ABORTED

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-ca-verify-x86_64/1576

https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1580/ : ABORTED

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-ca-verify-s390x/1580</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/14/2017, 1:23:37 PM<br><strong>Message</strong>: <pre>Patch Set 3: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1577/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-ca-verify-x86_64/1577

https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1581/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-ca-verify-s390x/1581</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 8/15/2017, 10:10:43 AM<br><strong>Message</strong>: <pre>Patch Set 3: Code-Review-1

(11 comments)</pre><strong>Reviewer</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Reviewed</strong>: 8/15/2017, 11:23:34 AM<br><strong>Message</strong>: <pre>Uploaded patch set 4.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/15/2017, 11:23:45 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1593/ (1/2)</pre><strong>Reviewer</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Reviewed</strong>: 8/15/2017, 11:24:05 AM<br><strong>Message</strong>: <pre>Patch Set 3:

(11 comments)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/15/2017, 11:27:49 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1589/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/15/2017, 11:52:28 AM<br><strong>Message</strong>: <pre>Patch Set 4: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1589/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-ca-verify-x86_64/1589

https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1593/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-ca-verify-s390x/1593</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 8/19/2017, 5:00:26 PM<br><strong>Message</strong>: <pre>Patch Set 4:

(1 comment)</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 8/20/2017, 4:23:35 AM<br><strong>Message</strong>: <pre>Patch Set 4: Code-Review-1

(2 comments)</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 8/20/2017, 6:28:59 AM<br><strong>Message</strong>: <pre>Patch Set 4:

(1 comment)</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 8/20/2017, 6:29:14 AM<br><strong>Message</strong>: <pre>Patch Set 4:

(1 comment)</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 8/20/2017, 6:35:35 AM<br><strong>Message</strong>: <pre>Patch Set 4:

(1 comment)</pre><strong>Reviewer</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Reviewed</strong>: 8/22/2017, 10:13:00 AM<br><strong>Message</strong>: <pre>Uploaded patch set 5.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/22/2017, 10:13:08 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1669/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/22/2017, 10:15:19 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1664/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/22/2017, 10:20:18 AM<br><strong>Message</strong>: <pre>Patch Set 5: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1664/ : FAILURE

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1664/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-ca-verify-x86_64/1664

https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1669/ : FAILURE

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1669/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-ca-verify-s390x/1669</pre><strong>Reviewer</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Reviewed</strong>: 8/22/2017, 10:45:07 AM<br><strong>Message</strong>: <pre>Uploaded patch set 6.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/22/2017, 10:45:14 AM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1671/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/22/2017, 10:47:44 AM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1666/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/22/2017, 11:19:34 AM<br><strong>Message</strong>: <pre>Patch Set 6: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1666/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-ca-verify-x86_64/1666

https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1671/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-ca-verify-s390x/1671</pre><strong>Reviewer</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Reviewed</strong>: 8/22/2017, 11:35:17 AM<br><strong>Message</strong>: <pre>Patch Set 6:

(2 comments)</pre><strong>Reviewer</strong>: Baohua Yang - yangbaohua@gmail.com<br><strong>Reviewed</strong>: 8/22/2017, 12:30:31 PM<br><strong>Message</strong>: <pre>Patch Set 6: Code-Review+1</pre><strong>Reviewer</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>Reviewed</strong>: 8/23/2017, 2:56:33 AM<br><strong>Message</strong>: <pre>Patch Set 6:

(3 comments)</pre><strong>Reviewer</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>Reviewed</strong>: 8/23/2017, 2:56:49 AM<br><strong>Message</strong>: <pre>Patch Set 6: Code-Review-1</pre><strong>Reviewer</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Reviewed</strong>: 8/23/2017, 9:44:05 AM<br><strong>Message</strong>: <pre>Patch Set 6:

(2 comments)</pre><strong>Reviewer</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>Reviewed</strong>: 8/23/2017, 10:38:06 PM<br><strong>Message</strong>: <pre>Patch Set 6: -Code-Review

(1 comment)

Thank you Saad. I understand. What do you think about the inline suggestion please?</pre><strong>Reviewer</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Reviewed</strong>: 8/24/2017, 9:41:03 AM<br><strong>Message</strong>: <pre>Patch Set 6:

(1 comment)</pre><strong>Reviewer</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>Reviewed</strong>: 8/24/2017, 1:24:29 PM<br><strong>Message</strong>: <pre>Patch Set 6: Code-Review+2

Got you. It wasn't clear to me. It is now - thank you.</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 8/24/2017, 2:22:54 PM<br><strong>Message</strong>: <pre>Patch Set 6: Code-Review+2</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 8/24/2017, 2:22:57 PM<br><strong>Message</strong>: <pre>Change has been successfully merged by Keith Smith</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Uploader</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Created</strong>: 7/31/2017, 11:29:04 AM<br><strong>UnmergedRevision</strong>: [11b57118fd53ffd3ac98050f97bc146a572fe434](https://github.com/hyperledger-gerrit-archive/fabric-ca/commit/11b57118fd53ffd3ac98050f97bc146a572fe434)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 8/10/2017, 12:12:49 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Uploader</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Created</strong>: 8/14/2017, 12:56:32 PM<br><strong>UnmergedRevision</strong>: [81251b31690756fc58cff2af8f76137c33c69348](https://github.com/hyperledger-gerrit-archive/fabric-ca/commit/81251b31690756fc58cff2af8f76137c33c69348)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 8/14/2017, 1:03:16 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 3</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Uploader</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Created</strong>: 8/14/2017, 1:02:03 PM<br><strong>UnmergedRevision</strong>: [03d7f96a7b69afaa9d06c43f1e190843666965fc](https://github.com/hyperledger-gerrit-archive/fabric-ca/commit/03d7f96a7b69afaa9d06c43f1e190843666965fc)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 8/14/2017, 1:23:37 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Approved</strong>: 8/15/2017, 10:10:43 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [cmd/fabric-ca-server/config.go#L104](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/03d7f96a7b69afaa9d06c43f1e190843666965fc/cmd/fabric-ca-server/config.go#L104)<br><strong>Comment</strong>: <pre>I think we should have a default certfile name of "tls-cert.pem"??</pre><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [cmd/fabric-ca-server/config.go#L104](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/03d7f96a7b69afaa9d06c43f1e190843666965fc/cmd/fabric-ca-server/config.go#L104)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [cmd/fabric-ca-server/config.go#L104](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/03d7f96a7b69afaa9d06c43f1e190843666965fc/cmd/fabric-ca-server/config.go#L104)<br><strong>Comment</strong>: <pre>I'm not sure I follow. Why do we want to call it tls-cert, please?</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [lib/server.go#L211](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/03d7f96a7b69afaa9d06c43f1e190843666965fc/lib/server.go#L211)<br><strong>Comment</strong>: <pre>A nit but could be more concise, just:

// Make home directory absolute, if not already
s.HomeDir, err = filepath.Abs(s.HomeDir)
if err != nil {
   ...
}</pre><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [lib/server.go#L211](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/03d7f96a7b69afaa9d06c43f1e190843666965fc/lib/server.go#L211)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [lib/server.go#L456](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/03d7f96a7b69afaa9d06c43f1e190843666965fc/lib/server.go#L456)<br><strong>Comment</strong>: <pre>I think they should be required to specify a cert file,
and error if they don't.
If the cert file does not exist, then we should autogenerate
it, but if it already exists, we should just use it.
The only questionable case of what to do is when the
cert file does not exist and they try to specify a key file.  If the cert file doesn't exist, we are going to autogenerate
the key and it would never be stored at the specified
path, so we could either ignore it or error out if they
specify a path.  I lean towards returning an error
to avoid confusion, but could go either way.</pre><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [lib/server.go#L456](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/03d7f96a7b69afaa9d06c43f1e190843666965fc/lib/server.go#L456)<br><strong>Comment</strong>: <pre>Done. I think erroring out when key specified but the certificate does not exist is also the correct approach.</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [lib/server.go#L678](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/03d7f96a7b69afaa9d06c43f1e190843666965fc/lib/server.go#L678)<br><strong>Comment</strong>: <pre>Is there a reason you can't use the default CA's CSP?
We don't want to force them to use the software version.</pre><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [lib/server.go#L678](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/03d7f96a7b69afaa9d06c43f1e190843666965fc/lib/server.go#L678)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [lib/server.go#L692](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/03d7f96a7b69afaa9d06c43f1e190843666965fc/lib/server.go#L692)<br><strong>Comment</strong>: <pre>Let's add a util.Hostname() func which does this and use it.
We are doing this multiple packages and should consolidate to
be consistent.</pre><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [lib/server.go#L692](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/03d7f96a7b69afaa9d06c43f1e190843666965fc/lib/server.go#L692)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [lib/server.go#L708](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/03d7f96a7b69afaa9d06c43f1e190843666965fc/lib/server.go#L708)<br><strong>Comment</strong>: <pre>Looks like it will panic if the default CA isn't named ""</pre><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [lib/server.go#L708](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/03d7f96a7b69afaa9d06c43f1e190843666965fc/lib/server.go#L708)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [lib/server.go#L714](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/03d7f96a7b69afaa9d06c43f1e190843666965fc/lib/server.go#L714)<br><strong>Comment</strong>: <pre>Why not require them to specify a filepath in the config and write it there?</pre><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [lib/server.go#L714](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/03d7f96a7b69afaa9d06c43f1e190843666965fc/lib/server.go#L714)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [lib/server_test.go#L1762](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/03d7f96a7b69afaa9d06c43f1e190843666965fc/lib/server_test.go#L1762)<br><strong>Comment</strong>: <pre>Add "defer os.RemoveAll(rootDir)"?  Is it cleaning up?</pre><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [lib/server_test.go#L1762](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/03d7f96a7b69afaa9d06c43f1e190843666965fc/lib/server_test.go#L1762)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [lib/server_test.go#L1766](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/03d7f96a7b69afaa9d06c43f1e190843666965fc/lib/server_test.go#L1766)<br><strong>Comment</strong>: <pre>Here's where I think you should be required to set the certfile</pre><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [lib/server_test.go#L1766](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/03d7f96a7b69afaa9d06c43f1e190843666965fc/lib/server_test.go#L1766)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [lib/server_test.go#L1781](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/03d7f96a7b69afaa9d06c43f1e190843666965fc/lib/server_test.go#L1781)<br><strong>Comment</strong>: <pre>Can just call:
   util.GetX509CertificateFromPEMFile</pre><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [lib/server_test.go#L1781](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/03d7f96a7b69afaa9d06c43f1e190843666965fc/lib/server_test.go#L1781)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [lib/tls/tls.go#L36](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/03d7f96a7b69afaa9d06c43f1e190843666965fc/lib/tls/tls.go#L36)<br><strong>Comment</strong>: <pre>I'm thinking we should have `def:"tls-cert.pem" ...` ??</pre><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [lib/tls/tls.go#L36](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/03d7f96a7b69afaa9d06c43f1e190843666965fc/lib/tls/tls.go#L36)<br><strong>Comment</strong>: <pre>Done</pre></blockquote><h3>PatchSet Number: 4</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Uploader</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Created</strong>: 8/15/2017, 11:23:34 AM<br><strong>UnmergedRevision</strong>: [47dcd6addac12d222bbe68476b52f1264f5c7c80](https://github.com/hyperledger-gerrit-archive/fabric-ca/commit/47dcd6addac12d222bbe68476b52f1264f5c7c80)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 8/15/2017, 11:52:28 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Approved</strong>: 8/20/2017, 4:23:35 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [lib/server.go#L460](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/47dcd6addac12d222bbe68476b52f1264f5c7c80/lib/server.go#L460)<br><strong>Comment</strong>: <pre>How about:
   "Certificate file '%s' does not exist; key file '%s' must not be specified in order to automatically generate the key"</pre><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [lib/server.go#L460](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/47dcd6addac12d222bbe68476b52f1264f5c7c80/lib/server.go#L460)<br><strong>Comment</strong>: <pre>> How about:
 > "Certificate file '%s' does not exist; key file '%s' must not be
 > specified in order to automatically generate the key"

"Found key file '%s' but could not find certificate file '%s'.  Please check your configuration."</pre><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [lib/server.go#L460](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/47dcd6addac12d222bbe68476b52f1264f5c7c80/lib/server.go#L460)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [lib/server.go#L460](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/47dcd6addac12d222bbe68476b52f1264f5c7c80/lib/server.go#L460)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [lib/server.go#L683](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/47dcd6addac12d222bbe68476b52f1264f5c7c80/lib/server.go#L683)<br><strong>Comment</strong>: <pre>We should just use "localhost" or minimally you need to have localhost as a SAN.  My preference would just be to use localhost</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [lib/server.go#L683](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/47dcd6addac12d222bbe68476b52f1264f5c7c80/lib/server.go#L683)<br><strong>Comment</strong>: <pre>I think this is OK for the CN, right?  But the default SAN list (if not specified) should be a list of 2 elements:
the hostname and "localhost".  This should be the case for all calls to GenCSR, not just for this case.  Sound OK Gari?</pre><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [lib/server.go#L683](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/47dcd6addac12d222bbe68476b52f1264f5c7c80/lib/server.go#L683)<br><strong>Comment</strong>: <pre>My bad on this.  Was reading the code wrong.</pre><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [lib/server.go#L683](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/47dcd6addac12d222bbe68476b52f1264f5c7c80/lib/server.go#L683)<br><strong>Comment</strong>: <pre>Done</pre></blockquote><h3>PatchSet Number: 5</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Uploader</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Created</strong>: 8/22/2017, 10:13:00 AM<br><strong>UnmergedRevision</strong>: [1c60638cce65b6face9151692ff2d2a5ecbe27ab](https://github.com/hyperledger-gerrit-archive/fabric-ca/commit/1c60638cce65b6face9151692ff2d2a5ecbe27ab)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 8/22/2017, 10:20:18 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 6</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Uploader</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Created</strong>: 8/22/2017, 10:45:07 AM<br><strong>GitHubMergedRevision</strong>: [f8a910fc44b8202faaa945ec1894c5df9760bf1a](https://github.com/hyperledger-gerrit-archive/fabric-ca/commit/f8a910fc44b8202faaa945ec1894c5df9760bf1a)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 8/22/2017, 11:19:34 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>Approved</strong>: 8/24/2017, 1:24:29 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Baohua Yang - yangbaohua@gmail.com<br><strong>Approved</strong>: 8/22/2017, 12:30:31 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Approved</strong>: 8/24/2017, 2:22:54 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>MergedBy</strong>: Keith Smith<br><strong>Merged</strong>: 8/24/2017, 2:22:57 PM<br><br><h2>Comments</h2><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [cmd/fabric-ca-server/config.go#L104](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/f8a910fc44b8202faaa945ec1894c5df9760bf1a/cmd/fabric-ca-server/config.go#L104)<br><strong>Comment</strong>: <pre>Why are we renaming the ca-cert to tis-cert?

I think the ca-cert, makes it clearer that this TLS certificate is the CA's. Wouldn't you agree?</pre><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [cmd/fabric-ca-server/config.go#L104](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/f8a910fc44b8202faaa945ec1894c5df9760bf1a/cmd/fabric-ca-server/config.go#L104)<br><strong>Comment</strong>: <pre>The ca-cert is the name of the CA's signing certificate. Originally, we were just using the ca-cert to function as TLS certificate unless the user specified another TLS cert. But, with this change set, we are generating a TLS certificate that has the proper usages. We don't want to use the same name as the ca signing certificates, so that is why we call it tls-cert to signify that this certificate is for TLS purposes.</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [lib/tls/tls.go#L37](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/f8a910fc44b8202faaa945ec1894c5df9760bf1a/lib/tls/tls.go#L37)<br><strong>Comment</strong>: <pre>Why the change/removal of the default 'ca-key.pem'?
If we merge this, some scripts that are already written/deploy may break.

Not saying that we can't change things, just trying to understand why, and later on, how to communicate it/this.

Thank you</pre><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [lib/tls/tls.go#L37](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/f8a910fc44b8202faaa945ec1894c5df9760bf1a/lib/tls/tls.go#L37)<br><strong>Comment</strong>: <pre>We are no longer defaulting to use the ca-cert and ca-key for TLS. If no TLS certificates exist, we are going to automatically generate a TLS certificate that is different than the ca signing cert (ca-cert). We can't have a tls certificate that is also called ca-cert so we are calling it tls-cert.</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [lib/tls/tls.go#L37](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/f8a910fc44b8202faaa945ec1894c5df9760bf1a/lib/tls/tls.go#L37)<br><strong>Comment</strong>: <pre>I'm with you. Here's my reasoning (but happy to discuss):
Since both of the certificates are TLS certificates, I find it a bit confusing to call one 'ca-cert' and the other default one 'tis-cert'. See what I mean?

I totally understand why/that we don't want to use the same name.

How about we use 'ca-cert' (if provided, e.g., in our examples, etc.)... and if it's not provided, we'll default to 'default-cert' ?

Makes sense? Will this solve the issue? Do you find it as intuitive?
Please advise.</pre><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [lib/tls/tls.go#L37](https://github.com/hyperledger-gerrit-archive/fabric-ca/blob/f8a910fc44b8202faaa945ec1894c5df9760bf1a/lib/tls/tls.go#L37)<br><strong>Comment</strong>: <pre>ca-cert.pem and tls-cert.pem both won't be TLS certificates. Initially, they were being used as such for a default TLS configuration. We are trying to move away from that. So now tls-cert.pem won't have a signing usage and will solely be used for a TLS connection. So that is why I think having different names makes things more clear. 

I think we want to move away from using the ca-cert.pem by default for TLS so that's why I think to leave it as ca-cert.pem, won't move towards that.

I don't necessarily think this should break any examples, cause if tls-cert.pem does not exist it will automatically get created. If the examples still refer to ca-cert.pem that should still be fine as well, as the ca-cert.pem will continue to exist and can be referred to because a ca signing certificate will also get generated by default too.</pre></blockquote>
<strong>Project</strong>: fabric-ca<br><strong>Branch</strong>: master<br><strong>ID</strong>: 9939<br><strong>Subject</strong>: [FAB-4093] Fix the TLS client using BCCSP<br><strong>Status</strong>: MERGED<br><strong>Owner</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Assignee</strong>:<br><strong>Created</strong>: 5/30/2017, 2:48:47 PM<br><strong>LastUpdated</strong>: 6/5/2017, 2:46:18 PM<br><strong>CommitMessage</strong>:<br><pre>[FAB-4093] Fix the TLS client using BCCSP

The TLS client fails when client authentication is enabled and
the key was generated by BCCSP.  This is because the key file
name can not be found since its name is the hash of the public
key.  This change set fixes this for the TLS client in the same
way that https://gerrit.hyperledger.org/r/#/c/9235 fixed this
for the TLS server.  It reuses the util.LoadX509KeyPair function
for the client as is already used for the server.

See TestTLSClientAuth in lib/client_whitebox_test.go for the test
case.

Change-Id: I61432042e5fde3e300e855cd60499862a90cd715
Signed-off-by: Keith Smith <bksmith@us.ibm.com>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 5/30/2017, 2:48:47 PM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/30/2017, 2:48:56 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1021/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/30/2017, 2:50:35 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1014/ (2/2)</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 5/30/2017, 2:56:50 PM<br><strong>Message</strong>: <pre>Uploaded patch set 2.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/30/2017, 2:56:56 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1022/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/30/2017, 3:01:45 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1015/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/30/2017, 3:16:19 PM<br><strong>Message</strong>: <pre>Patch Set 1: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1014/ : SUCCESS

https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1021/ : SUCCESS</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/30/2017, 3:24:09 PM<br><strong>Message</strong>: <pre>Patch Set 2: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1015/ : SUCCESS

https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1022/ : SUCCESS</pre><strong>Reviewer</strong>: AnilKumar Ambati - aambati@hotmail.com<br><strong>Reviewed</strong>: 5/31/2017, 2:10:16 PM<br><strong>Message</strong>: <pre>Patch Set 2:

(1 comment)</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 5/31/2017, 3:13:16 PM<br><strong>Message</strong>: <pre>Uploaded patch set 3.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/31/2017, 3:13:25 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1036/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/31/2017, 3:18:03 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1029/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/31/2017, 3:26:59 PM<br><strong>Message</strong>: <pre>Patch Set 3: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1029/ : FAILURE

https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1036/ : FAILURE</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 5/31/2017, 4:34:57 PM<br><strong>Message</strong>: <pre>Uploaded patch set 4.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/31/2017, 4:35:05 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1037/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/31/2017, 4:38:44 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1030/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/31/2017, 4:59:18 PM<br><strong>Message</strong>: <pre>Patch Set 4: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1030/ : SUCCESS

https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1037/ : SUCCESS</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 6/1/2017, 1:17:21 PM<br><strong>Message</strong>: <pre>Uploaded patch set 5.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/1/2017, 1:17:31 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1041/ (1/2)</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 6/1/2017, 1:19:10 PM<br><strong>Message</strong>: <pre>Patch Set 2:

(1 comment)

Addressed Anil's comment</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/1/2017, 1:22:06 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1034/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/1/2017, 1:56:27 PM<br><strong>Message</strong>: <pre>Patch Set 5: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1034/ : SUCCESS

https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1041/ : SUCCESS</pre><strong>Reviewer</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>Reviewed</strong>: 6/2/2017, 2:32:47 PM<br><strong>Message</strong>: <pre>Patch Set 5: Code-Review-2

(1 comment)

At this point, this needs a lot of testing, including at least one that reproduces the issue this fixes please...</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 6/5/2017, 11:01:56 AM<br><strong>Message</strong>: <pre>Uploaded patch set 6.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/5/2017, 11:02:02 AM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1056/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/5/2017, 11:10:51 AM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1049/ (2/2)</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 6/5/2017, 11:15:48 AM<br><strong>Message</strong>: <pre>Uploaded patch set 7.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/5/2017, 11:15:57 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1057/ (1/2)</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 6/5/2017, 11:17:36 AM<br><strong>Message</strong>: <pre>Patch Set 7:

(1 comment)

Responding to Jonathan's comments.
See TestTLSClientAuth in lib/client_whitebox_test.go for an additional test case which fails without this fix but passes with the fix.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/5/2017, 11:20:13 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1050/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/5/2017, 11:37:35 AM<br><strong>Message</strong>: <pre>Patch Set 6: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1056/ : SUCCESS

https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1049/ : SUCCESS</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/5/2017, 11:44:00 AM<br><strong>Message</strong>: <pre>Patch Set 7: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-ca-verify-s390x/1057/ : SUCCESS

https://jenkins.hyperledger.org/job/fabric-ca-verify-x86_64/1050/ : SUCCESS</pre><strong>Reviewer</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>Reviewed</strong>: 6/5/2017, 1:35:35 PM<br><strong>Message</strong>: <pre>Patch Set 7: Code-Review+2

I'm tired.</pre><strong>Reviewer</strong>: Christopher Ferris - chris.ferris@gmail.com<br><strong>Reviewed</strong>: 6/5/2017, 2:07:35 PM<br><strong>Message</strong>: <pre>Patch Set 7: Code-Review+2</pre><strong>Reviewer</strong>: Gerrit Code Review - gerrit@hyperledger.org<br><strong>Reviewed</strong>: 6/5/2017, 2:07:38 PM<br><strong>Message</strong>: <pre>Change has been successfully merged by Christopher Ferris</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/5/2017, 2:07:49 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-ca-merge-s390x/173/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/5/2017, 2:11:09 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-ca-merge-x86_64/173/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/5/2017, 2:46:18 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-ca-merge-s390x/173/ : SUCCESS

https://jenkins.hyperledger.org/job/fabric-ca-merge-x86_64/173/ : SUCCESS</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Uploader</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Created</strong>: 1496170127<br><strong>GitHubRevision</strong>: [de7ac870a93392ea853492390e4da3237ff3064c](https://github.com/hyperledger/fabric-ca/commit/de7ac870a93392ea853492390e4da3237ff3064c)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/30/2017, 3:16:19 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Uploader</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Created</strong>: 1496170610<br><strong>GitHubRevision</strong>: [153c4735b814093e65ca9736aae642f1dbde60e1](https://github.com/hyperledger/fabric-ca/commit/153c4735b814093e65ca9736aae642f1dbde60e1)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/30/2017, 3:24:09 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 3</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Uploader</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Created</strong>: 1496257996<br><strong>GitHubRevision</strong>: [957271cdcc8a8a03859195bf0c3a224777f2a065](https://github.com/hyperledger/fabric-ca/commit/957271cdcc8a8a03859195bf0c3a224777f2a065)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/31/2017, 3:26:59 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 4</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Uploader</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Created</strong>: 1496262897<br><strong>GitHubRevision</strong>: [e74275cdf3f6d89ef6a0274c5d90559d7e08cc0d](https://github.com/hyperledger/fabric-ca/commit/e74275cdf3f6d89ef6a0274c5d90559d7e08cc0d)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/31/2017, 4:59:18 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 5</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Uploader</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Created</strong>: 1496337441<br><strong>GitHubRevision</strong>: [65c8852aca4365ecdc6d697a28bc2abcb609d7d6](https://github.com/hyperledger/fabric-ca/commit/65c8852aca4365ecdc6d697a28bc2abcb609d7d6)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 6/1/2017, 1:56:27 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>Approved</strong>: 6/2/2017, 2:32:47 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 6</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Uploader</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Created</strong>: 1496674916<br><strong>GitHubRevision</strong>: [9162882692ba3c0e871a2b50569bc5569037caf1](https://github.com/hyperledger/fabric-ca/commit/9162882692ba3c0e871a2b50569bc5569037caf1)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 6/5/2017, 11:37:35 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>Approved</strong>: 6/2/2017, 2:32:47 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 7</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Uploader</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Created</strong>: 1496675748<br><strong>GitHubRevision</strong>: [f963ce8757d9caf59e8de54a93ce472856eca063](https://github.com/hyperledger/fabric-ca/commit/f963ce8757d9caf59e8de54a93ce472856eca063)<br><br><strong>Approver</strong>: Christopher Ferris - chris.ferris@gmail.com<br><strong>Approved</strong>: 6/5/2017, 2:07:35 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>MergedBy</strong>: Christopher Ferris<br><strong>Merged</strong>: 6/5/2017, 2:07:38 PM<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 6/5/2017, 11:44:00 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>Approved</strong>: 6/5/2017, 1:35:35 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br></blockquote>
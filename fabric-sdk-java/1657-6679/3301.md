<strong>Project</strong>: fabric-sdk-java<br><strong>Branch</strong>: WIP_fabric_v1<br><strong>ID</strong>: 3301<br><strong>Subject</strong>: FAB-1204 Implement support for COP in Java sdk 1.0<br><strong>Status</strong>: MERGED<br><strong>Owner</strong>: Rick Rine - cr22rc@gmail.com<br><strong>Assignee</strong>:<br><strong>Created</strong>: 12/14/2016, 12:05:44 PM<br><strong>LastUpdated</strong>: 1/11/2017, 9:23:00 AM<br><strong>CommitMessage</strong>:<br><pre>FAB-1204 Implement support for COP in Java sdk 1.0

Addressed comments.
Patch fixes test cases and also updates to use new Json payload in REST request.
Addressed Jim's latest comments.
Fixed typo and made defines consistent- reflect actual system property names.

Change-Id: I177ce102a14c2b394bb8669f89d850e6fab60286
Signed-off-by: rickr <cr22rc@gmail.com>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Rick Rine - cr22rc@gmail.com<br><strong>Reviewed</strong>: 12/14/2016, 12:05:44 PM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Rick Rine - cr22rc@gmail.com<br><strong>Reviewed</strong>: 12/14/2016, 12:30:00 PM<br><strong>Message</strong>: <pre>Patch Set 1:

I intended for this to update the original gerrit request but I'm not sure why it didn't. Can we just go with this ?</pre><strong>Reviewer</strong>: Muhammad Altaf - muhammada@fast.au.fujitsu.com<br><strong>Reviewed</strong>: 12/20/2016, 10:28:03 PM<br><strong>Message</strong>: <pre>Patch Set 1: Code-Review-1

(7 comments)</pre><strong>Reviewer</strong>: Rick Rine - cr22rc@gmail.com<br><strong>Reviewed</strong>: 1/5/2017, 10:27:07 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(1 comment)

Still looking at other comments</pre><strong>Reviewer</strong>: Rick Rine - cr22rc@gmail.com<br><strong>Reviewed</strong>: 1/5/2017, 2:05:56 PM<br><strong>Message</strong>: <pre>Uploaded patch set 2.</pre><strong>Reviewer</strong>: Rick Rine - cr22rc@gmail.com<br><strong>Reviewed</strong>: 1/5/2017, 3:10:30 PM<br><strong>Message</strong>: <pre>Patch Set 1:

(6 comments)</pre><strong>Reviewer</strong>: Rick Rine - cr22rc@gmail.com<br><strong>Reviewed</strong>: 1/10/2017, 2:33:33 PM<br><strong>Message</strong>: <pre>Uploaded patch set 3.</pre><strong>Reviewer</strong>: Rick Rine - cr22rc@gmail.com<br><strong>Reviewed</strong>: 1/11/2017, 8:10:31 AM<br><strong>Message</strong>: <pre>Patch Set 3: Code-Review+2

No further comments in 24 hours  will merge</pre><strong>Reviewer</strong>: Rick Rine - cr22rc@gmail.com<br><strong>Reviewed</strong>: 1/11/2017, 8:10:55 AM<br><strong>Message</strong>: <pre>Patch Set 3: Verified+1</pre><strong>Reviewer</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>Reviewed</strong>: 1/11/2017, 8:50:49 AM<br><strong>Message</strong>: <pre>Patch Set 3: Code-Review-1

(3 comments)

two minor changes please...</pre><strong>Reviewer</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>Reviewed</strong>: 1/11/2017, 8:56:17 AM<br><strong>Message</strong>: <pre>Patch Set 3:

(1 comment)</pre><strong>Reviewer</strong>: Rick Rine - cr22rc@gmail.com<br><strong>Reviewed</strong>: 1/11/2017, 9:07:12 AM<br><strong>Message</strong>: <pre>Patch Set 3:

(4 comments)

fixed or answered Jims comments</pre><strong>Reviewer</strong>: Rick Rine - cr22rc@gmail.com<br><strong>Reviewed</strong>: 1/11/2017, 9:18:04 AM<br><strong>Message</strong>: <pre>Uploaded patch set 4.</pre><strong>Reviewer</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>Reviewed</strong>: 1/11/2017, 9:21:35 AM<br><strong>Message</strong>: <pre>Patch Set 4: Code-Review+2</pre><strong>Reviewer</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>Reviewed</strong>: 1/11/2017, 9:22:14 AM<br><strong>Message</strong>: <pre>Patch Set 4: Verified+1</pre><strong>Reviewer</strong>: Gerrit Code Review - gerrit@hyperledger.org<br><strong>Reviewed</strong>: 1/11/2017, 9:23:00 AM<br><strong>Message</strong>: <pre>Change has been successfully merged by Jim Zhang</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Rick Rine - cr22rc@gmail.com<br><strong>Uploader</strong>: Rick Rine - cr22rc@gmail.com<br><strong>Created</strong>: 12/14/2016, 12:05:44 PM<br><strong>UnmergedRevision</strong>: [e431ed2e03b17b424d609f28decc8829622cf2d8](https://github.com/hyperledger-gerrit-archive/fabric-sdk-java/commit/e431ed2e03b17b424d609f28decc8829622cf2d8)<br><br><strong>Approver</strong>: Muhammad Altaf - muhammada@fast.au.fujitsu.com<br><strong>Approved</strong>: 12/20/2016, 10:28:03 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Muhammad Altaf - muhammada@fast.au.fujitsu.com<br><strong>CommentLine</strong>: [src/main/java/org/hyperledger/fabric/sdk/MemberServicesCOPImpl.java#L78](https://github.com/hyperledger-gerrit-archive/fabric-sdk-java/blob/e431ed2e03b17b424d609f28decc8829622cf2d8/src/main/java/org/hyperledger/fabric/sdk/MemberServicesCOPImpl.java#L78)<br><strong>Comment</strong>: <pre>Please don't hard code the property names here, Config already knows about them. Instead, define define two methods in config:
getDefaultSecurityLevel()
getDefaultHashAlgorithm()

These methods in config could simply use these property names to return the correct properties.</pre><strong>Commenter</strong>: Rick Rine - cr22rc@gmail.com<br><strong>CommentLine</strong>: [src/main/java/org/hyperledger/fabric/sdk/MemberServicesCOPImpl.java#L78](https://github.com/hyperledger-gerrit-archive/fabric-sdk-java/blob/e431ed2e03b17b424d609f28decc8829622cf2d8/src/main/java/org/hyperledger/fabric/sdk/MemberServicesCOPImpl.java#L78)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Muhammad Altaf - muhammada@fast.au.fujitsu.com<br><strong>CommentLine</strong>: [src/main/java/org/hyperledger/fabric/sdk/MemberServicesCOPImpl.java#L236](https://github.com/hyperledger-gerrit-archive/fabric-sdk-java/blob/e431ed2e03b17b424d609f28decc8829622cf2d8/src/main/java/org/hyperledger/fabric/sdk/MemberServicesCOPImpl.java#L236)<br><strong>Comment</strong>: <pre>Does this means we'll have to wait for COP release containing the given change Id? How can we test it before that?</pre><strong>Commenter</strong>: Rick Rine - cr22rc@gmail.com<br><strong>CommentLine</strong>: [src/main/java/org/hyperledger/fabric/sdk/MemberServicesCOPImpl.java#L236](https://github.com/hyperledger-gerrit-archive/fabric-sdk-java/blob/e431ed2e03b17b424d609f28decc8829622cf2d8/src/main/java/org/hyperledger/fabric/sdk/MemberServicesCOPImpl.java#L236)<br><strong>Comment</strong>: <pre>It works with what is there at the moment. When that COP change gets put in then we need to do this to make it work again</pre><strong>Commenter</strong>: Muhammad Altaf - muhammada@fast.au.fujitsu.com<br><strong>CommentLine</strong>: [src/main/java/org/hyperledger/fabric/sdk/MemberServicesCOPImpl.java#L280](https://github.com/hyperledger-gerrit-archive/fabric-sdk-java/blob/e431ed2e03b17b424d609f28decc8829622cf2d8/src/main/java/org/hyperledger/fabric/sdk/MemberServicesCOPImpl.java#L280)<br><strong>Comment</strong>: <pre>Change to EnrollmentException</pre><strong>Commenter</strong>: Rick Rine - cr22rc@gmail.com<br><strong>CommentLine</strong>: [src/main/java/org/hyperledger/fabric/sdk/MemberServicesCOPImpl.java#L280](https://github.com/hyperledger-gerrit-archive/fabric-sdk-java/blob/e431ed2e03b17b424d609f28decc8829622cf2d8/src/main/java/org/hyperledger/fabric/sdk/MemberServicesCOPImpl.java#L280)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Muhammad Altaf - muhammada@fast.au.fujitsu.com<br><strong>CommentLine</strong>: [src/main/java/org/hyperledger/fabric/sdk/MemberServicesCOPImpl.java#L285](https://github.com/hyperledger-gerrit-archive/fabric-sdk-java/blob/e431ed2e03b17b424d609f28decc8829622cf2d8/src/main/java/org/hyperledger/fabric/sdk/MemberServicesCOPImpl.java#L285)<br><strong>Comment</strong>: <pre>Change to EnrollmentException</pre><strong>Commenter</strong>: Rick Rine - cr22rc@gmail.com<br><strong>CommentLine</strong>: [src/main/java/org/hyperledger/fabric/sdk/MemberServicesCOPImpl.java#L285](https://github.com/hyperledger-gerrit-archive/fabric-sdk-java/blob/e431ed2e03b17b424d609f28decc8829622cf2d8/src/main/java/org/hyperledger/fabric/sdk/MemberServicesCOPImpl.java#L285)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Muhammad Altaf - muhammada@fast.au.fujitsu.com<br><strong>CommentLine</strong>: [src/main/java/org/hyperledger/fabric/sdk/MemberServicesCOPImpl.java#L288](https://github.com/hyperledger-gerrit-archive/fabric-sdk-java/blob/e431ed2e03b17b424d609f28decc8829622cf2d8/src/main/java/org/hyperledger/fabric/sdk/MemberServicesCOPImpl.java#L288)<br><strong>Comment</strong>: <pre>Change to EnrollmentException</pre><strong>Commenter</strong>: Rick Rine - cr22rc@gmail.com<br><strong>CommentLine</strong>: [src/main/java/org/hyperledger/fabric/sdk/MemberServicesCOPImpl.java#L288](https://github.com/hyperledger-gerrit-archive/fabric-sdk-java/blob/e431ed2e03b17b424d609f28decc8829622cf2d8/src/main/java/org/hyperledger/fabric/sdk/MemberServicesCOPImpl.java#L288)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Muhammad Altaf - muhammada@fast.au.fujitsu.com<br><strong>CommentLine</strong>: [src/main/java/org/hyperledger/fabric/sdk/helper/Config.java#L48](https://github.com/hyperledger-gerrit-archive/fabric-sdk-java/blob/e431ed2e03b17b424d609f28decc8829622cf2d8/src/main/java/org/hyperledger/fabric/sdk/helper/Config.java#L48)<br><strong>Comment</strong>: <pre>Move this static block to getConfig() to use the singleton pattern. Only do it when config is null</pre><strong>Commenter</strong>: Rick Rine - cr22rc@gmail.com<br><strong>CommentLine</strong>: [src/main/java/org/hyperledger/fabric/sdk/helper/Config.java#L48](https://github.com/hyperledger-gerrit-archive/fabric-sdk-java/blob/e431ed2e03b17b424d609f28decc8829622cf2d8/src/main/java/org/hyperledger/fabric/sdk/helper/Config.java#L48)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Muhammad Altaf - muhammada@fast.au.fujitsu.com<br><strong>CommentLine</strong>: [src/main/java/org/hyperledger/fabric/sdk/helper/Config.java#L101](https://github.com/hyperledger-gerrit-archive/fabric-sdk-java/blob/e431ed2e03b17b424d609f28decc8829622cf2d8/src/main/java/org/hyperledger/fabric/sdk/helper/Config.java#L101)<br><strong>Comment</strong>: <pre>Why this method when you can directly use sdkProperties.put?</pre><strong>Commenter</strong>: Rick Rine - cr22rc@gmail.com<br><strong>CommentLine</strong>: [src/main/java/org/hyperledger/fabric/sdk/helper/Config.java#L101](https://github.com/hyperledger-gerrit-archive/fabric-sdk-java/blob/e431ed2e03b17b424d609f28decc8829622cf2d8/src/main/java/org/hyperledger/fabric/sdk/helper/Config.java#L101)<br><strong>Comment</strong>: <pre>convenience</pre></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Rick Rine - cr22rc@gmail.com<br><strong>Uploader</strong>: Rick Rine - cr22rc@gmail.com<br><strong>Created</strong>: 1/5/2017, 2:05:56 PM<br><strong>UnmergedRevision</strong>: [9f010149d42061090516b15573fb833cb5dd46c0](https://github.com/hyperledger-gerrit-archive/fabric-sdk-java/commit/9f010149d42061090516b15573fb833cb5dd46c0)<br><br></blockquote><h3>PatchSet Number: 3</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Rick Rine - cr22rc@gmail.com<br><strong>Uploader</strong>: Rick Rine - cr22rc@gmail.com<br><strong>Created</strong>: 1/10/2017, 2:33:33 PM<br><strong>UnmergedRevision</strong>: [579163e4b1413e102671de341c0e03d5f160540c](https://github.com/hyperledger-gerrit-archive/fabric-sdk-java/commit/579163e4b1413e102671de341c0e03d5f160540c)<br><br><strong>Approver</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>Approved</strong>: 1/11/2017, 8:50:49 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Rick Rine - cr22rc@gmail.com<br><strong>Approved</strong>: 1/11/2017, 8:10:31 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Rick Rine - cr22rc@gmail.com<br><strong>Approved</strong>: 1/11/2017, 8:10:55 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>CommentLine</strong>: [src/main/java/org/hyperledger/fabric/sdk/MemberServicesCOPImpl.java#L76](https://github.com/hyperledger-gerrit-archive/fabric-sdk-java/blob/579163e4b1413e102671de341c0e03d5f160540c/src/main/java/org/hyperledger/fabric/sdk/MemberServicesCOPImpl.java#L76)<br><strong>Comment</strong>: <pre>typo: COP_ENROLLMEN**T**BASE</pre><strong>Commenter</strong>: Rick Rine - cr22rc@gmail.com<br><strong>CommentLine</strong>: [src/main/java/org/hyperledger/fabric/sdk/MemberServicesCOPImpl.java#L76](https://github.com/hyperledger-gerrit-archive/fabric-sdk-java/blob/579163e4b1413e102671de341c0e03d5f160540c/src/main/java/org/hyperledger/fabric/sdk/MemberServicesCOPImpl.java#L76)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>CommentLine</strong>: [src/main/java/org/hyperledger/fabric/sdk/helper/Config.java#L27](https://github.com/hyperledger-gerrit-archive/fabric-sdk-java/blob/579163e4b1413e102671de341c0e03d5f160540c/src/main/java/org/hyperledger/fabric/sdk/helper/Config.java#L27)<br><strong>Comment</strong>: <pre>this class description can be made more clear:
- basically the hierarchy goes System property > config file > default values in code
- to add a new hierarchical property, one needs to add a property name (private static final String) and add its default value via the "defaultProperty()" call</pre><strong>Commenter</strong>: Rick Rine - cr22rc@gmail.com<br><strong>CommentLine</strong>: [src/main/java/org/hyperledger/fabric/sdk/helper/Config.java#L27](https://github.com/hyperledger-gerrit-archive/fabric-sdk-java/blob/579163e4b1413e102671de341c0e03d5f160540c/src/main/java/org/hyperledger/fabric/sdk/helper/Config.java#L27)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>CommentLine</strong>: [src/main/java/org/hyperledger/fabric/sdk/helper/Config.java#L39](https://github.com/hyperledger-gerrit-archive/fabric-sdk-java/blob/579163e4b1413e102671de341c0e03d5f160540c/src/main/java/org/hyperledger/fabric/sdk/helper/Config.java#L39)<br><strong>Comment</strong>: <pre>why such a long name, why not shorten it to just "SECURITY_LEVEL" as the two var names above?</pre><strong>Commenter</strong>: Rick Rine - cr22rc@gmail.com<br><strong>CommentLine</strong>: [src/main/java/org/hyperledger/fabric/sdk/helper/Config.java#L39](https://github.com/hyperledger-gerrit-archive/fabric-sdk-java/blob/579163e4b1413e102671de341c0e03d5f160540c/src/main/java/org/hyperledger/fabric/sdk/helper/Config.java#L39)<br><strong>Comment</strong>: <pre>The names actually reflect the property name in the config file or system property</pre><strong>Commenter</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>CommentLine</strong>: [src/main/java/org/hyperledger/fabric/sdk/helper/Config.java#L40](https://github.com/hyperledger-gerrit-archive/fabric-sdk-java/blob/579163e4b1413e102671de341c0e03d5f160540c/src/main/java/org/hyperledger/fabric/sdk/helper/Config.java#L40)<br><strong>Comment</strong>: <pre>why not just "HASH_ALGORITHM"?</pre><strong>Commenter</strong>: Rick Rine - cr22rc@gmail.com<br><strong>CommentLine</strong>: [src/main/java/org/hyperledger/fabric/sdk/helper/Config.java#L40](https://github.com/hyperledger-gerrit-archive/fabric-sdk-java/blob/579163e4b1413e102671de341c0e03d5f160540c/src/main/java/org/hyperledger/fabric/sdk/helper/Config.java#L40)<br><strong>Comment</strong>: <pre>The names actually reflect the property name in the config file or system property</pre></blockquote><h3>PatchSet Number: 4</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Rick Rine - cr22rc@gmail.com<br><strong>Uploader</strong>: Rick Rine - cr22rc@gmail.com<br><strong>Created</strong>: 1/11/2017, 9:18:04 AM<br><strong>GitHubMergedRevision</strong>: [caa35185b51ca646b88374ac53bde22595710425](https://github.com/hyperledger-gerrit-archive/fabric-sdk-java/commit/caa35185b51ca646b88374ac53bde22595710425)<br><br><strong>Approver</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>Approved</strong>: 1/11/2017, 9:21:35 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>MergedBy</strong>: Jim Zhang<br><strong>Merged</strong>: 1/11/2017, 9:23:00 AM<br><br><strong>Approver</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>Approved</strong>: 1/11/2017, 9:22:14 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote>
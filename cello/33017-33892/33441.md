<strong>Project</strong>: cello<br><strong>Branch</strong>: master<br><strong>ID</strong>: 33441<br><strong>Subject</strong>: [CE-696] Add certs for Peer and Orderer<br><strong>Status</strong>: MERGED<br><strong>Owner</strong>: Manank Patni - manank321@gmail.com<br><strong>Assignee</strong>: Manank Patni - manank321@gmail.com<br><strong>Created</strong>: 9/10/2019, 6:31:45 PM<br><strong>LastUpdated</strong>: 9/23/2019, 3:11:16 PM<br><strong>CommitMessage</strong>:<br><pre>[CE-696] Add certs for Peer and Orderer

Pass certs to peer and orderer nodes

Change-Id: Ia3a8ccec72845cceb54b5386dd38fd12f60b3d5c
Signed-off-by: Manank Patni <manank321@gmail.com>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Manank Patni - manank321@gmail.com<br><strong>Reviewed</strong>: 9/10/2019, 6:31:45 PM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/10/2019, 6:33:37 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/cello-verify-x86_64/1296/</pre><strong>Reviewer</strong>: Manank Patni - manank321@gmail.com<br><strong>Reviewed</strong>: 9/10/2019, 6:34:28 PM<br><strong>Message</strong>: <pre>Assignee added: Manank Patni <manank321@gmail.com></pre><strong>Reviewer</strong>: Manank Patni - manank321@gmail.com<br><strong>Reviewed</strong>: 9/10/2019, 6:34:59 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Currently WIP</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/10/2019, 6:57:54 PM<br><strong>Message</strong>: <pre>Patch Set 1: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/cello-verify-x86_64/1296/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/cello-verify-x86_64/1296</pre><strong>Reviewer</strong>: tong  li - litong01@us.ibm.com<br><strong>Reviewed</strong>: 9/16/2019, 11:29:25 AM<br><strong>Message</strong>: <pre>Patch Set 2: Patch Set 1 was rebased</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/16/2019, 11:33:34 AM<br><strong>Message</strong>: <pre>Patch Set 2: -Verified

Build Started https://jenkins.hyperledger.org/job/cello-verify-x86_64/1301/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/16/2019, 12:02:02 PM<br><strong>Message</strong>: <pre>Patch Set 2: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/cello-verify-x86_64/1301/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/cello-verify-x86_64/1301</pre><strong>Reviewer</strong>: Manank Patni - manank321@gmail.com<br><strong>Reviewed</strong>: 9/17/2019, 12:12:05 AM<br><strong>Message</strong>: <pre>Uploaded patch set 3.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/17/2019, 12:14:51 AM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/cello-verify-x86_64/1302/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/17/2019, 12:46:38 AM<br><strong>Message</strong>: <pre>Patch Set 3: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/cello-verify-x86_64/1302/ : FAILURE

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/cello-verify-x86_64/1302</pre><strong>Reviewer</strong>: Manank Patni - manank321@gmail.com<br><strong>Reviewed</strong>: 9/17/2019, 1:14:47 AM<br><strong>Message</strong>: <pre>Uploaded patch set 4.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/17/2019, 1:16:36 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/cello-verify-x86_64/1303/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/17/2019, 1:38:33 AM<br><strong>Message</strong>: <pre>Patch Set 4: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/cello-verify-x86_64/1303/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/cello-verify-x86_64/1303</pre><strong>Reviewer</strong>: tong  li - litong01@us.ibm.com<br><strong>Reviewed</strong>: 9/17/2019, 12:42:05 PM<br><strong>Message</strong>: <pre>Patch Set 4:

(3 comments)</pre><strong>Reviewer</strong>: Manank Patni - manank321@gmail.com<br><strong>Reviewed</strong>: 9/17/2019, 3:15:17 PM<br><strong>Message</strong>: <pre>Patch Set 4:

(2 comments)</pre><strong>Reviewer</strong>: tong  li - litong01@us.ibm.com<br><strong>Reviewed</strong>: 9/17/2019, 3:41:49 PM<br><strong>Message</strong>: <pre>Patch Set 4:

what are the differences? I did not think they are different in terms of certificates.</pre><strong>Reviewer</strong>: Manank Patni - manank321@gmail.com<br><strong>Reviewed</strong>: 9/17/2019, 5:10:54 PM<br><strong>Message</strong>: <pre>Patch Set 4:

> Patch Set 4:
> 
> what are the differences? I did not think they are different in terms of certificates.

This https://gerrit.hyperledger.org/r/gitweb?p=cello.git;a=blob;f=src/agent/fabric-operator/pkg/apis/fabric/v1alpha1/orderer_types.go;h=39ae8f34ca3fb200a5a99b1576440b9757cb9ea0;hb=c7dbcf7dd7d0f9871e52bcf9380f7292887e084d#l20 and here https://gerrit.hyperledger.org/r/gitweb?p=cello.git;a=blob;f=src/agent/fabric-operator/pkg/apis/fabric/v1alpha1/peer_types.go;h=2f4d9e9027b185cd785917fbbf1a3b973a9a2ff5;hb=c7dbcf7dd7d0f9871e52bcf9380f7292887e084d#l20 is one of the differences. 

Other than above These are the TLS certs needed by Peer

        CORE_PEER_TLS_ENABLED = true
        CORE_PEER_TLS_CERT_FILE = fully qualified path of the server certificate
        CORE_PEER_TLS_KEY_FILE = fully qualified path of the server private key
        CORE_PEER_TLS_ROOTCERT_FILE = fully qualified path of the CA chain file
        CORE_PEER_TLS_CLIENTAUTHREQUIRED = true
        CORE_PEER_TLS_CLIENTROOTCAS_FILES = fully qualified path of the CA chain file
        CORE_PEER_TLS_CLIENTCERT_FILE = fully qualified path of the client certificate
        CORE_PEER_TLS_CLIENTKEY_FILE = fully qualified path of the client key

While these are needed by orderer 

        ORDERER_GENERAL_TLS_ENABLED = true
        ORDERER_GENERAL_TLS_PRIVATEKEY = fully qualified path of the file that contains the server private key
        ORDERER_GENERAL_TLS_CERTIFICATE = fully qualified path of the file that contains the server certificate
        ORDERER_GENERAL_TLS_ROOTCAS = fully qualified path of the file that contains the certificate chain of the CA that issued TLS server certificate
        ORDERER_GENERAL_TLS_CLIENTAUTHREQUIRED = true
        ORDERER_GENERAL_TLS_CLIENTROOTCAS = fully qualified path of the file that contains the certificate chain of the CA that issued TLS server certificate</pre><strong>Reviewer</strong>: tong  li - litong01@us.ibm.com<br><strong>Reviewed</strong>: 9/18/2019, 9:56:56 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Flags should not be part of the certs. Use the common ones and add the specific ones for each type spec such as OrdererSpec, PeerSpec, these two will be different, but their certs such as private key, cert, and rootcas should be all the same. Also tls client is only needed for peer when client authorization is true.</pre><strong>Reviewer</strong>: Manank Patni - manank321@gmail.com<br><strong>Reviewed</strong>: 9/22/2019, 2:07:07 AM<br><strong>Message</strong>: <pre>Uploaded patch set 5.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/22/2019, 2:08:32 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/cello-verify-x86_64/1306/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/22/2019, 2:31:06 AM<br><strong>Message</strong>: <pre>Patch Set 5: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/cello-verify-x86_64/1306/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/cello-verify-x86_64/1306</pre><strong>Reviewer</strong>: Baohua Yang - yangbaohua@gmail.com<br><strong>Reviewed</strong>: 9/23/2019, 2:34:16 PM<br><strong>Message</strong>: <pre>Patch Set 5: Code-Review+2</pre><strong>Reviewer</strong>: tong  li - litong01@us.ibm.com<br><strong>Reviewed</strong>: 9/23/2019, 3:11:10 PM<br><strong>Message</strong>: <pre>Patch Set 5: Code-Review+2</pre><strong>Reviewer</strong>: tong  li - litong01@us.ibm.com<br><strong>Reviewed</strong>: 9/23/2019, 3:11:16 PM<br><strong>Message</strong>: <pre>Change has been successfully merged by tong  li</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Manank Patni - manank321@gmail.com<br><strong>Uploader</strong>: Manank Patni - manank321@gmail.com<br><strong>Created</strong>: 9/10/2019, 6:31:45 PM<br><strong>UnmergedRevision</strong>: e5dc121c70b1e1911ae5d4797bddeb0256377b6d<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 9/10/2019, 6:57:54 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: TRIVIAL_REBASE<br><strong>Author</strong>: Manank Patni - manank321@gmail.com<br><strong>Uploader</strong>: tong  li - litong01@us.ibm.com<br><strong>Created</strong>: 9/16/2019, 11:29:25 AM<br><strong>UnmergedRevision</strong>: 7f5fa33db6c8f5e4225047f451d4e8d600f25203<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 9/16/2019, 12:02:02 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 3</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Manank Patni - manank321@gmail.com<br><strong>Uploader</strong>: Manank Patni - manank321@gmail.com<br><strong>Created</strong>: 9/17/2019, 12:12:05 AM<br><strong>UnmergedRevision</strong>: 781230fce90a2054e63648680d6581dfdf9b5188<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 9/17/2019, 12:46:38 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 4</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Manank Patni - manank321@gmail.com<br><strong>Uploader</strong>: Manank Patni - manank321@gmail.com<br><strong>Created</strong>: 9/17/2019, 1:14:47 AM<br><strong>UnmergedRevision</strong>: c7dbcf7dd7d0f9871e52bcf9380f7292887e084d<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 9/17/2019, 1:38:33 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 5</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Manank Patni - manank321@gmail.com<br><strong>Uploader</strong>: Manank Patni - manank321@gmail.com<br><strong>Created</strong>: 9/22/2019, 2:07:07 AM<br><strong>GitHubMergedRevision</strong>: [bda1e65d60462934da5421708accadcfd5a98198](https://github.com/hyperledger/cello/commit/bda1e65d60462934da5421708accadcfd5a98198)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 9/22/2019, 2:31:06 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Baohua Yang - yangbaohua@gmail.com<br><strong>Approved</strong>: 9/23/2019, 2:34:16 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: tong  li - litong01@us.ibm.com<br><strong>Approved</strong>: 9/23/2019, 3:11:10 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>MergedBy</strong>: tong  li<br><strong>Merged</strong>: 9/23/2019, 3:11:16 PM<br><br></blockquote>
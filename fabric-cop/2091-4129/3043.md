<strong>Project</strong>: fabric-cop<br><strong>Branch</strong>: master<br><strong>ID</strong>: 3043<br><strong>Subject</strong>: Extend CFSSL accessor to support ID in Cert table<br><strong>Status</strong>: MERGED<br><strong>Owner</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Assignee</strong>:<br><strong>Created</strong>: 12/6/2016, 5:51:56 PM<br><strong>LastUpdated</strong>: 12/19/2016, 2:46:19 PM<br><strong>CommitMessage</strong>:<br><pre>Extend CFSSL accessor to support ID in Cert table

Extend CFSSL DB accessor to support adding enrollment ID to
certificates table. A column in the certificates table will
be added for enrollment ID, each certificate will have an ID
associated with it.

https://jira.hyperledger.org/browse/FAB-1294

Change-Id: I144ca1debb12950eb35536546231528af42f50da
Signed-off-by: Saad Karim <skarim@us.ibm.com>
Signed-off-by: Keith Smith <bksmith@us.ibm.com>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Reviewed</strong>: 12/6/2016, 5:51:56 PM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/6/2016, 5:54:46 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/117/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/6/2016, 6:01:53 PM<br><strong>Message</strong>: <pre>Patch Set 1: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/117/ : SUCCESS</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 12/7/2016, 5:13:43 PM<br><strong>Message</strong>: <pre>Patch Set 1: Code-Review-1

(4 comments)</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 12/8/2016, 12:14:08 PM<br><strong>Message</strong>: <pre>Patch Set 1:

(1 comment)</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 12/8/2016, 12:18:09 PM<br><strong>Message</strong>: <pre>Patch Set 1:

(1 comment)</pre><strong>Reviewer</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Reviewed</strong>: 12/8/2016, 1:45:32 PM<br><strong>Message</strong>: <pre>Uploaded patch set 2.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/8/2016, 1:46:16 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/122/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/8/2016, 1:51:20 PM<br><strong>Message</strong>: <pre>Patch Set 2: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/122/ : SUCCESS</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 12/9/2016, 8:04:25 AM<br><strong>Message</strong>: <pre>Patch Set 2:

(1 comment)</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 12/9/2016, 12:11:40 PM<br><strong>Message</strong>: <pre>Patch Set 2: Code-Review+2

I'm ok for now.  might want to take a pass in the near future on naming and packaging once the full set of changes is in</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 12/9/2016, 4:28:01 PM<br><strong>Message</strong>: <pre>Uploaded patch set 3.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/9/2016, 4:28:53 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/133/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/9/2016, 4:29:24 PM<br><strong>Message</strong>: <pre>Patch Set 3: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/133/ : FAILURE</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/11/2016, 2:53:49 PM<br><strong>Message</strong>: <pre>Patch Set 3: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/140/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/11/2016, 2:54:21 PM<br><strong>Message</strong>: <pre>Patch Set 3: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/140/ : FAILURE</pre><strong>Reviewer</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Reviewed</strong>: 12/12/2016, 4:33:40 PM<br><strong>Message</strong>: <pre>Uploaded patch set 4.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/12/2016, 4:34:34 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/147/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/12/2016, 4:39:53 PM<br><strong>Message</strong>: <pre>Patch Set 4: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/147/ : SUCCESS</pre><strong>Reviewer</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Reviewed</strong>: 12/12/2016, 4:52:32 PM<br><strong>Message</strong>: <pre>Patch Set 2:

(1 comment)</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 12/13/2016, 7:50:49 AM<br><strong>Message</strong>: <pre>Patch Set 4: Code-Review+1</pre><strong>Reviewer</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>Reviewed</strong>: 12/13/2016, 1:45:13 PM<br><strong>Message</strong>: <pre>Patch Set 4: Code-Review-2

(19 comments)

Hi Saad,

1. The commit message suggests just extending C... accessor to support ID in Cert table, but it seems like you are making a lot of changes.
2. Things that make it to the shared "util", should be more generic, I feel.
3. Also, the whole "magic" of changing or rewriting to/the HOME is not ideal. In 0.5 we tried to keep the env variables very specific.
3. Please see some more comments inline.

Thank you, J</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 12/13/2016, 5:22:10 PM<br><strong>Message</strong>: <pre>Patch Set 4: -Code-Review

(1 comment)</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 12/13/2016, 5:33:02 PM<br><strong>Message</strong>: <pre>Patch Set 4:

(1 comment)</pre><strong>Reviewer</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>Reviewed</strong>: 12/14/2016, 2:45:13 AM<br><strong>Message</strong>: <pre>Patch Set 4:

(1 comment)

Re: "Jonathan, I wrote this code and gave it to Saad"

Thank you Keith, I did not know this. In this case then, we need to have you append your own Signed-off-by to the commit message (in addition to Saad's).

The easiest way would probably be to use:
git commit --amend -s</pre><strong>Reviewer</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Reviewed</strong>: 12/14/2016, 10:23:20 AM<br><strong>Message</strong>: <pre>Patch Set 4:

(14 comments)</pre><strong>Reviewer</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Reviewed</strong>: 12/14/2016, 10:23:58 AM<br><strong>Message</strong>: <pre>Uploaded patch set 5.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/14/2016, 10:25:05 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/161/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/14/2016, 10:32:07 AM<br><strong>Message</strong>: <pre>Patch Set 5: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/161/ : SUCCESS</pre><strong>Reviewer</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Reviewed</strong>: 12/14/2016, 11:00:14 AM<br><strong>Message</strong>: <pre>Uploaded patch set 6.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/14/2016, 11:01:47 AM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/162/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/14/2016, 11:07:56 AM<br><strong>Message</strong>: <pre>Patch Set 6: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/162/ : SUCCESS</pre><strong>Reviewer</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>Reviewed</strong>: 12/14/2016, 2:27:46 PM<br><strong>Message</strong>: <pre>Patch Set 4:

(13 comments)

Thank you Saad. Please see inline. 
- Keith, we really need you to sign this off as well.
- We should not hide the storage (the ".cop" thingy), etc.
- Please see some more inline...

Thanks.</pre><strong>Reviewer</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Reviewed</strong>: 12/14/2016, 2:40:56 PM<br><strong>Message</strong>: <pre>Patch Set 4:

(1 comment)</pre><strong>Reviewer</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Reviewed</strong>: 12/15/2016, 9:51:42 AM<br><strong>Message</strong>: <pre>Patch Set 4:

(3 comments)</pre><strong>Reviewer</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Reviewed</strong>: 12/15/2016, 9:56:31 AM<br><strong>Message</strong>: <pre>Uploaded patch set 7.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/15/2016, 9:57:27 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/167/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/15/2016, 10:02:20 AM<br><strong>Message</strong>: <pre>Patch Set 7: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/167/ : SUCCESS</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 12/16/2016, 9:54:39 AM<br><strong>Message</strong>: <pre>Patch Set 7: Code-Review-1

(2 comments)

Saad, see the 2 questions/comments below.</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 12/17/2016, 2:43:27 PM<br><strong>Message</strong>: <pre>Patch Set 7: Code-Review+1

(2 comments)</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 12/19/2016, 8:43:34 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Jonathan, you still have a -2 on this.  Can you pls clarify what Saad has not yet addressed here?  Thanks</pre><strong>Reviewer</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>Reviewed</strong>: 12/19/2016, 9:13:46 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Good morning Keith,

1. According to the project's guidelines, you cannot let people submit code on your behalf/that you have written - have them sign it off and then "review" their submission (your "+1").

2. Please see the earlier reviews/comments inline:
Please also add your own sign off, before we can proceed.

Thanks, J</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 12/19/2016, 1:07:36 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Jonathan, I think perhaps there is a misunderstanding.  I did not write any of the code which was initially submitted under this change set.  When Saad was trying to address one of your comments, he came to me for help.  I gave him the function in util.go which was from a dependent change set.  That said, I'll add my sign off to this as you requested.  But just wanted to make clear that I am not trying to get my code in without review by someone else.</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 12/19/2016, 1:10:32 PM<br><strong>Message</strong>: <pre>Uploaded patch set 8: Commit message was updated.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/19/2016, 1:11:24 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/179/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/19/2016, 1:16:44 PM<br><strong>Message</strong>: <pre>Patch Set 8: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/179/ : SUCCESS</pre><strong>Reviewer</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>Reviewed</strong>: 12/19/2016, 2:18:54 PM<br><strong>Message</strong>: <pre>Patch Set 8: -Code-Review

Keith: "But just wanted to make clear that I am not trying to get my code in without review by someone else."

I think that's clear (though thanks for clarifying, just in case). The system would not have allowed anyway with all the control/guards, etc. That's fine.

It is the exact scenario that you described (giving some code that you wrote that is getting added to a CR) and then the original CR author pushes/submits it under his name (with his signature) only, etc. that required the extra sign-off. See my review of patchset 4:
---
Dec 13 11:45 PM 
  Re: "Jonathan, I wrote this code and gave it to Saad"
  Thank you Keith, I did not know this. In this case then, we need to have you append your own Signed-off-by to the commit message (in addition to Saad's).

---


It's not a problem, just the procedure we follow. Same for me, I sometimes remove my own review score if/when I submit a patchset to an existing CR.</pre><strong>Reviewer</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>Reviewed</strong>: 12/19/2016, 2:21:02 PM<br><strong>Message</strong>: <pre>Patch Set 8: Code-Review+2

Good to go. LGTM. Thanks.

Saad: Yes, we can discuss the writing of the hidden ".cop" folder under a user's $HOME separately.</pre><strong>Reviewer</strong>: Pho Le - intelmind787@gmail.com<br><strong>Reviewed</strong>: 12/19/2016, 2:34:42 PM<br><strong>Message</strong>: <pre>Patch Set 8: Code-Review+1</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 12/19/2016, 2:37:46 PM<br><strong>Message</strong>: <pre>Patch Set 8: Code-Review+2</pre><strong>Reviewer</strong>: Gerrit Code Review - gerrit@hyperledger.org<br><strong>Reviewed</strong>: 12/19/2016, 2:38:20 PM<br><strong>Message</strong>: <pre>Change has been successfully merged by Gari Singh</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/19/2016, 2:40:58 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-cop-merge-x86_64/20/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/19/2016, 2:46:19 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-cop-merge-x86_64/20/ : SUCCESS</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Uploader</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Created</strong>: 12/6/2016, 5:51:56 PM<br><strong>UnmergedRevision</strong>: [beea9643e8d7511267adce9ff30613c2aebd74a6](https://github.com/hyperledger-gerrit-archive/fabric-cop/commit/beea9643e8d7511267adce9ff30613c2aebd74a6)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/6/2016, 6:01:53 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Approved</strong>: 12/7/2016, 5:13:43 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [cli/server/cfsslaccessor.go#L46](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/beea9643e8d7511267adce9ff30613c2aebd74a6/cli/server/cfsslaccessor.go#L46)<br><strong>Comment</strong>: <pre>The condition should be if id=:id and status != "revoked", because we don't want to lose the time at which it was initially revoked.</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [cli/server/cfsslaccessor.go#L133](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/beea9643e8d7511267adce9ff30613c2aebd74a6/cli/server/cfsslaccessor.go#L133)<br><strong>Comment</strong>: <pre>Should be plural ... GetCertificatesByID.</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [cli/server/cfsslaccessor.go#L167](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/beea9643e8d7511267adce9ff30613c2aebd74a6/cli/server/cfsslaccessor.go#L167)<br><strong>Comment</strong>: <pre>plural ... RevokeCertificatesByID</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [cli/server/cfsslaccessor.go#L192](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/beea9643e8d7511267adce9ff30613c2aebd74a6/cli/server/cfsslaccessor.go#L192)<br><strong>Comment</strong>: <pre>I think you need to delete this since multiple rows can be affected</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [cli/server/cfsslaccessor.go#L192](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/beea9643e8d7511267adce9ff30613c2aebd74a6/cli/server/cfsslaccessor.go#L192)<br><strong>Comment</strong>: <pre>I suggest just returning the number of rows affected from this function.  There are cases where 0, 1, or multiple may be legitimately affected, so it is up to the caller to determine which ones (if any) are errors.</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [cli/server/cfsslaccessor.go#L192](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/beea9643e8d7511267adce9ff30613c2aebd74a6/cli/server/cfsslaccessor.go#L192)<br><strong>Comment</strong>: <pre>Correction, I need you to return an array of the certificates that were revoked.</pre></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Uploader</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Created</strong>: 12/8/2016, 1:45:32 PM<br><strong>UnmergedRevision</strong>: [8c28b62c25ff21fa90ce68bd32c6a29c4c1b44c2](https://github.com/hyperledger-gerrit-archive/fabric-cop/commit/8c28b62c25ff21fa90ce68bd32c6a29c4c1b44c2)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/8/2016, 1:51:20 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Approved</strong>: 12/9/2016, 12:11:40 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [cli/server/cfsslaccessor.go#L56](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/8c28b62c25ff21fa90ce68bd32c6a29c4c1b44c2/cli/server/cfsslaccessor.go#L56)<br><strong>Comment</strong>: <pre>we should probably call this CertDBAccessor and rename the file given that this is really for certdb</pre><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [cli/server/cfsslaccessor.go#L56](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/8c28b62c25ff21fa90ce68bd32c6a29c4c1b44c2/cli/server/cfsslaccessor.go#L56)<br><strong>Comment</strong>: <pre>Done</pre></blockquote><h3>PatchSet Number: 3</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Uploader</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Created</strong>: 12/9/2016, 4:28:01 PM<br><strong>UnmergedRevision</strong>: [561ac4af11f46989ca4b67630d116b9762d60ff6](https://github.com/hyperledger-gerrit-archive/fabric-cop/commit/561ac4af11f46989ca4b67630d116b9762d60ff6)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/11/2016, 2:54:21 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 4</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Uploader</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Created</strong>: 12/12/2016, 4:33:40 PM<br><strong>UnmergedRevision</strong>: [1bc3982cb7acc21a9786da1cf2a6c5db88c8268a](https://github.com/hyperledger-gerrit-archive/fabric-cop/commit/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/12/2016, 4:39:53 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>Approved</strong>: 12/13/2016, 1:45:13 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [cli/server/config.go#L97](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/cli/server/config.go#L97)<br><strong>Comment</strong>: <pre>What does this mean? Is this documented that you default to 1 ?</pre><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [cli/server/config.go#L97](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/cli/server/config.go#L97)<br><strong>Comment</strong>: <pre>Allows you to specify how many times a user can use its one time password to enroll itself. I updated the Readme about it.</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [cli/server/config.go#L97](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/cli/server/config.go#L97)<br><strong>Comment</strong>: <pre>Thank you.

What I do/did not like is the fact that it switches from 0 to 1 (as it's not intuitive). I suggest to either have 0 interpreted as "unlimited", or alternatively, to break if the MaxEnrollments is not a positive number.</pre><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [cli/server/config.go#L97](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/cli/server/config.go#L97)<br><strong>Comment</strong>: <pre>I've made it so now that we interpret zero as infinite.</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [cli/server/dbaccessor.go#L362](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/cli/server/dbaccessor.go#L362)<br><strong>Comment</strong>: <pre>Let remove pls</pre><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [cli/server/dbaccessor.go#L362](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/cli/server/dbaccessor.go#L362)<br><strong>Comment</strong>: <pre>This is temporarily commented it out. It needs to be reintroduced when some of the depending code is finished.</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [cli/server/dbaccessor.go#L362](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/cli/server/dbaccessor.go#L362)<br><strong>Comment</strong>: <pre>OK, if it makes it easier. In general, it's OK to just use the versioning system (git, or so, for these).</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [cli/server/dbaccessor.go#L409](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/cli/server/dbaccessor.go#L409)<br><strong>Comment</strong>: <pre>The signature of the function states that it expects only an error (one)</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [cli/server/dbaccessor.go#L409](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/cli/server/dbaccessor.go#L409)<br><strong>Comment</strong>: <pre>[Please ignore the above]</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [cli/server/dbaccessor.go#L409](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/cli/server/dbaccessor.go#L409)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [cli/server/dbaccessor.go#L409](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/cli/server/dbaccessor.go#L409)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [cli/server/enroll.go#L110](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/cli/server/enroll.go#L110)<br><strong>Comment</strong>: <pre>1. I can't tell when we use CFG and when we don't... so now we use the CFG and for UserRegistry we don't?

2. This should all be in JIRA or in the commit message(s).

3. Does this have to be part of this changeset (to extend the CFSSL...)?</pre><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [cli/server/enroll.go#L110](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/cli/server/enroll.go#L110)<br><strong>Comment</strong>: <pre>1. CFG is going to be strictly used for what is defined in the server config file (cop.json). There is some clean up happening to strictly enforce that rule. UserRegistry was moved out of the config object. 

3. No this was just some clean up that was done.</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [cli/server/factory.go#L33](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/cli/server/factory.go#L33)<br><strong>Comment</strong>: <pre>Why "global variables" ?</pre><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [cli/server/factory.go#L33](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/cli/server/factory.go#L33)<br><strong>Comment</strong>: <pre>We want them to be available to the entire package</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [cli/server/factory.go#L33](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/cli/server/factory.go#L33)<br><strong>Comment</strong>: <pre>OK, let's move on and see if we can refrain from these (somehow).</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [cli/server/factory.go#L69](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/cli/server/factory.go#L69)<br><strong>Comment</strong>: <pre>What happened to the CFG.UserRegistry ?</pre><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [cli/server/factory.go#L69](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/cli/server/factory.go#L69)<br><strong>Comment</strong>: <pre>Made it a global variable.</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [cli/server/factory.go#L84](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/cli/server/factory.go#L84)<br><strong>Comment</strong>: <pre>1. Why do you need the temporary?
2. If you are changing from NewCffslAccessor to NewCertDBAccessor(), let's change the variable.
3. (a repeat): Why are you introducing these "package level" global variables?</pre><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [cli/server/factory.go#L84](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/cli/server/factory.go#L84)<br><strong>Comment</strong>: <pre>1. Its not temporary, the function does two thing. One it return an interface that CFSSL needs. Second it sets a global variable that is a pointer to the accessor which is used for making DB calls that CFSSL doesn't support. 

2. Done

3. Cause these are database accessor. Db access might be required in multiple places in the package such as for register, enroll, revoke functionality.</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [cli/server/factory.go#L84](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/cli/server/factory.go#L84)<br><strong>Comment</strong>: <pre>In 1, I meant the temporary variable "certDBAccessor".
2. Thanks.
3. Yes, let's keep these, and we'll take a look to see if we can avoid these (using interfaces).</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [cli/server/factory.go#L85](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/cli/server/factory.go#L85)<br><strong>Comment</strong>: <pre>Same here please.</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [cli/server/server_test.go#L264](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/cli/server/server_test.go#L264)<br><strong>Comment</strong>: <pre>Thanks for removing this!</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [cli/server/server_test.go#L320](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/cli/server/server_test.go#L320)<br><strong>Comment</strong>: <pre>Enroll</pre><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [cli/server/server_test.go#L320](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/cli/server/server_test.go#L320)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [util/util.go#L367](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/util/util.go#L367)<br><strong>Comment</strong>: <pre>I don't think we should use HOME, at all.</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [util/util.go#L367](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/util/util.go#L367)<br><strong>Comment</strong>: <pre>Jonathan, why not use HOME?  This is used by other clients, such as the "cf" CLI for cloudfoundry.</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [util/util.go#L367](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/util/util.go#L367)<br><strong>Comment</strong>: <pre>The HOME (in Linux/UNIX is used by so many things, e.g., reset by Telnet, and so many others).

Would rather have something more specific, JAVA_HOME (which clearly belongs to one's JAVA settings or the "MEMBERSRVC_CA_" prefix as an example for something we used earlier to avoid potential collisions, while making it clear that stuff belongs to ""MEMBERSRVC...." etc. Same goes for JAVA and many others).

In general, I would always rather have a more intuitive and explicit error messaging, over storing a hidden (".cop") repository in a user's domain without their knowledge. While clearly this was not the intention, it may bite us back.</pre><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [util/util.go#L367](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/util/util.go#L367)<br><strong>Comment</strong>: <pre>Can we discuss this outside of this changeset. The intention of this changeset is not around this.</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [util/util.go#L373](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/util/util.go#L373)<br><strong>Comment</strong>: <pre>I am sure I have objected to this before/at some point. Please let's not write to "production" especially if someone has not set HOME.

The default (for someone who hasn't read the manual, for example, and so has not set the env variable) should be "dev" or "test" at best. E.g.,

/var/hyperledger/fabric/dev/.fabric-cop</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [util/util.go#L373](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/util/util.go#L373)<br><strong>Comment</strong>: <pre>Still waiting for a response for this, but thinking it over - we also don't really need to have it "hidden" either way (be it dev or test)</pre><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [util/util.go#L373](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/util/util.go#L373)<br><strong>Comment</strong>: <pre>Sorry, forgot to change it here. I'll fix that.</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [util/util.go#L378](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/util/util.go#L378)<br><strong>Comment</strong>: <pre>You are converting to an x509 Certificate</pre><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [util/util.go#L378](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/util/util.go#L378)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [util/util.go#L379](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/util/util.go#L379)<br><strong>Comment</strong>: <pre>If this function supports only Certificate(s), then let's call it as such.</pre><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [util/util.go#L379](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/util/util.go#L379)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [util/util.go#L380](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/util/util.go#L380)<br><strong>Comment</strong>: <pre>Please can we read also the DER part?</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [util/util.go#L380](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/util/util.go#L380)<br><strong>Comment</strong>: <pre>Jonathan, I wrote this and gave it to Saad, so he was asking me what to do here.  I'm not sure I understand either.  Are you proposing that we make the function more general so that it accepts either a PEM or a DER encoding?  In that case, we'll need to change the function name also.  Please clarify.</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [util/util.go#L380](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/util/util.go#L380)<br><strong>Comment</strong>: <pre>The way PEM is decoded, is iteratively/recursively:
That is, you fetch a block, and keep the "rest" (DER), use the block, then decode the "rest" (DER), and so forth

The current code:

1. Errors/throws/complains about not being able to parse a certificate, before we tried to parse the block,
, and another issue is tha,
2. It ignores the "rest" after the first iteration.

---

But I can just follow up with another changeset, it it is easier.</pre><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [util/util.go#L380](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/util/util.go#L380)<br><strong>Comment</strong>: <pre>Yeah, I think Keith was checking this in as part of one of his changeset. Perhaps the changes can be addressed there.</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [util/util.go#L382](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/util/util.go#L382)<br><strong>Comment</strong>: <pre>Potentially misleading: the failure here has nothing to do with a certificate (yet). The package you are using simply reads a block from text (bytes).</pre><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [util/util.go#L382](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/util/util.go#L382)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [util/util.go#L382](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/util/util.go#L382)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [util/util.go#L391](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/util/util.go#L391)<br><strong>Comment</strong>: <pre>EnrollmentID

(let's keep it a "term", as per the original documentation/design docs)</pre><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [util/util.go#L391](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/util/util.go#L391)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [util/util.go#L391](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/util/util.go#L391)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [util/util.go#L400](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/util/util.go#L400)<br><strong>Comment</strong>: <pre>EnrollmentID

(let's keep it a "term", as per the original documentation/design docs)</pre><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [util/util.go#L400](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/util/util.go#L400)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [util/util.go#L400](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/util/util.go#L400)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [util/util_test.go#L207](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/util/util_test.go#L207)<br><strong>Comment</strong>: <pre>Failed -> File</pre><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [util/util_test.go#L207](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/util/util_test.go#L207)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [util/util_test.go#L215](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/util/util_test.go#L215)<br><strong>Comment</strong>: <pre>Let's add some text here?</pre><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [util/util_test.go#L215](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/1bc3982cb7acc21a9786da1cf2a6c5db88c8268a/util/util_test.go#L215)<br><strong>Comment</strong>: <pre>Done</pre></blockquote><h3>PatchSet Number: 5</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Uploader</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Created</strong>: 12/14/2016, 10:23:58 AM<br><strong>UnmergedRevision</strong>: [a52a99ce66261e40997ed59db5bc1c21d8b78921](https://github.com/hyperledger-gerrit-archive/fabric-cop/commit/a52a99ce66261e40997ed59db5bc1c21d8b78921)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/14/2016, 10:32:07 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>Approved</strong>: 12/13/2016, 1:45:13 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 6</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Uploader</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Created</strong>: 12/14/2016, 11:00:14 AM<br><strong>UnmergedRevision</strong>: [62f59e8625ea3c34bde95c0053bd4feb453ef74a](https://github.com/hyperledger-gerrit-archive/fabric-cop/commit/62f59e8625ea3c34bde95c0053bd4feb453ef74a)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/14/2016, 11:07:56 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>Approved</strong>: 12/13/2016, 1:45:13 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 7</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Uploader</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Created</strong>: 12/15/2016, 9:56:31 AM<br><strong>UnmergedRevision</strong>: [43976d08045d98ce10aeb2c70c06d9b218b9c91d](https://github.com/hyperledger-gerrit-archive/fabric-cop/commit/43976d08045d98ce10aeb2c70c06d9b218b9c91d)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/15/2016, 10:02:20 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>Approved</strong>: 12/13/2016, 1:45:13 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Approved</strong>: 12/17/2016, 2:43:27 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [cli/server/dbaccessor.go#L415](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/43976d08045d98ce10aeb2c70c06d9b218b9c91d/cli/server/dbaccessor.go#L415)<br><strong>Comment</strong>: <pre>I think this should simply be "if u.maxEnrollments > 0", right?  If the limit is infinite, then there is no reason to increment the number of enrollments in the DB.</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [cli/server/dbaccessor.go#L415](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/43976d08045d98ce10aeb2c70c06d9b218b9c91d/cli/server/dbaccessor.go#L415)<br><strong>Comment</strong>: <pre>Actually, on 2nd thought, this is correct because if the maxEnrollments is changed, we still need to enforce it for previously enrolled users.</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [cli/server/register.go#L183](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/43976d08045d98ce10aeb2c70c06d9b218b9c91d/cli/server/register.go#L183)<br><strong>Comment</strong>: <pre>Is this 2 database updates?  Any reason this couldn't be done in a single call?  This is the same table, right?</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [cli/server/register.go#L183](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/43976d08045d98ce10aeb2c70c06d9b218b9c91d/cli/server/register.go#L183)<br><strong>Comment</strong>: <pre>I've opened https://jira.hyperledger.org/browse/FAB-1442 to make this improvement in a future changeset.  It is not functionally incorrect as it is.</pre></blockquote><h3>PatchSet Number: 8</h3><blockquote><strong>Type</strong>: NO_CODE_CHANGE<br><strong>Author</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Uploader</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Created</strong>: 12/19/2016, 1:10:32 PM<br><strong>GitHubMergedRevision</strong>: [17abd200eeb649181bc081749c3b72a1fbc75f63](https://github.com/hyperledger-gerrit-archive/fabric-cop/commit/17abd200eeb649181bc081749c3b72a1fbc75f63)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/19/2016, 1:16:44 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>Approved</strong>: 12/19/2016, 2:21:02 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Approved</strong>: 12/19/2016, 2:37:46 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>MergedBy</strong>: Gari Singh<br><strong>Merged</strong>: 12/19/2016, 2:38:19 PM<br><br><strong>Approver</strong>: Pho Le - intelmind787@gmail.com<br><strong>Approved</strong>: 12/19/2016, 2:34:42 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br></blockquote>
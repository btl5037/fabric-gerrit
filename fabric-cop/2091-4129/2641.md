<strong>Project</strong>: fabric-cop<br><strong>Branch</strong>: master<br><strong>ID</strong>: 2641<br><strong>Subject</strong>: Add support for cop client reenroll<br><strong>Status</strong>: MERGED<br><strong>Owner</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Assignee</strong>:<br><strong>Created</strong>: 11/19/2016, 7:22:24 PM<br><strong>LastUpdated</strong>: 12/2/2016, 8:04:11 AM<br><strong>CommitMessage</strong>:<br><pre>Add support for cop client reenroll

This allows a user to renew a certificate by adding
support for the following command:
 cop client reenroll <copServerURL>
This is similar to the enroll command which is
 cop client enroll <enrollmentID> <enrollmentSecret> <copServerURL>
except that the reenroll uses token-based authentication rather than
basic auth.

More specifically, the authorization header of the request contains
a token which has a signature created from the private key of the
current enrollment certificate.  This allows a certificate to be
refreshed by the owner of the current certificate.  The body of a
reenroll request has a CSR just as the body of a enroll request.

Since there was a good bit in common between enroll and reenroll,
I rearranged some code to enable code sharing between the 2 paths.
In particular, some of the code from under the cli/client package
was moved to the lib package to allow it to be shared by enroll,
reenroll, or any other commands in the future.

See https://jira.hyperledger.org/browse/FAB-1147

Change-Id: I350a8bf8a700550e58b44beadc9a9af173cc2fee
Signed-off-by: Keith Smith <bksmith@us.ibm.com>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 11/19/2016, 7:22:24 PM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 11/19/2016, 7:23:53 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/49/</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 11/19/2016, 7:29:40 PM<br><strong>Message</strong>: <pre>Uploaded patch set 2.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 11/19/2016, 7:31:34 PM<br><strong>Message</strong>: <pre>Patch Set 1: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/49/ : FAILURE</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 11/19/2016, 7:31:36 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/50/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 11/19/2016, 7:37:48 PM<br><strong>Message</strong>: <pre>Patch Set 2: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/50/ : FAILURE</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 11/19/2016, 7:51:17 PM<br><strong>Message</strong>: <pre>Patch Set 2:

reverify</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 11/19/2016, 7:52:40 PM<br><strong>Message</strong>: <pre>Patch Set 2: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/51/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 11/19/2016, 7:59:20 PM<br><strong>Message</strong>: <pre>Patch Set 2: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/51/ : FAILURE</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 11/20/2016, 1:56:46 PM<br><strong>Message</strong>: <pre>Uploaded patch set 3.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 11/20/2016, 1:57:49 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/52/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 11/20/2016, 2:03:46 PM<br><strong>Message</strong>: <pre>Patch Set 3: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/52/ : SUCCESS</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 11/22/2016, 10:17:19 AM<br><strong>Message</strong>: <pre>Uploaded patch set 4.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 11/22/2016, 10:20:02 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/71/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 11/22/2016, 10:24:54 AM<br><strong>Message</strong>: <pre>Patch Set 4: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/71/ : SUCCESS</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 11/23/2016, 7:36:30 AM<br><strong>Message</strong>: <pre>Uploaded patch set 5.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 11/23/2016, 7:37:23 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/73/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 11/23/2016, 7:39:15 AM<br><strong>Message</strong>: <pre>Patch Set 5: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/73/ : FAILURE</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 11/23/2016, 7:42:05 AM<br><strong>Message</strong>: <pre>Uploaded patch set 6.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 11/23/2016, 7:43:01 AM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/74/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 11/23/2016, 7:48:44 AM<br><strong>Message</strong>: <pre>Patch Set 6: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/74/ : SUCCESS</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 11/29/2016, 12:49:34 PM<br><strong>Message</strong>: <pre>Uploaded patch set 7.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 11/29/2016, 12:50:26 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/78/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 11/29/2016, 12:51:42 PM<br><strong>Message</strong>: <pre>Patch Set 7: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/78/ : FAILURE</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 11/29/2016, 1:30:03 PM<br><strong>Message</strong>: <pre>Uploaded patch set 8.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 11/29/2016, 1:32:52 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/81/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 11/29/2016, 1:38:33 PM<br><strong>Message</strong>: <pre>Patch Set 8: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/81/ : SUCCESS</pre><strong>Reviewer</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Reviewed</strong>: 11/29/2016, 1:54:17 PM<br><strong>Message</strong>: <pre>Patch Set 8:

(2 comments)</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 11/29/2016, 5:41:48 PM<br><strong>Message</strong>: <pre>Uploaded patch set 9.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 11/29/2016, 5:42:42 PM<br><strong>Message</strong>: <pre>Patch Set 9:

Build Started https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/86/</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 11/29/2016, 5:46:12 PM<br><strong>Message</strong>: <pre>Patch Set 9:

(2 comments)

Addressed the comments</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 11/29/2016, 5:50:22 PM<br><strong>Message</strong>: <pre>Patch Set 9: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/86/ : SUCCESS</pre><strong>Reviewer</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Reviewed</strong>: 11/30/2016, 9:38:20 AM<br><strong>Message</strong>: <pre>Patch Set 9: Code-Review+1</pre><strong>Reviewer</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>Reviewed</strong>: 12/1/2016, 7:50:16 AM<br><strong>Message</strong>: <pre>Patch Set 9: Code-Review-1

(16 comments)

Hi Keith, a quick review from my end...  thank you.</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 12/1/2016, 9:44:32 AM<br><strong>Message</strong>: <pre>Uploaded patch set 10.</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 12/1/2016, 9:46:20 AM<br><strong>Message</strong>: <pre>Patch Set 10:

(13 comments)

I fixed/answered all of Jonathan's comments.  All changes are in patch set 10.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/1/2016, 10:38:52 AM<br><strong>Message</strong>: <pre>Patch Set 10:

Build Started https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/91/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/1/2016, 10:38:55 AM<br><strong>Message</strong>: <pre>Patch Set 10: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/91/ : FAILURE</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 12/1/2016, 12:41:01 PM<br><strong>Message</strong>: <pre>Patch Set 10:

reverify</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/1/2016, 12:41:45 PM<br><strong>Message</strong>: <pre>Patch Set 10: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/92/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/1/2016, 12:45:59 PM<br><strong>Message</strong>: <pre>Patch Set 10: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-cop-verify-x86_64/92/ : SUCCESS</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 12/2/2016, 6:04:49 AM<br><strong>Message</strong>: <pre>Patch Set 10: Code-Review+1

Thanks Keith.  I'll wait for Jonathan, but overall thanks for making the adjustments he asked for</pre><strong>Reviewer</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>Reviewed</strong>: 12/2/2016, 7:11:14 AM<br><strong>Message</strong>: <pre>Patch Set 9:

(7 comments)

Morning. Yes, thank you Keith for all the updates.

One small suggestion for the latest patchset in https://gerrit.hyperledger.org/r/#/c/2641/10/lib/client.go@127

We can fix it now, or later. I'll "LGTM" it now, and we can fix it in one of the next PRs/CRs  whatever's easier.</pre><strong>Reviewer</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>Reviewed</strong>: 12/2/2016, 7:11:58 AM<br><strong>Message</strong>: <pre>Patch Set 10: Code-Review+2</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 12/2/2016, 7:57:09 AM<br><strong>Message</strong>: <pre>Patch Set 10: Code-Review+2</pre><strong>Reviewer</strong>: Gerrit Code Review - gerrit@hyperledger.org<br><strong>Reviewed</strong>: 12/2/2016, 7:57:19 AM<br><strong>Message</strong>: <pre>Change has been successfully merged by Gari Singh</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/2/2016, 7:58:17 AM<br><strong>Message</strong>: <pre>Patch Set 10:

Build Started https://jenkins.hyperledger.org/job/fabric-cop-merge-x86_64/7/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/2/2016, 8:04:11 AM<br><strong>Message</strong>: <pre>Patch Set 10:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-cop-merge-x86_64/7/ : SUCCESS</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Uploader</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Created</strong>: 11/19/2016, 7:22:24 PM<br><strong>UnmergedRevision</strong>: [8a9d2643c2b40ef5b2d81d7e5fe8e4fa20a859ae](https://github.com/hyperledger-gerrit-archive/fabric-cop/commit/8a9d2643c2b40ef5b2d81d7e5fe8e4fa20a859ae)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 11/19/2016, 7:31:34 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Uploader</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Created</strong>: 11/19/2016, 7:29:40 PM<br><strong>UnmergedRevision</strong>: [aae67bb435ba306a970958ca00195db8bea8838d](https://github.com/hyperledger-gerrit-archive/fabric-cop/commit/aae67bb435ba306a970958ca00195db8bea8838d)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 11/19/2016, 7:59:20 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 3</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Uploader</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Created</strong>: 11/20/2016, 1:56:46 PM<br><strong>UnmergedRevision</strong>: [d4917debc553556dd6aa7bda2b82c5b300471d0d](https://github.com/hyperledger-gerrit-archive/fabric-cop/commit/d4917debc553556dd6aa7bda2b82c5b300471d0d)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 11/20/2016, 2:03:46 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 4</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Uploader</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Created</strong>: 11/22/2016, 10:17:19 AM<br><strong>UnmergedRevision</strong>: [ccddf777e41226e710589442ef4537ff4d6d20e0](https://github.com/hyperledger-gerrit-archive/fabric-cop/commit/ccddf777e41226e710589442ef4537ff4d6d20e0)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 11/22/2016, 10:24:54 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 5</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Uploader</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Created</strong>: 11/23/2016, 7:36:30 AM<br><strong>UnmergedRevision</strong>: [e8acdedb449c3c257d3001be9512c37f5d6bcf67](https://github.com/hyperledger-gerrit-archive/fabric-cop/commit/e8acdedb449c3c257d3001be9512c37f5d6bcf67)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 11/23/2016, 7:39:15 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 6</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Uploader</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Created</strong>: 11/23/2016, 7:42:05 AM<br><strong>UnmergedRevision</strong>: [a0859e90d3b11789a26840051cee8b5f356ae106](https://github.com/hyperledger-gerrit-archive/fabric-cop/commit/a0859e90d3b11789a26840051cee8b5f356ae106)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 11/23/2016, 7:48:44 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 7</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Uploader</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Created</strong>: 11/29/2016, 12:49:34 PM<br><strong>UnmergedRevision</strong>: [3cca4e24c20fab40ef400778a7ae7f7b209480cd](https://github.com/hyperledger-gerrit-archive/fabric-cop/commit/3cca4e24c20fab40ef400778a7ae7f7b209480cd)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 11/29/2016, 12:51:42 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 8</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Uploader</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Created</strong>: 11/29/2016, 1:30:03 PM<br><strong>UnmergedRevision</strong>: [a876f017c74c178520e7dab7f4115299715a0242](https://github.com/hyperledger-gerrit-archive/fabric-cop/commit/a876f017c74c178520e7dab7f4115299715a0242)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 11/29/2016, 1:38:33 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [cli/client/enroll.go#L75](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/a876f017c74c178520e7dab7f4115299715a0242/cli/client/enroll.go#L75)<br><strong>Comment</strong>: <pre>The reason I had a check to see if it was json file was because you could potentially have "loglevel=0" as the last argument.</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [cli/client/enroll.go#L75](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/a876f017c74c178520e7dab7f4115299715a0242/cli/client/enroll.go#L75)<br><strong>Comment</strong>: <pre>loglevel=0 isn't recognized.  We should use the COP_DEBUG variable to set this.</pre><strong>Commenter</strong>: Saad Karim - skarim@us.ibm.com<br><strong>CommentLine</strong>: [cli/server/reenroll.go#L92](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/a876f017c74c178520e7dab7f4115299715a0242/cli/server/reenroll.go#L92)<br><strong>Comment</strong>: <pre>You probably don't need all this after my latest changeset moved the DBaccessor has part of the config object. I believe that changeset has been merged.</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [cli/server/reenroll.go#L92](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/a876f017c74c178520e7dab7f4115299715a0242/cli/server/reenroll.go#L92)<br><strong>Comment</strong>: <pre>I simplified</pre></blockquote><h3>PatchSet Number: 9</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Uploader</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Created</strong>: 11/29/2016, 5:41:48 PM<br><strong>UnmergedRevision</strong>: [60cfd294affe8fa74f7a504410eef8d1c5eb3eb4](https://github.com/hyperledger-gerrit-archive/fabric-cop/commit/60cfd294affe8fa74f7a504410eef8d1c5eb3eb4)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 11/29/2016, 5:50:22 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>Approved</strong>: 12/1/2016, 7:50:16 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Saad Karim - skarim@us.ibm.com<br><strong>Approved</strong>: 11/30/2016, 9:38:20 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [cli/cop.go#L144](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/60cfd294affe8fa74f7a504410eef8d1c5eb3eb4/cli/cop.go#L144)<br><strong>Comment</strong>: <pre>Shall we also print out/log the error somehow?</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [cli/cop.go#L144](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/60cfd294affe8fa74f7a504410eef8d1c5eb3eb4/cli/cop.go#L144)<br><strong>Comment</strong>: <pre>Jonathan, cfssl code already prints the error.  I actually did that initially but it was double logging it.</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [cli/cop.go#L144](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/60cfd294affe8fa74f7a504410eef8d1c5eb3eb4/cli/cop.go#L144)<br><strong>Comment</strong>: <pre>Oh, I see. Good to know, thank you.</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [cli/server/auth.go#L131](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/60cfd294affe8fa74f7a504410eef8d1c5eb3eb4/cli/server/auth.go#L131)<br><strong>Comment</strong>: <pre>Hmmm.... what does VerifyToken() return now?</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [cli/server/auth.go#L131](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/60cfd294affe8fa74f7a504410eef8d1c5eb3eb4/cli/server/auth.go#L131)<br><strong>Comment</strong>: <pre>The 1st arg is a pointer to an x509.Certificate, but it is not needed in this context.  Actually, if you look at the revocation changeset (2843), I do use it there.</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [cli/server/reenroll.go#L51](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/60cfd294affe8fa74f7a504410eef8d1c5eb3eb4/cli/server/reenroll.go#L51)<br><strong>Comment</strong>: <pre>Let's remove</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [cli/server/reenroll.go#L51](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/60cfd294affe8fa74f7a504410eef8d1c5eb3eb4/cli/server/reenroll.go#L51)<br><strong>Comment</strong>: <pre>ok</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [cli/server/reenroll.go#L54](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/60cfd294affe8fa74f7a504410eef8d1c5eb3eb4/cli/server/reenroll.go#L54)<br><strong>Comment</strong>: <pre>Let's remove</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [cli/server/reenroll.go#L54](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/60cfd294affe8fa74f7a504410eef8d1c5eb3eb4/cli/server/reenroll.go#L54)<br><strong>Comment</strong>: <pre>ok</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [cli/server/reenroll.go#L61](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/60cfd294affe8fa74f7a504410eef8d1c5eb3eb4/cli/server/reenroll.go#L61)<br><strong>Comment</strong>: <pre>Maybe: "Reenroll request was handled successfully" ?

(We can leave as 'reenroll' if you prefer. Both work here, I see why)</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [cli/server/reenroll.go#L61](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/60cfd294affe8fa74f7a504410eef8d1c5eb3eb4/cli/server/reenroll.go#L61)<br><strong>Comment</strong>: <pre>ok</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [cli/server/reenroll.go#L61](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/60cfd294affe8fa74f7a504410eef8d1c5eb3eb4/cli/server/reenroll.go#L61)<br><strong>Comment</strong>: <pre>BTW: This change was not included in your recent patchset. Not a biggy, just to let you know.</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [cli/server/server.go#L152](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/60cfd294affe8fa74f7a504410eef8d1c5eb3eb4/cli/server/server.go#L152)<br><strong>Comment</strong>: <pre>SignerFromConfigAndDB ?</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [cli/server/server.go#L152](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/60cfd294affe8fa74f7a504410eef8d1c5eb3eb4/cli/server/server.go#L152)<br><strong>Comment</strong>: <pre>ok</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [cli/server/server.go#L153](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/60cfd294affe8fa74f7a504410eef8d1c5eb3eb4/cli/server/server.go#L153)<br><strong>Comment</strong>: <pre>SignerFromConfig -> SignerFromConfigAndDB ?</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [cli/server/server.go#L153](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/60cfd294affe8fa74f7a504410eef8d1c5eb3eb4/cli/server/server.go#L153)<br><strong>Comment</strong>: <pre>ok</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [cli/server/server.go#L166](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/60cfd294affe8fa74f7a504410eef8d1c5eb3eb4/cli/server/server.go#L166)<br><strong>Comment</strong>: <pre>BTW: What is this hardcoded/non-configurable name?</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [cli/server/server.go#L166](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/60cfd294affe8fa74f7a504410eef8d1c5eb3eb4/cli/server/server.go#L166)<br><strong>Comment</strong>: <pre>This function is only used for test case execution.  See the comment at the top.</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [cli/server/server.go#L166](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/60cfd294affe8fa74f7a504410eef8d1c5eb3eb4/cli/server/server.go#L166)<br><strong>Comment</strong>: <pre>Yes, saw this. Thanks. Let's see, maybe it will be useful to be able to configure these too at some point. LGTM</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [lib/client.go#L51](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/60cfd294affe8fa74f7a504410eef8d1c5eb3eb4/lib/client.go#L51)<br><strong>Comment</strong>: <pre>(I know that it's the default in CFSSL, ...)

Do we have plans to change it/make it configurable, or so?</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [lib/client.go#L51](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/60cfd294affe8fa74f7a504410eef8d1c5eb3eb4/lib/client.go#L51)<br><strong>Comment</strong>: <pre>We do plan on making the default https rather than http.  This will be coming soon in a change set.
I wasn't thinking of changing the default port, though maybe we should go with standard 443.  We would then have to override the defaults for test cases no running as root to work on server side.

It is configurable by providing a 'config' string similar to:
   {"serverURL": "https://localhost"}</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [lib/client.go#L51](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/60cfd294affe8fa74f7a504410eef8d1c5eb3eb4/lib/client.go#L51)<br><strong>Comment</strong>: <pre>Thank you. Sounds good. We can discuss that configuration/changeset over a separate JIRA. I think that would be useful.</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [lib/client.go#L119](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/60cfd294affe8fa74f7a504410eef8d1c5eb3eb4/lib/client.go#L119)<br><strong>Comment</strong>: <pre>Hold on, should we not return 'err2' here, not 'err', right?</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [lib/client.go#L119](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/60cfd294affe8fa74f7a504410eef8d1c5eb3eb4/lib/client.go#L119)<br><strong>Comment</strong>: <pre>yes, good catch</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [lib/client.go#L127](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/60cfd294affe8fa74f7a504410eef8d1c5eb3eb4/lib/client.go#L127)<br><strong>Comment</strong>: <pre>Let's make it a sentence describing the status. "The request to Register ..."</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [lib/identity.go#L126](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/60cfd294affe8fa74f7a504410eef8d1c5eb3eb4/lib/identity.go#L126)<br><strong>Comment</strong>: <pre>Yes, this makes much more sense to me now (to have a public getter). Thank you.</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [lib/identity.go#L131](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/60cfd294affe8fa74f7a504410eef8d1c5eb3eb4/lib/identity.go#L131)<br><strong>Comment</strong>: <pre>Similarly, this makes much more sense to me now (to have a public getter). Thank you.</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [testdata/cop.json#L2](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/60cfd294affe8fa74f7a504410eef8d1c5eb3eb4/testdata/cop.json#L2)<br><strong>Comment</strong>: <pre>What does this flag mean please?

Documented anywhere?</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [testdata/cop.json#L2](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/60cfd294affe8fa74f7a504410eef8d1c5eb3eb4/testdata/cop.json#L2)<br><strong>Comment</strong>: <pre>This was intended to be used only during development so that folks could make progress before the authentication framework was in place.  It is used by in cli/server/auth.go to by-pass authentication for all endpoints.  I'll remove it from this and any other files but prefer to leave the functionality there for at least now just in case we need it.  The default value is of course true.</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [testdata/cop.json#L2](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/60cfd294affe8fa74f7a504410eef8d1c5eb3eb4/testdata/cop.json#L2)<br><strong>Comment</strong>: <pre>Thank you.

BTW: If it is still useful (say, while in development), we can still have this and just document it briefly.</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [util/util.go#L171](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/60cfd294affe8fa74f7a504410eef8d1c5eb3eb4/util/util.go#L171)<br><strong>Comment</strong>: <pre>Not sure I understand what's "Error in parsing x509 cert given Block Bytes"...

Mind you, the user has no clue that we have a temporary variable called 'block'.</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [util/util.go#L171](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/60cfd294affe8fa74f7a504410eef8d1c5eb3eb4/util/util.go#L171)<br><strong>Comment</strong>: <pre>Fixing</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [util/util.go#L182](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/60cfd294affe8fa74f7a504410eef8d1c5eb3eb4/util/util.go#L182)<br><strong>Comment</strong>: <pre>What's the type of tockenerr?</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [util/util.go#L182](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/60cfd294affe8fa74f7a504410eef8d1c5eb3eb4/util/util.go#L182)<br><strong>Comment</strong>: <pre>Changing to reuse err variable.  It is an error type.  Also reviewed/improved error messages and use of error variables elsewhere in this module.</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [util/util.go#L182](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/60cfd294affe8fa74f7a504410eef8d1c5eb3eb4/util/util.go#L182)<br><strong>Comment</strong>: <pre>Yes, I saw the improvement. Thanks Keith.</pre></blockquote><h3>PatchSet Number: 10</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Uploader</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Created</strong>: 12/1/2016, 9:44:32 AM<br><strong>GitHubMergedRevision</strong>: [84328df00357b1d17b6aedb7aa2f0c53cfa69324](https://github.com/hyperledger-gerrit-archive/fabric-cop/commit/84328df00357b1d17b6aedb7aa2f0c53cfa69324)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/1/2016, 12:45:59 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>Approved</strong>: 12/2/2016, 7:11:58 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Approved</strong>: 12/2/2016, 7:57:09 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>MergedBy</strong>: Gari Singh<br><strong>Merged</strong>: 12/2/2016, 7:57:19 AM<br><br><h2>Comments</h2><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [lib/client.go#L127](https://github.com/hyperledger-gerrit-archive/fabric-cop/blob/84328df00357b1d17b6aedb7aa2f0c53cfa69324/lib/client.go#L127)<br><strong>Comment</strong>: <pre>"The register request *completely* successfully"
>>
"The register request [completed] successfully"</pre></blockquote>
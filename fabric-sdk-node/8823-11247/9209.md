<strong>Project</strong>: fabric-sdk-node<br><strong>Branch</strong>: master<br><strong>ID</strong>: 9209<br><strong>Subject</strong>: FAB-3881  Remove local key store from Crypto<br><strong>Status</strong>: MERGED<br><strong>Owner</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>Assignee</strong>:<br><strong>Created</strong>: 5/10/2017, 3:39:50 PM<br><strong>LastUpdated</strong>: 5/18/2017, 2:37:00 PM<br><strong>CommitMessage</strong>:<br><pre>FAB-3881  Remove local key store from Crypto

CryptoSuite does not need to include a store
when used by Chain.js, so the store is removed
from CryptoSuite and when needed the application
will get a Client.newCryptoKeyStore(...) and
set it on the CryptoSuite.

Change-Id: I41168b20fd17121432f550bf26e814199a465648
Signed-off-by: cdaughtr <cdaughtr@us.ibm.com>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>Reviewed</strong>: 5/10/2017, 3:39:50 PM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/10/2017, 3:40:01 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-s390x/462/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/10/2017, 3:43:16 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-x86_64/993/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/10/2017, 4:03:31 PM<br><strong>Message</strong>: <pre>Patch Set 1: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-s390x/462/ : FAILURE (skipped)

https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-x86_64/993/ : FAILURE</pre><strong>Reviewer</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>Reviewed</strong>: 5/10/2017, 10:15:13 PM<br><strong>Message</strong>: <pre>Patch Set 1: Code-Review-1

(10 comments)</pre><strong>Reviewer</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>Reviewed</strong>: 5/11/2017, 4:47:51 PM<br><strong>Message</strong>: <pre>Uploaded patch set 2.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/11/2017, 4:48:23 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-s390x/472/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/11/2017, 4:56:00 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-x86_64/1003/ (2/2)</pre><strong>Reviewer</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>Reviewed</strong>: 5/11/2017, 4:57:08 PM<br><strong>Message</strong>: <pre>Uploaded patch set 3: Commit message was updated.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/11/2017, 4:57:18 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-s390x/473/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/11/2017, 5:01:51 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-x86_64/1004/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/11/2017, 5:24:30 PM<br><strong>Message</strong>: <pre>Patch Set 2: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-s390x/472/ : FAILURE (skipped)

https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-x86_64/1003/ : FAILURE</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/11/2017, 5:27:42 PM<br><strong>Message</strong>: <pre>Patch Set 3: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-s390x/473/ : FAILURE (skipped)

https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-x86_64/1004/ : FAILURE</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/11/2017, 7:03:31 PM<br><strong>Message</strong>: <pre>Patch Set 3: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-x86_64/1005/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/11/2017, 7:03:31 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-s390x/474/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/11/2017, 7:31:04 PM<br><strong>Message</strong>: <pre>Patch Set 3: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-x86_64/1005/ : FAILURE

https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-s390x/474/ : FAILURE (skipped)</pre><strong>Reviewer</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>Reviewed</strong>: 5/15/2017, 6:08:02 PM<br><strong>Message</strong>: <pre>Uploaded patch set 4.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/15/2017, 6:08:11 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-s390x/485/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/15/2017, 6:11:06 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-x86_64/1016/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/15/2017, 6:30:33 PM<br><strong>Message</strong>: <pre>Patch Set 4: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-s390x/485/ : FAILURE (skipped)

https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-x86_64/1016/ : FAILURE</pre><strong>Reviewer</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>Reviewed</strong>: 5/16/2017, 3:38:55 PM<br><strong>Message</strong>: <pre>Uploaded patch set 5.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/16/2017, 3:39:04 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-s390x/490/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/16/2017, 3:43:32 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-x86_64/1021/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/16/2017, 4:03:42 PM<br><strong>Message</strong>: <pre>Patch Set 5: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-x86_64/1021/ : FAILURE

https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-s390x/490/ : FAILURE (skipped)</pre><strong>Reviewer</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>Reviewed</strong>: 5/16/2017, 4:28:33 PM<br><strong>Message</strong>: <pre>Patch Set 5:

(2 comments)

reverify</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/16/2017, 4:28:46 PM<br><strong>Message</strong>: <pre>Patch Set 5: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-s390x/491/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/16/2017, 4:33:50 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-x86_64/1022/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/16/2017, 4:55:51 PM<br><strong>Message</strong>: <pre>Patch Set 5: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-x86_64/1022/ : FAILURE

https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-s390x/491/ : FAILURE (skipped)</pre><strong>Reviewer</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>Reviewed</strong>: 5/16/2017, 5:41:10 PM<br><strong>Message</strong>: <pre>Patch Set 5: Code-Review-1

(6 comments)</pre><strong>Reviewer</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>Reviewed</strong>: 5/17/2017, 11:03:39 AM<br><strong>Message</strong>: <pre>Patch Set 5:

(6 comments)</pre><strong>Reviewer</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>Reviewed</strong>: 5/17/2017, 12:35:59 PM<br><strong>Message</strong>: <pre>Patch Set 5:

(2 comments)</pre><strong>Reviewer</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>Reviewed</strong>: 5/17/2017, 12:46:43 PM<br><strong>Message</strong>: <pre>Patch Set 5:

(3 comments)</pre><strong>Reviewer</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>Reviewed</strong>: 5/18/2017, 5:41:20 AM<br><strong>Message</strong>: <pre>Uploaded patch set 6.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2017, 5:41:29 AM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-s390x/499/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2017, 5:44:29 AM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-x86_64/1030/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2017, 6:09:34 AM<br><strong>Message</strong>: <pre>Patch Set 6: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-x86_64/1030/ : SUCCESS

https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-s390x/499/ : SUCCESS</pre><strong>Reviewer</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>Reviewed</strong>: 5/18/2017, 9:46:10 AM<br><strong>Message</strong>: <pre>Patch Set 5:

(5 comments)</pre><strong>Reviewer</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>Reviewed</strong>: 5/18/2017, 11:32:26 AM<br><strong>Message</strong>: <pre>Uploaded patch set 7.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2017, 11:32:33 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-s390x/500/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2017, 11:37:14 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-x86_64/1031/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2017, 11:57:39 AM<br><strong>Message</strong>: <pre>Patch Set 7: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-x86_64/1031/ : FAILURE

https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-s390x/500/ : FAILURE (skipped)</pre><strong>Reviewer</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>Reviewed</strong>: 5/18/2017, 12:53:09 PM<br><strong>Message</strong>: <pre>Uploaded patch set 8.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2017, 12:53:19 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-s390x/501/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2017, 12:58:02 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-x86_64/1032/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2017, 1:18:28 PM<br><strong>Message</strong>: <pre>Patch Set 8: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-x86_64/1032/ : SUCCESS

https://jenkins.hyperledger.org/job/fabric-sdk-node-verify-s390x/501/ : SUCCESS</pre><strong>Reviewer</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>Reviewed</strong>: 5/18/2017, 1:47:56 PM<br><strong>Message</strong>: <pre>Patch Set 8: Code-Review+2

(3 comments)

please see my comments for further enhancements, but can be done in a separate CR. thanks!</pre><strong>Reviewer</strong>: Gerrit Code Review - gerrit@hyperledger.org<br><strong>Reviewed</strong>: 5/18/2017, 1:48:00 PM<br><strong>Message</strong>: <pre>Change has been successfully merged by Jim Zhang</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2017, 1:48:10 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node-merge-s390x/134/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2017, 1:54:55 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node-merge-x86_64/309/ (2/2)</pre><strong>Reviewer</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>Reviewed</strong>: 5/18/2017, 2:35:32 PM<br><strong>Message</strong>: <pre>Patch Set 8:

(3 comments)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2017, 2:37:00 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-sdk-node-merge-x86_64/309/ : FAILURE

https://jenkins.hyperledger.org/job/fabric-sdk-node-merge-s390x/134/ : SUCCESS</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>Uploader</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>Created</strong>: 5/10/2017, 3:39:50 PM<br><strong>UnmergedRevision</strong>: [c5664c1dd0b112c9ac8ff83cc418365b59563b63](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/commit/c5664c1dd0b112c9ac8ff83cc418365b59563b63)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/10/2017, 4:03:31 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>Approved</strong>: 5/10/2017, 10:15:13 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>CommentLine</strong>: [fabric-ca-client/lib/msp/LocalMSP.js#L1](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/c5664c1dd0b112c9ac8ff83cc418365b59563b63/fabric-ca-client/lib/msp/LocalMSP.js#L1)<br><strong>Comment</strong>: <pre>should be copied by `gulp ca` and ignored from git checkin</pre><strong>Commenter</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>CommentLine</strong>: [fabric-ca-client/lib/msp/LocalMSP.js#L1](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/c5664c1dd0b112c9ac8ff83cc418365b59563b63/fabric-ca-client/lib/msp/LocalMSP.js#L1)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>CommentLine</strong>: [fabric-ca-client/lib/msp/msp.js#L1](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/c5664c1dd0b112c9ac8ff83cc418365b59563b63/fabric-ca-client/lib/msp/msp.js#L1)<br><strong>Comment</strong>: <pre>this is copied by `gulp ca` and should be ignored from git checkin</pre><strong>Commenter</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>CommentLine</strong>: [fabric-ca-client/lib/msp/msp.js#L1](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/c5664c1dd0b112c9ac8ff83cc418365b59563b63/fabric-ca-client/lib/msp/msp.js#L1)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>CommentLine</strong>: [fabric-client/lib/impl/CryptoSuite_ECDSA_AES.js#L56](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/c5664c1dd0b112c9ac8ff83cc418365b59563b63/fabric-client/lib/impl/CryptoSuite_ECDSA_AES.js#L56)<br><strong>Comment</strong>: <pre>with the LocalMSP now managing the CryptoKeyStore, we should eliminate these two params from the constructor, such that the cryptosuite instance is created without any concerns of the keystore. The keystore will be set via the setter method as a separate step, by someone like the LocalMSP who needs to use the cryptosuite instance to perform operations that requires a crypto key store.</pre><strong>Commenter</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>CommentLine</strong>: [fabric-client/lib/impl/CryptoSuite_ECDSA_AES.js#L78](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/c5664c1dd0b112c9ac8ff83cc418365b59563b63/fabric-client/lib/impl/CryptoSuite_ECDSA_AES.js#L78)<br><strong>Comment</strong>: <pre>per comment above, this is not needed any longer.</pre><strong>Commenter</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>CommentLine</strong>: [fabric-client/lib/impl/CryptoSuite_ECDSA_AES.js#L83](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/c5664c1dd0b112c9ac8ff83cc418365b59563b63/fabric-client/lib/impl/CryptoSuite_ECDSA_AES.js#L83)<br><strong>Comment</strong>: <pre>probably a getter for the Crypto Key Store instead, corresponding to the setter discussed in the next comment</pre><strong>Commenter</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>CommentLine</strong>: [fabric-client/lib/impl/CryptoSuite_ECDSA_AES.js#L87](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/c5664c1dd0b112c9ac8ff83cc418365b59563b63/fabric-client/lib/impl/CryptoSuite_ECDSA_AES.js#L87)<br><strong>Comment</strong>: <pre>the crypto suite only needs the crypto keys store, instead of the local MSP. replace this with crypto key store to keep class level coupling to a minimum.</pre><strong>Commenter</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>CommentLine</strong>: [fabric-client/lib/impl/CryptoSuite_ECDSA_AES.js#L165](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/c5664c1dd0b112c9ac8ff83cc418365b59563b63/fabric-client/lib/impl/CryptoSuite_ECDSA_AES.js#L165)<br><strong>Comment</strong>: <pre>should check the value of opts.ephemeral, if "false" then the caller's intent is for the generated key to be saved in the key store, and should reject here. resolve if opts.ephemeral is "true"</pre><strong>Commenter</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>CommentLine</strong>: [fabric-client/lib/impl/CryptoSuite_ECDSA_AES.js#L242](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/c5664c1dd0b112c9ac8ff83cc418365b59563b63/fabric-client/lib/impl/CryptoSuite_ECDSA_AES.js#L242)<br><strong>Comment</strong>: <pre>same as above</pre><strong>Commenter</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>CommentLine</strong>: [fabric-client/lib/impl/CryptoSuite_ECDSA_AES.js#L274](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/c5664c1dd0b112c9ac8ff83cc418365b59563b63/fabric-client/lib/impl/CryptoSuite_ECDSA_AES.js#L274)<br><strong>Comment</strong>: <pre>key store</pre><strong>Commenter</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>CommentLine</strong>: [fabric-client/lib/msp/LocalMSP.js#L24](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/c5664c1dd0b112c9ac8ff83cc418365b59563b63/fabric-client/lib/msp/LocalMSP.js#L24)<br><strong>Comment</strong>: <pre>now that i'm looking at what LocalMSP is doing, i realize it's sole purpose is trying to manage the crypto key store. I'm starting to think why we need this at all. I think the following would work better:
- add a newCryptoKeyStore() method to Client.js, and move what you have below to that method
- applications would simply call setCryptoKeyStore() on the CryptoSuite object when it's needed. like before it calls User.setEnrollment() it'll make sure the cryptosuite on the user object has a key store.

what do you think?</pre></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>Uploader</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>Created</strong>: 5/11/2017, 4:47:51 PM<br><strong>UnmergedRevision</strong>: [cfd5918e9a58451ac8280fc965fe4437f418173b](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/commit/cfd5918e9a58451ac8280fc965fe4437f418173b)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/11/2017, 5:24:30 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 3</h3><blockquote><strong>Type</strong>: NO_CODE_CHANGE<br><strong>Author</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>Uploader</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>Created</strong>: 5/11/2017, 4:57:08 PM<br><strong>UnmergedRevision</strong>: [eeea6e05d054f27bc3bddf4a2fc2067ff6d2ebc1](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/commit/eeea6e05d054f27bc3bddf4a2fc2067ff6d2ebc1)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/11/2017, 7:31:04 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 4</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>Uploader</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>Created</strong>: 5/15/2017, 6:08:02 PM<br><strong>UnmergedRevision</strong>: [1e93f32be0268a38ab080058fafbfd4a6186d939](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/commit/1e93f32be0268a38ab080058fafbfd4a6186d939)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/15/2017, 6:30:33 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 5</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>Uploader</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>Created</strong>: 5/16/2017, 3:38:55 PM<br><strong>UnmergedRevision</strong>: [e3af148d8327182da23e7fdcd82fdc270b507862](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/commit/e3af148d8327182da23e7fdcd82fdc270b507862)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/16/2017, 4:55:51 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>Approved</strong>: 5/16/2017, 5:41:10 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>CommentLine</strong>: [fabric-client/lib/impl/CryptoSuite_ECDSA_AES.js#L52](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/e3af148d8327182da23e7fdcd82fdc270b507862/fabric-client/lib/impl/CryptoSuite_ECDSA_AES.js#L52)<br><strong>Comment</strong>: <pre>should be removed</pre><strong>Commenter</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>CommentLine</strong>: [fabric-client/lib/impl/CryptoSuite_ECDSA_AES.js#L52](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/e3af148d8327182da23e7fdcd82fdc270b507862/fabric-client/lib/impl/CryptoSuite_ECDSA_AES.js#L52)<br><strong>Comment</strong>: <pre>Changed doc for opts and removed KVSImplClass.  Now opts is specifically for bccps_pkcs11:
@param {object} opts Option is the form { lib: string, slot: number, pin: string }</pre><strong>Commenter</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>CommentLine</strong>: [fabric-client/lib/impl/CryptoSuite_ECDSA_AES.js#L52](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/e3af148d8327182da23e7fdcd82fdc270b507862/fabric-client/lib/impl/CryptoSuite_ECDSA_AES.js#L52)<br><strong>Comment</strong>: <pre>note that the PKCS11 class is a parallel implementation to this class, meaning you don't need to take into consideration what PKCS11 needs when you design this class.

so, the opts parameter is not needed here.</pre><strong>Commenter</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>CommentLine</strong>: [fabric-client/lib/impl/CryptoSuite_ECDSA_AES.js#L52](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/e3af148d8327182da23e7fdcd82fdc270b507862/fabric-client/lib/impl/CryptoSuite_ECDSA_AES.js#L52)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>CommentLine</strong>: [fabric-client/lib/impl/CryptoSuite_ECDSA_AES.js#L55](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/e3af148d8327182da23e7fdcd82fdc270b507862/fabric-client/lib/impl/CryptoSuite_ECDSA_AES.js#L55)<br><strong>Comment</strong>: <pre>not needed any longer</pre><strong>Commenter</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>CommentLine</strong>: [fabric-client/lib/impl/CryptoSuite_ECDSA_AES.js#L55](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/e3af148d8327182da23e7fdcd82fdc270b507862/fabric-client/lib/impl/CryptoSuite_ECDSA_AES.js#L55)<br><strong>Comment</strong>: <pre>I left this opts to pass to bccsp_pks11.js which has an opts as the 2nd parameter. settings gets passed as opts from utils.newCryptoSuite</pre><strong>Commenter</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>CommentLine</strong>: [fabric-client/lib/impl/CryptoSuite_ECDSA_AES.js#L55](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/e3af148d8327182da23e7fdcd82fdc270b507862/fabric-client/lib/impl/CryptoSuite_ECDSA_AES.js#L55)<br><strong>Comment</strong>: <pre>see response above</pre><strong>Commenter</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>CommentLine</strong>: [fabric-client/lib/impl/CryptoSuite_ECDSA_AES.js#L55](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/e3af148d8327182da23e7fdcd82fdc270b507862/fabric-client/lib/impl/CryptoSuite_ECDSA_AES.js#L55)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>CommentLine</strong>: [fabric-client/lib/impl/CryptoSuite_ECDSA_AES.js#L243](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/e3af148d8327182da23e7fdcd82fdc270b507862/fabric-client/lib/impl/CryptoSuite_ECDSA_AES.js#L243)<br><strong>Comment</strong>: <pre>this code branch is likely not covered in unit test, because the "reject()" call would fail. please make sure this is covered in unit test's negative checks</pre><strong>Commenter</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>CommentLine</strong>: [fabric-client/lib/impl/CryptoSuite_ECDSA_AES.js#L243](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/e3af148d8327182da23e7fdcd82fdc270b507862/fabric-client/lib/impl/CryptoSuite_ECDSA_AES.js#L243)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>CommentLine</strong>: [fabric-client/lib/utils.js#L48](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/e3af148d8327182da23e7fdcd82fdc270b507862/fabric-client/lib/utils.js#L48)<br><strong>Comment</strong>: <pre>I like the consolidation of the optional 'opts' into 'settings'</pre><strong>Commenter</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>CommentLine</strong>: [fabric-client/lib/utils.js#L94](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/e3af148d8327182da23e7fdcd82fdc270b507862/fabric-client/lib/utils.js#L94)<br><strong>Comment</strong>: <pre>the `opt` should not be required any longer, now that the crypto store is done outside of the cryptosuite and just set to it.</pre><strong>Commenter</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>CommentLine</strong>: [fabric-client/lib/utils.js#L94](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/e3af148d8327182da23e7fdcd82fdc270b507862/fabric-client/lib/utils.js#L94)<br><strong>Comment</strong>: <pre>I found that opts was originally being used for both the cryptoKeyStore and the bccsp_pkcs11 2nd parameter where lib, slot and pin can be passed.  So the opts that is being passed here is just for bccsp_pkcs11, else we get test some failures.</pre><strong>Commenter</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>CommentLine</strong>: [fabric-client/lib/utils.js#L94](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/e3af148d8327182da23e7fdcd82fdc270b507862/fabric-client/lib/utils.js#L94)<br><strong>Comment</strong>: <pre>ok, that makes sense. in that case let's move the 'opts' to the 3rd place so it's optional. note that in CryptoSuite_ECDSA_AES constructor, you'll only have 'keysize' and 'hashAlgo'. and in the PKCS11 constructor, you'll have all 3.</pre><strong>Commenter</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>CommentLine</strong>: [fabric-client/lib/utils.js#L94](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/e3af148d8327182da23e7fdcd82fdc270b507862/fabric-client/lib/utils.js#L94)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>CommentLine</strong>: [fabric-client/lib/utils.js#L94](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/e3af148d8327182da23e7fdcd82fdc270b507862/fabric-client/lib/utils.js#L94)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>CommentLine</strong>: [fabric-client/lib/utils.js#L408](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/e3af148d8327182da23e7fdcd82fdc270b507862/fabric-client/lib/utils.js#L408)<br><strong>Comment</strong>: <pre>this doesn't need to be an exported method since it will have newCryptoKeyStore() exported. should just be a local function</pre><strong>Commenter</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>CommentLine</strong>: [fabric-client/lib/utils.js#L408](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/e3af148d8327182da23e7fdcd82fdc270b507862/fabric-client/lib/utils.js#L408)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>CommentLine</strong>: [fabric-client/lib/utils.js#L444](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/e3af148d8327182da23e7fdcd82fdc270b507862/fabric-client/lib/utils.js#L444)<br><strong>Comment</strong>: <pre>should be moved to the top so require() doesn't get called repeatedly every time _getKeyStore() is called</pre><strong>Commenter</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>CommentLine</strong>: [fabric-client/lib/utils.js#L444](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/e3af148d8327182da23e7fdcd82fdc270b507862/fabric-client/lib/utils.js#L444)<br><strong>Comment</strong>: <pre>Moved it to the bottom of utils to allow utils to be loaded prior to CryptoKeyStore's require of utils, else an error is thrown,  TypeError: utils.getLogger is not a function.</pre><strong>Commenter</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>CommentLine</strong>: [fabric-client/lib/utils.js#L444](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/e3af148d8327182da23e7fdcd82fdc270b507862/fabric-client/lib/utils.js#L444)<br><strong>Comment</strong>: <pre>ah ok, circular dependencies. in that case i think your original approach to inline the require inside the _getKeyStore() is more robust.</pre><strong>Commenter</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>CommentLine</strong>: [fabric-client/lib/utils.js#L444](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/e3af148d8327182da23e7fdcd82fdc270b507862/fabric-client/lib/utils.js#L444)<br><strong>Comment</strong>: <pre>Done</pre></blockquote><h3>PatchSet Number: 6</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>Uploader</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>Created</strong>: 5/18/2017, 5:41:20 AM<br><strong>UnmergedRevision</strong>: [7c50012dd82ad8c06af0e162386a3f7ae6248732](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/commit/7c50012dd82ad8c06af0e162386a3f7ae6248732)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/18/2017, 6:09:34 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 7</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>Uploader</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>Created</strong>: 5/18/2017, 11:32:26 AM<br><strong>UnmergedRevision</strong>: [8265b4395949703cb6be7c4697d9c2cff376b2b0](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/commit/8265b4395949703cb6be7c4697d9c2cff376b2b0)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/18/2017, 11:57:39 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 8</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>Uploader</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>Created</strong>: 5/18/2017, 12:53:09 PM<br><strong>GitHubMergedRevision</strong>: [6d5751abc16af0f4c248ef5bb6c9118c00fd25a4](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/commit/6d5751abc16af0f4c248ef5bb6c9118c00fd25a4)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/18/2017, 1:18:28 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>Approved</strong>: 5/18/2017, 1:47:56 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>MergedBy</strong>: Jim Zhang<br><strong>Merged</strong>: 5/18/2017, 1:48:00 PM<br><br><h2>Comments</h2><strong>Commenter</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>CommentLine</strong>: [fabric-ca-client/lib/FabricCAClientImpl.js#L67](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/6d5751abc16af0f4c248ef5bb6c9118c00fd25a4/fabric-ca-client/lib/FabricCAClientImpl.js#L67)<br><strong>Comment</strong>: <pre>this class also needs a static newCryptoKeyStore() method just like Client.js. the two packages 'fabric-client' and 'fabric-ca-client' are self-sufficient so app developers should be able to create a custom crypto key store in FabricCAClientImpl as well</pre><strong>Commenter</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>CommentLine</strong>: [fabric-ca-client/lib/FabricCAClientImpl.js#L67](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/6d5751abc16af0f4c248ef5bb6c9118c00fd25a4/fabric-ca-client/lib/FabricCAClientImpl.js#L67)<br><strong>Comment</strong>: <pre>OK.  Will use FAB-4019 to make the change.</pre><strong>Commenter</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>CommentLine</strong>: [fabric-client/lib/Client.js#L78](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/6d5751abc16af0f4c248ef5bb6c9118c00fd25a4/fabric-client/lib/Client.js#L78)<br><strong>Comment</strong>: <pre>this makes it sound like the *same* instance should be used in both places. in fact i don't think this line is needed.</pre><strong>Commenter</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>CommentLine</strong>: [fabric-client/lib/Client.js#L78](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/6d5751abc16af0f4c248ef5bb6c9118c00fd25a4/fabric-client/lib/Client.js#L78)<br><strong>Comment</strong>: <pre>OK.  Will include this change with FAB-4019 newCryptoKeyStore on FabricCAClientImpl.</pre><strong>Commenter</strong>: Jim Zhang - jim_the_matrix@hotmail.com<br><strong>CommentLine</strong>: [fabric-client/lib/Client.js#L117](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/6d5751abc16af0f4c248ef5bb6c9118c00fd25a4/fabric-client/lib/Client.js#L117)<br><strong>Comment</strong>: <pre>use <br><code>....</code> to make this stand out as code snippet in the generated html</pre><strong>Commenter</strong>: Caroline Daughtrey - cdaughtr@us.ibm.com<br><strong>CommentLine</strong>: [fabric-client/lib/Client.js#L117](https://github.com/hyperledger-gerrit-archive/fabric-sdk-node/blob/6d5751abc16af0f4c248ef5bb6c9118c00fd25a4/fabric-client/lib/Client.js#L117)<br><strong>Comment</strong>: <pre>Will do on FAB-4019.</pre></blockquote>
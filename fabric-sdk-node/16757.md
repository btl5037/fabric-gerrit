<strong>Project</strong>: fabric-sdk-node</br><strong>Branch</strong>: master<br><strong>ID</strong>: 16757<br><strong>Subject</strong>: FAB-7642 NodeSDK - connection profile events<br><strong>Status</strong>: MERGED<br><strong>Owner</strong>: Bret Harrison - beharrison@nc.rr.com<br><strong>Assignee</strong>:<strong>Created</strong>: 1/10/2018, 5:39:43 PM<br><strong>LastUpdated</strong>: 1/22/2018, 2:01:46 PM<br><strong>CommitMessage</strong>:<br><pre>FAB-7642 NodeSDK - connection profile events

Add an API to get the channel event hubs for an
organization on a channel. Requires that a
connection profile be loaded.

Change-Id: If8f075d1ed69c4f2ae4a155b87bf143db281f065
Signed-off-by: Bret Harrison <beharrison@nc.rr.com>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Bret Harrison - beharrison@nc.rr.com<br><strong>Reviewed</strong>: 1/10/2018, 5:39:43 PM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/10/2018, 5:39:50 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node8-verify-s390x/80/ (1/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/10/2018, 5:42:55 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node8-verify-x86_64/253/ (2/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/10/2018, 5:43:00 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node-vulnerable-tests-x86_64/175/ (3/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/10/2018, 6:07:13 PM<br><strong>Message</strong>: <pre>Patch Set 1: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-sdk-node8-verify-x86_64/253/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-sdk-node8-verify-x86_64/253

https://jenkins.hyperledger.org/job/fabric-sdk-node-vulnerable-tests-x86_64/175/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-sdk-node-vulnerable-tests-x86_64/175

https://jenkins.hyperledger.org/job/fabric-sdk-node8-verify-s390x/80/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-sdk-node8-verify-s390x/80</pre><strong>Reviewer</strong>: Bret Harrison - beharrison@nc.rr.com<br><strong>Reviewed</strong>: 1/17/2018, 8:23:35 PM<br><strong>Message</strong>: <pre>Uploaded patch set 2.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/17/2018, 8:23:44 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node8-verify-s390x/91/ (1/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/17/2018, 8:24:37 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node8-verify-x86_64/264/ (2/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/17/2018, 8:24:58 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node-vulnerable-tests-x86_64/186/ (3/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/17/2018, 8:37:41 PM<br><strong>Message</strong>: <pre>Patch Set 2: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-sdk-node8-verify-x86_64/264/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-sdk-node8-verify-x86_64/264

https://jenkins.hyperledger.org/job/fabric-sdk-node-vulnerable-tests-x86_64/186/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-sdk-node-vulnerable-tests-x86_64/186

https://jenkins.hyperledger.org/job/fabric-sdk-node8-verify-s390x/91/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-sdk-node8-verify-s390x/91</pre><strong>Reviewer</strong>: Dave Kelsey - d_kelsey@uk.ibm.com<br><strong>Reviewed</strong>: 1/19/2018, 5:07:47 AM<br><strong>Message</strong>: <pre>Patch Set 2: Code-Review+1</pre><strong>Reviewer</strong>: Bret Harrison - beharrison@nc.rr.com<br><strong>Reviewed</strong>: 1/19/2018, 3:21:33 PM<br><strong>Message</strong>: <pre>Patch Set 3: Patch Set 2 was rebased</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/19/2018, 3:21:42 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node8-verify-s390x/99/ (1/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/19/2018, 3:23:30 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node8-verify-x86_64/271/ (2/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/19/2018, 3:23:59 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node-vulnerable-tests-x86_64/193/ (3/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/19/2018, 3:38:38 PM<br><strong>Message</strong>: <pre>Patch Set 3: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-sdk-node8-verify-x86_64/271/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-sdk-node8-verify-x86_64/271

https://jenkins.hyperledger.org/job/fabric-sdk-node-vulnerable-tests-x86_64/193/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-sdk-node-vulnerable-tests-x86_64/193

https://jenkins.hyperledger.org/job/fabric-sdk-node8-verify-s390x/99/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-sdk-node8-verify-s390x/99</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 1/19/2018, 5:26:17 PM<br><strong>Message</strong>: <pre>Patch Set 3: Code-Review-1

(4 comments)

I don't understand how this will be used.  It would seem that if you want to deliver an event exactly once, then you would need to find one peer per channel that is up and only be connected to one at a time.  Is that logic, or some other logic to remove duplicate notifications, going to be handled by composer?  Anyway, I need more info in order to review this.</pre><strong>Reviewer</strong>: Bret Harrison - beharrison@nc.rr.com<br><strong>Reviewed</strong>: 1/19/2018, 5:52:41 PM<br><strong>Message</strong>: <pre>Patch Set 3:

(4 comments)

You might think of the event as being a duplicate, but it is from a different peer and it could have different status. Having all your peers post when they are done committing the transaction is the only way to be sure you can move forward with dependent transactions or queries.</pre><strong>Reviewer</strong>: Bret Harrison - beharrison@nc.rr.com<br><strong>Reviewed</strong>: 1/19/2018, 5:53:17 PM<br><strong>Message</strong>: <pre>Uploaded patch set 4.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/19/2018, 5:53:27 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node8-verify-s390x/100/ (1/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/19/2018, 5:55:26 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node8-verify-x86_64/272/ (2/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/19/2018, 5:55:47 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node-vulnerable-tests-x86_64/194/ (3/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/19/2018, 6:13:04 PM<br><strong>Message</strong>: <pre>Patch Set 4: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-sdk-node8-verify-x86_64/272/ : FAILURE

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-sdk-node8-verify-x86_64/272/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-sdk-node8-verify-x86_64/272

https://jenkins.hyperledger.org/job/fabric-sdk-node-vulnerable-tests-x86_64/194/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-sdk-node-vulnerable-tests-x86_64/194

https://jenkins.hyperledger.org/job/fabric-sdk-node8-verify-s390x/100/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-sdk-node8-verify-s390x/100</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 1/20/2018, 9:09:35 AM<br><strong>Message</strong>: <pre>Patch Set 4: Code-Review-1

I don't see how the same event from different peers can have a different status since these events come from blocks written to the ledger which by definition must be the same across peers.  Am I missing something?

I don't understand the design of the getChannelEventHubsForOrg method in Channel.js.  I think it will send folks down a path of doing something very difficult, more difficult than it needs to be, or wrong.

It seems to me that the existing ChannelEventHub could be enhanced to know about multiple peers, but only be connected to one at a time.  If the connection fails to the current peer, then it remembers the last block, reconnects to any of the peers, and then continues with the next block.  The list of peers associated with a ChannelEventHub could come by default from the network config if it is loaded, but could be set explicitly also.</pre><strong>Reviewer</strong>: Bret Harrison - beharrison@nc.rr.com<br><strong>Reviewed</strong>: 1/22/2018, 10:29:01 AM<br><strong>Message</strong>: <pre>Patch Set 4:

reverify</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/22/2018, 10:29:13 AM<br><strong>Message</strong>: <pre>Patch Set 4: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node8-verify-s390x/101/ (1/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/22/2018, 10:31:44 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node8-verify-x86_64/273/ (2/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/22/2018, 10:32:09 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-sdk-node-vulnerable-tests-x86_64/195/ (3/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/22/2018, 10:51:45 AM<br><strong>Message</strong>: <pre>Patch Set 4: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-sdk-node8-verify-x86_64/273/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-sdk-node8-verify-x86_64/273

https://jenkins.hyperledger.org/job/fabric-sdk-node-vulnerable-tests-x86_64/195/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-sdk-node-vulnerable-tests-x86_64/195

https://jenkins.hyperledger.org/job/fabric-sdk-node8-verify-s390x/101/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-sdk-node8-verify-s390x/101</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 1/22/2018, 1:42:23 PM<br><strong>Message</strong>: <pre>Patch Set 4: Code-Review+2

Composer needs to know when a transaction has been committed on ALL peers, thus this design.</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 1/22/2018, 1:42:26 PM<br><strong>Message</strong>: <pre>Change has been successfully merged by Keith Smith</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/22/2018, 2:01:46 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-sdk-node8-merge-s390x/25/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-sdk-node8-merge-s390x/25

https://jenkins.hyperledger.org/job/fabric-sdk-node8-merge-x86_64/91/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-sdk-node8-merge-x86_64/91</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Bret Harrison - beharrison@nc.rr.com<br><strong>Uploader</strong>: Bret Harrison - beharrison@nc.rr.com<br><strong>Created</strong>: 1515623983<br><strong>GitHubRevision</strong>: [ef19ecb999f9983b82e05c9a34bc8232f8a3d591](https://github.com/hyperledger/fabric-sdk-node/commit/ef19ecb999f9983b82e05c9a34bc8232f8a3d591)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/10/2018, 6:07:13 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Bret Harrison - beharrison@nc.rr.com<br><strong>Uploader</strong>: Bret Harrison - beharrison@nc.rr.com<br><strong>Created</strong>: 1516238615<br><strong>GitHubRevision</strong>: [6370fb4a2c967cba2f72b50de72fa408dcfece7b](https://github.com/hyperledger/fabric-sdk-node/commit/6370fb4a2c967cba2f72b50de72fa408dcfece7b)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/17/2018, 8:37:41 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Dave Kelsey - d_kelsey@uk.ibm.com<br><strong>Approved</strong>: 1/19/2018, 5:07:47 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 3</h3><blockquote><strong>Type</strong>: TRIVIAL_REBASE<br><strong>Author</strong>: Bret Harrison - beharrison@nc.rr.com<br><strong>Uploader</strong>: Bret Harrison - beharrison@nc.rr.com<br><strong>Created</strong>: 1516393293<br><strong>GitHubRevision</strong>: [e238706b02799c6a8f8b3127eacf45429b326b88](https://github.com/hyperledger/fabric-sdk-node/commit/e238706b02799c6a8f8b3127eacf45429b326b88)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/19/2018, 3:38:38 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Approved</strong>: 1/19/2018, 5:26:17 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 4</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Bret Harrison - beharrison@nc.rr.com<br><strong>Uploader</strong>: Bret Harrison - beharrison@nc.rr.com<br><strong>Created</strong>: 1516402397<br><strong>GitHubRevision</strong>: [749873aa5a49f4525dbedeec73659fc1c16e88c5](https://github.com/hyperledger/fabric-sdk-node/commit/749873aa5a49f4525dbedeec73659fc1c16e88c5)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/22/2018, 10:51:45 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Approved</strong>: 1/22/2018, 1:42:23 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>MergedBy</strong>: Keith Smith<br><strong>Merged</strong>: 1/22/2018, 1:42:26 PM<br><br></blockquote>
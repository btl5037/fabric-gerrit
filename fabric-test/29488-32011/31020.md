<strong>Project</strong>: fabric-test<br><strong>Branch</strong>: master<br><strong>ID</strong>: 31020<br><strong>Subject</strong>: [FAB-15204] PTE implements Mocha/Chai<br><strong>Status</strong>: MERGED<br><strong>Owner</strong>: Bharadwaj Ambati - bharadwaj.ambati1@ibm.com<br><strong>Assignee</strong>:<br><strong>Created</strong>: 4/18/2019, 3:06:58 PM<br><strong>LastUpdated</strong>: 4/26/2019, 5:47:02 PM<br><strong>CommitMessage</strong>:<br><pre>[FAB-15204] PTE implements Mocha/Chai

Executing tests using NodeJS with Mocha and Chai frameworks

Change-Id: I4311285ca724ff1a4f1cabde6deb4d7bc0064ed7
Signed-off-by: bharadwajambati1 <bharadwaj.ambati1@ibm.com>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Bharadwaj Ambati - bharadwaj.ambati1@ibm.com<br><strong>Reviewed</strong>: 4/18/2019, 3:06:58 PM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/18/2019, 3:16:38 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/2832/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/18/2019, 3:52:36 PM<br><strong>Message</strong>: <pre>Patch Set 1: Code-Review-1

Build Unstable 

https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/2832/ : UNSTABLE

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-test-verify-x86_64/2832</pre><strong>Reviewer</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Reviewed</strong>: 4/22/2019, 10:39:21 AM<br><strong>Message</strong>: <pre>Patch Set 1: Code-Review-1

(10 comments)</pre><strong>Reviewer</strong>: Dongming Hwang - dongming@ibm.com<br><strong>Reviewed</strong>: 4/22/2019, 2:03:34 PM<br><strong>Message</strong>: <pre>Patch Set 1: Code-Review-1

(6 comments)</pre><strong>Reviewer</strong>: Bharadwaj Ambati - bharadwaj.ambati1@ibm.com<br><strong>Reviewed</strong>: 4/22/2019, 4:59:03 PM<br><strong>Message</strong>: <pre>Uploaded patch set 2.</pre><strong>Reviewer</strong>: Bharadwaj Ambati - bharadwaj.ambati1@ibm.com<br><strong>Reviewed</strong>: 4/22/2019, 4:59:50 PM<br><strong>Message</strong>: <pre>Patch Set 2:

(6 comments)

> (10 comments)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/22/2019, 5:04:07 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/2848/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/22/2019, 5:37:59 PM<br><strong>Message</strong>: <pre>Patch Set 2: Code-Review-1

Build Unstable 

https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/2848/ : UNSTABLE

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-test-verify-x86_64/2848</pre><strong>Reviewer</strong>: Dongming Hwang - dongming@ibm.com<br><strong>Reviewed</strong>: 4/23/2019, 11:39:25 AM<br><strong>Message</strong>: <pre>Patch Set 2: Code-Review-1

(5 comments)</pre><strong>Reviewer</strong>: Bharadwaj Ambati - bharadwaj.ambati1@ibm.com<br><strong>Reviewed</strong>: 4/23/2019, 12:24:23 PM<br><strong>Message</strong>: <pre>Uploaded patch set 3.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/23/2019, 12:26:19 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/2855/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/23/2019, 1:06:01 PM<br><strong>Message</strong>: <pre>Patch Set 3: Code-Review-1

Build Unstable 

https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/2855/ : UNSTABLE

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-test-verify-x86_64/2855</pre><strong>Reviewer</strong>: Bharadwaj Ambati - bharadwaj.ambati1@ibm.com<br><strong>Reviewed</strong>: 4/23/2019, 3:28:37 PM<br><strong>Message</strong>: <pre>Uploaded patch set 4.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/23/2019, 3:30:30 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/2856/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/23/2019, 4:10:37 PM<br><strong>Message</strong>: <pre>Patch Set 4: Code-Review-1

Build Unstable 

https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/2856/ : UNSTABLE

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-test-verify-x86_64/2856</pre><strong>Reviewer</strong>: Dongming Hwang - dongming@ibm.com<br><strong>Reviewed</strong>: 4/24/2019, 9:20:20 AM<br><strong>Message</strong>: <pre>Patch Set 4: Code-Review+1

looks good</pre><strong>Reviewer</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Reviewed</strong>: 4/24/2019, 10:22:46 AM<br><strong>Message</strong>: <pre>Patch Set 4: Code-Review-1

(6 comments)</pre><strong>Reviewer</strong>: Bharadwaj Ambati - bharadwaj.ambati1@ibm.com<br><strong>Reviewed</strong>: 4/24/2019, 3:51:01 PM<br><strong>Message</strong>: <pre>Uploaded patch set 5.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/24/2019, 3:52:51 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/2859/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/24/2019, 4:26:26 PM<br><strong>Message</strong>: <pre>Patch Set 5: Code-Review-1

Build Unstable 

https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/2859/ : UNSTABLE

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-test-verify-x86_64/2859</pre><strong>Reviewer</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Reviewed</strong>: 4/25/2019, 12:28:15 PM<br><strong>Message</strong>: <pre>Patch Set 5: Code-Review-1

(2 comments)

Looks mostly better, although I still would like us to take a few minutes to do a code walkthrough together with Dongming and me, to be sure we understand the flow, now that we are implementing exits and cleanups.</pre><strong>Reviewer</strong>: Bharadwaj Ambati - bharadwaj.ambati1@ibm.com<br><strong>Reviewed</strong>: 4/26/2019, 3:39:20 PM<br><strong>Message</strong>: <pre>Uploaded patch set 6.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/26/2019, 3:42:59 PM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/2873/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/26/2019, 4:16:24 PM<br><strong>Message</strong>: <pre>Patch Set 6: Code-Review-1

Build Unstable 

https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/2873/ : UNSTABLE

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-test-verify-x86_64/2873</pre><strong>Reviewer</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Reviewed</strong>: 4/26/2019, 5:12:24 PM<br><strong>Message</strong>: <pre>Patch Set 6: Code-Review+2</pre><strong>Reviewer</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Reviewed</strong>: 4/26/2019, 5:12:29 PM<br><strong>Message</strong>: <pre>Patch Set 7: Patch Set 6 was rebased</pre><strong>Reviewer</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Reviewed</strong>: 4/26/2019, 5:12:34 PM<br><strong>Message</strong>: <pre>Patch Set 7: Verified+1</pre><strong>Reviewer</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Reviewed</strong>: 4/26/2019, 5:12:37 PM<br><strong>Message</strong>: <pre>Change has been successfully merged by Scott Zwierzynski</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/26/2019, 5:47:01 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Unstable 

https://jenkins.hyperledger.org/job/fabric-test-merge-x86_64/649/ : UNSTABLE

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-test-merge-x86_64/649</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/26/2019, 5:47:02 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Unstable 

https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/2876/ : UNSTABLE

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-test-verify-x86_64/2876</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Bharadwaj Ambati - bharadwaj.ambati1@ibm.com<br><strong>Uploader</strong>: Bharadwaj Ambati - bharadwaj.ambati1@ibm.com<br><strong>Created</strong>: 4/18/2019, 3:06:58 PM<br><strong>UnmergedRevision</strong>: [73ff79d3a140f4f7b086996f320d7176b0f41d28](https://github.com/hyperledger-gerrit-archive/fabric-test/commit/73ff79d3a140f4f7b086996f320d7176b0f41d28)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 4/18/2019, 3:52:36 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Dongming Hwang - dongming@ibm.com<br><strong>Approved</strong>: 4/22/2019, 2:03:34 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Approved</strong>: 4/22/2019, 10:39:21 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/README.md#L309](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/73ff79d3a140f4f7b086996f320d7176b0f41d28/tools/PTE/CITest/README.md#L309)<br><strong>Comment</strong>: <pre>Also should mention that this duplicates funtionality of the CLI test_driver.sh, allowing the use of nodeJS and mocha to display test results.</pre><strong>Commenter</strong>: Dongming Hwang - dongming@ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/README.md#L311](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/73ff79d3a140f4f7b086996f320d7176b0f41d28/tools/PTE/CITest/README.md#L311)<br><strong>Comment</strong>: <pre>remove the trailing space using command
sed -i 's/[ \t]*$//' README.md</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/README.md#L314](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/73ff79d3a140f4f7b086996f320d7176b0f41d28/tools/PTE/CITest/README.md#L314)<br><strong>Comment</strong>: <pre>Does user need to install mocha separately? what is a results.tap file, and what program does one use it to display the results?</pre><strong>Commenter</strong>: Bharadwaj Ambati - bharadwaj.ambati1@ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/README.md#L314](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/73ff79d3a140f4f7b086996f320d7176b0f41d28/tools/PTE/CITest/README.md#L314)<br><strong>Comment</strong>: <pre>User doesn't need to install the mocha separately. It will be installed with other node_modules when he/she run "npm install" as mentioned on line 312. results.tap file will show which tests have passed and which were failed. User doesn't need to run any separate program to display the results, they will be generated automatically once the test case is executed.</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/README.md#L316](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/73ff79d3a140f4f7b086996f320d7176b0f41d28/tools/PTE/CITest/README.md#L316)<br><strong>Comment</strong>: <pre>where are the options explained? Could we add a line in the example section? How can the user see testDriverHelp ?</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/README.md#L319](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/73ff79d3a140f4f7b086996f320d7176b0f41d28/tools/PTE/CITest/README.md#L319)<br><strong>Comment</strong>: <pre>Let's change these to be something to execute, and make it clear what is the commentary. Change the colon to a comment hashmark. For example, this first line should be

- node test_driver.js -n -m FAB-3808-2i -p -c samplecc -t FAB-3808-2i && npm test  # create a network, create join channels, install/instantiate samplecc chaincode using setting in FAB-3808-2i, and execute test case FAB-3808-2i</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/README.md#L326](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/73ff79d3a140f4f7b086996f320d7176b0f41d28/tools/PTE/CITest/README.md#L326)<br><strong>Comment</strong>: <pre>Do you mean using test_drier.js, or some other way? How can someone do this? Can you provide a simple example?</pre><strong>Commenter</strong>: Bharadwaj Ambati - bharadwaj.ambati1@ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/README.md#L326](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/73ff79d3a140f4f7b086996f320d7176b0f41d28/tools/PTE/CITest/README.md#L326)<br><strong>Comment</strong>: <pre>As of now, we are running the customized tests using the command "./test_driver.sh -t myTest" as mentioned in the README.md file. We can also run then using the nodeJS, by running the following command
"node test_driver.js -t myTest".</pre><strong>Commenter</strong>: Dongming Hwang - dongming@ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/package.json#L1](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/73ff79d3a140f4f7b086996f320d7176b0f41d28/tools/PTE/CITest/scripts/package.json#L1)<br><strong>Comment</strong>: <pre>mention to run npm install in the readme</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/test_channel.sh#L48](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/73ff79d3a140f4f7b086996f320d7176b0f41d28/tools/PTE/CITest/scripts/test_channel.sh#L48)<br><strong>Comment</strong>: <pre>why are you doing this? how will this impact other tests? Did you run any tests that use anchor updates? And tests that do not use them? I think you will also need to edit the privatedata tests that require the anchor peer updates, to be sure to set this to true.</pre><strong>Commenter</strong>: Bharadwaj Ambati - bharadwaj.ambati1@ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/test_channel.sh#L48](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/73ff79d3a140f4f7b086996f320d7176b0f41d28/tools/PTE/CITest/scripts/test_channel.sh#L48)<br><strong>Comment</strong>: <pre>I am doing this to prevent running the channel update for each and every test. We need channel updates to those tests which include private data. As we are setting -exo to  our scripts, it's getting exit out with 

'CITest/FAB-8192-4i/preconfig/channels/runCases*update*': No such file or directory error, which results in the failure of the test. 

So, instead of running the channel update for each and every test, I am using this AnchorPeerUpdate which will be set to true by the user for running the private data tests.

I also updated the testDriverHelp in test_driver.sh with this AnchorPeerUpdate</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/test_driver.js#L14](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/73ff79d3a140f4f7b086996f320d7176b0f41d28/tools/PTE/CITest/scripts/test_driver.js#L14)<br><strong>Comment</strong>: <pre>This string seems too generic. What will an error look like to the user? Will the function name be displayed by default somehow? Or should we add the function name in the error string here, and the timeout value?</pre><strong>Commenter</strong>: Bharadwaj Ambati - bharadwaj.ambati1@ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/test_driver.js#L14](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/73ff79d3a140f4f7b086996f320d7176b0f41d28/tools/PTE/CITest/scripts/test_driver.js#L14)<br><strong>Comment</strong>: <pre>This string is to compare the test result in the mocha test cases. If we get an error it will show that installing npm modules have failed. I don't think we have to include this function name in any error messages, because if we see the logs we can directly say that the error is because of the npm modules.</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/test_driver.js#L36](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/73ff79d3a140f4f7b086996f320d7176b0f41d28/tools/PTE/CITest/scripts/test_driver.js#L36)<br><strong>Comment</strong>: <pre>same comments: would it make sense to make this error string more helpful about what failed?</pre><strong>Commenter</strong>: Bharadwaj Ambati - bharadwaj.ambati1@ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/test_driver.js#L36](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/73ff79d3a140f4f7b086996f320d7176b0f41d28/tools/PTE/CITest/scripts/test_driver.js#L36)<br><strong>Comment</strong>: <pre>This string is used to compare the test result is the mocha tests. If the function return success, then the test case will pass else it fails. All the logs can be seen in the PTE/CITests/Logs/<Test-Case-Number> directory.</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/test_driver.js#L141](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/73ff79d3a140f4f7b086996f320d7176b0f41d28/tools/PTE/CITest/scripts/test_driver.js#L141)<br><strong>Comment</strong>: <pre>why are these testcases available, but not others? how could someone add a testcase to this "available" list?  Maybe we could refer people to the Readme file, if you agree that is appropriate.</pre><strong>Commenter</strong>: Bharadwaj Ambati - bharadwaj.ambati1@ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/test_driver.js#L141](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/73ff79d3a140f4f7b086996f320d7176b0f41d28/tools/PTE/CITest/scripts/test_driver.js#L141)<br><strong>Comment</strong>: <pre>These are only some of the test cases that I found in test_driver.sh. I copied testDriverHelp from test_driver.sh and I had made few changes.</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/test_driver.js#L163](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/73ff79d3a140f4f7b086996f320d7176b0f41d28/tools/PTE/CITest/scripts/test_driver.js#L163)<br><strong>Comment</strong>: <pre>could we change this to 
  #</pre><strong>Commenter</strong>: Dongming Hwang - dongming@ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/test_driver.sh#L16](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/73ff79d3a140f4f7b086996f320d7176b0f41d28/tools/PTE/CITest/scripts/test_driver.sh#L16)<br><strong>Comment</strong>: <pre>remove trailing space</pre><strong>Commenter</strong>: Dongming Hwang - dongming@ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/test_driver.sh#L33](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/73ff79d3a140f4f7b086996f320d7176b0f41d28/tools/PTE/CITest/scripts/test_driver.sh#L33)<br><strong>Comment</strong>: <pre>add a space here to align with other lines</pre><strong>Commenter</strong>: Dongming Hwang - dongming@ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/test_driver.sh#L88](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/73ff79d3a140f4f7b086996f320d7176b0f41d28/tools/PTE/CITest/scripts/test_driver.sh#L88)<br><strong>Comment</strong>: <pre>remove trailing spaces</pre><strong>Commenter</strong>: Dongming Hwang - dongming@ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/test_driver.sh#L119](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/73ff79d3a140f4f7b086996f320d7176b0f41d28/tools/PTE/CITest/scripts/test_driver.sh#L119)<br><strong>Comment</strong>: <pre>remove spaces</pre></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Bharadwaj Ambati - bharadwaj.ambati1@ibm.com<br><strong>Uploader</strong>: Bharadwaj Ambati - bharadwaj.ambati1@ibm.com<br><strong>Created</strong>: 4/22/2019, 4:59:03 PM<br><strong>UnmergedRevision</strong>: [9cc297ac0e1d2162f2d235ddb3cdcf2b40fa56a3](https://github.com/hyperledger-gerrit-archive/fabric-test/commit/9cc297ac0e1d2162f2d235ddb3cdcf2b40fa56a3)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 4/22/2019, 5:37:59 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Dongming Hwang - dongming@ibm.com<br><strong>Approved</strong>: 4/23/2019, 11:39:25 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Dongming Hwang - dongming@ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/test_driver.js#L134](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/9cc297ac0e1d2162f2d235ddb3cdcf2b40fa56a3/tools/PTE/CITest/scripts/test_driver.js#L134)<br><strong>Comment</strong>: <pre>remove trailing space</pre><strong>Commenter</strong>: Dongming Hwang - dongming@ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/test_driver.js#L146](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/9cc297ac0e1d2162f2d235ddb3cdcf2b40fa56a3/tools/PTE/CITest/scripts/test_driver.js#L146)<br><strong>Comment</strong>: <pre>remove white spaces</pre><strong>Commenter</strong>: Dongming Hwang - dongming@ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/test_driver.js#L167](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/9cc297ac0e1d2162f2d235ddb3cdcf2b40fa56a3/tools/PTE/CITest/scripts/test_driver.js#L167)<br><strong>Comment</strong>: <pre>remove trailing space</pre><strong>Commenter</strong>: Dongming Hwang - dongming@ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/test_driver.js#L168](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/9cc297ac0e1d2162f2d235ddb3cdcf2b40fa56a3/tools/PTE/CITest/scripts/test_driver.js#L168)<br><strong>Comment</strong>: <pre>remove trailing space</pre><strong>Commenter</strong>: Dongming Hwang - dongming@ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/test_driver.sh#L118](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/9cc297ac0e1d2162f2d235ddb3cdcf2b40fa56a3/tools/PTE/CITest/scripts/test_driver.sh#L118)<br><strong>Comment</strong>: <pre>remove trailing space</pre></blockquote><h3>PatchSet Number: 3</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Bharadwaj Ambati - bharadwaj.ambati1@ibm.com<br><strong>Uploader</strong>: Bharadwaj Ambati - bharadwaj.ambati1@ibm.com<br><strong>Created</strong>: 4/23/2019, 12:24:23 PM<br><strong>UnmergedRevision</strong>: [ec3b051113ca3700281d33f66cb65c0216c2da73](https://github.com/hyperledger-gerrit-archive/fabric-test/commit/ec3b051113ca3700281d33f66cb65c0216c2da73)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 4/23/2019, 1:06:01 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 4</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Bharadwaj Ambati - bharadwaj.ambati1@ibm.com<br><strong>Uploader</strong>: Bharadwaj Ambati - bharadwaj.ambati1@ibm.com<br><strong>Created</strong>: 4/23/2019, 3:28:37 PM<br><strong>UnmergedRevision</strong>: [03479066e4a8b718a8f5817537a8a452318ddaa4](https://github.com/hyperledger-gerrit-archive/fabric-test/commit/03479066e4a8b718a8f5817537a8a452318ddaa4)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 4/23/2019, 4:10:37 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Dongming Hwang - dongming@ibm.com<br><strong>Approved</strong>: 4/24/2019, 9:20:20 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Approved</strong>: 4/24/2019, 10:22:46 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/test_channel.sh#L11](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/03479066e4a8b718a8f5817537a8a452318ddaa4/tools/PTE/CITest/scripts/test_channel.sh#L11)<br><strong>Comment</strong>: <pre>add a line like this to echo the value of AnchorPeerUpdate</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/test_channel.sh#L48](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/03479066e4a8b718a8f5817537a8a452318ddaa4/tools/PTE/CITest/scripts/test_channel.sh#L48)<br><strong>Comment</strong>: <pre>I repeat: doing this requires you to change the sidedb testa and any others that require anchorPeerUpdate; please do that too. You can look in the PTE/CITest folder for the files with "update" in the name (per the comment in line 46). 
Then, we can delete the comments lines 43-47 after you edit the testcases to pass in the 2nd parameter.</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/test_channel.sh#L58](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/03479066e4a8b718a8f5817537a8a452318ddaa4/tools/PTE/CITest/scripts/test_channel.sh#L58)<br><strong>Comment</strong>: <pre>and this should be changed to an error, and modify the text  a bit, and exit 1.</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/test_driver.js#L196](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/03479066e4a8b718a8f5817537a8a452318ddaa4/tools/PTE/CITest/scripts/test_driver.js#L196)<br><strong>Comment</strong>: <pre>Case n is also "create".
Should this case p be named something else?
Also, when I look at the possible args listed in the help comments, it seems there some args missing from this list.</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/test_driver.sh#L128](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/03479066e4a8b718a8f5817537a8a452318ddaa4/tools/PTE/CITest/scripts/test_driver.sh#L128)<br><strong>Comment</strong>: <pre>Also we should print out ANCHOR_PEER_UPDATE value too.
And synchup.</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/test_pte.sh#L2](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/03479066e4a8b718a8f5817537a8a452318ddaa4/tools/PTE/CITest/scripts/test_pte.sh#L2)<br><strong>Comment</strong>: <pre>I would like to more thoroughly consider the effects of what happens with this, when this script exits upon error. And same for all these scripts. For instance, we might want to instead trap the error and execute a cleanup function. Let's discuss, and decide if your code is sufficient for now, or permanently, or if we should modify the implementation for better user convenience and usability. (We could implement a new function "cleanupAndExit1". But I am thinking it might be necessary to do that only in whatever high-level scripts do the cleanup - so they still cleanup instead of exit and leave partial networks lying around.)

trap 'cleanupAndExit1' ERR</pre></blockquote><h3>PatchSet Number: 5</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Bharadwaj Ambati - bharadwaj.ambati1@ibm.com<br><strong>Uploader</strong>: Bharadwaj Ambati - bharadwaj.ambati1@ibm.com<br><strong>Created</strong>: 4/24/2019, 3:51:01 PM<br><strong>UnmergedRevision</strong>: [e44ea869149ab8d2aedc9a46d48a3ea549978def](https://github.com/hyperledger-gerrit-archive/fabric-test/commit/e44ea869149ab8d2aedc9a46d48a3ea549978def)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 4/24/2019, 4:26:26 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Approved</strong>: 4/25/2019, 12:28:15 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [/COMMIT_MSG#L8](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/e44ea869149ab8d2aedc9a46d48a3ea549978def//COMMIT_MSG#L8)<br><strong>Comment</strong>: <pre>This changeset is really doing two things, and we should mention them both.
Do we have another jira task open for fixing robustness of the scripts to exit upon failure, and handle the non-zero exits appropriately? If so, mention that FAB here too. If not, then at least mention that additional work you did.</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/README.md#L307](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/e44ea869149ab8d2aedc9a46d48a3ea549978def/tools/PTE/CITest/README.md#L307)<br><strong>Comment</strong>: <pre>I think this entire section lines 307-316 should be moved higher up, where we first explain about test_driver.sh (line 33).  Put it prior to the "available testcases" subsection; then we would not need lines 318-330. Would you agree that it would read/flow better?</pre></blockquote><h3>PatchSet Number: 6</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Bharadwaj Ambati - bharadwaj.ambati1@ibm.com<br><strong>Uploader</strong>: Bharadwaj Ambati - bharadwaj.ambati1@ibm.com<br><strong>Created</strong>: 4/26/2019, 3:39:20 PM<br><strong>UnmergedRevision</strong>: [dfcbb261fbafedc24c9c5f36b7dee261bc33313b](https://github.com/hyperledger-gerrit-archive/fabric-test/commit/dfcbb261fbafedc24c9c5f36b7dee261bc33313b)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 4/26/2019, 4:16:24 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Approved</strong>: 4/26/2019, 5:12:24 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 7</h3><blockquote><strong>Type</strong>: TRIVIAL_REBASE<br><strong>Author</strong>: Bharadwaj Ambati - bharadwaj.ambati1@ibm.com<br><strong>Uploader</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Created</strong>: 4/26/2019, 5:12:29 PM<br><strong>GitHubMergedRevision</strong>: [6d38f6574d4c9cb232e491eeca0da594c1342362](https://github.com/hyperledger-gerrit-archive/fabric-test/commit/6d38f6574d4c9cb232e491eeca0da594c1342362)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 4/26/2019, 4:16:24 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Approved</strong>: 4/26/2019, 5:12:24 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>MergedBy</strong>: Scott Zwierzynski<br><strong>Merged</strong>: 4/26/2019, 5:12:37 PM<br><br><strong>Approver</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Approved</strong>: 4/26/2019, 5:12:34 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote>
<strong>Project</strong>: fabric-test<br><strong>Branch</strong>: master<br><strong>ID</strong>: 26393<br><strong>Subject</strong>: [FAB-11613] PTE to support CouchDB Pagination<br><strong>Status</strong>: MERGED<br><strong>Owner</strong>: Dongming Hwang - dongming@ibm.com<br><strong>Assignee</strong>:<br><strong>Created</strong>: 9/19/2018, 1:45:31 PM<br><strong>LastUpdated</strong>: 9/21/2018, 4:17:59 PM<br><strong>CommitMessage</strong>:<br><pre>[FAB-11613] PTE to support CouchDB Pagination

Change-Id: Ie5e0da65676a0f6fefd6a1f883cffa1289d484de
Signed-off-by: Dongming <dming@us.ibm.com>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Dongming Hwang - dongming@ibm.com<br><strong>Reviewed</strong>: 9/19/2018, 1:45:31 PM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/19/2018, 1:49:02 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/1882/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/19/2018, 3:50:10 PM<br><strong>Message</strong>: <pre>Patch Set 1: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/1882/ : FAILURE

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/1882/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-test-verify-x86_64/1882</pre><strong>Reviewer</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Reviewed</strong>: 9/20/2018, 3:27:36 PM<br><strong>Message</strong>: <pre>Patch Set 1:

(8 comments)</pre><strong>Reviewer</strong>: Dongming Hwang - dongming@ibm.com<br><strong>Reviewed</strong>: 9/20/2018, 4:02:09 PM<br><strong>Message</strong>: <pre>Patch Set 1:

(2 comments)</pre><strong>Reviewer</strong>: Dongming Hwang - dongming@ibm.com<br><strong>Reviewed</strong>: 9/20/2018, 4:02:52 PM<br><strong>Message</strong>: <pre>Uploaded patch set 2.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/20/2018, 4:05:21 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/1893/</pre><strong>Reviewer</strong>: Dongming Hwang - dongming@ibm.com<br><strong>Reviewed</strong>: 9/20/2018, 4:54:03 PM<br><strong>Message</strong>: <pre>Uploaded patch set 3.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/20/2018, 4:54:35 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/1894/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/20/2018, 4:55:06 PM<br><strong>Message</strong>: <pre>Patch Set 2: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/1893/ : ABORTED

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/1893/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-test-verify-x86_64/1893</pre><strong>Reviewer</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Reviewed</strong>: 9/20/2018, 5:21:53 PM<br><strong>Message</strong>: <pre>Patch Set 3: Code-Review+1</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/20/2018, 6:55:50 PM<br><strong>Message</strong>: <pre>Patch Set 3: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/1894/ : FAILURE

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/1894/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-test-verify-x86_64/1894</pre><strong>Reviewer</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Reviewed</strong>: 9/21/2018, 3:16:49 PM<br><strong>Message</strong>: <pre>Patch Set 3: Verified+1 Code-Review+2</pre><strong>Reviewer</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Reviewed</strong>: 9/21/2018, 3:17:11 PM<br><strong>Message</strong>: <pre>Removed Verified-1 by Hyperledger Jobbuilder <jobbuilder@jenkins.hyperledger.org>
</pre><strong>Reviewer</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Reviewed</strong>: 9/21/2018, 3:18:00 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Removed the verifier vote -1 as the error is unrelated. There's a separate fix going in for that.</pre><strong>Reviewer</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Reviewed</strong>: 9/21/2018, 3:18:08 PM<br><strong>Message</strong>: <pre>Patch Set 4: Patch Set 3 was rebased</pre><strong>Reviewer</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Reviewed</strong>: 9/21/2018, 3:18:16 PM<br><strong>Message</strong>: <pre>Change has been successfully merged by Adnan C</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/21/2018, 3:21:04 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/1905/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/21/2018, 3:24:45 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-test-merge-x86_64/447/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/21/2018, 4:09:54 PM<br><strong>Message</strong>: <pre>Patch Set 4: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/1905/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-test-verify-x86_64/1905</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/21/2018, 4:17:59 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-test-merge-x86_64/447/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-test-merge-x86_64/447</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Dongming - dming@us.ibm.com<br><strong>Uploader</strong>: Dongming Hwang - dongming@ibm.com<br><strong>Created</strong>: 9/19/2018, 1:45:31 PM<br><strong>UnmergedRevision</strong>: [97a60dd28ae0bb4f2b14b149cc792d5bb7493c8c](https://github.com/hyperledger-gerrit-archive/fabric-test/commit/97a60dd28ae0bb4f2b14b149cc792d5bb7493c8c)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 9/19/2018, 3:50:10 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/ccArgumentsGenerators/marblescc/ccFunctions.js#L70](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/97a60dd28ae0bb4f2b14b149cc792d5bb7493c8c/tools/PTE/ccArgumentsGenerators/marblescc/ccFunctions.js#L70)<br><strong>Comment</strong>: <pre>Is this docType valid for queryMarblesByOwner too? If so, it would be incorrectly ignored.</pre><strong>Commenter</strong>: Dongming Hwang - dongming@ibm.com<br><strong>CommentLine</strong>: [tools/PTE/ccArgumentsGenerators/marblescc/ccFunctions.js#L70](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/97a60dd28ae0bb4f2b14b149cc792d5bb7493c8c/tools/PTE/ccArgumentsGenerators/marblescc/ccFunctions.js#L70)<br><strong>Comment</strong>: <pre>queryMarbleswithpagination does not need this ... 
restore line 64</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/ccArgumentsGenerators/marblescc/ccFunctions.js#L80](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/97a60dd28ae0bb4f2b14b149cc792d5bb7493c8c/tools/PTE/ccArgumentsGenerators/marblescc/ccFunctions.js#L80)<br><strong>Comment</strong>: <pre>is this needed for ONLY queryMarblesWithPagination? The way you have it now, it is applied also for every queryMarbles too. I am wondering if we should create a variable for paginationRequested. It could be set true way above here when reading in the property. Then any chaincode API that wants pagination could set it; here you would only need to see if the paginationRequested boolean is true. That way, the pagination functionality would not be tied to specific chaincodes functions.

I suppose we could defer such a refactoring until another time.</pre><strong>Commenter</strong>: Dongming Hwang - dongming@ibm.com<br><strong>CommentLine</strong>: [tools/PTE/ccArgumentsGenerators/marblescc/ccFunctions.js#L80](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/97a60dd28ae0bb4f2b14b149cc792d5bb7493c8c/tools/PTE/ccArgumentsGenerators/marblescc/ccFunctions.js#L80)<br><strong>Comment</strong>: <pre>queryMarbleWithPagination needs selector, so I put it here.  However, pagesize is not needed by queryMarbles, so it will not impact it.</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/marblesccInputs/marblescc-chan2-constant-qmpg-TLS.json#L62](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/97a60dd28ae0bb4f2b14b149cc792d5bb7493c8c/tools/PTE/marblesccInputs/marblescc-chan2-constant-qmpg-TLS.json#L62)<br><strong>Comment</strong>: <pre>ok, but let's add another one or two selectors here</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/marblesccInputs/marblescc-chan2-constant-qmpg-TLS.json#L65](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/97a60dd28ae0bb4f2b14b149cc792d5bb7493c8c/tools/PTE/marblesccInputs/marblescc-chan2-constant-qmpg-TLS.json#L65)<br><strong>Comment</strong>: <pre>trailing whitespace</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/marblesccInputs/marblescc-chan3-constant-qmpg-TLS.json#L64](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/97a60dd28ae0bb4f2b14b149cc792d5bb7493c8c/tools/PTE/marblesccInputs/marblescc-chan3-constant-qmpg-TLS.json#L64)<br><strong>Comment</strong>: <pre>let's try a bigger pagesize, such as 1000 or 10,000. What is the default (if the user does not specify pagesize) or the valid range here? That is something that could be explained in the readme.</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/pte-execRequest.js#L2106](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/97a60dd28ae0bb4f2b14b149cc792d5bb7493c8c/tools/PTE/pte-execRequest.js#L2106)<br><strong>Comment</strong>: <pre>do we really want this else statement? I think maybe we should always check for the BOOKMARK and KEY.</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/pte-execRequest.js#L2300](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/97a60dd28ae0bb4f2b14b149cc792d5bb7493c8c/tools/PTE/pte-execRequest.js#L2300)<br><strong>Comment</strong>: <pre>remove</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/pte-execRequest.js#L2628](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/97a60dd28ae0bb4f2b14b149cc792d5bb7493c8c/tools/PTE/pte-execRequest.js#L2628)<br><strong>Comment</strong>: <pre>remove</pre></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Dongming - dming@us.ibm.com<br><strong>Uploader</strong>: Dongming Hwang - dongming@ibm.com<br><strong>Created</strong>: 9/20/2018, 4:02:52 PM<br><strong>UnmergedRevision</strong>: [94491fb6b0245f0ae541bcedc63ca518822a49c9](https://github.com/hyperledger-gerrit-archive/fabric-test/commit/94491fb6b0245f0ae541bcedc63ca518822a49c9)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 9/20/2018, 4:55:06 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 3</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Dongming - dming@us.ibm.com<br><strong>Uploader</strong>: Dongming Hwang - dongming@ibm.com<br><strong>Created</strong>: 9/20/2018, 4:54:03 PM<br><strong>UnmergedRevision</strong>: [61c341efb5334742b1ea5d0ddb0e67af099a52fd](https://github.com/hyperledger-gerrit-archive/fabric-test/commit/61c341efb5334742b1ea5d0ddb0e67af099a52fd)<br><br><strong>Approver</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Approved</strong>: 9/20/2018, 5:21:53 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Approved</strong>: 9/21/2018, 3:16:49 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Approved</strong>: 9/21/2018, 3:16:49 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 4</h3><blockquote><strong>Type</strong>: TRIVIAL_REBASE<br><strong>Author</strong>: Dongming - dming@us.ibm.com<br><strong>Uploader</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Created</strong>: 9/21/2018, 3:18:08 PM<br><strong>GitHubMergedRevision</strong>: [6efbd3c5bd146b317f2976ac7a00f4a3c2a8e9ae](https://github.com/hyperledger-gerrit-archive/fabric-test/commit/6efbd3c5bd146b317f2976ac7a00f4a3c2a8e9ae)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 9/21/2018, 4:09:54 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Approved</strong>: 9/20/2018, 5:21:53 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Approved</strong>: 9/21/2018, 3:16:49 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>MergedBy</strong>: Adnan C<br><strong>Merged</strong>: 9/21/2018, 3:18:16 PM<br><br><strong>Approver</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Approved</strong>: 9/21/2018, 3:16:49 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote>
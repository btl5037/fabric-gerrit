<strong>Project</strong>: fabric-test<br><strong>Branch</strong>: master<br><strong>ID</strong>: 24575<br><strong>Subject</strong>: [FAB-11147] PTE extends burst mode to n modes<br><strong>Status</strong>: MERGED<br><strong>Owner</strong>: Dongming Hwang - dongming@ibm.com<br><strong>Assignee</strong>:<br><strong>Created</strong>: 7/19/2018, 10:35:16 AM<br><strong>LastUpdated</strong>: 7/23/2018, 4:41:31 PM<br><strong>CommitMessage</strong>:<br><pre>[FAB-11147] PTE extends burst mode to n modes

PTE executes burst mode traffic with any number
of burst modes

Change-Id: Ibf059f34bbc18ee243ca704de85e6bc27c1a9676
Signed-off-by: Dongming <dming@us.ibm.com>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Dongming Hwang - dongming@ibm.com<br><strong>Reviewed</strong>: 7/19/2018, 10:35:16 AM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 7/19/2018, 10:39:12 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/1565/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 7/19/2018, 12:06:57 PM<br><strong>Message</strong>: <pre>Patch Set 1: Code-Review-1

Build Unstable 

https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/1565/ : UNSTABLE

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/1565/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-test-verify-x86_64/1565</pre><strong>Reviewer</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Reviewed</strong>: 7/20/2018, 10:56:42 AM<br><strong>Message</strong>: <pre>Patch Set 1: Code-Review-1

(5 comments)

Here are a few clarifications in the readme.
I think we may want to defer this until v1.2. (But I'll decide after I finish reviewing. So far, I only reviewed the Readme.)</pre><strong>Reviewer</strong>: Dongming Hwang - dongming@ibm.com<br><strong>Reviewed</strong>: 7/20/2018, 12:00:09 PM<br><strong>Message</strong>: <pre>Uploaded patch set 2.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 7/20/2018, 12:04:46 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/1572/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 7/20/2018, 2:02:01 PM<br><strong>Message</strong>: <pre>Patch Set 2: Code-Review-1

Build Unstable 

https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/1572/ : UNSTABLE

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/1572/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-test-verify-x86_64/1572</pre><strong>Reviewer</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Reviewed</strong>: 7/22/2018, 6:01:21 PM<br><strong>Message</strong>: <pre>Patch Set 2: Code-Review-1

(10 comments)</pre><strong>Reviewer</strong>: Dongming Hwang - dongming@ibm.com<br><strong>Reviewed</strong>: 7/23/2018, 10:33:01 AM<br><strong>Message</strong>: <pre>Uploaded patch set 3.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 7/23/2018, 10:36:59 AM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/1576/</pre><strong>Reviewer</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Reviewed</strong>: 7/23/2018, 11:01:57 AM<br><strong>Message</strong>: <pre>Patch Set 3: Code-Review-1

(1 comment)</pre><strong>Reviewer</strong>: Dongming Hwang - dongming@ibm.com<br><strong>Reviewed</strong>: 7/23/2018, 11:14:05 AM<br><strong>Message</strong>: <pre>Uploaded patch set 4.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 7/23/2018, 11:14:41 AM<br><strong>Message</strong>: <pre>Patch Set 3: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/1576/ : ABORTED

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/1576/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-test-verify-x86_64/1576</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 7/23/2018, 11:20:21 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/1578/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 7/23/2018, 1:21:16 PM<br><strong>Message</strong>: <pre>Patch Set 4: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/1578/ : FAILURE

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/1578/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-test-verify-x86_64/1578</pre><strong>Reviewer</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Reviewed</strong>: 7/23/2018, 2:33:48 PM<br><strong>Message</strong>: <pre>Patch Set 4: Verified+1 Code-Review+2</pre><strong>Reviewer</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Reviewed</strong>: 7/23/2018, 2:33:51 PM<br><strong>Message</strong>: <pre>Removed Verified-1 by Hyperledger Jobbuilder <jobbuilder@jenkins.hyperledger.org>
</pre><strong>Reviewer</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Reviewed</strong>: 7/23/2018, 2:33:56 PM<br><strong>Message</strong>: <pre>Patch Set 5: Patch Set 4 was rebased</pre><strong>Reviewer</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Reviewed</strong>: 7/23/2018, 2:33:59 PM<br><strong>Message</strong>: <pre>Change has been successfully merged by Scott Zwierzynski</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 7/23/2018, 2:37:53 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/1581/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 7/23/2018, 2:40:39 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-test-merge-x86_64/371/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 7/23/2018, 4:41:31 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-test-merge-x86_64/371/ : FAILURE

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-test-merge-x86_64/371/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-test-merge-x86_64/371</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Dongming - dming@us.ibm.com<br><strong>Uploader</strong>: Dongming Hwang - dongming@ibm.com<br><strong>Created</strong>: 7/19/2018, 10:35:16 AM<br><strong>UnmergedRevision</strong>: [a77f72c417375f3dad5a970b6671213bd01c5c77](https://github.com/hyperledger-gerrit-archive/fabric-test/commit/a77f72c417375f3dad5a970b6671213bd01c5c77)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 7/19/2018, 12:06:57 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Approved</strong>: 7/20/2018, 10:56:42 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/README.md#L834](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/a77f72c417375f3dad5a970b6671213bd01c5c77/tools/PTE/README.md#L834)<br><strong>Comment</strong>: <pre>Can we append the following (assuming I understand correctly):

transaction mode (applicable to each thread). Note: the per-thread transaction send rates for all modes have an upper bound. One limitation is explained in Simple mode, below. For example, if it typically takes 5 ms to get ack responses for sending transactions to peers in your network, then that limits your max effective rate to be 200 tps - such as when you use transMode = Constant with constantOpt.constFreq = any value between 1 - 5 ms. The host hardware cpu and memory resources may also impose limitations, especially when your test uses higher numbers of simultaneous connections and threads competing for those resources.</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/README.md#L835](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/a77f72c417375f3dad5a970b6671213bd01c5c77/tools/PTE/README.md#L835)<br><strong>Comment</strong>: <pre>And append:
received. This is the fastest rate possible, per thread.</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/README.md#L835](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/a77f72c417375f3dad5a970b6671213bd01c5c77/tools/PTE/README.md#L835)<br><strong>Comment</strong>: <pre>change , to ;</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/README.md#L879](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/a77f72c417375f3dad5a970b6671213bd01c5c77/tools/PTE/README.md#L879)<br><strong>Comment</strong>: <pre>delete this duplicate "and" word</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/README.md#L879](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/a77f72c417375f3dad5a970b6671213bd01c5c77/tools/PTE/README.md#L879)<br><strong>Comment</strong>: <pre>How about "extra paramaters will be ignored from the longer list". (It took me a minute to figure out what you were saying, and I think this makes it more clear. What do you think?)</pre></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Dongming - dming@us.ibm.com<br><strong>Uploader</strong>: Dongming Hwang - dongming@ibm.com<br><strong>Created</strong>: 7/20/2018, 12:00:09 PM<br><strong>UnmergedRevision</strong>: [452a8096568ef93f8e49e4cdd96c092f14ffa913](https://github.com/hyperledger-gerrit-archive/fabric-test/commit/452a8096568ef93f8e49e4cdd96c092f14ffa913)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 7/20/2018, 2:02:01 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Approved</strong>: 7/22/2018, 6:01:21 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/README.md#L879](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/452a8096568ef93f8e49e4cdd96c092f14ffa913/tools/PTE/README.md#L879)<br><strong>Comment</strong>: <pre>change:
at</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/README.md#L879](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/452a8096568ef93f8e49e4cdd96c092f14ffa913/tools/PTE/README.md#L879)<br><strong>Comment</strong>: <pre>change:
corresponding</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/README.md#L879](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/452a8096568ef93f8e49e4cdd96c092f14ffa913/tools/PTE/README.md#L879)<br><strong>Comment</strong>: <pre>change:
interval. It will cycle through all intervals, repeating the cycle as necessary until the test completes (as specified by runDur).</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/README.md#L879](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/452a8096568ef93f8e49e4cdd96c092f14ffa913/tools/PTE/README.md#L879)<br><strong>Comment</strong>: <pre>change:
Each PTE thread</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/README.md#L880](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/452a8096568ef93f8e49e4cdd96c092f14ffa913/tools/PTE/README.md#L880)<br><strong>Comment</strong>: <pre>change:
list of frequencies, in ms; the time between sending two successive msgs; tester must provide one transmit frequency per corresponding burstDur interval</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/README.md#L881](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/452a8096568ef93f8e49e4cdd96c092f14ffa913/tools/PTE/README.md#L881)<br><strong>Comment</strong>: <pre>list of interval durations for sending transactions, in ms</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/pte-execRequest.js#L2436](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/452a8096568ef93f8e49e4cdd96c092f14ffa913/tools/PTE/pte-execRequest.js#L2436)<br><strong>Comment</strong>: <pre>1. Is this function necessary? what does it do? Please add a comment header. Not only is your implementation recursive, but with this change you are doubling your stack size because you are cycling two functions back-to-back, in addition to passing two parameters (instead of one).
2. Plus, my head is spinning in circles trying to figure out how this could possibly manage the send intervals for the durations. A comment it the top of invoke_move_burst() might help with that.
3. Do you need a similar function for the queries, too?</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/pte-execRequest.js#L2563](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/452a8096568ef93f8e49e4cdd96c092f14ffa913/tools/PTE/pte-execRequest.js#L2563)<br><strong>Comment</strong>: <pre>Seems excessive to use 3 logs, printing out all the same data each time except the single last item. Can you put these together? How about deleting these 3 lines, and just put all three variables in the statement in 2572 instead?</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/pte-execRequest.js#L2566](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/452a8096568ef93f8e49e4cdd96c092f14ffa913/tools/PTE/pte-execRequest.js#L2566)<br><strong>Comment</strong>: <pre>This line 2566, and line 2571, will crash if both lists exist but when either the Freq list or the Dur list is empty (zero length).</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/pte-execRequest.js#L2576](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/452a8096568ef93f8e49e4cdd96c092f14ffa913/tools/PTE/pte-execRequest.js#L2576)<br><strong>Comment</strong>: <pre>do we really need to do this? you did this just 4 lines above.</pre></blockquote><h3>PatchSet Number: 3</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Dongming - dming@us.ibm.com<br><strong>Uploader</strong>: Dongming Hwang - dongming@ibm.com<br><strong>Created</strong>: 7/23/2018, 10:33:01 AM<br><strong>UnmergedRevision</strong>: [8b6c316a0070c649c9fb42cc031013a35e49d83b](https://github.com/hyperledger-gerrit-archive/fabric-test/commit/8b6c316a0070c649c9fb42cc031013a35e49d83b)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 7/23/2018, 11:14:41 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Approved</strong>: 7/23/2018, 11:01:57 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/pte-execRequest.js#L2564](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/8b6c316a0070c649c9fb42cc031013a35e49d83b/tools/PTE/pte-execRequest.js#L2564)<br><strong>Comment</strong>: <pre>you did not address my comment on this.
Can we first check if bTotalModes is zero (and exit) before proceeding to do this?</pre></blockquote><h3>PatchSet Number: 4</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Dongming - dming@us.ibm.com<br><strong>Uploader</strong>: Dongming Hwang - dongming@ibm.com<br><strong>Created</strong>: 7/23/2018, 11:14:05 AM<br><strong>UnmergedRevision</strong>: [b5b38e2beca8b51a8acde44193078d5280cf4536](https://github.com/hyperledger-gerrit-archive/fabric-test/commit/b5b38e2beca8b51a8acde44193078d5280cf4536)<br><br><strong>Approver</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Approved</strong>: 7/23/2018, 2:33:48 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Approved</strong>: 7/23/2018, 2:33:48 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 5</h3><blockquote><strong>Type</strong>: TRIVIAL_REBASE<br><strong>Author</strong>: Dongming - dming@us.ibm.com<br><strong>Uploader</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Created</strong>: 7/23/2018, 2:33:56 PM<br><strong>GitHubMergedRevision</strong>: [6aca22f470e986010fd36ec7f4d79e8b4e5ddf21](https://github.com/hyperledger-gerrit-archive/fabric-test/commit/6aca22f470e986010fd36ec7f4d79e8b4e5ddf21)<br><br><strong>Approver</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Approved</strong>: 7/23/2018, 2:33:48 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>MergedBy</strong>: Scott Zwierzynski<br><strong>Merged</strong>: 7/23/2018, 2:33:59 PM<br><br><strong>Approver</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Approved</strong>: 7/23/2018, 2:33:48 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote>
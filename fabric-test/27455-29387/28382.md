<strong>Project</strong>: fabric-test<br><strong>Branch</strong>: master<br><strong>ID</strong>: 28382<br><strong>Subject</strong>: FABCI-47 CI Piepline changes<br><strong>Status</strong>: ABANDONED<br><strong>Owner</strong>: Ramesh Babu Thoomu - rameshbabu.thoomu@gmail.com<br><strong>Assignee</strong>:<br><strong>Created</strong>: 12/25/2018, 4:10:18 PM<br><strong>LastUpdated</strong>: 2/26/2019, 11:58:28 AM<br><strong>CommitMessage</strong>:<br><pre>FABCI-47 CI Piepline changes

This patch creates CI jenkins pipeline configuration for both
verify and merge jobs. The CI configuration should use the patchset dependencies
in verify job and clone the repository in merge job.

Change-Id: Ifd8bc81bba36bd5d2de94a15ae259f2fa3b0aa21
Signed-off-by: rameshthoomu <rameshbabu.thoomu@gmail.com>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Ramesh Babu Thoomu - rameshbabu.thoomu@gmail.com<br><strong>Reviewed</strong>: 12/25/2018, 4:10:18 PM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Ramesh Babu Thoomu - rameshbabu.thoomu@gmail.com<br><strong>Reviewed</strong>: 12/25/2018, 4:14:41 PM<br><strong>Message</strong>: <pre>Uploaded patch set 2.</pre><strong>Reviewer</strong>: Ramesh Babu Thoomu - rameshbabu.thoomu@gmail.com<br><strong>Reviewed</strong>: 12/25/2018, 4:18:26 PM<br><strong>Message</strong>: <pre>Uploaded patch set 3.</pre><strong>Reviewer</strong>: Ramesh Babu Thoomu - rameshbabu.thoomu@gmail.com<br><strong>Reviewed</strong>: 12/25/2018, 4:28:08 PM<br><strong>Message</strong>: <pre>Uploaded patch set 4.</pre><strong>Reviewer</strong>: Ramesh Babu Thoomu - rameshbabu.thoomu@gmail.com<br><strong>Reviewed</strong>: 12/25/2018, 4:31:56 PM<br><strong>Message</strong>: <pre>Uploaded patch set 5.</pre><strong>Reviewer</strong>: Ramesh Babu Thoomu - rameshbabu.thoomu@gmail.com<br><strong>Reviewed</strong>: 1/3/2019, 4:41:34 PM<br><strong>Message</strong>: <pre>Uploaded patch set 6.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/3/2019, 4:46:57 PM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/2409/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/3/2019, 5:39:16 PM<br><strong>Message</strong>: <pre>Patch Set 6: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/2409/ : FAILURE

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-test-verify-x86_64/2409</pre><strong>Reviewer</strong>: Ramesh Babu Thoomu - rameshbabu.thoomu@gmail.com<br><strong>Reviewed</strong>: 1/9/2019, 10:49:41 AM<br><strong>Message</strong>: <pre>Patch Set 7: Patch Set 6 was rebased</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2019, 10:52:23 AM<br><strong>Message</strong>: <pre>Patch Set 7: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/2428/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2019, 11:45:48 AM<br><strong>Message</strong>: <pre>Patch Set 7: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/2428/ : FAILURE

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-test-verify-x86_64/2428</pre><strong>Reviewer</strong>: Ramesh Babu Thoomu - rameshbabu.thoomu@gmail.com<br><strong>Reviewed</strong>: 1/16/2019, 2:50:23 PM<br><strong>Message</strong>: <pre>Topic set to pipeline-fabric-test</pre><strong>Reviewer</strong>: Latitia Haskins - latitia.haskins@gmail.com<br><strong>Reviewed</strong>: 1/16/2019, 4:24:12 PM<br><strong>Message</strong>: <pre>Patch Set 7:

(2 comments)</pre><strong>Reviewer</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Reviewed</strong>: 1/16/2019, 7:47:45 PM<br><strong>Message</strong>: <pre>Patch Set 7: Code-Review-1

(6 comments)</pre><strong>Reviewer</strong>: Latitia Haskins - latitia.haskins@gmail.com<br><strong>Reviewed</strong>: 1/17/2019, 2:05:23 PM<br><strong>Message</strong>: <pre>Patch Set 7: Code-Review-1

(4 comments)</pre><strong>Reviewer</strong>: Sambhav Nidamarty - sambhavdutt@gmail.com<br><strong>Reviewed</strong>: 1/21/2019, 11:24:22 PM<br><strong>Message</strong>: <pre>Patch Set 7:

(8 comments)</pre><strong>Reviewer</strong>: Ramesh Babu Thoomu - rameshbabu.thoomu@gmail.com<br><strong>Reviewed</strong>: 2/13/2019, 12:53:25 PM<br><strong>Message</strong>: <pre>Patch Set 8: Patch Set 7 was rebased</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/13/2019, 12:57:33 PM<br><strong>Message</strong>: <pre>Patch Set 8: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/2544/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/13/2019, 1:39:20 PM<br><strong>Message</strong>: <pre>Patch Set 8: Code-Review-1

Build Unstable 

https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/2544/ : UNSTABLE

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-test-verify-x86_64/2544</pre><strong>Reviewer</strong>: Ramesh Babu Thoomu - rameshbabu.thoomu@gmail.com<br><strong>Reviewed</strong>: 2/26/2019, 11:58:28 AM<br><strong>Message</strong>: <pre>Abandoned

Sambhav pushed similar change. Abandon this for now.</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Ramesh Babu Thoomu - rameshbabu.thoomu@gmail.com<br><strong>Uploader</strong>: Ramesh Babu Thoomu - rameshbabu.thoomu@gmail.com<br><strong>Created</strong>: 12/25/2018, 4:10:18 PM<br><strong>UnmergedRevision</strong>: [ff8d3438e9b773a7708255e5d5dd6194a16af1ae](https://github.com/hyperledger-gerrit-archive/fabric-test/commit/ff8d3438e9b773a7708255e5d5dd6194a16af1ae)<br><br></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Ramesh Babu Thoomu - rameshbabu.thoomu@gmail.com<br><strong>Uploader</strong>: Ramesh Babu Thoomu - rameshbabu.thoomu@gmail.com<br><strong>Created</strong>: 12/25/2018, 4:14:41 PM<br><strong>UnmergedRevision</strong>: [5735cc465e13de1d354ef3f183fd91faf96e8b46](https://github.com/hyperledger-gerrit-archive/fabric-test/commit/5735cc465e13de1d354ef3f183fd91faf96e8b46)<br><br></blockquote><h3>PatchSet Number: 3</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Ramesh Babu Thoomu - rameshbabu.thoomu@gmail.com<br><strong>Uploader</strong>: Ramesh Babu Thoomu - rameshbabu.thoomu@gmail.com<br><strong>Created</strong>: 12/25/2018, 4:18:26 PM<br><strong>UnmergedRevision</strong>: [30f9f868351f6e073204e1b24b75908331e710b3](https://github.com/hyperledger-gerrit-archive/fabric-test/commit/30f9f868351f6e073204e1b24b75908331e710b3)<br><br></blockquote><h3>PatchSet Number: 4</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Ramesh Babu Thoomu - rameshbabu.thoomu@gmail.com<br><strong>Uploader</strong>: Ramesh Babu Thoomu - rameshbabu.thoomu@gmail.com<br><strong>Created</strong>: 12/25/2018, 4:28:08 PM<br><strong>UnmergedRevision</strong>: [b0bba2fe9ec5be612292196ad3fc171fec5c295b](https://github.com/hyperledger-gerrit-archive/fabric-test/commit/b0bba2fe9ec5be612292196ad3fc171fec5c295b)<br><br></blockquote><h3>PatchSet Number: 5</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Ramesh Babu Thoomu - rameshbabu.thoomu@gmail.com<br><strong>Uploader</strong>: Ramesh Babu Thoomu - rameshbabu.thoomu@gmail.com<br><strong>Created</strong>: 12/25/2018, 4:31:56 PM<br><strong>UnmergedRevision</strong>: [41974dea4a4486794e14705f083271a1c1567e00](https://github.com/hyperledger-gerrit-archive/fabric-test/commit/41974dea4a4486794e14705f083271a1c1567e00)<br><br></blockquote><h3>PatchSet Number: 6</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Ramesh Babu Thoomu - rameshbabu.thoomu@gmail.com<br><strong>Uploader</strong>: Ramesh Babu Thoomu - rameshbabu.thoomu@gmail.com<br><strong>Created</strong>: 1/3/2019, 4:41:34 PM<br><strong>UnmergedRevision</strong>: [14e37371729517e773f2bc048ea791dc19659469](https://github.com/hyperledger-gerrit-archive/fabric-test/commit/14e37371729517e773f2bc048ea791dc19659469)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/3/2019, 5:39:16 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 7</h3><blockquote><strong>Type</strong>: TRIVIAL_REBASE<br><strong>Author</strong>: Ramesh Babu Thoomu - rameshbabu.thoomu@gmail.com<br><strong>Uploader</strong>: Ramesh Babu Thoomu - rameshbabu.thoomu@gmail.com<br><strong>Created</strong>: 1/9/2019, 10:49:41 AM<br><strong>UnmergedRevision</strong>: [cf9599baeed6e2b460123f9528a5dd6e490841c2](https://github.com/hyperledger-gerrit-archive/fabric-test/commit/cf9599baeed6e2b460123f9528a5dd6e490841c2)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/9/2019, 11:45:48 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Approved</strong>: 1/16/2019, 7:47:45 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Latitia Haskins - latitia.haskins@gmail.com<br><strong>Approved</strong>: 1/17/2019, 2:05:23 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Latitia Haskins - latitia.haskins@gmail.com<br><strong>CommentLine</strong>: [Jenkinsfile#L5](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/cf9599baeed6e2b460123f9528a5dd6e490841c2/Jenkinsfile#L5)<br><strong>Comment</strong>: <pre>In thinking about this, is it possible to simplify this by just having this file limited to calling make targets? Otherwise, this can get unwieldy very fast.

I understand (kinda) the  "Fetch Patchset" stage - there are some things that are inherit to Jenkins that you will want to denote.  Though I really don't like the sh call on ln 41. I think that should be a make target and then you call that make target if needed.

It would be nice to be able to see what is happening here at a glance.</pre><strong>Commenter</strong>: Sambhav Nidamarty - sambhavdutt@gmail.com<br><strong>CommentLine</strong>: [Jenkinsfile#L5](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/cf9599baeed6e2b460123f9528a5dd6e490841c2/Jenkinsfile#L5)<br><strong>Comment</strong>: <pre>I have addressed the comments in my Patchset
https://gerrit.hyperledger.org/r/#/c/28879/    master
https://gerrit.hyperledger.org/r/#/c/28832/    release-1.4</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [Jenkinsfile#L20](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/cf9599baeed6e2b460123f9528a5dd6e490841c2/Jenkinsfile#L20)<br><strong>Comment</strong>: <pre>What is the working directory? Where is this function defined? It might be better to describe that and replace the comment line above</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [Jenkinsfile#L32](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/cf9599baeed6e2b460123f9528a5dd6e490841c2/Jenkinsfile#L32)<br><strong>Comment</strong>: <pre>this comment makes no sense to me. can we delete it? or add a different comment?</pre><strong>Commenter</strong>: Sambhav Nidamarty - sambhavdutt@gmail.com<br><strong>CommentLine</strong>: [Jenkinsfile#L32](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/cf9599baeed6e2b460123f9528a5dd6e490841c2/Jenkinsfile#L32)<br><strong>Comment</strong>: <pre>This has been Removed in my patchset</pre><strong>Commenter</strong>: Latitia Haskins - latitia.haskins@gmail.com<br><strong>CommentLine</strong>: [Jenkinsfile#L45](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/cf9599baeed6e2b460123f9528a5dd6e490841c2/Jenkinsfile#L45)<br><strong>Comment</strong>: <pre>Replace this with a make target</pre><strong>Commenter</strong>: Sambhav Nidamarty - sambhavdutt@gmail.com<br><strong>CommentLine</strong>: [Jenkinsfile#L45](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/cf9599baeed6e2b460123f9528a5dd6e490841c2/Jenkinsfile#L45)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Latitia Haskins - latitia.haskins@gmail.com<br><strong>CommentLine</strong>: [Jenkinsfile#L59](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/cf9599baeed6e2b460123f9528a5dd6e490841c2/Jenkinsfile#L59)<br><strong>Comment</strong>: <pre>Replace this with a make target</pre><strong>Commenter</strong>: Sambhav Nidamarty - sambhavdutt@gmail.com<br><strong>CommentLine</strong>: [Jenkinsfile#L59](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/cf9599baeed6e2b460123f9528a5dd6e490841c2/Jenkinsfile#L59)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Latitia Haskins - latitia.haskins@gmail.com<br><strong>CommentLine</strong>: [Jenkinsfile#L60](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/cf9599baeed6e2b460123f9528a5dd6e490841c2/Jenkinsfile#L60)<br><strong>Comment</strong>: <pre>also add make clean to this stage</pre><strong>Commenter</strong>: Sambhav Nidamarty - sambhavdutt@gmail.com<br><strong>CommentLine</strong>: [Jenkinsfile#L60](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/cf9599baeed6e2b460123f9528a5dd6e490841c2/Jenkinsfile#L60)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Latitia Haskins - latitia.haskins@gmail.com<br><strong>CommentLine</strong>: [Jenkinsfile#L70](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/cf9599baeed6e2b460123f9528a5dd6e490841c2/Jenkinsfile#L70)<br><strong>Comment</strong>: <pre>Can we break this out further to these stages:

StageName: Setup Environment
  -> MakeTargets: git-init git-latest pre-setup fabric
StageName: Pull Docker Images
  -> MakeTargets: pull-images pull-thirdparty-images
StageName: Pull Binaries
  -> MakeTargets: pull-binaries
StageName: Build Tooling
  -> MakeTargets: build-sdk-wrapper 
StageName: Execute Smoke Tests
  -> MakeTargets: smoke-tests

I think we will want to break down the tests further for the daily jobs... Though those are already separate jobs, so we may be good to go there.

The Makefile should also be cleaned up to not perform cleans and setup in the pull-images target, since those aren't related to pulling images, but that can be done separate to this CR, IMHO.</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [Jenkinsfile#L70](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/cf9599baeed6e2b460123f9528a5dd6e490841c2/Jenkinsfile#L70)<br><strong>Comment</strong>: <pre>Sounds good.</pre><strong>Commenter</strong>: Sambhav Nidamarty - sambhavdutt@gmail.com<br><strong>CommentLine</strong>: [Jenkinsfile#L70](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/cf9599baeed6e2b460123f9528a5dd6e490841c2/Jenkinsfile#L70)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [Jenkinsfile#L85](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/cf9599baeed6e2b460123f9528a5dd6e490841c2/Jenkinsfile#L85)<br><strong>Comment</strong>: <pre>Remove comment. We are not doing a code coverage report here. Maybe did you mean something else?</pre><strong>Commenter</strong>: Sambhav Nidamarty - sambhavdutt@gmail.com<br><strong>CommentLine</strong>: [Jenkinsfile#L85](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/cf9599baeed6e2b460123f9528a5dd6e490841c2/Jenkinsfile#L85)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [Jenkinsfile#L90](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/cf9599baeed6e2b460123f9528a5dd6e490841c2/Jenkinsfile#L90)<br><strong>Comment</strong>: <pre>should we print the JOB_NAME here first?</pre><strong>Commenter</strong>: Sambhav Nidamarty - sambhavdutt@gmail.com<br><strong>CommentLine</strong>: [Jenkinsfile#L90](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/cf9599baeed6e2b460123f9528a5dd6e490841c2/Jenkinsfile#L90)<br><strong>Comment</strong>: <pre>The Job name will will be displayed in the Rocketchat notification along with the failed status.</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [scripts/Jenkins_Scripts/CI_Script.sh#L0](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/cf9599baeed6e2b460123f9528a5dd6e490841c2/scripts/Jenkins_Scripts/CI_Script.sh#L0)<br><strong>Comment</strong>: <pre>1. Could we come up with a more descriptive filename for this script?
2. And, When is this called???</pre><strong>Commenter</strong>: Latitia Haskins - latitia.haskins@gmail.com<br><strong>CommentLine</strong>: [scripts/Jenkins_Scripts/CI_Script.sh#L0](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/cf9599baeed6e2b460123f9528a5dd6e490841c2/scripts/Jenkins_Scripts/CI_Script.sh#L0)<br><strong>Comment</strong>: <pre>Yes, this seems to be a clean up script... Is there a reason that this is it's own separate thing and does not replace the clean make target?</pre></blockquote><h3>PatchSet Number: 8</h3><blockquote><strong>Type</strong>: TRIVIAL_REBASE<br><strong>Author</strong>: Ramesh Babu Thoomu - rameshbabu.thoomu@gmail.com<br><strong>Uploader</strong>: Ramesh Babu Thoomu - rameshbabu.thoomu@gmail.com<br><strong>Created</strong>: 2/13/2019, 12:53:25 PM<br><strong>UnmergedRevision</strong>: [c19705e34b1fa17250bd777d15225a1d2984b4e9](https://github.com/hyperledger-gerrit-archive/fabric-test/commit/c19705e34b1fa17250bd777d15225a1d2984b4e9)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 2/13/2019, 1:39:20 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Approved</strong>: 1/16/2019, 7:47:45 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Latitia Haskins - latitia.haskins@gmail.com<br><strong>Approved</strong>: 1/17/2019, 2:05:23 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br></blockquote>
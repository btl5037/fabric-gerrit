<strong>Project</strong>: fabric-test<br><strong>Branch</strong>: master<br><strong>ID</strong>: 28993<br><strong>Subject</strong>: [FAB-13930] PTE: tool for simple K8S management<br><strong>Status</strong>: MERGED<br><strong>Owner</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Assignee</strong>:<br><strong>Created</strong>: 1/28/2019, 6:12:56 PM<br><strong>LastUpdated</strong>: 3/13/2019, 4:19:17 PM<br><strong>CommitMessage</strong>:<br><pre>[FAB-13930] PTE: tool for simple K8S management

Stop an orderer, Resume an orderer, find leader Orderer. WIP.

Change-Id: I275345b7b6e7eec3e6d1182e7c516fb2c4e7abd3
Signed-off-by: Adnan Choudhury <adnan.choudhury@itpeoplecorp.com>
Stop an orderer, Resume an orderer, find leader Orderer. WIP
</pre><h1>Comments</h1><strong>Reviewer</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Reviewed</strong>: 1/28/2019, 6:12:56 PM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/28/2019, 6:16:53 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/2501/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/28/2019, 7:00:23 PM<br><strong>Message</strong>: <pre>Patch Set 1: Code-Review-1

Build Unstable 

https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/2501/ : UNSTABLE

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-test-verify-x86_64/2501</pre><strong>Reviewer</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Reviewed</strong>: 1/30/2019, 9:11:16 AM<br><strong>Message</strong>: <pre>Patch Set 1: Code-Review-1

(8 comments)</pre><strong>Reviewer</strong>: Naga Venkata Sai Surya Teja Lanka - suryalnvs@gmail.com<br><strong>Reviewed</strong>: 1/30/2019, 9:18:59 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(1 comment)</pre><strong>Reviewer</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Reviewed</strong>: 2/19/2019, 10:31:12 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(1 comment)</pre><strong>Reviewer</strong>: Bharadwaj Ambati - bharadwaj.ambati1@ibm.com<br><strong>Reviewed</strong>: 3/5/2019, 12:34:01 PM<br><strong>Message</strong>: <pre>Uploaded patch set 2.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/5/2019, 12:37:48 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/2617/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/5/2019, 1:17:09 PM<br><strong>Message</strong>: <pre>Patch Set 2: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/2617/ : FAILURE

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-test-verify-x86_64/2617</pre><strong>Reviewer</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Reviewed</strong>: 3/7/2019, 8:58:40 PM<br><strong>Message</strong>: <pre>Patch Set 2: Code-Review-1

(3 comments)</pre><strong>Reviewer</strong>: Bharadwaj Ambati - bharadwaj.ambati1@ibm.com<br><strong>Reviewed</strong>: 3/8/2019, 9:35:28 AM<br><strong>Message</strong>: <pre>Uploaded patch set 3.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/8/2019, 9:38:46 AM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/2626/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/8/2019, 10:19:49 AM<br><strong>Message</strong>: <pre>Patch Set 3: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/2626/ : FAILURE

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-test-verify-x86_64/2626</pre><strong>Reviewer</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Reviewed</strong>: 3/13/2019, 3:35:49 PM<br><strong>Message</strong>: <pre>Removed Verified-1 by Hyperledger Jobbuilder <jobbuilder@jenkins.hyperledger.org>
</pre><strong>Reviewer</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Reviewed</strong>: 3/13/2019, 3:35:54 PM<br><strong>Message</strong>: <pre>Patch Set 3: Verified+1 Code-Review+2</pre><strong>Reviewer</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Reviewed</strong>: 3/13/2019, 3:35:57 PM<br><strong>Message</strong>: <pre>Patch Set 4: Patch Set 3 was rebased</pre><strong>Reviewer</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Reviewed</strong>: 3/13/2019, 3:36:03 PM<br><strong>Message</strong>: <pre>Change has been successfully merged by Scott Zwierzynski</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/13/2019, 3:38:55 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-test-verify-x86_64/2650/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/13/2019, 3:41:30 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-test-merge-x86_64/605/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/13/2019, 4:19:17 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-test-merge-x86_64/605/ : FAILURE

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-test-merge-x86_64/605</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Uploader</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Created</strong>: 1/28/2019, 6:12:56 PM<br><strong>UnmergedRevision</strong>: [8ca60c60f5ebb602ea0a1596b03ac860961a6f73](https://github.com/hyperledger-gerrit-archive/fabric-test/commit/8ca60c60f5ebb602ea0a1596b03ac860961a6f73)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/28/2019, 7:00:23 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Approved</strong>: 1/30/2019, 9:11:16 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/test_k8s_util.sh#L0](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/8ca60c60f5ebb602ea0a1596b03ac860961a6f73/tools/PTE/CITest/scripts/test_k8s_util.sh#L0)<br><strong>Comment</strong>: <pre>since ths is essentially a test utility driver... can we give it an easier name? I don't know; how about just "fabkubemgr"?  And don't use iks.</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/test_k8s_util.sh#L9](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/8ca60c60f5ebb602ea0a1596b03ac860961a6f73/tools/PTE/CITest/scripts/test_k8s_util.sh#L9)<br><strong>Comment</strong>: <pre>delete</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/test_k8s_util.sh#L14](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/8ca60c60f5ebb602ea0a1596b03ac860961a6f73/tools/PTE/CITest/scripts/test_k8s_util.sh#L14)<br><strong>Comment</strong>: <pre>I like the fact that you put a summary line here. Can we simplify it? And put this summary line above the Usage line 13. 

$0 : tools to manage HLF test network in IKS cluster</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/test_k8s_util.sh#L16](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/8ca60c60f5ebb602ea0a1596b03ac860961a6f73/tools/PTE/CITest/scripts/test_k8s_util.sh#L16)<br><strong>Comment</strong>: <pre>p</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/test_k8s_util.sh#L18](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/8ca60c60f5ebb602ea0a1596b03ac860961a6f73/tools/PTE/CITest/scripts/test_k8s_util.sh#L18)<br><strong>Comment</strong>: <pre>Lets echo another line here to state an assumption that the INFO logs must have been enabled upon startup in the specified orderer in order for this to be reliable in most scenarios.
And later we can also mention the need for DEBUG logs for the other scenarios once we enhance to query the orderers for the "Forwarding to leader" debug log.</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/test_k8s_util.sh#L83](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/8ca60c60f5ebb602ea0a1596b03ac860961a6f73/tools/PTE/CITest/scripts/test_k8s_util.sh#L83)<br><strong>Comment</strong>: <pre>insert:
exit 1</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/test_k8s_util.sh#L87](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/8ca60c60f5ebb602ea0a1596b03ac860961a6f73/tools/PTE/CITest/scripts/test_k8s_util.sh#L87)<br><strong>Comment</strong>: <pre>insert:
exit 1</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/test_k8s_util.sh#L99](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/8ca60c60f5ebb602ea0a1596b03ac860961a6f73/tools/PTE/CITest/scripts/test_k8s_util.sh#L99)<br><strong>Comment</strong>: <pre>exit 1</pre><strong>Commenter</strong>: Naga Venkata Sai Surya Teja Lanka - suryalnvs@gmail.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/test_k8s_util.sh#L116](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/8ca60c60f5ebb602ea0a1596b03ac860961a6f73/tools/PTE/CITest/scripts/test_k8s_util.sh#L116)<br><strong>Comment</strong>: <pre>this works only for raft. is this script going to be specific for raft ?</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/test_k8s_util.sh#L116](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/8ca60c60f5ebb602ea0a1596b03ac860961a6f73/tools/PTE/CITest/scripts/test_k8s_util.sh#L116)<br><strong>Comment</strong>: <pre>this command is specific to raft. but the rest are general for any k8s network, right?

We could change the internal variable name from ifFindLeader to ifFindRaftLeader, but that is about all we can do; the help menu already says it finds a raft leader.</pre></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Uploader</strong>: Bharadwaj Ambati - bharadwaj.ambati1@ibm.com<br><strong>Created</strong>: 3/5/2019, 12:34:01 PM<br><strong>UnmergedRevision</strong>: [d2b1dd3f668414905b66aab2dc116d85e5ce30d1](https://github.com/hyperledger-gerrit-archive/fabric-test/commit/d2b1dd3f668414905b66aab2dc116d85e5ce30d1)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/5/2019, 1:17:09 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Approved</strong>: 3/7/2019, 8:58:40 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/fabkubemgr.sh#L15](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/d2b1dd3f668414905b66aab2dc116d85e5ce30d1/tools/PTE/CITest/scripts/fabkubemgr.sh#L15)<br><strong>Comment</strong>: <pre>This ends in the middle of a sentence. Seems like we are missing something (or else should have deleted the last two words).</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/fabkubemgr.sh#L27](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/d2b1dd3f668414905b66aab2dc116d85e5ce30d1/tools/PTE/CITest/scripts/fabkubemgr.sh#L27)<br><strong>Comment</strong>: <pre>Change this to fabkubemgr</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [tools/PTE/CITest/scripts/fabkubemgr.sh#L30](https://github.com/hyperledger-gerrit-archive/fabric-test/blob/d2b1dd3f668414905b66aab2dc116d85e5ce30d1/tools/PTE/CITest/scripts/fabkubemgr.sh#L30)<br><strong>Comment</strong>: <pre>ditto</pre></blockquote><h3>PatchSet Number: 3</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Uploader</strong>: Bharadwaj Ambati - bharadwaj.ambati1@ibm.com<br><strong>Created</strong>: 3/8/2019, 9:35:28 AM<br><strong>UnmergedRevision</strong>: [28963bd3990f0e0d21b4ed0540ea10bca6bb0ceb](https://github.com/hyperledger-gerrit-archive/fabric-test/commit/28963bd3990f0e0d21b4ed0540ea10bca6bb0ceb)<br><br><strong>Approver</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Approved</strong>: 3/13/2019, 3:35:54 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Approved</strong>: 3/13/2019, 3:35:54 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 4</h3><blockquote><strong>Type</strong>: TRIVIAL_REBASE<br><strong>Author</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Uploader</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Created</strong>: 3/13/2019, 3:35:57 PM<br><strong>GitHubMergedRevision</strong>: [f75082f94d8ed399bd4d84825c5d4e487914c3c1](https://github.com/hyperledger-gerrit-archive/fabric-test/commit/f75082f94d8ed399bd4d84825c5d4e487914c3c1)<br><br><strong>Approver</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Approved</strong>: 3/13/2019, 3:35:54 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>MergedBy</strong>: Scott Zwierzynski<br><strong>Merged</strong>: 3/13/2019, 3:36:03 PM<br><br><strong>Approver</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Approved</strong>: 3/13/2019, 3:35:54 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote>
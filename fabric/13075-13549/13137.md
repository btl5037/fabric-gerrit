<strong>Project</strong>: fabric<br><strong>Branch</strong>: master<br><strong>ID</strong>: 13137<br><strong>Subject</strong>: [FAB-6026] Define proto structures for collections<br><strong>Status</strong>: ABANDONED<br><strong>Owner</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Assignee</strong>:<br><strong>Created</strong>: 9/5/2017, 8:22:26 AM<br><strong>LastUpdated</strong>: 9/6/2017, 5:46:46 PM<br><strong>CommitMessage</strong>:<br><pre>[FAB-6026] Define proto structures for collections

Change-Id: I5a792a32dd334e3002f53adb32da5453a3935ee8
Signed-off-by: yacovm <yacovm@il.ibm.com>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 9/5/2017, 8:22:26 AM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/5/2017, 8:22:36 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-z/12071/ (1/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/5/2017, 8:30:22 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/16424/ (2/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/5/2017, 8:30:23 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/10437/ (3/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/5/2017, 8:30:41 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/8009/ (4/4)</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 9/5/2017, 9:20:36 AM<br><strong>Message</strong>: <pre>Patch Set 1: Code-Review+2</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/5/2017, 9:59:36 AM<br><strong>Message</strong>: <pre>Patch Set 1: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-z/12071/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-verify-z/12071

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/16424/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-verify-x86_64/16424

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/10437/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-verify-behave-x86_64/10437

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/8009/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-verify-end-2-end-x86_64/8009</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 9/5/2017, 11:07:23 AM<br><strong>Message</strong>: <pre>Patch Set 1: Code-Review-1

(3 comments)

Not really a -1 but marking to ask for clarification and I do think adding more to the comments in the proto definition would be helpful</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 9/5/2017, 11:07:47 AM<br><strong>Message</strong>: <pre>Patch Set 1: -Code-Review</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 9/5/2017, 11:22:16 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(1 comment)</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 9/5/2017, 11:25:55 AM<br><strong>Message</strong>: <pre>Uploaded patch set 2.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/5/2017, 11:26:11 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-z/12082/ (1/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/5/2017, 11:29:09 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/16435/ (2/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/5/2017, 11:29:30 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/10447/ (3/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/5/2017, 11:29:52 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/8019/ (4/4)</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 9/5/2017, 11:35:37 AM<br><strong>Message</strong>: <pre>Patch Set 2: Code-Review+2</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 9/5/2017, 11:57:13 AM<br><strong>Message</strong>: <pre>Patch Set 2: Code-Review+2</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/5/2017, 12:47:07 PM<br><strong>Message</strong>: <pre>Patch Set 2: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-z/12082/ : FAILURE

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-z/12082/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-verify-z/12082

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/16435/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-verify-x86_64/16435

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/10447/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-verify-behave-x86_64/10447

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/8019/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-verify-end-2-end-x86_64/8019</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 9/5/2017, 1:04:07 PM<br><strong>Message</strong>: <pre>Patch Set 2:

rebuild-z</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/5/2017, 1:04:17 PM<br><strong>Message</strong>: <pre>Patch Set 2: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-verify-z/12089/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/5/2017, 1:13:06 PM<br><strong>Message</strong>: <pre>Patch Set 2: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-z/12089/ : FAILURE

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-z/12089/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-1/fabric-verify-z/12089</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 9/5/2017, 2:01:08 PM<br><strong>Message</strong>: <pre>Patch Set 2: Code-Review-1

(1 comment)</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 9/5/2017, 2:19:32 PM<br><strong>Message</strong>: <pre>Patch Set 2:

(1 comment)</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 9/5/2017, 2:27:43 PM<br><strong>Message</strong>: <pre>Patch Set 2:

(1 comment)</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 9/5/2017, 2:44:14 PM<br><strong>Message</strong>: <pre>Patch Set 2:

(1 comment)</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 9/5/2017, 3:11:09 PM<br><strong>Message</strong>: <pre>Patch Set 2:

(1 comment)</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 9/6/2017, 5:46:46 PM<br><strong>Message</strong>: <pre>Abandoned

.</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Uploader</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Created</strong>: 9/5/2017, 8:22:26 AM<br><strong>UnmergedRevision</strong>: [91e0e81668a7ce9093bc32c86720acb1ba5b3191](https://github.com/hyperledger-gerrit-archive/fabric/commit/91e0e81668a7ce9093bc32c86720acb1ba5b3191)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 9/5/2017, 9:59:36 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Approved</strong>: 9/5/2017, 9:20:36 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [protos/ledger/rwset/rwset.proto#L77](https://github.com/hyperledger-gerrit-archive/fabric/blob/91e0e81668a7ce9093bc32c86720acb1ba5b3191/protos/ledger/rwset/rwset.proto#L77)<br><strong>Comment</strong>: <pre>should use collection_name here to be consistent with collection_name above in CollectionPvtReadWriteSet</pre><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [protos/ledger/rwset/rwset.proto#L79](https://github.com/hyperledger-gerrit-archive/fabric/blob/91e0e81668a7ce9093bc32c86720acb1ba5b3191/protos/ledger/rwset/rwset.proto#L79)<br><strong>Comment</strong>: <pre>So it looks like you are basically regrouping NsPvtReadWriteSet which stores collections for a namespace and now storing namespaces for a collection?</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [protos/ledger/rwset/rwset.proto#L79](https://github.com/hyperledger-gerrit-archive/fabric/blob/91e0e81668a7ce9093bc32c86720acb1ba5b3191/protos/ledger/rwset/rwset.proto#L79)<br><strong>Comment</strong>: <pre>yes. I need a per-collection aggregation.</pre><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [protos/ledger/rwset/rwset.proto#L85](https://github.com/hyperledger-gerrit-archive/fabric/blob/91e0e81668a7ce9093bc32c86720acb1ba5b3191/protos/ledger/rwset/rwset.proto#L85)<br><strong>Comment</strong>: <pre>Maybe this should be rwsets rather than read_write_sets (again for consistency).
I also assume that one of these corresponds to a CollectionPvtReadWriteSet.rwset?  If so (or if not), can you add a comment as to where this comes from?</pre></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Uploader</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Created</strong>: 9/5/2017, 11:25:55 AM<br><strong>UnmergedRevision</strong>: [9450616be5367e552213e2ae78a810cee7e369e4](https://github.com/hyperledger-gerrit-archive/fabric/commit/9450616be5367e552213e2ae78a810cee7e369e4)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 9/5/2017, 1:13:06 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Approved</strong>: 9/5/2017, 2:01:08 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Approved</strong>: 9/5/2017, 11:57:13 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Approved</strong>: 9/5/2017, 11:35:37 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [protos/ledger/rwset/rwset.proto#L87](https://github.com/hyperledger-gerrit-archive/fabric/blob/9450616be5367e552213e2ae78a810cee7e369e4/protos/ledger/rwset/rwset.proto#L87)<br><strong>Comment</strong>: <pre>This file/package (`rwset`) is only for readwriteset protos that is produced by the ledger. Please use a different file/package for the structs for the other purposes.

Also, the message above ('CollectionCriteria') should be out of this file. Can we move these to the gossip protos file?</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [protos/ledger/rwset/rwset.proto#L87](https://github.com/hyperledger-gerrit-archive/fabric/blob/9450616be5367e552213e2ae78a810cee7e369e4/protos/ledger/rwset/rwset.proto#L87)<br><strong>Comment</strong>: <pre>But if you look here https://gerrit.hyperledger.org/r/#/c/13125/5/core/ledger/ledger_interface.go

The ledger code produces them.</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [protos/ledger/rwset/rwset.proto#L87](https://github.com/hyperledger-gerrit-archive/fabric/blob/9450616be5367e552213e2ae78a810cee7e369e4/protos/ledger/rwset/rwset.proto#L87)<br><strong>Comment</strong>: <pre>Will look at that CR now. But the message above `CollectionCriteria` is out of context here and better if you we move that some other place... gossip protos?</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [protos/ledger/rwset/rwset.proto#L87](https://github.com/hyperledger-gerrit-archive/fabric/blob/9450616be5367e552213e2ae78a810cee7e369e4/protos/ledger/rwset/rwset.proto#L87)<br><strong>Comment</strong>: <pre>I can move it to gossip protos, sure. But in a subsequent CR, ok?</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [protos/ledger/rwset/rwset.proto#L87](https://github.com/hyperledger-gerrit-archive/fabric/blob/9450616be5367e552213e2ae78a810cee7e369e4/protos/ledger/rwset/rwset.proto#L87)<br><strong>Comment</strong>: <pre>Please see comments on https://gerrit.hyperledger.org/r/#/c/13125/5/core/ledger/ledger_interface.go

I think that it will be good to fix the messages introduced in this CR here. And the one that already got merged (`CollectionCriteria`) can be moved in a subsequent CR.</pre></blockquote>
<strong>Project</strong>: fabric<br><strong>Branch</strong>: master<br><strong>ID</strong>: 22253<br><strong>Subject</strong>: [FAB-6526] Collection membership policy checks<br><strong>Status</strong>: MERGED<br><strong>Owner</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Assignee</strong>:<br><strong>Created</strong>: 5/24/2018, 7:55:28 AM<br><strong>LastUpdated</strong>: 6/4/2018, 11:23:43 AM<br><strong>CommitMessage</strong>:<br><pre>[FAB-6526] Collection membership policy checks

Perform validation of collection configuration supplied at deploy/upgrade time
to ensure that the member signature policy is meaningful (only consists
of ORs).

Also perform input sanitization at LSCC deploy/upgrade time to check
that the member signature policy orgs are part of the channel.

Change-Id: I71f82cf7757c9f360a789832effa68d0df59166a
Signed-off-by: Matthias Neugschwandtner <eug@zurich.ibm.com>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Reviewed</strong>: 5/24/2018, 7:55:28 AM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 7:58:06 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/2030/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 7:58:31 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 7:58:32 AM<br><strong>Message</strong>: <pre>Patch Set 1:

WIP - No Build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 7:59:09 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/2030/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/2030</pre><strong>Reviewer</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Reviewed</strong>: 5/24/2018, 8:58:42 AM<br><strong>Message</strong>: <pre>Uploaded patch set 2.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 9:00:42 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/2035/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 9:01:06 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 9:01:07 AM<br><strong>Message</strong>: <pre>Patch Set 2:

WIP - No Build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 9:01:45 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/2035/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/2035</pre><strong>Reviewer</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Reviewed</strong>: 5/24/2018, 9:06:28 AM<br><strong>Message</strong>: <pre>Uploaded patch set 3.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 9:08:57 AM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/2036/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 9:09:22 AM<br><strong>Message</strong>: <pre>Patch Set 3:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 9:16:37 AM<br><strong>Message</strong>: <pre>Patch Set 3: F2-DocBuild+1 F1-VerifyBuild+1 F3-IntegrationTest+1

Succeeded, Run SmokeTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 9:17:14 AM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/2036/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/2036</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 9:21:53 AM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1383/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 9:22:16 AM<br><strong>Message</strong>: <pre>Patch Set 3:

Starting smoke tests</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 5/24/2018, 9:23:22 AM<br><strong>Message</strong>: <pre>Patch Set 3: Code-Review-1

test</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 9:33:53 AM<br><strong>Message</strong>: <pre>Patch Set 3: F2-SmokeTest+1

Succeeded, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 9:36:09 AM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2245/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 9:36:33 AM<br><strong>Message</strong>: <pre>Patch Set 3:

Starting unit tests</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 5/24/2018, 9:37:15 AM<br><strong>Message</strong>: <pre>Patch Set 3:

(1 comment)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 9:52:48 AM<br><strong>Message</strong>: <pre>Patch Set 3: F3-UnitTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 9:53:21 AM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1383/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-smoke-tests-x86_64/1383

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2245/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/2245</pre><strong>Reviewer</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Reviewed</strong>: 5/24/2018, 10:15:36 AM<br><strong>Message</strong>: <pre>Uploaded patch set 4.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 10:15:43 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/2041/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 10:16:02 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Starting verify build</pre><strong>Reviewer</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Reviewed</strong>: 5/24/2018, 10:16:04 AM<br><strong>Message</strong>: <pre>Patch Set 3:

(1 comment)</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 5/24/2018, 10:20:54 AM<br><strong>Message</strong>: <pre>Patch Set 4: Code-Review-1

(1 comment)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 10:21:23 AM<br><strong>Message</strong>: <pre>Patch Set 4: F2-DocBuild+1 F1-VerifyBuild+1 F3-IntegrationTest+1

Succeeded, Run SmokeTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 10:21:33 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1387/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 10:21:47 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/2041/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/2041</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 10:22:01 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Starting smoke tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 10:37:46 AM<br><strong>Message</strong>: <pre>Patch Set 4: F2-SmokeTest+1

Succeeded, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 10:40:10 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2249/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 10:40:38 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 10:55:36 AM<br><strong>Message</strong>: <pre>Patch Set 4: F3-UnitTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 10:56:13 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1387/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-smoke-tests-x86_64/1387

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2249/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/2249</pre><strong>Reviewer</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Reviewed</strong>: 5/24/2018, 11:21:11 AM<br><strong>Message</strong>: <pre>Uploaded patch set 5.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 11:23:22 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/2044/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 11:23:46 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Starting verify build</pre><strong>Reviewer</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Reviewed</strong>: 5/24/2018, 11:25:32 AM<br><strong>Message</strong>: <pre>Patch Set 4:

(1 comment)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 11:29:26 AM<br><strong>Message</strong>: <pre>Patch Set 5: F2-DocBuild+1 F1-VerifyBuild+1 F3-IntegrationTest+1

Succeeded, Run SmokeTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 11:29:49 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/2044/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/2044</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 11:32:49 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1390/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 11:33:18 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Starting smoke tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 11:47:41 AM<br><strong>Message</strong>: <pre>Patch Set 5: F2-SmokeTest+1

Succeeded, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 11:52:04 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2252/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 11:52:29 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 12:06:36 PM<br><strong>Message</strong>: <pre>Patch Set 5: F3-UnitTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/24/2018, 12:07:03 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1390/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-smoke-tests-x86_64/1390

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2252/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/2252</pre><strong>Reviewer</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Reviewed</strong>: 5/24/2018, 1:23:36 PM<br><strong>Message</strong>: <pre>Patch Set 6: Patch Set 5 was rebased</pre><strong>Reviewer</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>Reviewed</strong>: 5/25/2018, 6:16:41 AM<br><strong>Message</strong>: <pre>Patch Set 6:

(7 comments)</pre><strong>Reviewer</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Reviewed</strong>: 5/25/2018, 7:49:01 AM<br><strong>Message</strong>: <pre>Patch Set 6:

(1 comment)</pre><strong>Reviewer</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>Reviewed</strong>: 5/25/2018, 8:56:08 AM<br><strong>Message</strong>: <pre>Patch Set 6:

(1 comment)</pre><strong>Reviewer</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Reviewed</strong>: 5/25/2018, 9:25:24 AM<br><strong>Message</strong>: <pre>Patch Set 6:

(7 comments)</pre><strong>Reviewer</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Reviewed</strong>: 5/25/2018, 1:42:20 PM<br><strong>Message</strong>: <pre>Uploaded patch set 7.</pre><strong>Reviewer</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Reviewed</strong>: 5/25/2018, 1:43:04 PM<br><strong>Message</strong>: <pre>Patch Set 6:

(9 comments)

Dave, Matt - thank you for the review! Comments inline.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/25/2018, 1:43:54 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/2079/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/25/2018, 1:44:17 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/25/2018, 1:50:10 PM<br><strong>Message</strong>: <pre>Patch Set 7: F2-DocBuild+1 F1-VerifyBuild+1 F3-IntegrationTest+1

Succeeded, Run SmokeTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/25/2018, 1:50:49 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/2079/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/2079</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/25/2018, 1:51:59 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1414/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/25/2018, 1:52:22 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Starting smoke tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/25/2018, 2:02:27 PM<br><strong>Message</strong>: <pre>Patch Set 7: F2-SmokeTest+1

Succeeded, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/25/2018, 2:02:35 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2282/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/25/2018, 2:02:55 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/25/2018, 2:15:56 PM<br><strong>Message</strong>: <pre>Patch Set 7: F3-UnitTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/25/2018, 2:16:17 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1414/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-smoke-tests-x86_64/1414

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2282/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/2282</pre><strong>Reviewer</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>Reviewed</strong>: 6/1/2018, 7:29:32 AM<br><strong>Message</strong>: <pre>Patch Set 7: Code-Review-1

(2 comments)</pre><strong>Reviewer</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Reviewed</strong>: 6/1/2018, 9:04:06 AM<br><strong>Message</strong>: <pre>Uploaded patch set 8.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/1/2018, 9:06:20 AM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/2253/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/1/2018, 9:06:42 AM<br><strong>Message</strong>: <pre>Patch Set 8:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/1/2018, 9:12:15 AM<br><strong>Message</strong>: <pre>Patch Set 8: F2-DocBuild+1 F1-VerifyBuild+1 F3-IntegrationTest+1

Succeeded, Run SmokeTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/1/2018, 9:12:39 AM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/2253/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/2253</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/1/2018, 9:14:26 AM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1504/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/1/2018, 9:14:51 AM<br><strong>Message</strong>: <pre>Patch Set 8:

Starting smoke tests</pre><strong>Reviewer</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Reviewed</strong>: 6/1/2018, 9:21:50 AM<br><strong>Message</strong>: <pre>Uploaded patch set 9.</pre><strong>Reviewer</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Reviewed</strong>: 6/1/2018, 9:22:46 AM<br><strong>Message</strong>: <pre>Patch Set 7:

(2 comments)

Thanks Dave! Updated version pushed.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/1/2018, 9:24:15 AM<br><strong>Message</strong>: <pre>Patch Set 9:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/2254/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/1/2018, 9:24:40 AM<br><strong>Message</strong>: <pre>Patch Set 9:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/1/2018, 9:25:48 AM<br><strong>Message</strong>: <pre>Patch Set 8: F2-SmokeTest+1

Succeeded, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/1/2018, 9:30:32 AM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2405/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/1/2018, 9:30:53 AM<br><strong>Message</strong>: <pre>Patch Set 8:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/1/2018, 9:31:18 AM<br><strong>Message</strong>: <pre>Patch Set 9: F2-DocBuild+1 F1-VerifyBuild+1 F3-IntegrationTest+1

Succeeded, Run SmokeTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/1/2018, 9:31:50 AM<br><strong>Message</strong>: <pre>Patch Set 9:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/2254/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/2254</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/1/2018, 9:35:16 AM<br><strong>Message</strong>: <pre>Patch Set 9:

Build Started https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1505/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/1/2018, 9:35:44 AM<br><strong>Message</strong>: <pre>Patch Set 9:

Starting smoke tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/1/2018, 9:45:31 AM<br><strong>Message</strong>: <pre>Patch Set 8: F3-UnitTest-1

Failed</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/1/2018, 9:46:08 AM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2405/ : FAILURE (skipped)

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2405/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/2405

https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1504/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-smoke-tests-x86_64/1504</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/1/2018, 9:52:36 AM<br><strong>Message</strong>: <pre>Patch Set 9: F2-SmokeTest+1

Succeeded, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/1/2018, 9:54:12 AM<br><strong>Message</strong>: <pre>Patch Set 9:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2406/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/1/2018, 9:54:33 AM<br><strong>Message</strong>: <pre>Patch Set 9:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/1/2018, 10:08:00 AM<br><strong>Message</strong>: <pre>Patch Set 9: F3-UnitTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/1/2018, 10:08:23 AM<br><strong>Message</strong>: <pre>Patch Set 9:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1505/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-smoke-tests-x86_64/1505

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2406/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/2406</pre><strong>Reviewer</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Reviewed</strong>: 6/1/2018, 10:11:22 AM<br><strong>Message</strong>: <pre>Patch Set 9: Code-Review-1

(4 comments)

You're not testing what you think you are.</pre><strong>Reviewer</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>Reviewed</strong>: 6/1/2018, 10:42:45 AM<br><strong>Message</strong>: <pre>Patch Set 9:

Function looks good now.  Just need to clean up the tests per Matt's suggestion.</pre><strong>Reviewer</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Reviewed</strong>: 6/1/2018, 11:43:58 AM<br><strong>Message</strong>: <pre>Uploaded patch set 10.</pre><strong>Reviewer</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Reviewed</strong>: 6/1/2018, 11:44:01 AM<br><strong>Message</strong>: <pre>Patch Set 9:

(3 comments)

Matt, thank you for the review! Comments inline.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/1/2018, 11:46:52 AM<br><strong>Message</strong>: <pre>Patch Set 10:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/2258/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/1/2018, 11:47:13 AM<br><strong>Message</strong>: <pre>Patch Set 10:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/1/2018, 11:52:36 AM<br><strong>Message</strong>: <pre>Patch Set 10: F2-DocBuild+1 F1-VerifyBuild+1 F3-IntegrationTest+1

Succeeded, Run SmokeTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/1/2018, 11:53:00 AM<br><strong>Message</strong>: <pre>Patch Set 10:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/2258/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/2258</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/1/2018, 11:55:50 AM<br><strong>Message</strong>: <pre>Patch Set 10:

Build Started https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1508/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/1/2018, 11:56:10 AM<br><strong>Message</strong>: <pre>Patch Set 10:

Starting smoke tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/1/2018, 12:06:14 PM<br><strong>Message</strong>: <pre>Patch Set 10: F2-SmokeTest+1

Succeeded, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/1/2018, 12:08:02 PM<br><strong>Message</strong>: <pre>Patch Set 10:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2408/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/1/2018, 12:08:27 PM<br><strong>Message</strong>: <pre>Patch Set 10:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/1/2018, 12:22:15 PM<br><strong>Message</strong>: <pre>Patch Set 10: F3-UnitTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/1/2018, 12:22:48 PM<br><strong>Message</strong>: <pre>Patch Set 10:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1508/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-smoke-tests-x86_64/1508

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2408/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/2408</pre><strong>Reviewer</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Reviewed</strong>: 6/1/2018, 2:10:38 PM<br><strong>Message</strong>: <pre>Patch Set 10:

(8 comments)

I'm going to leave this without a vote but it really feels like the tests need to be thoroughly reviewed. Many of the assertions are using the wrong matcher and the latest patch set only updates the one I pointed out. There are certainly others.

I don't want to broaden the scope of this change to include all of the issues but a work item really needs to be opened to fix the matchers and to properly evaluate the test coverage. I'd appreciate if the issue number could be added to this CR.</pre><strong>Reviewer</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Reviewed</strong>: 6/4/2018, 3:56:30 AM<br><strong>Message</strong>: <pre>Patch Set 10:

Matt, thank you for reviewing the tests on the other validation code as well. I created a new issue as you requested: FAB-10528</pre><strong>Reviewer</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>Reviewed</strong>: 6/4/2018, 6:04:53 AM<br><strong>Message</strong>: <pre>Patch Set 10: Code-Review+2

I've tested e2e and the new validations work as expected with meaningful messages for users.

The remaining tests will be completed in FAB-10528.</pre><strong>Reviewer</strong>: Christopher Ferris - chris.ferris@gmail.com<br><strong>Reviewed</strong>: 6/4/2018, 10:44:48 AM<br><strong>Message</strong>: <pre>Patch Set 10: Code-Review+2</pre><strong>Reviewer</strong>: Christopher Ferris - chris.ferris@gmail.com<br><strong>Reviewed</strong>: 6/4/2018, 10:44:53 AM<br><strong>Message</strong>: <pre>Change has been successfully merged by Christopher Ferris</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/4/2018, 10:47:07 AM<br><strong>Message</strong>: <pre>Patch Set 10:

Build Started https://jenkins.hyperledger.org/job/fabric-merge-x86_64/3962/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/4/2018, 10:47:45 AM<br><strong>Message</strong>: <pre>Patch Set 10:

Build Started https://jenkins.hyperledger.org/job/fabric-merge-end-2-end-x86_64/2632/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/4/2018, 11:23:43 AM<br><strong>Message</strong>: <pre>Patch Set 10:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-merge-x86_64/3962/ : FAILURE (skipped)

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-merge-x86_64/3962/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-merge-x86_64/3962

https://jenkins.hyperledger.org/job/fabric-merge-end-2-end-x86_64/2632/ : FAILURE (skipped)

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-merge-end-2-end-x86_64/2632/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-merge-end-2-end-x86_64/2632</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Uploader</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Created</strong>: 5/24/2018, 7:55:28 AM<br><strong>UnmergedRevision</strong>: [823fe121a367f8d5a8650c807f52e65e0c30303c](https://github.com/hyperledger-gerrit-archive/fabric/commit/823fe121a367f8d5a8650c807f52e65e0c30303c)<br><br></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Uploader</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Created</strong>: 5/24/2018, 8:58:42 AM<br><strong>UnmergedRevision</strong>: [eb9ffa7f92b406002d6a9aadf5616d05e2e2fffd](https://github.com/hyperledger-gerrit-archive/fabric/commit/eb9ffa7f92b406002d6a9aadf5616d05e2e2fffd)<br><br></blockquote><h3>PatchSet Number: 3</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Uploader</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Created</strong>: 5/24/2018, 9:06:28 AM<br><strong>UnmergedRevision</strong>: [28637f538d1665681739377c96b3e3d0f8127145](https://github.com/hyperledger-gerrit-archive/fabric/commit/28637f538d1665681739377c96b3e3d0f8127145)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/24/2018, 9:16:37 AM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/24/2018, 9:16:37 AM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/24/2018, 9:33:53 AM<br><strong>Type</strong>: F2-SmokeTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/24/2018, 9:16:37 AM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/24/2018, 9:52:48 AM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Approved</strong>: 5/24/2018, 9:23:22 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [core/handlers/validation/builtin/validation_logic.go#L223](https://github.com/hyperledger-gerrit-archive/fabric/blob/28637f538d1665681739377c96b3e3d0f8127145/core/handlers/validation/builtin/validation_logic.go#L223)<br><strong>Comment</strong>: <pre>errors start with lowercase</pre><strong>Commenter</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>CommentLine</strong>: [core/handlers/validation/builtin/validation_logic.go#L223](https://github.com/hyperledger-gerrit-archive/fabric/blob/28637f538d1665681739377c96b3e3d0f8127145/core/handlers/validation/builtin/validation_logic.go#L223)<br><strong>Comment</strong>: <pre>thanks, done!</pre></blockquote><h3>PatchSet Number: 4</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Uploader</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Created</strong>: 5/24/2018, 10:15:36 AM<br><strong>UnmergedRevision</strong>: [52100b4510dfd4b7e248c875be4355b378d571af](https://github.com/hyperledger-gerrit-archive/fabric/commit/52100b4510dfd4b7e248c875be4355b378d571af)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/24/2018, 10:21:23 AM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/24/2018, 10:21:23 AM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/24/2018, 10:37:46 AM<br><strong>Type</strong>: F2-SmokeTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/24/2018, 10:21:23 AM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/24/2018, 10:55:36 AM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Approved</strong>: 5/24/2018, 10:20:54 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [core/handlers/validation/builtin/validation_logic.go#L231](https://github.com/hyperledger-gerrit-archive/fabric/blob/52100b4510dfd4b7e248c875be4355b378d571af/core/handlers/validation/builtin/validation_logic.go#L231)<br><strong>Comment</strong>: <pre>can you please write a test? :(</pre><strong>Commenter</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>CommentLine</strong>: [core/handlers/validation/builtin/validation_logic.go#L231](https://github.com/hyperledger-gerrit-archive/fabric/blob/52100b4510dfd4b7e248c875be4355b378d571af/core/handlers/validation/builtin/validation_logic.go#L231)<br><strong>Comment</strong>: <pre>sure, test added</pre></blockquote><h3>PatchSet Number: 5</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Uploader</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Created</strong>: 5/24/2018, 11:21:11 AM<br><strong>UnmergedRevision</strong>: [09b69edec0571c41303e3cc7bbf5b3cbc978ae53](https://github.com/hyperledger-gerrit-archive/fabric/commit/09b69edec0571c41303e3cc7bbf5b3cbc978ae53)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/24/2018, 11:29:26 AM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/24/2018, 11:29:26 AM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/24/2018, 11:47:41 AM<br><strong>Type</strong>: F2-SmokeTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/24/2018, 11:29:26 AM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/24/2018, 12:06:36 PM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 6</h3><blockquote><strong>Type</strong>: TRIVIAL_REBASE<br><strong>Author</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Uploader</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Created</strong>: 5/24/2018, 1:23:36 PM<br><strong>UnmergedRevision</strong>: [bb31734dfba5475830298aa88b1ec0e5c8294ac7](https://github.com/hyperledger-gerrit-archive/fabric/commit/bb31734dfba5475830298aa88b1ec0e5c8294ac7)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/24/2018, 11:29:26 AM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/24/2018, 11:29:26 AM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/24/2018, 11:47:41 AM<br><strong>Type</strong>: F2-SmokeTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/24/2018, 11:29:26 AM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/24/2018, 12:06:36 PM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>CommentLine</strong>: [core/handlers/validation/builtin/validation_logic.go#L170](https://github.com/hyperledger-gerrit-archive/fabric/blob/bb31734dfba5475830298aa88b1ec0e5c8294ac7/core/handlers/validation/builtin/validation_logic.go#L170)<br><strong>Comment</strong>: <pre>Why is this added? Doesn't seem to be used.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/mocks/scc/lscc/support.go#L57](https://github.com/hyperledger-gerrit-archive/fabric/blob/bb31734dfba5475830298aa88b1ec0e5c8294ac7/core/mocks/scc/lscc/support.go#L57)<br><strong>Comment</strong>: <pre>We're moving away from hand coded mocks. If/when you decompose "support" into meaningful abstractions, you should also use the generated tools.</pre><strong>Commenter</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>CommentLine</strong>: [core/scc/lscc/lscc.go#L99](https://github.com/hyperledger-gerrit-archive/fabric/blob/bb31734dfba5475830298aa88b1ec0e5c8294ac7/core/scc/lscc/lscc.go#L99)<br><strong>Comment</strong>: <pre>This doesn't fall under the category of 'FileSystemSupport'.</pre><strong>Commenter</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>CommentLine</strong>: [core/scc/lscc/lscc.go#L99](https://github.com/hyperledger-gerrit-archive/fabric/blob/bb31734dfba5475830298aa88b1ec0e5c8294ac7/core/scc/lscc/lscc.go#L99)<br><strong>Comment</strong>: <pre>I agree, I put it here because "CheckInstationPolicy" is also here. Where do you suggest it should go instead? Or maybe the support file can simply be renamed from "FileSystemSupport" to "LSCCSupport"?</pre><strong>Commenter</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>CommentLine</strong>: [core/scc/lscc/lscc.go#L99](https://github.com/hyperledger-gerrit-archive/fabric/blob/bb31734dfba5475830298aa88b1ec0e5c8294ac7/core/scc/lscc/lscc.go#L99)<br><strong>Comment</strong>: <pre>Matt Sykes has been trying to improve the way we do these support interfaces, so let's get his opinion.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/scc/lscc/lscc.go#L99](https://github.com/hyperledger-gerrit-archive/fabric/blob/bb31734dfba5475830298aa88b1ec0e5c8294ac7/core/scc/lscc/lscc.go#L99)<br><strong>Comment</strong>: <pre>Support is an anti-pattern. What it means is that everything you need gets dumped behind one interface. That makes it very difficult to use and inject single-purpose dependencies. The reason these were introduced is because the code is adapting a collection of functions that work on global state to something you can mock. We need to stop propagating that pattern.

Use small, meaningful, focused interfaces and inject an implementation that satisfies the contract.

In this case, your dependency is really the MSP manager and the function you've implemented should use that dependency. If a "CollectionChecker" (or whatever noun is appropriate) is the abstraction you want, there should be a object that has explicit dependencies and is independently tested.</pre><strong>Commenter</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>CommentLine</strong>: [core/scc/lscc/lscc.go#L99](https://github.com/hyperledger-gerrit-archive/fabric/blob/bb31734dfba5475830298aa88b1ec0e5c8294ac7/core/scc/lscc/lscc.go#L99)<br><strong>Comment</strong>: <pre>Thank you for the review and explanation of that anti-pattern. I moved the function and changed the dependency, hopefully addressing the issue properly.</pre><strong>Commenter</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>CommentLine</strong>: [core/scc/lscc/lscc.go#L167](https://github.com/hyperledger-gerrit-archive/fabric/blob/bb31734dfba5475830298aa88b1ec0e5c8294ac7/core/scc/lscc/lscc.go#L167)<br><strong>Comment</strong>: <pre>Need to handle any error that is returned by CheckCollectionConfig().</pre><strong>Commenter</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>CommentLine</strong>: [core/scc/lscc/lscc.go#L167](https://github.com/hyperledger-gerrit-archive/fabric/blob/bb31734dfba5475830298aa88b1ec0e5c8294ac7/core/scc/lscc/lscc.go#L167)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>CommentLine</strong>: [core/scc/lscc/support.go#L114](https://github.com/hyperledger-gerrit-archive/fabric/blob/bb31734dfba5475830298aa88b1ec0e5c8294ac7/core/scc/lscc/support.go#L114)<br><strong>Comment</strong>: <pre>Need function comment, mention what is checked.

The function name makes it sound like it is going to check various collection config criteria, but it only checks one thing, the config against the collection membership. Is there a reason this isn't checked at validation time like the other collection validations?  The channel membership may change between simulation time and validation/commit time.

I think ideally all the collection validation logic should be applied both at lscc simulation (execution) time, and at validation/commit time. But that is beyond the scope of this CR as it is a pre-existing issue.  Just wanted your thought on it, and if there was a reason why you added one check at lscc simultation time and one check at validation/commit time.</pre><strong>Commenter</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>CommentLine</strong>: [core/scc/lscc/support.go#L114](https://github.com/hyperledger-gerrit-archive/fabric/blob/bb31734dfba5475830298aa88b1ec0e5c8294ac7/core/scc/lscc/support.go#L114)<br><strong>Comment</strong>: <pre>The function comment was on the support interface (but still missing here). I put a comment now.

This is the result of a discussion with Yacov, Elli, Angelo and Alessandro. In a nutshell, the check is not security critical because even if an organization that is not a channel member is added to the collection member policy, this will not enable that organization to receive private data. Thus it is not necessary to have the check as part of the validation, but rather just as an input sanitization during lscc simulation time.
On top of that having the check as part of the validation code would have introduced a hard-to-resolve dependency on the channel MSP there.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/scc/lscc/support.go#L119](https://github.com/hyperledger-gerrit-archive/fabric/blob/bb31734dfba5475830298aa88b1ec0e5c8294ac7/core/scc/lscc/support.go#L119)<br><strong>Comment</strong>: <pre>This is untested</pre><strong>Commenter</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>CommentLine</strong>: [core/scc/lscc/support.go#L135](https://github.com/hyperledger-gerrit-archive/fabric/blob/bb31734dfba5475830298aa88b1ec0e5c8294ac7/core/scc/lscc/support.go#L135)<br><strong>Comment</strong>: <pre>Seems at least some of these would be unexpected and therefore error conditions rather than just return nil.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/scc/lscc/support.go#L135](https://github.com/hyperledger-gerrit-archive/fabric/blob/bb31734dfba5475830298aa88b1ec0e5c8294ac7/core/scc/lscc/support.go#L135)<br><strong>Comment</strong>: <pre>None of these are tested.</pre><strong>Commenter</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>CommentLine</strong>: [core/scc/lscc/support.go#L135](https://github.com/hyperledger-gerrit-archive/fabric/blob/bb31734dfba5475830298aa88b1ec0e5c8294ac7/core/scc/lscc/support.go#L135)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>CommentLine</strong>: [core/scc/lscc/support.go#L146](https://github.com/hyperledger-gerrit-archive/fabric/blob/bb31734dfba5475830298aa88b1ec0e5c8294ac7/core/scc/lscc/support.go#L146)<br><strong>Comment</strong>: <pre>Include the underlying error in the returned error.</pre><strong>Commenter</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>CommentLine</strong>: [core/scc/lscc/support.go#L146](https://github.com/hyperledger-gerrit-archive/fabric/blob/bb31734dfba5475830298aa88b1ec0e5c8294ac7/core/scc/lscc/support.go#L146)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/scc/lscc/support.go#L151](https://github.com/hyperledger-gerrit-archive/fabric/blob/bb31734dfba5475830298aa88b1ec0e5c8294ac7/core/scc/lscc/support.go#L151)<br><strong>Comment</strong>: <pre>found appears equivalent to return nil - why break?</pre><strong>Commenter</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>CommentLine</strong>: [core/scc/lscc/support.go#L151](https://github.com/hyperledger-gerrit-archive/fabric/blob/bb31734dfba5475830298aa88b1ec0e5c8294ac7/core/scc/lscc/support.go#L151)<br><strong>Comment</strong>: <pre>Found is not equivalent to return nil - this would exit the outer loop prematurely. Break exits the inner loop.</pre><strong>Commenter</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>CommentLine</strong>: [core/scc/lscc/support.go#L160](https://github.com/hyperledger-gerrit-archive/fabric/blob/bb31734dfba5475830298aa88b1ec0e5c8294ac7/core/scc/lscc/support.go#L160)<br><strong>Comment</strong>: <pre>Include the underlying error in the returned error.</pre><strong>Commenter</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>CommentLine</strong>: [core/scc/lscc/support.go#L160](https://github.com/hyperledger-gerrit-archive/fabric/blob/bb31734dfba5475830298aa88b1ec0e5c8294ac7/core/scc/lscc/support.go#L160)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/scc/lscc/support.go#L169](https://github.com/hyperledger-gerrit-archive/fabric/blob/bb31734dfba5475830298aa88b1ec0e5c8294ac7/core/scc/lscc/support.go#L169)<br><strong>Comment</strong>: <pre>This block is completely untested.</pre><strong>Commenter</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>CommentLine</strong>: [core/scc/lscc/support.go#L169](https://github.com/hyperledger-gerrit-archive/fabric/blob/bb31734dfba5475830298aa88b1ec0e5c8294ac7/core/scc/lscc/support.go#L169)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/scc/lscc/support.go#L181](https://github.com/hyperledger-gerrit-archive/fabric/blob/bb31734dfba5475830298aa88b1ec0e5c8294ac7/core/scc/lscc/support.go#L181)<br><strong>Comment</strong>: <pre>If you return (instead of break) when found, this becomes the fallback error and flattens the structure.</pre><strong>Commenter</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>CommentLine</strong>: [core/scc/lscc/support.go#L181](https://github.com/hyperledger-gerrit-archive/fabric/blob/bb31734dfba5475830298aa88b1ec0e5c8294ac7/core/scc/lscc/support.go#L181)<br><strong>Comment</strong>: <pre>See above - if I return instead of break, I exit the outer loop prematurely.</pre></blockquote><h3>PatchSet Number: 7</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Uploader</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Created</strong>: 5/25/2018, 1:42:20 PM<br><strong>UnmergedRevision</strong>: [92a4a377dfa97e2df2afcbb012f0ecf41fb5d054](https://github.com/hyperledger-gerrit-archive/fabric/commit/92a4a377dfa97e2df2afcbb012f0ecf41fb5d054)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/25/2018, 1:50:10 PM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/25/2018, 1:50:10 PM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/25/2018, 2:02:27 PM<br><strong>Type</strong>: F2-SmokeTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/25/2018, 1:50:10 PM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/25/2018, 2:15:56 PM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>Approved</strong>: 6/1/2018, 7:29:32 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>CommentLine</strong>: [core/handlers/validation/builtin/validation_logic.go#L170](https://github.com/hyperledger-gerrit-archive/fabric/blob/92a4a377dfa97e2df2afcbb012f0ecf41fb5d054/core/handlers/validation/builtin/validation_logic.go#L170)<br><strong>Comment</strong>: <pre>channelName added but not used.</pre><strong>Commenter</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>CommentLine</strong>: [core/handlers/validation/builtin/validation_logic.go#L170](https://github.com/hyperledger-gerrit-archive/fabric/blob/92a4a377dfa97e2df2afcbb012f0ecf41fb5d054/core/handlers/validation/builtin/validation_logic.go#L170)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>CommentLine</strong>: [core/scc/lscc/lscc.go#L217](https://github.com/hyperledger-gerrit-archive/fabric/blob/92a4a377dfa97e2df2afcbb012f0ecf41fb5d054/core/scc/lscc/lscc.go#L217)<br><strong>Comment</strong>: <pre>Also print the org name which does not comply.

On further thought, I think this should print a Warning message but not return an Error.  There are valid scenarios where you know a new member will be joining the channel soon, and when you instantiate the chaincode you may want to pre-include them rather than having to upgrade the chaincode for collection policy each time a member is added to the channel.</pre><strong>Commenter</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>CommentLine</strong>: [core/scc/lscc/lscc.go#L217](https://github.com/hyperledger-gerrit-archive/fabric/blob/92a4a377dfa97e2df2afcbb012f0ecf41fb5d054/core/scc/lscc/lscc.go#L217)<br><strong>Comment</strong>: <pre>Done</pre></blockquote><h3>PatchSet Number: 8</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Uploader</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Created</strong>: 6/1/2018, 9:04:06 AM<br><strong>UnmergedRevision</strong>: [0c7cf1ee480978797dbbdc5296b1deb6b7957b48](https://github.com/hyperledger-gerrit-archive/fabric/commit/0c7cf1ee480978797dbbdc5296b1deb6b7957b48)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 6/1/2018, 9:12:15 AM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 6/1/2018, 9:12:15 AM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 6/1/2018, 9:25:48 AM<br><strong>Type</strong>: F2-SmokeTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 6/1/2018, 9:12:15 AM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 6/1/2018, 9:45:31 AM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 9</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Uploader</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Created</strong>: 6/1/2018, 9:21:50 AM<br><strong>UnmergedRevision</strong>: [63da7e7ef334284183ffd239cd85a61039ac8a88](https://github.com/hyperledger-gerrit-archive/fabric/commit/63da7e7ef334284183ffd239cd85a61039ac8a88)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 6/1/2018, 9:31:18 AM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 6/1/2018, 9:31:18 AM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 6/1/2018, 9:52:36 AM<br><strong>Type</strong>: F2-SmokeTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 6/1/2018, 9:31:18 AM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 6/1/2018, 10:08:00 AM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Approved</strong>: 6/1/2018, 10:11:22 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/handlers/validation/builtin/validation_logic.go#L210](https://github.com/hyperledger-gerrit-archive/fabric/blob/63da7e7ef334284183ffd239cd85a61039ac8a88/core/handlers/validation/builtin/validation_logic.go#L210)<br><strong>Comment</strong>: <pre>Why are we "wrapping" here instead of capturing the stack/context in the helper?

This looks like a VSCCEndorsementPolicyError wrapped around a  pkg/errors.withMessage wrapped around a pkg/errors.withStack wrapped around a VSCCEdnorsementPolicyError wrapped around a fmt.stringError. 

Basically, you're calling your own helper that returns a policy error - just return what you've got and make sure that original policy error has the context.

Oh - and we wrap it again(!) in the caller (validateRWSetAndCollection).</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/handlers/validation/builtin/validation_logic.go#L210](https://github.com/hyperledger-gerrit-archive/fabric/blob/63da7e7ef334284183ffd239cd85a61039ac8a88/core/handlers/validation/builtin/validation_logic.go#L210)<br><strong>Comment</strong>: <pre>This is untested.</pre><strong>Commenter</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>CommentLine</strong>: [core/handlers/validation/builtin/validation_logic.go#L210](https://github.com/hyperledger-gerrit-archive/fabric/blob/63da7e7ef334284183ffd239cd85a61039ac8a88/core/handlers/validation/builtin/validation_logic.go#L210)<br><strong>Comment</strong>: <pre>Indeed, this was crap. I now only create the context in the innermost function and leave the VSCCEndorsementPolicyError wrapping to the caller. I also removed the double-wrapping from the other locations within validateNewCollectionConfigs().</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/handlers/validation/builtin/validation_logic.go#L224](https://github.com/hyperledger-gerrit-archive/fabric/blob/63da7e7ef334284183ffd239cd85a61039ac8a88/core/handlers/validation/builtin/validation_logic.go#L224)<br><strong>Comment</strong>: <pre>This is untested.</pre><strong>Commenter</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>CommentLine</strong>: [core/handlers/validation/builtin/validation_logic.go#L224](https://github.com/hyperledger-gerrit-archive/fabric/blob/63da7e7ef334284183ffd239cd85a61039ac8a88/core/handlers/validation/builtin/validation_logic.go#L224)<br><strong>Comment</strong>: <pre>fixed the corresponding test</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/handlers/validation/builtin/validation_logic_test.go#L1838](https://github.com/hyperledger-gerrit-archive/fabric/blob/63da7e7ef334284183ffd239cd85a61039ac8a88/core/handlers/validation/builtin/validation_logic_test.go#L1838)<br><strong>Comment</strong>: <pre>This test is wrong. You're using the wrong matcher.

The error you're getting back is 'collection-name: mycollection3 -- maximum peer count (1) cannot be greater than the required peer count (2)' - which is non-nil; it's not the one you should be getting.</pre><strong>Commenter</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>CommentLine</strong>: [core/handlers/validation/builtin/validation_logic_test.go#L1838](https://github.com/hyperledger-gerrit-archive/fabric/blob/63da7e7ef334284183ffd239cd85a61039ac8a88/core/handlers/validation/builtin/validation_logic_test.go#L1838)<br><strong>Comment</strong>: <pre>fixed the test using the correct matcher and a valid peer configuration.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/handlers/validation/builtin/validation_logic_test.go#L1838](https://github.com/hyperledger-gerrit-archive/fabric/blob/63da7e7ef334284183ffd239cd85a61039ac8a88/core/handlers/validation/builtin/validation_logic_test.go#L1838)<br><strong>Comment</strong>: <pre>I'm happy you fixed this one but there were many others in here with the same problem. (Looks like you copied and pasted the broken pattern.)

Seems like those should have been fixed as well. Can you point me to an open issue that captures this problem to address in the future?</pre></blockquote><h3>PatchSet Number: 10</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Uploader</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Created</strong>: 6/1/2018, 11:43:58 AM<br><strong>GitHubMergedRevision</strong>: [d689f798db7181197c55dfb66a29d43508c7942a](https://github.com/hyperledger-gerrit-archive/fabric/commit/d689f798db7181197c55dfb66a29d43508c7942a)<br><br><strong>Approver</strong>: Christopher Ferris - chris.ferris@gmail.com<br><strong>Approved</strong>: 6/4/2018, 10:44:48 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>MergedBy</strong>: Christopher Ferris<br><strong>Merged</strong>: 6/4/2018, 10:44:53 AM<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 6/1/2018, 11:52:36 AM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 6/1/2018, 11:52:36 AM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 6/1/2018, 12:06:14 PM<br><strong>Type</strong>: F2-SmokeTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 6/1/2018, 11:52:36 AM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 6/1/2018, 12:22:15 PM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>Approved</strong>: 6/4/2018, 6:04:53 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/handlers/validation/builtin/validation_logic.go#L202](https://github.com/hyperledger-gerrit-archive/fabric/blob/d689f798db7181197c55dfb66a29d43508c7942a/core/handlers/validation/builtin/validation_logic.go#L202)<br><strong>Comment</strong>: <pre>"less than" and this path is untested.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/handlers/validation/builtin/validation_logic_test.go#L1755](https://github.com/hyperledger-gerrit-archive/fabric/blob/d689f798db7181197c55dfb66a29d43508c7942a/core/handlers/validation/builtin/validation_logic_test.go#L1755)<br><strong>Comment</strong>: <pre>EqualError</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/handlers/validation/builtin/validation_logic_test.go#L1760](https://github.com/hyperledger-gerrit-archive/fabric/blob/d689f798db7181197c55dfb66a29d43508c7942a/core/handlers/validation/builtin/validation_logic_test.go#L1760)<br><strong>Comment</strong>: <pre>EqualError</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/handlers/validation/builtin/validation_logic_test.go#L1780](https://github.com/hyperledger-gerrit-archive/fabric/blob/d689f798db7181197c55dfb66a29d43508c7942a/core/handlers/validation/builtin/validation_logic_test.go#L1780)<br><strong>Comment</strong>: <pre>EqualError</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/handlers/validation/builtin/validation_logic_test.go#L1785](https://github.com/hyperledger-gerrit-archive/fabric/blob/d689f798db7181197c55dfb66a29d43508c7942a/core/handlers/validation/builtin/validation_logic_test.go#L1785)<br><strong>Comment</strong>: <pre>EqualError</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/handlers/validation/builtin/validation_logic_test.go#L1823](https://github.com/hyperledger-gerrit-archive/fabric/blob/d689f798db7181197c55dfb66a29d43508c7942a/core/handlers/validation/builtin/validation_logic_test.go#L1823)<br><strong>Comment</strong>: <pre>EqualError</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/handlers/validation/builtin/validation_logic_test.go#L1831](https://github.com/hyperledger-gerrit-archive/fabric/blob/d689f798db7181197c55dfb66a29d43508c7942a/core/handlers/validation/builtin/validation_logic_test.go#L1831)<br><strong>Comment</strong>: <pre>EqualError</pre></blockquote>
<strong>Project</strong>: fabric<br><strong>Branch</strong>: master<br><strong>ID</strong>: 29710<br><strong>Subject</strong>: FAB-13247 kafka2raft abort and crash recovery<br><strong>Status</strong>: ABANDONED<br><strong>Owner</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Assignee</strong>:<br><strong>Created</strong>: 2/28/2019, 9:48:38 AM<br><strong>LastUpdated</strong>: 4/2/2019, 9:44:33 AM<br><strong>CommitMessage</strong>:<br><pre>FAB-13247 kafka2raft abort and crash recovery

This change addresses 3 issues:
- Kafka2Raft migration abort path
- Kafka2Raft migration crash recovery
- Addressing review comments

* Kafka2Raft migration abort path

The abort path builds on the "green" path described in an earlier task
(FAB-13264) and adds the ability to abort a migration after it was started
but before it is committed. Recall that starting a migration blocks all
normal transactions. The ability to abort an on-going migration allows an
admin to cope with errors and problems in the process of migration without
freezing the ordering service during the entire time. 

Possible use cases for the abort path are the following:

- An admin starts a migration, tries to commit, but receives a response
  that not all standard channels have the same Raft metadata in the
  "CONTEXT".
- An admin starts a migration, and while submitting a "CONTEXT" receives 
  a response that the Raft metadata in it is invalid.
- The admin can then abort, allowing the system to continue
  processing transactions, regroup, and try again in a later (maybe much
  later) time.

See JIRA FAB-13245 for additional details.

* Kafka2Raft migration crash recovery

Deals with an OSN that crashes before or during migration, and recovers
during or after migration.  When this happens, there are two things that
need to be done:
1. Restore the migration status of every chain, based on the last
   config update from the ledger
2. Carefully consume messages from Kafka in order to respect the order
   of migration commands

See JIRA FAB-13247 for additional details.

Change-Id: If347502cb5c9f6c9121454c5eb582bdc504dedb4
Signed-off-by: Yoav Tock <tock@il.ibm.com>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Reviewed</strong>: 2/28/2019, 9:48:38 AM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/28/2019, 9:52:06 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/10905/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/28/2019, 9:52:35 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/28/2019, 9:55:28 AM<br><strong>Message</strong>: <pre>Patch Set 1: F1-VerifyBuild-1

code checks are failed</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/28/2019, 9:56:22 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/10905/ : FAILURE (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/10905</pre><strong>Reviewer</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Reviewed</strong>: 2/28/2019, 10:34:45 AM<br><strong>Message</strong>: <pre>Uploaded patch set 2.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/28/2019, 10:37:41 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/10915/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/28/2019, 10:38:10 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/28/2019, 10:41:47 AM<br><strong>Message</strong>: <pre>Patch Set 2: F1-VerifyBuild-1

code checks are failed</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/28/2019, 10:42:22 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/10915/ : FAILURE (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/10915</pre><strong>Reviewer</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Reviewed</strong>: 2/28/2019, 11:01:41 AM<br><strong>Message</strong>: <pre>Uploaded patch set 3.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/28/2019, 11:05:51 AM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/10922/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/28/2019, 11:06:20 AM<br><strong>Message</strong>: <pre>Patch Set 3:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/28/2019, 11:10:34 AM<br><strong>Message</strong>: <pre>Patch Set 3: F1-VerifyBuild-1

code checks are failed</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/28/2019, 11:11:27 AM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/10922/ : FAILURE (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/10922</pre><strong>Reviewer</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Reviewed</strong>: 2/28/2019, 11:41:52 AM<br><strong>Message</strong>: <pre>Uploaded patch set 4.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/28/2019, 11:47:13 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/10928/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/28/2019, 11:47:49 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/28/2019, 11:54:56 AM<br><strong>Message</strong>: <pre>Patch Set 4: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run IntegrationTest, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/28/2019, 11:55:53 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/10928/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/10928</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/28/2019, 11:57:49 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/9643/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/28/2019, 11:58:16 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/28/2019, 11:58:18 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/6407/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/28/2019, 11:58:48 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Starting Integration tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/28/2019, 12:26:01 PM<br><strong>Message</strong>: <pre>Patch Set 4: F3-UnitTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/28/2019, 12:43:03 PM<br><strong>Message</strong>: <pre>Patch Set 4: F3-IntegrationTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/28/2019, 12:43:47 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/9643/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/9643

https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/6407/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-integration-tests-x86_64/6407</pre><strong>Reviewer</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Reviewed</strong>: 3/3/2019, 6:51:17 AM<br><strong>Message</strong>: <pre>Uploaded patch set 5.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/3/2019, 7:20:44 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/11040/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/3/2019, 7:21:33 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/3/2019, 7:29:59 AM<br><strong>Message</strong>: <pre>Patch Set 5: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run IntegrationTest, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/3/2019, 7:30:52 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/11040/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/11040</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/3/2019, 7:32:59 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/9799/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/3/2019, 7:33:26 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/3/2019, 7:34:47 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/6530/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/3/2019, 7:35:13 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Starting Integration tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/3/2019, 8:01:53 AM<br><strong>Message</strong>: <pre>Patch Set 5: F3-UnitTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/3/2019, 8:20:52 AM<br><strong>Message</strong>: <pre>Patch Set 5: F3-IntegrationTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/3/2019, 8:22:41 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/9799/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/9799

https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/6530/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-integration-tests-x86_64/6530</pre><strong>Reviewer</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Reviewed</strong>: 3/5/2019, 5:59:21 AM<br><strong>Message</strong>: <pre>Uploaded patch set 6: Patch Set 5 was rebased.</pre><strong>Reviewer</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Reviewed</strong>: 3/6/2019, 8:57:03 AM<br><strong>Message</strong>: <pre>Uploaded patch set 7.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/6/2019, 9:00:25 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/11326/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/6/2019, 9:00:57 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/6/2019, 9:07:13 AM<br><strong>Message</strong>: <pre>Patch Set 7: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run IntegrationTest, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/6/2019, 9:08:01 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/11326/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/11326</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/6/2019, 9:11:24 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/10105/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/6/2019, 9:12:18 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/6/2019, 9:12:27 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/6840/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/6/2019, 9:13:04 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Starting Integration tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/6/2019, 9:40:29 AM<br><strong>Message</strong>: <pre>Patch Set 7: F3-UnitTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/6/2019, 9:56:38 AM<br><strong>Message</strong>: <pre>Patch Set 7: F3-IntegrationTest-1

Failed</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/6/2019, 9:57:22 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/6840/ : FAILURE (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-integration-tests-x86_64/6840

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/10105/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/10105</pre><strong>Reviewer</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Reviewed</strong>: 3/6/2019, 10:09:23 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Run IntegrationTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/6/2019, 10:12:13 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/6842/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/6/2019, 10:12:55 AM<br><strong>Message</strong>: <pre>Patch Set 7: -F3-IntegrationTest

Starting Integration tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/6/2019, 11:02:40 AM<br><strong>Message</strong>: <pre>Patch Set 7: F3-IntegrationTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/6/2019, 11:03:34 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/6842/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-integration-tests-x86_64/6842</pre><strong>Reviewer</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Reviewed</strong>: 3/7/2019, 6:18:38 AM<br><strong>Message</strong>: <pre>Uploaded patch set 8: Patch Set 7 was rebased.</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 3/7/2019, 8:07:07 AM<br><strong>Message</strong>: <pre>Patch Set 7:

(8 comments)

Still need to continue reading, here my comments so far. General note, I wish this could be splited into smaller CRs.</pre><strong>Reviewer</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Reviewed</strong>: 3/8/2019, 9:28:27 AM<br><strong>Message</strong>: <pre>Uploaded patch set 9.</pre><strong>Reviewer</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Reviewed</strong>: 3/8/2019, 9:30:05 AM<br><strong>Message</strong>: <pre>Patch Set 7:

(8 comments)

Thanks for the review Artem!</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/8/2019, 9:32:51 AM<br><strong>Message</strong>: <pre>Patch Set 9:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/11469/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/8/2019, 9:33:24 AM<br><strong>Message</strong>: <pre>Patch Set 9:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/8/2019, 9:40:48 AM<br><strong>Message</strong>: <pre>Patch Set 9: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run IntegrationTest, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/8/2019, 9:41:51 AM<br><strong>Message</strong>: <pre>Patch Set 9:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/11469/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/11469</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/8/2019, 9:43:20 AM<br><strong>Message</strong>: <pre>Patch Set 9:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/10215/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/8/2019, 9:43:52 AM<br><strong>Message</strong>: <pre>Patch Set 9:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/6940/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/8/2019, 9:43:59 AM<br><strong>Message</strong>: <pre>Patch Set 9:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/8/2019, 9:44:37 AM<br><strong>Message</strong>: <pre>Patch Set 9:

Starting Integration tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/8/2019, 10:11:27 AM<br><strong>Message</strong>: <pre>Patch Set 9: F3-UnitTest-1

Failed</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/8/2019, 10:30:13 AM<br><strong>Message</strong>: <pre>Patch Set 9: F3-IntegrationTest-1

Failed</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/8/2019, 10:31:04 AM<br><strong>Message</strong>: <pre>Patch Set 9:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/10215/ : FAILURE (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/10215

https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/6940/ : FAILURE (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-integration-tests-x86_64/6940</pre><strong>Reviewer</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Reviewed</strong>: 3/8/2019, 2:54:31 PM<br><strong>Message</strong>: <pre>Uploaded patch set 10.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/8/2019, 2:59:24 PM<br><strong>Message</strong>: <pre>Patch Set 10:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/11489/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/8/2019, 3:00:01 PM<br><strong>Message</strong>: <pre>Patch Set 10:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/8/2019, 3:05:43 PM<br><strong>Message</strong>: <pre>Patch Set 10: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run IntegrationTest, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/8/2019, 3:06:26 PM<br><strong>Message</strong>: <pre>Patch Set 10:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/11489/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/11489</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/8/2019, 3:08:15 PM<br><strong>Message</strong>: <pre>Patch Set 10:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/10238/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/8/2019, 3:08:42 PM<br><strong>Message</strong>: <pre>Patch Set 10:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/8/2019, 3:08:42 PM<br><strong>Message</strong>: <pre>Patch Set 10:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/6958/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/8/2019, 3:09:15 PM<br><strong>Message</strong>: <pre>Patch Set 10:

Starting Integration tests</pre><strong>Reviewer</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Reviewed</strong>: 3/8/2019, 3:24:10 PM<br><strong>Message</strong>: <pre>Uploaded patch set 11: Patch Set 10 was rebased.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/8/2019, 3:37:02 PM<br><strong>Message</strong>: <pre>Patch Set 10: F3-UnitTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/8/2019, 3:48:01 PM<br><strong>Message</strong>: <pre>Patch Set 10: F3-IntegrationTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/8/2019, 3:48:30 PM<br><strong>Message</strong>: <pre>Patch Set 10:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/10238/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/10238

https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/6958/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-integration-tests-x86_64/6958</pre><strong>Reviewer</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Reviewed</strong>: 3/8/2019, 4:41:34 PM<br><strong>Message</strong>: <pre>Patch Set 11:

Run UnitTest</pre><strong>Reviewer</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Reviewed</strong>: 3/8/2019, 4:41:51 PM<br><strong>Message</strong>: <pre>Patch Set 11:

Run IntegrationTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/8/2019, 4:44:49 PM<br><strong>Message</strong>: <pre>Patch Set 11:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/10250/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/8/2019, 4:45:24 PM<br><strong>Message</strong>: <pre>Patch Set 11:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/8/2019, 4:46:01 PM<br><strong>Message</strong>: <pre>Patch Set 11:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/6968/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/8/2019, 4:46:54 PM<br><strong>Message</strong>: <pre>Patch Set 11:

Starting Integration tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/8/2019, 5:15:10 PM<br><strong>Message</strong>: <pre>Patch Set 11: F3-UnitTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/8/2019, 5:35:20 PM<br><strong>Message</strong>: <pre>Patch Set 11: F3-IntegrationTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/8/2019, 5:36:18 PM<br><strong>Message</strong>: <pre>Patch Set 11:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/10250/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/10250

https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/6968/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-integration-tests-x86_64/6968</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 3/10/2019, 5:46:52 AM<br><strong>Message</strong>: <pre>Patch Set 11: Code-Review+1

It looks good to me, but I'd rather wait for @Jason and @Yacov as second pair of eyes here.</pre><strong>Reviewer</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Reviewed</strong>: 3/10/2019, 7:23:52 AM<br><strong>Message</strong>: <pre>Uploaded patch set 12: Patch Set 11 was rebased.</pre><strong>Reviewer</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Reviewed</strong>: 3/11/2019, 4:58:08 AM<br><strong>Message</strong>: <pre>Uploaded patch set 13: Patch Set 12 was rebased.</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 3/11/2019, 9:11:13 AM<br><strong>Message</strong>: <pre>Patch Set 13:

(6 comments)

reached file 13/19 ....</pre><strong>Reviewer</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Reviewed</strong>: 3/12/2019, 4:54:31 AM<br><strong>Message</strong>: <pre>Uploaded patch set 14.</pre><strong>Reviewer</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Reviewed</strong>: 3/12/2019, 4:56:18 AM<br><strong>Message</strong>: <pre>Patch Set 14:

(6 comments)

Thanks for the review Yacov!</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/12/2019, 4:59:15 AM<br><strong>Message</strong>: <pre>Patch Set 14:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/11587/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/12/2019, 4:59:56 AM<br><strong>Message</strong>: <pre>Patch Set 14:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/12/2019, 5:05:51 AM<br><strong>Message</strong>: <pre>Patch Set 14: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run IntegrationTest, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/12/2019, 5:06:38 AM<br><strong>Message</strong>: <pre>Patch Set 14:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/11587/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/11587</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/12/2019, 5:08:20 AM<br><strong>Message</strong>: <pre>Patch Set 14:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/10318/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/12/2019, 5:08:46 AM<br><strong>Message</strong>: <pre>Patch Set 14:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/12/2019, 5:09:05 AM<br><strong>Message</strong>: <pre>Patch Set 14:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/7034/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/12/2019, 5:09:37 AM<br><strong>Message</strong>: <pre>Patch Set 14:

Starting Integration tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/12/2019, 5:33:43 AM<br><strong>Message</strong>: <pre>Patch Set 14: F3-UnitTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/12/2019, 5:53:14 AM<br><strong>Message</strong>: <pre>Patch Set 14: F3-IntegrationTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/12/2019, 5:53:56 AM<br><strong>Message</strong>: <pre>Patch Set 14:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/10318/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/10318

https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/7034/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-integration-tests-x86_64/7034</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 3/12/2019, 6:40:49 AM<br><strong>Message</strong>: <pre>Patch Set 14:

(1 comment)</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 3/12/2019, 7:34:42 AM<br><strong>Message</strong>: <pre>Patch Set 14: Code-Review+1</pre><strong>Reviewer</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Reviewed</strong>: 3/12/2019, 7:38:13 AM<br><strong>Message</strong>: <pre>Patch Set 14:

(1 comment)

Thanks for the review, Yacov!</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 3/14/2019, 2:24:46 AM<br><strong>Message</strong>: <pre>Patch Set 14: Code-Review-1

(9 comments)

I'm a bit new into this series, but there are some code style things that I saw a bit too much of not to comment on.  Sorry if the comments come off as mostly style over substance, but especially when it comes to exit patterns, nesting depths, etc. that it really affects the readability and maintainability of the code.

In general, I'm seeing a lot of deeply nested code, switches, in switches, in for loops, which is a bit troubling and makes me think the structure could be improved.  I also realize that pieces of this are already merged, but this change is also hitting a significant portion of the code and is not nearly as compartmentalized as I would hope.

I've also not finished reviewing everything here, but a few hours in and I need to hang it up for the night.  -1-ing for now to prevent merge.</pre><strong>Reviewer</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Reviewed</strong>: 3/14/2019, 4:41:27 PM<br><strong>Message</strong>: <pre>Uploaded patch set 15.</pre><strong>Reviewer</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Reviewed</strong>: 3/14/2019, 4:42:40 PM<br><strong>Message</strong>: <pre>Patch Set 15:

(9 comments)

@Jason Thanks for the review!</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/14/2019, 4:45:48 PM<br><strong>Message</strong>: <pre>Patch Set 15:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/11734/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/14/2019, 4:46:39 PM<br><strong>Message</strong>: <pre>Patch Set 15:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/14/2019, 4:52:30 PM<br><strong>Message</strong>: <pre>Patch Set 15: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run IntegrationTest, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/14/2019, 4:53:23 PM<br><strong>Message</strong>: <pre>Patch Set 15:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/11734/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/11734</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/14/2019, 4:54:57 PM<br><strong>Message</strong>: <pre>Patch Set 15:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/10460/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/14/2019, 4:55:23 PM<br><strong>Message</strong>: <pre>Patch Set 15:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/14/2019, 4:56:32 PM<br><strong>Message</strong>: <pre>Patch Set 15:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/7166/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/14/2019, 4:57:02 PM<br><strong>Message</strong>: <pre>Patch Set 15:

Starting Integration tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/14/2019, 5:20:25 PM<br><strong>Message</strong>: <pre>Patch Set 15: F3-UnitTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/14/2019, 5:42:06 PM<br><strong>Message</strong>: <pre>Patch Set 15: F3-IntegrationTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/14/2019, 5:43:04 PM<br><strong>Message</strong>: <pre>Patch Set 15:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/10460/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/10460

https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/7166/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-integration-tests-x86_64/7166</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 3/15/2019, 12:57:58 AM<br><strong>Message</strong>: <pre>Patch Set 15:

(11 comments)</pre><strong>Reviewer</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Reviewed</strong>: 3/17/2019, 1:27:44 PM<br><strong>Message</strong>: <pre>Uploaded patch set 16: Patch Set 15 was rebased.</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 3/19/2019, 3:55:27 AM<br><strong>Message</strong>: <pre>Patch Set 16: Code-Review+2</pre><strong>Reviewer</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Reviewed</strong>: 3/19/2019, 7:28:01 AM<br><strong>Message</strong>: <pre>Uploaded patch set 17.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/19/2019, 7:33:28 AM<br><strong>Message</strong>: <pre>Patch Set 17:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/11936/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/19/2019, 7:33:50 AM<br><strong>Message</strong>: <pre>Patch Set 17:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/19/2019, 7:39:04 AM<br><strong>Message</strong>: <pre>Patch Set 17: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run IntegrationTest, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/19/2019, 7:39:50 AM<br><strong>Message</strong>: <pre>Patch Set 17:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/11936/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/11936</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/19/2019, 7:41:57 AM<br><strong>Message</strong>: <pre>Patch Set 17:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/10664/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/19/2019, 7:42:25 AM<br><strong>Message</strong>: <pre>Patch Set 17:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/19/2019, 7:42:43 AM<br><strong>Message</strong>: <pre>Patch Set 17:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/7335/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/19/2019, 7:43:08 AM<br><strong>Message</strong>: <pre>Patch Set 17:

Starting Integration tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/19/2019, 8:07:50 AM<br><strong>Message</strong>: <pre>Patch Set 17: F3-UnitTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/19/2019, 8:25:17 AM<br><strong>Message</strong>: <pre>Patch Set 17: F3-IntegrationTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/19/2019, 8:25:58 AM<br><strong>Message</strong>: <pre>Patch Set 17:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/10664/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/10664

https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/7335/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-integration-tests-x86_64/7335</pre><strong>Reviewer</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Reviewed</strong>: 3/19/2019, 8:34:47 AM<br><strong>Message</strong>: <pre>Uploaded patch set 18: Patch Set 17 was rebased.</pre><strong>Reviewer</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Reviewed</strong>: 3/20/2019, 2:52:05 AM<br><strong>Message</strong>: <pre>Patch Set 15:

(8 comments)

@Jason, thanks for the review!</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 3/24/2019, 5:05:45 PM<br><strong>Message</strong>: <pre>Patch Set 18:

(2 comments)</pre><strong>Reviewer</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Reviewed</strong>: 3/25/2019, 12:19:57 PM<br><strong>Message</strong>: <pre>Uploaded patch set 19.</pre><strong>Reviewer</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Reviewed</strong>: 3/25/2019, 12:21:06 PM<br><strong>Message</strong>: <pre>Patch Set 19:

(2 comments)

Thanks for the review!</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/25/2019, 12:22:40 PM<br><strong>Message</strong>: <pre>Patch Set 19:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/12173/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/25/2019, 12:23:05 PM<br><strong>Message</strong>: <pre>Patch Set 19:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/25/2019, 12:27:56 PM<br><strong>Message</strong>: <pre>Patch Set 19: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run IntegrationTest, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/25/2019, 12:28:37 PM<br><strong>Message</strong>: <pre>Patch Set 19:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/12173/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/12173</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/25/2019, 12:30:43 PM<br><strong>Message</strong>: <pre>Patch Set 19:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/10844/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/25/2019, 12:31:07 PM<br><strong>Message</strong>: <pre>Patch Set 19:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/25/2019, 12:31:18 PM<br><strong>Message</strong>: <pre>Patch Set 19:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/7496/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/25/2019, 12:31:44 PM<br><strong>Message</strong>: <pre>Patch Set 19:

Starting Integration tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/25/2019, 1:00:02 PM<br><strong>Message</strong>: <pre>Patch Set 19: F3-UnitTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/25/2019, 1:13:16 PM<br><strong>Message</strong>: <pre>Patch Set 19: F3-IntegrationTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/25/2019, 1:13:59 PM<br><strong>Message</strong>: <pre>Patch Set 19:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/10844/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/10844

https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/7496/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-integration-tests-x86_64/7496</pre><strong>Reviewer</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Reviewed</strong>: 3/26/2019, 6:55:33 AM<br><strong>Message</strong>: <pre>Uploaded patch set 20.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/26/2019, 6:58:17 AM<br><strong>Message</strong>: <pre>Patch Set 20:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/12236/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/26/2019, 6:58:56 AM<br><strong>Message</strong>: <pre>Patch Set 20:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/26/2019, 7:04:39 AM<br><strong>Message</strong>: <pre>Patch Set 20: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run IntegrationTest, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/26/2019, 7:05:25 AM<br><strong>Message</strong>: <pre>Patch Set 20:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/12236/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/12236</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/26/2019, 7:07:17 AM<br><strong>Message</strong>: <pre>Patch Set 20:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/10888/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/26/2019, 7:07:40 AM<br><strong>Message</strong>: <pre>Patch Set 20:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/26/2019, 7:07:47 AM<br><strong>Message</strong>: <pre>Patch Set 20:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/7548/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/26/2019, 7:08:21 AM<br><strong>Message</strong>: <pre>Patch Set 20:

Starting Integration tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/26/2019, 7:24:34 AM<br><strong>Message</strong>: <pre>Patch Set 20: F3-UnitTest-1

Failed</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/26/2019, 7:45:41 AM<br><strong>Message</strong>: <pre>Patch Set 20: F3-IntegrationTest-1

Failed</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/26/2019, 7:46:16 AM<br><strong>Message</strong>: <pre>Patch Set 20:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/10888/ : FAILURE (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/10888

https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/7548/ : FAILURE (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-integration-tests-x86_64/7548</pre><strong>Reviewer</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Reviewed</strong>: 3/26/2019, 9:20:49 AM<br><strong>Message</strong>: <pre>Uploaded patch set 21.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/26/2019, 9:25:46 AM<br><strong>Message</strong>: <pre>Patch Set 21:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/12262/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/26/2019, 9:26:13 AM<br><strong>Message</strong>: <pre>Patch Set 21:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/26/2019, 9:31:02 AM<br><strong>Message</strong>: <pre>Patch Set 21: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run IntegrationTest, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/26/2019, 9:31:45 AM<br><strong>Message</strong>: <pre>Patch Set 21:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/12262/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/12262</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/26/2019, 9:34:07 AM<br><strong>Message</strong>: <pre>Patch Set 21:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/10891/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/26/2019, 9:34:47 AM<br><strong>Message</strong>: <pre>Patch Set 21:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/7553/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/26/2019, 9:35:17 AM<br><strong>Message</strong>: <pre>Patch Set 21:

Starting Integration tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/26/2019, 9:35:27 AM<br><strong>Message</strong>: <pre>Patch Set 21:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/26/2019, 10:02:35 AM<br><strong>Message</strong>: <pre>Patch Set 21: F3-UnitTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/26/2019, 10:17:58 AM<br><strong>Message</strong>: <pre>Patch Set 21: F3-IntegrationTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/26/2019, 10:18:39 AM<br><strong>Message</strong>: <pre>Patch Set 21:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/10891/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/10891

https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/7553/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-integration-tests-x86_64/7553</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 3/27/2019, 7:43:33 AM<br><strong>Message</strong>: <pre>Patch Set 22: Patch Set 21 was rebased</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 3/27/2019, 7:43:51 AM<br><strong>Message</strong>: <pre>Patch Set 22:

Run VerifyBuild</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 3/27/2019, 7:44:50 AM<br><strong>Message</strong>: <pre>Patch Set 22: Code-Review+2</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/27/2019, 7:47:15 AM<br><strong>Message</strong>: <pre>Patch Set 22:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/12382/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/27/2019, 7:47:40 AM<br><strong>Message</strong>: <pre>Patch Set 22: -F2-DocBuild -F1-VerifyBuild -F3-IntegrationTest -F3-UnitTest

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/27/2019, 7:52:32 AM<br><strong>Message</strong>: <pre>Patch Set 22: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run IntegrationTest, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/27/2019, 7:55:21 AM<br><strong>Message</strong>: <pre>Patch Set 22:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/11009/ (2/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/27/2019, 7:55:53 AM<br><strong>Message</strong>: <pre>Patch Set 22:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/27/2019, 7:56:11 AM<br><strong>Message</strong>: <pre>Patch Set 22:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/7701/ (3/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/27/2019, 7:56:37 AM<br><strong>Message</strong>: <pre>Patch Set 22:

Starting Integration tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/27/2019, 8:21:28 AM<br><strong>Message</strong>: <pre>Patch Set 22: F3-UnitTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/27/2019, 8:37:30 AM<br><strong>Message</strong>: <pre>Patch Set 22: F3-IntegrationTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/27/2019, 8:38:09 AM<br><strong>Message</strong>: <pre>Patch Set 22:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/12382/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/12382

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/11009/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/11009

https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/7701/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-integration-tests-x86_64/7701</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 3/28/2019, 9:48:12 AM<br><strong>Message</strong>: <pre>Patch Set 23: Patch Set 22 was rebased</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 3/28/2019, 9:48:25 AM<br><strong>Message</strong>: <pre>Patch Set 23:

Run VerifyBuild</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/28/2019, 9:53:28 AM<br><strong>Message</strong>: <pre>Patch Set 23:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/12461/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/28/2019, 9:53:51 AM<br><strong>Message</strong>: <pre>Patch Set 23: -F2-DocBuild -F1-VerifyBuild -F3-IntegrationTest -F3-UnitTest

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/28/2019, 9:58:24 AM<br><strong>Message</strong>: <pre>Patch Set 23: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run IntegrationTest, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/28/2019, 10:00:51 AM<br><strong>Message</strong>: <pre>Patch Set 23:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/11062/ (2/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/28/2019, 10:01:16 AM<br><strong>Message</strong>: <pre>Patch Set 23:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/28/2019, 10:01:38 AM<br><strong>Message</strong>: <pre>Patch Set 23:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/7765/ (3/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/28/2019, 10:02:04 AM<br><strong>Message</strong>: <pre>Patch Set 23:

Starting Integration tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/28/2019, 10:30:04 AM<br><strong>Message</strong>: <pre>Patch Set 23: F3-UnitTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/28/2019, 10:47:50 AM<br><strong>Message</strong>: <pre>Patch Set 23: F3-IntegrationTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/28/2019, 10:48:36 AM<br><strong>Message</strong>: <pre>Patch Set 23:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/12461/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/12461

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/11062/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/11062

https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/7765/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-integration-tests-x86_64/7765</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 3/28/2019, 2:19:40 PM<br><strong>Message</strong>: <pre>Patch Set 23: Code-Review-2

(1 comment)

Let's put a hold on this migration work for the moment.  Priority needs to be v1.4.1 and flakes, and I'm still concerned with the overall approach.  I know I'm late to the game here, but I think it's important that we pause to make sure we're applying our efforts in the right direction.</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 3/28/2019, 3:41:11 PM<br><strong>Message</strong>: <pre>Patch Set 23:

> Let's put a hold on this migration work for the moment.  Priority needs to be v1.4.1 and flakes, and I'm still concerned with the overall approach.  I know I'm late to the game here, but I think it's important that we pause to make sure we're applying our efforts in the right direction.


I think we're too far ahead (and almost done) so it's not cost-effective to take a step back and re-assess. There is only going forward at this point (at least that's how i see it).</pre><strong>Reviewer</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Reviewed</strong>: 3/31/2019, 3:29:07 AM<br><strong>Message</strong>: <pre>Patch Set 23:

> (1 comment)
 > 
 > Let's put a hold on this migration work for the moment.  Priority
 > needs to be v1.4.1 and flakes, and I'm still concerned with the
 > overall approach.  I know I'm late to the game here, but I think
 > it's important that we pause to make sure we're applying our
 > efforts in the right direction.

I think that the design and implementation are sound and reusable. It would be possible to support migration from a "source" consensus protocol to a "target" protocol. All it would require is some minor integration of the migration calls. 

Note that the bulk of migration (i.e. the "green" path) is already in, and working fine. What you see here is treatment of some corner failure cases. 

I share Yacov's assessment that we are very close to finish.

Let's spend some time going over the design and hopefully I can convince you that we are on the right track.</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 3/31/2019, 6:36:26 AM<br><strong>Message</strong>: <pre>Removed Code-Review+2 by Artem Barger <bartem@il.ibm.com>
</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 3/31/2019, 6:42:17 AM<br><strong>Message</strong>: <pre>Patch Set 23:

> Priority needs to be v1.4.1 and flakes, 

Though I agree these should be priorities, while I see migration is orthogonal to this effort and very close to be done, so not sure why to pause it now.

> and I'm still concerned with the overall approach. I know I'm late to the game here, but I think it's important that we pause to make sure we're applying our efforts in the right direction.

This is another story, if you think there is another/better approach or something that could be improved, this could be done here or addressed later. @Jason do you have specific suggestions or alternative to suggest design?</pre><strong>Reviewer</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Reviewed</strong>: 4/2/2019, 9:44:33 AM<br><strong>Message</strong>: <pre>Abandoned

Design change</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Uploader</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Created</strong>: 2/28/2019, 9:48:38 AM<br><strong>UnmergedRevision</strong>: [b9b5f878fccaeb29595cfb87ca7d5aefe22f1735](https://github.com/hyperledger-gerrit-archive/fabric/commit/b9b5f878fccaeb29595cfb87ca7d5aefe22f1735)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 2/28/2019, 9:55:28 AM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Uploader</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Created</strong>: 2/28/2019, 10:34:45 AM<br><strong>UnmergedRevision</strong>: [2f06621e6995508e98e06fe594a6bef6548a43ac](https://github.com/hyperledger-gerrit-archive/fabric/commit/2f06621e6995508e98e06fe594a6bef6548a43ac)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 2/28/2019, 10:41:47 AM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 3</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Uploader</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Created</strong>: 2/28/2019, 11:01:41 AM<br><strong>UnmergedRevision</strong>: [d9d88698575f36866f39adae7212d882e34cdac6](https://github.com/hyperledger-gerrit-archive/fabric/commit/d9d88698575f36866f39adae7212d882e34cdac6)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 2/28/2019, 11:10:34 AM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 4</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Uploader</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Created</strong>: 2/28/2019, 11:41:52 AM<br><strong>UnmergedRevision</strong>: [f58965f6c450524d8407af4a032d52d06a86acda](https://github.com/hyperledger-gerrit-archive/fabric/commit/f58965f6c450524d8407af4a032d52d06a86acda)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 2/28/2019, 11:54:56 AM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 2/28/2019, 11:54:56 AM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 2/28/2019, 12:43:03 PM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 2/28/2019, 12:26:01 PM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 5</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Uploader</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Created</strong>: 3/3/2019, 6:51:17 AM<br><strong>UnmergedRevision</strong>: [ee3ef55c590e01c4904bfacb27042333ae10616e](https://github.com/hyperledger-gerrit-archive/fabric/commit/ee3ef55c590e01c4904bfacb27042333ae10616e)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/3/2019, 7:29:59 AM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/3/2019, 7:29:59 AM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/3/2019, 8:20:52 AM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/3/2019, 8:01:53 AM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 6</h3><blockquote><strong>Type</strong>: TRIVIAL_REBASE<br><strong>Author</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Uploader</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Created</strong>: 3/5/2019, 5:59:21 AM<br><strong>UnmergedRevision</strong>: [faca59f429a47ca8942369558ee97d26f1bd1716](https://github.com/hyperledger-gerrit-archive/fabric/commit/faca59f429a47ca8942369558ee97d26f1bd1716)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/3/2019, 7:29:59 AM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/3/2019, 7:29:59 AM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/3/2019, 8:20:52 AM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/3/2019, 8:01:53 AM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 7</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Uploader</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Created</strong>: 3/6/2019, 8:57:03 AM<br><strong>UnmergedRevision</strong>: [077154eb49ada12330b1b07cc886dceda8528b21](https://github.com/hyperledger-gerrit-archive/fabric/commit/077154eb49ada12330b1b07cc886dceda8528b21)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/6/2019, 9:07:13 AM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/6/2019, 9:07:13 AM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/6/2019, 11:02:40 AM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/6/2019, 9:40:29 AM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [orderer/common/multichannel/chainsupport.go#L153](https://github.com/hyperledger-gerrit-archive/fabric/blob/077154eb49ada12330b1b07cc886dceda8528b21/orderer/common/multichannel/chainsupport.go#L153)<br><strong>Comment</strong>: <pre>do you really need this if? I mean it seems that regardless of whenever it's system channel or not, all what matter is 

    if state == orderer.ConsensusType_MIG_STATE_CONTEXT {
	isMigrationCommit = true
    }

am I missing something?</pre><strong>Commenter</strong>: Yoav Tock - tock@il.ibm.com<br><strong>CommentLine</strong>: [orderer/common/multichannel/chainsupport.go#L153](https://github.com/hyperledger-gerrit-archive/fabric/blob/077154eb49ada12330b1b07cc886dceda8528b21/orderer/common/multichannel/chainsupport.go#L153)<br><strong>Comment</strong>: <pre>If it is the system channel, we're expecting a COMMIT, if it is a standard channel we expect a CONTEXT; 

CONTEXT != COMMIT</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [orderer/common/multichannel/registrar.go#L235](https://github.com/hyperledger-gerrit-archive/fabric/blob/077154eb49ada12330b1b07cc886dceda8528b21/orderer/common/multichannel/registrar.go#L235)<br><strong>Comment</strong>: <pre>I think it's worth a Debug log message.</pre><strong>Commenter</strong>: Yoav Tock - tock@il.ibm.com<br><strong>CommentLine</strong>: [orderer/common/multichannel/registrar.go#L235](https://github.com/hyperledger-gerrit-archive/fabric/blob/077154eb49ada12330b1b07cc886dceda8528b21/orderer/common/multichannel/registrar.go#L235)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [orderer/common/multichannel/registrar.go#L260](https://github.com/hyperledger-gerrit-archive/fabric/blob/077154eb49ada12330b1b07cc886dceda8528b21/orderer/common/multichannel/registrar.go#L260)<br><strong>Comment</strong>: <pre>IMO it's worth adding log message in debug here.</pre><strong>Commenter</strong>: Yoav Tock - tock@il.ibm.com<br><strong>CommentLine</strong>: [orderer/common/multichannel/registrar.go#L260](https://github.com/hyperledger-gerrit-archive/fabric/blob/077154eb49ada12330b1b07cc886dceda8528b21/orderer/common/multichannel/registrar.go#L260)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [orderer/common/multichannel/registrar.go#L301](https://github.com/hyperledger-gerrit-archive/fabric/blob/077154eb49ada12330b1b07cc886dceda8528b21/orderer/common/multichannel/registrar.go#L301)<br><strong>Comment</strong>: <pre>you can merged both this cases, no?</pre><strong>Commenter</strong>: Yoav Tock - tock@il.ibm.com<br><strong>CommentLine</strong>: [orderer/common/multichannel/registrar.go#L301](https://github.com/hyperledger-gerrit-archive/fabric/blob/077154eb49ada12330b1b07cc886dceda8528b21/orderer/common/multichannel/registrar.go#L301)<br><strong>Comment</strong>: <pre>Yes, Done.</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [orderer/common/multichannel/registrar.go#L317](https://github.com/hyperledger-gerrit-archive/fabric/blob/077154eb49ada12330b1b07cc886dceda8528b21/orderer/common/multichannel/registrar.go#L317)<br><strong>Comment</strong>: <pre>why application channel cannot be in MIG_STATE_CONTEXT?</pre><strong>Commenter</strong>: Yoav Tock - tock@il.ibm.com<br><strong>CommentLine</strong>: [orderer/common/multichannel/registrar.go#L317](https://github.com/hyperledger-gerrit-archive/fabric/blob/077154eb49ada12330b1b07cc886dceda8528b21/orderer/common/multichannel/registrar.go#L317)<br><strong>Comment</strong>: <pre>because a CONTEXT can only be encountered when the system channel is in START.</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/migration/migration.go#L87](https://github.com/hyperledger-gerrit-archive/fabric/blob/077154eb49ada12330b1b07cc886dceda8528b21/orderer/consensus/migration/migration.go#L87)<br><strong>Comment</strong>: <pre>It seems that Filter doesn't really reflects the essence of this method, probably change it to UpdateAllowed or CheckValid.</pre><strong>Commenter</strong>: Yoav Tock - tock@il.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/migration/migration.go#L87](https://github.com/hyperledger-gerrit-archive/fabric/blob/077154eb49ada12330b1b07cc886dceda8528b21/orderer/consensus/migration/migration.go#L87)<br><strong>Comment</strong>: <pre>I changed to CheckAllowed</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/migration/migration.go#L365](https://github.com/hyperledger-gerrit-archive/fabric/blob/077154eb49ada12330b1b07cc886dceda8528b21/orderer/consensus/migration/migration.go#L365)<br><strong>Comment</strong>: <pre>this might be a nit, but I see pattern repeats itself here, probably abstract this logic out and reuse it? I see you are doing it several times here in this function.</pre><strong>Commenter</strong>: Yoav Tock - tock@il.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/migration/migration.go#L365](https://github.com/hyperledger-gerrit-archive/fabric/blob/077154eb49ada12330b1b07cc886dceda8528b21/orderer/consensus/migration/migration.go#L365)<br><strong>Comment</strong>: <pre>Good idea, done.</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/migration/migration.go#L404](https://github.com/hyperledger-gerrit-archive/fabric/blob/077154eb49ada12330b1b07cc886dceda8528b21/orderer/consensus/migration/migration.go#L404)<br><strong>Comment</strong>: <pre>can you probably extract each case section into separate function to make it easier to follow, since currently this function over 100 LOC and most of it code is repeated.</pre><strong>Commenter</strong>: Yoav Tock - tock@il.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/migration/migration.go#L404](https://github.com/hyperledger-gerrit-archive/fabric/blob/077154eb49ada12330b1b07cc886dceda8528b21/orderer/consensus/migration/migration.go#L404)<br><strong>Comment</strong>: <pre>Done</pre></blockquote><h3>PatchSet Number: 8</h3><blockquote><strong>Type</strong>: TRIVIAL_REBASE<br><strong>Author</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Uploader</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Created</strong>: 3/7/2019, 6:18:38 AM<br><strong>UnmergedRevision</strong>: [12e6334486117905b1e034b86bd0b6a41f073a3d](https://github.com/hyperledger-gerrit-archive/fabric/commit/12e6334486117905b1e034b86bd0b6a41f073a3d)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/6/2019, 9:07:13 AM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/6/2019, 9:07:13 AM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/6/2019, 11:02:40 AM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/6/2019, 9:40:29 AM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 9</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Uploader</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Created</strong>: 3/8/2019, 9:28:27 AM<br><strong>UnmergedRevision</strong>: [390a86dc734e239df4677649f24f36637950486f](https://github.com/hyperledger-gerrit-archive/fabric/commit/390a86dc734e239df4677649f24f36637950486f)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/8/2019, 9:40:48 AM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/8/2019, 9:40:48 AM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/8/2019, 10:30:13 AM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/8/2019, 10:11:27 AM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 10</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Uploader</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Created</strong>: 3/8/2019, 2:54:31 PM<br><strong>UnmergedRevision</strong>: [fff68958e0491668c6dd8c956d956781c7b9e29e](https://github.com/hyperledger-gerrit-archive/fabric/commit/fff68958e0491668c6dd8c956d956781c7b9e29e)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/8/2019, 3:05:43 PM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/8/2019, 3:05:43 PM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/8/2019, 3:48:01 PM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/8/2019, 3:37:02 PM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 11</h3><blockquote><strong>Type</strong>: TRIVIAL_REBASE<br><strong>Author</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Uploader</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Created</strong>: 3/8/2019, 3:24:10 PM<br><strong>UnmergedRevision</strong>: [0ae5aa0d5fb8de199c9fb4f99266478d06246321](https://github.com/hyperledger-gerrit-archive/fabric/commit/0ae5aa0d5fb8de199c9fb4f99266478d06246321)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/8/2019, 3:05:43 PM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/8/2019, 3:05:43 PM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/8/2019, 5:35:20 PM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/8/2019, 5:15:10 PM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Approved</strong>: 3/10/2019, 5:46:52 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 12</h3><blockquote><strong>Type</strong>: TRIVIAL_REBASE<br><strong>Author</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Uploader</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Created</strong>: 3/10/2019, 7:23:52 AM<br><strong>UnmergedRevision</strong>: [217678c90da3cb2b190879926b5f05ddfd0f825f](https://github.com/hyperledger-gerrit-archive/fabric/commit/217678c90da3cb2b190879926b5f05ddfd0f825f)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/8/2019, 3:05:43 PM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/8/2019, 3:05:43 PM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/8/2019, 5:35:20 PM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/8/2019, 5:15:10 PM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Approved</strong>: 3/10/2019, 5:46:52 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 13</h3><blockquote><strong>Type</strong>: TRIVIAL_REBASE<br><strong>Author</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Uploader</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Created</strong>: 3/11/2019, 4:58:08 AM<br><strong>UnmergedRevision</strong>: [dd1a71f5930046da4a68e0d270cd7bf79d676309](https://github.com/hyperledger-gerrit-archive/fabric/commit/dd1a71f5930046da4a68e0d270cd7bf79d676309)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/8/2019, 3:05:43 PM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/8/2019, 3:05:43 PM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/8/2019, 5:35:20 PM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/8/2019, 5:15:10 PM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Approved</strong>: 3/10/2019, 5:46:52 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [orderer/common/multichannel/chainsupport.go#L76](https://github.com/hyperledger-gerrit-archive/fabric/blob/dd1a71f5930046da4a68e0d270cd7bf79d676309/orderer/common/multichannel/chainsupport.go#L76)<br><strong>Comment</strong>: <pre>always</pre><strong>Commenter</strong>: Yoav Tock - tock@il.ibm.com<br><strong>CommentLine</strong>: [orderer/common/multichannel/chainsupport.go#L76](https://github.com/hyperledger-gerrit-archive/fabric/blob/dd1a71f5930046da4a68e0d270cd7bf79d676309/orderer/common/multichannel/chainsupport.go#L76)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [orderer/common/multichannel/registrar.go#L400](https://github.com/hyperledger-gerrit-archive/fabric/blob/dd1a71f5930046da4a68e0d270cd7bf79d676309/orderer/common/multichannel/registrar.go#L400)<br><strong>Comment</strong>: <pre>so we have an exported method with the same lowercase equivalence with an unexported method? 

Perhaps change the name of the unexported to something else, like - "canMigrationStart()" so it won't be confusing?</pre><strong>Commenter</strong>: Yoav Tock - tock@il.ibm.com<br><strong>CommentLine</strong>: [orderer/common/multichannel/registrar.go#L400](https://github.com/hyperledger-gerrit-archive/fabric/blob/dd1a71f5930046da4a68e0d270cd7bf79d676309/orderer/common/multichannel/registrar.go#L400)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/consensus.go#L93](https://github.com/hyperledger-gerrit-archive/fabric/blob/dd1a71f5930046da4a68e0d270cd7bf79d676309/orderer/consensus/consensus.go#L93)<br><strong>Comment</strong>: <pre>you just need the capabilities, no? why do you drag all the channel config with it?</pre><strong>Commenter</strong>: Yoav Tock - tock@il.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/consensus.go#L93](https://github.com/hyperledger-gerrit-archive/fabric/blob/dd1a71f5930046da4a68e0d270cd7bf79d676309/orderer/consensus/consensus.go#L93)<br><strong>Comment</strong>: <pre>Symmetry with SharedConfig(), which gives you channelconfig.Orderer... this one will give you channelconfig.Channel. I think it is a good idea to expose the config rather than just the capabilities in this API.</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/kafka/chain.go#L269](https://github.com/hyperledger-gerrit-archive/fabric/blob/dd1a71f5930046da4a68e0d270cd7bf79d676309/orderer/consensus/kafka/chain.go#L269)<br><strong>Comment</strong>: <pre>where is this tested?</pre><strong>Commenter</strong>: Yoav Tock - tock@il.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/kafka/chain.go#L269](https://github.com/hyperledger-gerrit-archive/fabric/blob/dd1a71f5930046da4a68e0d270cd7bf79d676309/orderer/consensus/kafka/chain.go#L269)<br><strong>Comment</strong>: <pre>Will be unit-tested when I get to this Jira: FAB-13246, currently it is covered by the integration test (integration/e2e/migration_test.go).</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/kafka/chain.go#L283](https://github.com/hyperledger-gerrit-archive/fabric/blob/dd1a71f5930046da4a68e0d270cd7bf79d676309/orderer/consensus/kafka/chain.go#L283)<br><strong>Comment</strong>: <pre>if ! isOrdConf {

return nil

}</pre><strong>Commenter</strong>: Yoav Tock - tock@il.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/kafka/chain.go#L283](https://github.com/hyperledger-gerrit-archive/fabric/blob/dd1a71f5930046da4a68e0d270cd7bf79d676309/orderer/consensus/kafka/chain.go#L283)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/kafka/chain.go#L307](https://github.com/hyperledger-gerrit-archive/fabric/blob/dd1a71f5930046da4a68e0d270cd7bf79d676309/orderer/consensus/kafka/chain.go#L307)<br><strong>Comment</strong>: <pre>why do you need to copy here? you don't do anything with the byte slice. you just validate it.</pre><strong>Commenter</strong>: Yoav Tock - tock@il.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/kafka/chain.go#L307](https://github.com/hyperledger-gerrit-archive/fabric/blob/dd1a71f5930046da4a68e0d270cd7bf79d676309/orderer/consensus/kafka/chain.go#L307)<br><strong>Comment</strong>: <pre>That is correct. I was being extra cautious I guess. I'll change it.</pre></blockquote><h3>PatchSet Number: 14</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Uploader</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Created</strong>: 3/12/2019, 4:54:31 AM<br><strong>UnmergedRevision</strong>: [f295db601c1dbdb500781f1dcf0e7487e5672c0d](https://github.com/hyperledger-gerrit-archive/fabric/commit/f295db601c1dbdb500781f1dcf0e7487e5672c0d)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/12/2019, 5:05:51 AM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/12/2019, 5:05:51 AM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/12/2019, 5:53:14 AM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/12/2019, 5:33:43 AM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Approved</strong>: 3/14/2019, 2:24:46 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Approved</strong>: 3/12/2019, 7:34:42 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [orderer/common/multichannel/chainsupport.go#L77](https://github.com/hyperledger-gerrit-archive/fabric/blob/f295db601c1dbdb500781f1dcf0e7487e5672c0d/orderer/common/multichannel/chainsupport.go#L77)<br><strong>Comment</strong>: <pre>Under what condition is the system channel ID == 0? If the system channel is always created first, then why is this check necessary?</pre><strong>Commenter</strong>: Yoav Tock - tock@il.ibm.com<br><strong>CommentLine</strong>: [orderer/common/multichannel/chainsupport.go#L77](https://github.com/hyperledger-gerrit-archive/fabric/blob/f295db601c1dbdb500781f1dcf0e7487e5672c0d/orderer/common/multichannel/chainsupport.go#L77)<br><strong>Comment</strong>: <pre>newChainSupport() is called by the Registrar (L167) before the ID of the system channel is set (L191),
  r.systemChannelID = chainID

Thus, the first time we get here, registrar.systemChannelID is still empty, and this is a sign that it is the system channel. When we get here next, it is full (because system channel is created first), and that it is a sign that it is a standard channel. I agree that the comment does not tell this story, I'll improve.</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [orderer/common/multichannel/chainsupport.go#L156](https://github.com/hyperledger-gerrit-archive/fabric/blob/f295db601c1dbdb500781f1dcf0e7487e5672c0d/orderer/common/multichannel/chainsupport.go#L156)<br><strong>Comment</strong>: <pre>Potentially a bit of a style nit, but with many of these methods, we're following a principle of "return once" when I think it would be much clearer to "return early, return often".  This bit of the function could be rewritten as:

 if lastConfigIndex != lastBlock.Header.Number {
     return false
 }

 if isSystem {
     return state == orderer.ConsensusType_MIG_STATE_COMMIT
 }

 return state == orderer.ConsensusType_MIG_STATE_CONTEXT

Personally, I find this sort of structure to be much more clear.</pre><strong>Commenter</strong>: Yoav Tock - tock@il.ibm.com<br><strong>CommentLine</strong>: [orderer/common/multichannel/chainsupport.go#L156](https://github.com/hyperledger-gerrit-archive/fabric/blob/f295db601c1dbdb500781f1dcf0e7487e5672c0d/orderer/common/multichannel/chainsupport.go#L156)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [orderer/common/multichannel/registrar.go#L276](https://github.com/hyperledger-gerrit-archive/fabric/blob/f295db601c1dbdb500781f1dcf0e7487e5672c0d/orderer/common/multichannel/registrar.go#L276)<br><strong>Comment</strong>: <pre>Another case where restructuring the code would make the logic much clearer.

Here we have:

 if "kafka" {
    // do not return, usually
 } else if "raft" {
    // always return
 } else {
   // always return
 }

This would be much more cleanly structured to me as:

 if "raft" {
     // always return
 }

 if ! "kafka" {
     // always return
 }

 // do the real logic</pre><strong>Commenter</strong>: Yoav Tock - tock@il.ibm.com<br><strong>CommentLine</strong>: [orderer/common/multichannel/registrar.go#L276](https://github.com/hyperledger-gerrit-archive/fabric/blob/f295db601c1dbdb500781f1dcf0e7487e5672c0d/orderer/common/multichannel/registrar.go#L276)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [orderer/common/multichannel/registrar.go#L281](https://github.com/hyperledger-gerrit-archive/fabric/blob/f295db601c1dbdb500781f1dcf0e7487e5672c0d/orderer/common/multichannel/registrar.go#L281)<br><strong>Comment</strong>: <pre>This style logging is hard to service, and hard to read. In general I'd suggest we use literal format strings in our log and error messages.  If we have to repeat the same log or error message in multiple places, this seems like a sign that the code could be cleaned/refactored to reduce the duplication.</pre><strong>Commenter</strong>: Yoav Tock - tock@il.ibm.com<br><strong>CommentLine</strong>: [orderer/common/multichannel/registrar.go#L281](https://github.com/hyperledger-gerrit-archive/fabric/blob/f295db601c1dbdb500781f1dcf0e7487e5672c0d/orderer/common/multichannel/registrar.go#L281)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [orderer/common/multichannel/registrar.go#L288](https://github.com/hyperledger-gerrit-archive/fabric/blob/f295db601c1dbdb500781f1dcf0e7487e5672c0d/orderer/common/multichannel/registrar.go#L288)<br><strong>Comment</strong>: <pre>This structure doesn't sit well with me.  We have a variable which is fixed outside of the for loop, but that we then switch on inside of the for loop.  Maybe this is the cleanest way to do it, but something more like

 switch stdState {
 case START:
     resumeChainMigrationAsStarted(chains)
 case ABORT:
     resumeChainMigrationAsAborted(chains)
 ...

Maybe that is less clear... what do you think?</pre><strong>Commenter</strong>: Yoav Tock - tock@il.ibm.com<br><strong>CommentLine</strong>: [orderer/common/multichannel/registrar.go#L288](https://github.com/hyperledger-gerrit-archive/fabric/blob/f295db601c1dbdb500781f1dcf0e7487e5672c0d/orderer/common/multichannel/registrar.go#L288)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/kafka/chain.go#L7](https://github.com/hyperledger-gerrit-archive/fabric/blob/f295db601c1dbdb500781f1dcf0e7487e5672c0d/orderer/consensus/kafka/chain.go#L7)<br><strong>Comment</strong>: <pre>This file has a lot of changed lines, but not a lot of new tests, it looks like these lines are not covered by unit tests?</pre><strong>Commenter</strong>: Yoav Tock - tock@il.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/kafka/chain.go#L7](https://github.com/hyperledger-gerrit-archive/fabric/blob/f295db601c1dbdb500781f1dcf0e7487e5672c0d/orderer/consensus/kafka/chain.go#L7)<br><strong>Comment</strong>: <pre>I have Jira item FAB-13246 for extending the tests in this component. 

Currently it is (pretty well) tested in integration tests (see integration/e2e/migration_test.go). It is pretty hard to generate the right conditions for correctly unit testing migration at this level, because it is by nature a multi-chain protocol. So I started with extensive e2e tests. 

I'll get to that pretty soon.</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/kafka/chain.go#L277](https://github.com/hyperledger-gerrit-archive/fabric/blob/f295db601c1dbdb500781f1dcf0e7487e5672c0d/orderer/consensus/kafka/chain.go#L277)<br><strong>Comment</strong>: <pre>What is the point of logging this at info? If we return this as an error, surely, this should be logged by the caller? (Confirmed that in fact, it is ultimately logged at Warning in the caller in broadcast)</pre><strong>Commenter</strong>: Yoav Tock - tock@il.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/kafka/chain.go#L277](https://github.com/hyperledger-gerrit-archive/fabric/blob/f295db601c1dbdb500781f1dcf0e7487e5672c0d/orderer/consensus/kafka/chain.go#L277)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/kafka/chain.go#L280](https://github.com/hyperledger-gerrit-archive/fabric/blob/f295db601c1dbdb500781f1dcf0e7487e5672c0d/orderer/consensus/kafka/chain.go#L280)<br><strong>Comment</strong>: <pre>Another one where returning nil first, would decrease the level of indentation and increase clarity.</pre><strong>Commenter</strong>: Yoav Tock - tock@il.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/kafka/chain.go#L280](https://github.com/hyperledger-gerrit-archive/fabric/blob/f295db601c1dbdb500781f1dcf0e7487e5672c0d/orderer/consensus/kafka/chain.go#L280)<br><strong>Comment</strong>: <pre>Not really, because I still have to test the negative condition...</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/kafka/chain.go#L280](https://github.com/hyperledger-gerrit-archive/fabric/blob/f295db601c1dbdb500781f1dcf0e7487e5672c0d/orderer/consensus/kafka/chain.go#L280)<br><strong>Comment</strong>: <pre>You're quite right, inverting this doesn't help us, however, given:

 if cond1 {
   if cond2 {
     return error
   } else {
     return nil
   }
 }

I actually thought the linter complained about this and asked you to turn it into

 if cond1 {
   if cond2 {
     return error
   }
   return nil
 }

It cleans up one level of indendation, and makes it immedietly obvious that if cond1 is true, it is impossible to continue beyond this function.</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/kafka/chain.go#L297](https://github.com/hyperledger-gerrit-archive/fabric/blob/f295db601c1dbdb500781f1dcf0e7487e5672c0d/orderer/consensus/kafka/chain.go#L297)<br><strong>Comment</strong>: <pre>If migration is not enabled, and there is no change of consensus type, and the migration type is not set, why would we go on to check if the migration is allowed below, shouldn't we return here?</pre><strong>Commenter</strong>: Yoav Tock - tock@il.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/kafka/chain.go#L297](https://github.com/hyperledger-gerrit-archive/fabric/blob/f295db601c1dbdb500781f1dcf0e7487e5672c0d/orderer/consensus/kafka/chain.go#L297)<br><strong>Comment</strong>: <pre>Good catch. 

Lucky for me, the Validate and CheckAllowed bellow behave correctly even when migration is not enabled... but indeed it is a waste of cycles.</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/migration/migration.go#L157](https://github.com/hyperledger-gerrit-archive/fabric/blob/f295db601c1dbdb500781f1dcf0e7487e5672c0d/orderer/consensus/migration/migration.go#L157)<br><strong>Comment</strong>: <pre>Why the change to "NewManager", I'd agree I don't love "StatusStepper", but it's certainly more descriptive than "Manager" (something we've been trying to get away from in the code).</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/migration/migration.go#L354](https://github.com/hyperledger-gerrit-archive/fabric/blob/f295db601c1dbdb500781f1dcf0e7487e5672c0d/orderer/consensus/migration/migration.go#L354)<br><strong>Comment</strong>: <pre>Is it possible to do all of this 'illegal enum' sanitization centrally? It seems like in every switch statement we have very similar logic and it seems like a lot of unnecessary repetition.</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/migration/migration.go#L871](https://github.com/hyperledger-gerrit-archive/fabric/blob/f295db601c1dbdb500781f1dcf0e7487e5672c0d/orderer/consensus/migration/migration.go#L871)<br><strong>Comment</strong>: <pre>these do not seem to be covered by unit tests... are you intending to add tests for them?</pre><strong>Commenter</strong>: Yoav Tock - tock@il.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/migration/migration.go#L871](https://github.com/hyperledger-gerrit-archive/fabric/blob/f295db601c1dbdb500781f1dcf0e7487e5672c0d/orderer/consensus/migration/migration.go#L871)<br><strong>Comment</strong>: <pre>The unit test will be extended to include Validate() when I get to this Jira: FAB-13246. Currently it is tested by integration test (integration/e2e/migration_test.go).</pre></blockquote><h3>PatchSet Number: 15</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Uploader</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Created</strong>: 3/14/2019, 4:41:27 PM<br><strong>UnmergedRevision</strong>: [abac8079e19a3c7089da35bcd2e9fc98012fc0b8](https://github.com/hyperledger-gerrit-archive/fabric/commit/abac8079e19a3c7089da35bcd2e9fc98012fc0b8)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/14/2019, 4:52:30 PM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/14/2019, 4:52:30 PM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/14/2019, 5:42:06 PM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/14/2019, 5:20:25 PM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/migration/migration.go#L1](https://github.com/hyperledger-gerrit-archive/fabric/blob/abac8079e19a3c7089da35bcd2e9fc98012fc0b8/orderer/consensus/migration/migration.go#L1)<br><strong>Comment</strong>: <pre>Based on the way this is constructed, it looks to me like the changes in this file could be broken out into their own CR?  Overall, this change set is enormous, and one that I'm having trouble grasping mentally as to whether code paths are adequately tested.  If not splitting out this migration package work, what about finding another way to decompose this?  If we can't decompose things, it would seem to indicate we've gotten some of our abstractions wrong.</pre><strong>Commenter</strong>: Yoav Tock - tock@il.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/migration/migration.go#L1](https://github.com/hyperledger-gerrit-archive/fabric/blob/abac8079e19a3c7089da35bcd2e9fc98012fc0b8/orderer/consensus/migration/migration.go#L1)<br><strong>Comment</strong>: <pre>I split this CR in three. This is the last. The two other that this one is stacked on are:

FAB-14699 Green path struct/var rename & skeleton functions: 
https://gerrit.hyperledger.org/r/#/c/30213/

and 

FAB-14700  Kafka2Raft validate broadcast:
https://gerrit.hyperledger.org/r/#/c/30216/

I hope this will make the review easier.</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/migration/migration.go#L72](https://github.com/hyperledger-gerrit-archive/fabric/blob/abac8079e19a3c7089da35bcd2e9fc98012fc0b8/orderer/consensus/migration/migration.go#L72)<br><strong>Comment</strong>: <pre>Why rename this from StatusStepper.  It's not my most favorite name in the world, but seems at least more descriptive than 'Manager'.  (This was something Yacov actually used to get on me about, and I think my code is better for trying to avoid it).</pre><strong>Commenter</strong>: Yoav Tock - tock@il.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/migration/migration.go#L72](https://github.com/hyperledger-gerrit-archive/fabric/blob/abac8079e19a3c7089da35bcd2e9fc98012fc0b8/orderer/consensus/migration/migration.go#L72)<br><strong>Comment</strong>: <pre>We can certainly think of a better name. However, because there are 6 CRs stacked on top of this, let's implement this change after the dust settles, in FAB-13719.</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/migration/migration.go#L315](https://github.com/hyperledger-gerrit-archive/fabric/blob/abac8079e19a3c7089da35bcd2e9fc98012fc0b8/orderer/consensus/migration/migration.go#L315)<br><strong>Comment</strong>: <pre>Sorry to keep harping on this, but...

 if sm.SystemChannel {
     return sm.stepSystem(next, lastCutBlockNumber, migrationController)
 }

 return sm.stepStandard(next, migrationController), false

This is much shorter, and much clearer.</pre><strong>Commenter</strong>: Yoav Tock - tock@il.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/migration/migration.go#L315](https://github.com/hyperledger-gerrit-archive/fabric/blob/abac8079e19a3c7089da35bcd2e9fc98012fc0b8/orderer/consensus/migration/migration.go#L315)<br><strong>Comment</strong>: <pre>I will change this. However, because there are 6 CRs stacked on top of this, let's implement this change after the dust settles, in FAB-13719.</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/migration/migration.go#L356](https://github.com/hyperledger-gerrit-archive/fabric/blob/abac8079e19a3c7089da35bcd2e9fc98012fc0b8/orderer/consensus/migration/migration.go#L356)<br><strong>Comment</strong>: <pre>Same here, if you can return, just return inline.  Then you can delete the 'default' part of the switch statement put the panic outside of the switch.</pre><strong>Commenter</strong>: Yoav Tock - tock@il.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/migration/migration.go#L356](https://github.com/hyperledger-gerrit-archive/fabric/blob/abac8079e19a3c7089da35bcd2e9fc98012fc0b8/orderer/consensus/migration/migration.go#L356)<br><strong>Comment</strong>: <pre>I will change this. However, because there are 6 CRs stacked on top of this, let's implement this change after the dust settles, in FAB-13719.</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/migration/migration.go#L418](https://github.com/hyperledger-gerrit-archive/fabric/blob/abac8079e19a3c7089da35bcd2e9fc98012fc0b8/orderer/consensus/migration/migration.go#L418)<br><strong>Comment</strong>: <pre>Another one, please return in the switch where possible.</pre><strong>Commenter</strong>: Yoav Tock - tock@il.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/migration/migration.go#L418](https://github.com/hyperledger-gerrit-archive/fabric/blob/abac8079e19a3c7089da35bcd2e9fc98012fc0b8/orderer/consensus/migration/migration.go#L418)<br><strong>Comment</strong>: <pre>I will change this. However, because there are 6 CRs stacked on top of this, let's implement this change after the dust settles, in FAB-13719.</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/migration/migration.go#L451](https://github.com/hyperledger-gerrit-archive/fabric/blob/abac8079e19a3c7089da35bcd2e9fc98012fc0b8/orderer/consensus/migration/migration.go#L451)<br><strong>Comment</strong>: <pre>And another :)</pre><strong>Commenter</strong>: Yoav Tock - tock@il.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/migration/migration.go#L451](https://github.com/hyperledger-gerrit-archive/fabric/blob/abac8079e19a3c7089da35bcd2e9fc98012fc0b8/orderer/consensus/migration/migration.go#L451)<br><strong>Comment</strong>: <pre>I will change this. However, because there are 6 CRs stacked on top of this, let's implement this change after the dust settles, in FAB-13719.</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/migration/migration.go#L576](https://github.com/hyperledger-gerrit-archive/fabric/blob/abac8079e19a3c7089da35bcd2e9fc98012fc0b8/orderer/consensus/migration/migration.go#L576)<br><strong>Comment</strong>: <pre>Another</pre><strong>Commenter</strong>: Yoav Tock - tock@il.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/migration/migration.go#L576](https://github.com/hyperledger-gerrit-archive/fabric/blob/abac8079e19a3c7089da35bcd2e9fc98012fc0b8/orderer/consensus/migration/migration.go#L576)<br><strong>Comment</strong>: <pre>I will change this. However, because there are 6 CRs stacked on top of this, let's implement this change after the dust settles, in FAB-13719.</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/migration/migration.go#L795](https://github.com/hyperledger-gerrit-archive/fabric/blob/abac8079e19a3c7089da35bcd2e9fc98012fc0b8/orderer/consensus/migration/migration.go#L795)<br><strong>Comment</strong>: <pre>Funnily enough, the entire tail end of this file seems to prefer exiting earlier and lower levels of nesting (which is a good thing in my book!)</pre><strong>Commenter</strong>: Yoav Tock - tock@il.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/migration/migration.go#L795](https://github.com/hyperledger-gerrit-archive/fabric/blob/abac8079e19a3c7089da35bcd2e9fc98012fc0b8/orderer/consensus/migration/migration.go#L795)<br><strong>Comment</strong>: <pre>I separated the validate (system & standard) into its own file: validation.go, and added unit tests for it as well: validation_test.go. Coverage is ~95%.</pre></blockquote><h3>PatchSet Number: 16</h3><blockquote><strong>Type</strong>: TRIVIAL_REBASE<br><strong>Author</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Uploader</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Created</strong>: 3/17/2019, 1:27:44 PM<br><strong>UnmergedRevision</strong>: [fe81c159d13ca8ff7ec1509db49fae4642814e55](https://github.com/hyperledger-gerrit-archive/fabric/commit/fe81c159d13ca8ff7ec1509db49fae4642814e55)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/14/2019, 4:52:30 PM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/14/2019, 4:52:30 PM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/14/2019, 5:42:06 PM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/14/2019, 5:20:25 PM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Approved</strong>: 3/19/2019, 3:55:27 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 17</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Uploader</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Created</strong>: 3/19/2019, 7:28:01 AM<br><strong>UnmergedRevision</strong>: [c21909a279e13e2d874c9718f39c934439efeb75](https://github.com/hyperledger-gerrit-archive/fabric/commit/c21909a279e13e2d874c9718f39c934439efeb75)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/19/2019, 7:39:04 AM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/19/2019, 7:39:04 AM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/19/2019, 8:25:17 AM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/19/2019, 8:07:50 AM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 18</h3><blockquote><strong>Type</strong>: TRIVIAL_REBASE<br><strong>Author</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Uploader</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Created</strong>: 3/19/2019, 8:34:47 AM<br><strong>UnmergedRevision</strong>: [1a3ef09b1adc77b3a2e48f9df071cabb483d699d](https://github.com/hyperledger-gerrit-archive/fabric/commit/1a3ef09b1adc77b3a2e48f9df071cabb483d699d)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/19/2019, 7:39:04 AM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/19/2019, 7:39:04 AM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/19/2019, 8:25:17 AM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/19/2019, 8:07:50 AM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/kafka/chain.go#L232](https://github.com/hyperledger-gerrit-archive/fabric/blob/1a3ef09b1adc77b3a2e48f9df071cabb483d699d/orderer/consensus/kafka/chain.go#L232)<br><strong>Comment</strong>: <pre>why did you remove chainID from error message?</pre><strong>Commenter</strong>: Yoav Tock - tock@il.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/kafka/chain.go#L232](https://github.com/hyperledger-gerrit-archive/fabric/blob/1a3ef09b1adc77b3a2e48f9df071cabb483d699d/orderer/consensus/kafka/chain.go#L232)<br><strong>Comment</strong>: <pre>Because ChainID is added by the caller, in broadcast.go L176</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/kafka/chain.go#L16](https://github.com/hyperledger-gerrit-archive/fabric/blob/1a3ef09b1adc77b3a2e48f9df071cabb483d699d/orderer/consensus/kafka/chain.go#L16)<br><strong>Comment</strong>: <pre>can you please fix imports?</pre><strong>Commenter</strong>: Yoav Tock - tock@il.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/kafka/chain.go#L16](https://github.com/hyperledger-gerrit-archive/fabric/blob/1a3ef09b1adc77b3a2e48f9df071cabb483d699d/orderer/consensus/kafka/chain.go#L16)<br><strong>Comment</strong>: <pre>Done</pre></blockquote><h3>PatchSet Number: 19</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Uploader</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Created</strong>: 3/25/2019, 12:19:57 PM<br><strong>UnmergedRevision</strong>: [613326f4f523ffe7f4fa88d9c94d18d670c56e93](https://github.com/hyperledger-gerrit-archive/fabric/commit/613326f4f523ffe7f4fa88d9c94d18d670c56e93)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/25/2019, 12:27:56 PM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/25/2019, 12:27:56 PM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/25/2019, 1:13:16 PM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/25/2019, 1:00:02 PM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 20</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Uploader</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Created</strong>: 3/26/2019, 6:55:33 AM<br><strong>UnmergedRevision</strong>: [516719059bde75320171a5a896786ada091910e1](https://github.com/hyperledger-gerrit-archive/fabric/commit/516719059bde75320171a5a896786ada091910e1)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/26/2019, 7:04:39 AM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/26/2019, 7:04:39 AM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/26/2019, 7:45:41 AM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/26/2019, 7:24:34 AM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 21</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Uploader</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Created</strong>: 3/26/2019, 9:20:49 AM<br><strong>UnmergedRevision</strong>: [44e3723fbe011de6b0687c4c2b2095e760b215e3](https://github.com/hyperledger-gerrit-archive/fabric/commit/44e3723fbe011de6b0687c4c2b2095e760b215e3)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/26/2019, 9:31:02 AM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/26/2019, 9:31:02 AM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/26/2019, 10:17:58 AM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/26/2019, 10:02:35 AM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 22</h3><blockquote><strong>Type</strong>: TRIVIAL_REBASE<br><strong>Author</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Uploader</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Created</strong>: 3/27/2019, 7:43:33 AM<br><strong>UnmergedRevision</strong>: [8f12e2c0780dff90100d15a1692f7d4c57c15310](https://github.com/hyperledger-gerrit-archive/fabric/commit/8f12e2c0780dff90100d15a1692f7d4c57c15310)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/27/2019, 7:52:32 AM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/27/2019, 7:52:32 AM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/27/2019, 8:37:30 AM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/27/2019, 8:21:28 AM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Approved</strong>: 3/27/2019, 7:44:50 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 23</h3><blockquote><strong>Type</strong>: TRIVIAL_REBASE<br><strong>Author</strong>: Yoav Tock - tock@il.ibm.com<br><strong>Uploader</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Created</strong>: 3/28/2019, 9:48:12 AM<br><strong>UnmergedRevision</strong>: [d3964d1888a0ae2fa0e5b2119d9f53e471636de8](https://github.com/hyperledger-gerrit-archive/fabric/commit/d3964d1888a0ae2fa0e5b2119d9f53e471636de8)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/28/2019, 9:58:24 AM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/28/2019, 9:58:24 AM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/28/2019, 10:47:50 AM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/28/2019, 10:30:04 AM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Approved</strong>: 3/28/2019, 2:19:40 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [orderer/consensus/kafka/chain.go#L7](https://github.com/hyperledger-gerrit-archive/fabric/blob/d3964d1888a0ae2fa0e5b2119d9f53e471636de8/orderer/consensus/kafka/chain.go#L7)<br><strong>Comment</strong>: <pre>This is really a dealbreaker for me.  We cannot be polluting consensus modules with migration logic.  This should really minimally be in the common components so that it can be re-used.</pre></blockquote>
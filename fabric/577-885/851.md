<strong>Project</strong>: fabric<br><strong>Branch</strong>: master<br><strong>ID</strong>: 851<br><strong>Subject</strong>: node-SDK: add support for fabric events(block, chaincode, transactional)<br><strong>Status</strong>: MERGED<br><strong>Owner</strong>: Patrick Mullaney - pm.mullaney@gmail.com<br><strong>Assignee</strong>:<br><strong>Created</strong>: 9/1/2016, 2:45:40 PM<br><strong>LastUpdated</strong>: 9/13/2016, 3:07:34 PM<br><strong>CommitMessage</strong>:<br><pre>node-SDK: add support for fabric events(block, chaincode, transactional)

This patch adds support for fabric events to the SDK. It defaults to
the same timer based mechanism for transactional events if the app
doesn't connect to a peer event source(eventHubConnect).

Change-Id: Ib9f9f79f11438eb67d5ada7666ce1d117af511a5
Signed-off-by: Patrick Mullaney <pm.mullaney@gmail.com>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Patrick Mullaney - pm.mullaney@gmail.com<br><strong>Reviewed</strong>: 9/1/2016, 2:45:40 PM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/1/2016, 2:46:44 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/819/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/1/2016, 3:54:27 PM<br><strong>Message</strong>: <pre>Patch Set 1: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/819/ : SUCCESS</pre><strong>Reviewer</strong>: Christopher Ferris - chris.ferris@gmail.com<br><strong>Reviewed</strong>: 9/2/2016, 7:17:11 AM<br><strong>Message</strong>: <pre>Patch Set 1: Code-Review-1

where are the tests? please add unit tests for the new function</pre><strong>Reviewer</strong>: Patrick Mullaney - pm.mullaney@gmail.com<br><strong>Reviewed</strong>: 9/2/2016, 11:12:55 AM<br><strong>Message</strong>: <pre>Patch Set 1:

The transactional events can be covered via existing unit tests. The functionality is not on by default and hence I didn't alter the unit tests for this. Since this was deemed high priority, I wasn't sure the tests couldn't be added in a follow up. I'll work on adding a few.</pre><strong>Reviewer</strong>: Patrick Mullaney - pm.mullaney@gmail.com<br><strong>Reviewed</strong>: 9/2/2016, 1:50:30 PM<br><strong>Message</strong>: <pre>Uploaded patch set 2.</pre><strong>Reviewer</strong>: Patrick Mullaney - pm.mullaney@gmail.com<br><strong>Reviewed</strong>: 9/2/2016, 1:52:57 PM<br><strong>Message</strong>: <pre>Patch Set 2:

The chain-tests unit tests now run using fabric events.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/2/2016, 1:54:29 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/877/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/2/2016, 3:08:44 PM<br><strong>Message</strong>: <pre>Patch Set 2: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/877/ : FAILURE</pre><strong>Reviewer</strong>: Christopher Ferris - chris.ferris@gmail.com<br><strong>Reviewed</strong>: 9/2/2016, 3:58:33 PM<br><strong>Message</strong>: <pre>Patch Set 2:

> Build Failed
 > 
 > https://jenkins.hyperledger.org/job/fabric-verify-x86_64/877/ :
 > FAILURE

reverify</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/2/2016, 4:00:20 PM<br><strong>Message</strong>: <pre>Patch Set 2: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/881/</pre><strong>Reviewer</strong>: Anna Derbakova - adderbak@us.ibm.com<br><strong>Reviewed</strong>: 9/2/2016, 4:03:30 PM<br><strong>Message</strong>: <pre>Patch Set 2: Code-Review-1

(2 comments)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/2/2016, 5:05:27 PM<br><strong>Message</strong>: <pre>Patch Set 2: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/881/ : SUCCESS</pre><strong>Reviewer</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Reviewed</strong>: 9/3/2016, 4:07:11 PM<br><strong>Message</strong>: <pre>Patch Set 2: Code-Review-1

(4 comments)

Patrick, I'm not 100% clear on the usage.  Does it support custom events?  Is there a sample of that?  Also, as I said in code comments, I would hope that it is possible to hide the eventHub underneath other existing APIs for ease-of-use.  Thanks</pre><strong>Reviewer</strong>: Patrick Mullaney - pm.mullaney@gmail.com<br><strong>Reviewed</strong>: 9/6/2016, 6:42:55 PM<br><strong>Message</strong>: <pre>Uploaded patch set 3.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/6/2016, 6:43:55 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/947/</pre><strong>Reviewer</strong>: Patrick Mullaney - pm.mullaney@gmail.com<br><strong>Reviewed</strong>: 9/6/2016, 7:24:20 PM<br><strong>Message</strong>: <pre>Patch Set 3:

(4 comments)

The last patchset only addresses an error in one test I mistakenly left in. I'll work with Keith and Anna to address their points/concerns starting tomorrow.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/6/2016, 8:03:07 PM<br><strong>Message</strong>: <pre>Patch Set 3: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/947/ : FAILURE</pre><strong>Reviewer</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Reviewed</strong>: 9/8/2016, 3:10:59 PM<br><strong>Message</strong>: <pre>Patch Set 2:

(3 comments)</pre><strong>Reviewer</strong>: Patrick Mullaney - pm.mullaney@gmail.com<br><strong>Reviewed</strong>: 9/8/2016, 7:49:25 PM<br><strong>Message</strong>: <pre>Patch Set 3:

(2 comments)</pre><strong>Reviewer</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Reviewed</strong>: 9/9/2016, 12:02:05 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Pat, could you resolve the merge conflict. Thanks.</pre><strong>Reviewer</strong>: Patrick Mullaney - pm.mullaney@gmail.com<br><strong>Reviewed</strong>: 9/9/2016, 3:42:41 PM<br><strong>Message</strong>: <pre>Uploaded patch set 4.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/9/2016, 3:44:21 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/1073/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/9/2016, 3:45:21 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/1/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/9/2016, 4:45:49 PM<br><strong>Message</strong>: <pre>Patch Set 4: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/1073/ : SUCCESS

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/1/ : SUCCESS (skipped)</pre><strong>Reviewer</strong>: Gabor Hosszu - gabor@digitalasset.com<br><strong>Reviewed</strong>: 9/12/2016, 9:50:48 AM<br><strong>Message</strong>: <pre>Patch Set 4: Code-Review+2

(1 comment)</pre><strong>Reviewer</strong>: Christopher Ferris - chris.ferris@gmail.com<br><strong>Reviewed</strong>: 9/12/2016, 10:31:01 AM<br><strong>Message</strong>: <pre>Patch Set 4: Code-Review-1

> (1 comment)

Gabor, did you mean to +2 with the comment? Seems like it should be addressed.</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 9/12/2016, 2:01:14 PM<br><strong>Message</strong>: <pre>Patch Set 4: Code-Review-1

(3 comments)

I don't really see any tests for the eventHub?</pre><strong>Reviewer</strong>: Christopher Ferris - chris.ferris@gmail.com<br><strong>Reviewed</strong>: 9/12/2016, 2:30:40 PM<br><strong>Message</strong>: <pre>Patch Set 4:

(1 comment)</pre><strong>Reviewer</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Reviewed</strong>: 9/13/2016, 9:33:06 AM<br><strong>Message</strong>: <pre>Patch Set 4: Code-Review+2</pre><strong>Reviewer</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Reviewed</strong>: 9/13/2016, 9:34:11 AM<br><strong>Message</strong>: <pre>Patch Set 4:

> Patch Set 4: Code-Review+2

I see some minor comments if you want to address. Overall LGTM</pre><strong>Reviewer</strong>: Patrick Mullaney - pm.mullaney@gmail.com<br><strong>Reviewed</strong>: 9/13/2016, 10:01:15 AM<br><strong>Message</strong>: <pre>Uploaded patch set 5.</pre><strong>Reviewer</strong>: Patrick Mullaney - pm.mullaney@gmail.com<br><strong>Reviewed</strong>: 9/13/2016, 10:01:21 AM<br><strong>Message</strong>: <pre>Patch Set 4:

(3 comments)

The chain-test units tests now use eventhub which covers transactional and block events.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/13/2016, 10:02:50 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/1129/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/13/2016, 10:05:46 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/52/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/13/2016, 11:11:01 AM<br><strong>Message</strong>: <pre>Patch Set 5: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/1129/ : SUCCESS

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/52/ : SUCCESS (skipped)</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 9/13/2016, 12:29:27 PM<br><strong>Message</strong>: <pre>Patch Set 5: Code-Review+2</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 9/13/2016, 12:30:11 PM<br><strong>Message</strong>: <pre>Patch Set 5:

LGTM
I do think we need some more tests for this, but given its primary use in the SDK I think integrating with the current tests is OK</pre><strong>Reviewer</strong>: Christopher Ferris - chris.ferris@gmail.com<br><strong>Reviewed</strong>: 9/13/2016, 2:09:10 PM<br><strong>Message</strong>: <pre>Patch Set 5: Code-Review+2

LGTM - I agree we need more tests for this.</pre><strong>Reviewer</strong>: Gerrit Code Review - gerrit@hyperledger.org<br><strong>Reviewed</strong>: 9/13/2016, 2:09:14 PM<br><strong>Message</strong>: <pre>Change has been successfully merged by Christopher Ferris</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/13/2016, 2:11:06 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-merge-x86_64/188/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/13/2016, 2:13:29 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-merge-behave-x86_64/18/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/13/2016, 3:04:31 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-merge-x86_64/188/ : FAILURE

https://jenkins.hyperledger.org/job/fabric-merge-behave-x86_64/18/ : FAILURE (skipped)</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 9/13/2016, 3:07:34 PM<br><strong>Message</strong>: <pre>Patch Set 5:

(2 comments)

perhaps some debug messages to help troubleshoot ?</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Patrick Mullaney - pm.mullaney@gmail.com<br><strong>Uploader</strong>: Patrick Mullaney - pm.mullaney@gmail.com<br><strong>Created</strong>: 9/1/2016, 2:45:40 PM<br><strong>UnmergedRevision</strong>: [bc36816ba06b4f9e1354e77b8602ce4b540cd81c](https://github.com/hyperledger-gerrit-archive/fabric/commit/bc36816ba06b4f9e1354e77b8602ce4b540cd81c)<br><br><strong>Approver</strong>: Christopher Ferris - chris.ferris@gmail.com<br><strong>Approved</strong>: 9/2/2016, 7:17:11 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 9/1/2016, 3:54:27 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Patrick Mullaney - pm.mullaney@gmail.com<br><strong>Uploader</strong>: Patrick Mullaney - pm.mullaney@gmail.com<br><strong>Created</strong>: 9/2/2016, 1:50:30 PM<br><strong>UnmergedRevision</strong>: [0cdef1b9c829ef3902b428508eb394b54d95d222](https://github.com/hyperledger-gerrit-archive/fabric/commit/0cdef1b9c829ef3902b428508eb394b54d95d222)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 9/2/2016, 5:05:27 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>Approved</strong>: 9/3/2016, 4:07:11 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Anna Derbakova - adderbak@us.ibm.com<br><strong>Approved</strong>: 9/2/2016, 4:03:30 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Anna Derbakova - adderbak@us.ibm.com<br><strong>CommentLine</strong>: [sdk/node/package.json#L0](https://github.com/hyperledger-gerrit-archive/fabric/blob/0cdef1b9c829ef3902b428508eb394b54d95d222/sdk/node/package.json#L0)<br><strong>Comment</strong>: <pre>The package.json version must be modified for this change. Though, we need to discuss on what it should be. I am about to put in a change for FAB-288 that will bump the version to 0.6.1. So the version going in with this change must be after that.</pre><strong>Commenter</strong>: Patrick Mullaney - pm.mullaney@gmail.com<br><strong>CommentLine</strong>: [sdk/node/package.json#L0](https://github.com/hyperledger-gerrit-archive/fabric/blob/0cdef1b9c829ef3902b428508eb394b54d95d222/sdk/node/package.json#L0)<br><strong>Comment</strong>: <pre>I'll check with you prior to submission to get this right and once we have agreement on the other issues.</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [sdk/node/src/hfc.ts#L425](https://github.com/hyperledger-gerrit-archive/fabric/blob/0cdef1b9c829ef3902b428508eb394b54d95d222/sdk/node/src/hfc.ts#L425)<br><strong>Comment</strong>: <pre>Looks like the eventHub is per-Transaction but the comment says it is per chain.</pre><strong>Commenter</strong>: Patrick Mullaney - pm.mullaney@gmail.com<br><strong>CommentLine</strong>: [sdk/node/src/hfc.ts#L425](https://github.com/hyperledger-gerrit-archive/fabric/blob/0cdef1b9c829ef3902b428508eb394b54d95d222/sdk/node/src/hfc.ts#L425)<br><strong>Comment</strong>: <pre>Its per chain. Basically its a connection that is held open to receive events from the peer.</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [sdk/node/src/hfc.ts#L529](https://github.com/hyperledger-gerrit-archive/fabric/blob/0cdef1b9c829ef3902b428508eb394b54d95d222/sdk/node/src/hfc.ts#L529)<br><strong>Comment</strong>: <pre>The existing peer list is a failover list.  It seems to me that we should make the EventHub invisible to the user and use the existing peer list to connect to, also handling failover if we are unable to connect to the primary, secondary, etc.  And it should always be enabled since we need it to receive events related to a TransactionContext.  If I understand correctly, it seems that the EventHub should be per-TransactionContext.</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [sdk/node/src/hfc.ts#L529](https://github.com/hyperledger-gerrit-archive/fabric/blob/0cdef1b9c829ef3902b428508eb394b54d95d222/sdk/node/src/hfc.ts#L529)<br><strong>Comment</strong>: <pre>Event failover is difficult with the current implementation as events are not persisted. Next iteration, events are persisted with their transactions on blocks, so a reconnect may ask for events from certain block height. So if possible, I would suggest defer event failover support until the next architecture implementation in place.</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [sdk/node/test/unit/chain-tests.js#L51](https://github.com/hyperledger-gerrit-archive/fabric/blob/0cdef1b9c829ef3902b428508eb394b54d95d222/sdk/node/test/unit/chain-tests.js#L51)<br><strong>Comment</strong>: <pre>Having to configure multiple ports for a single peer is beginning to make the SDK harder and harder to use.  I think the user should only need to know the REST port and we then query the REST port for all other ports, security settings, and anything else needed by the SDK.
I think this needs to be done before this bleeds through into making the SDK harder to use.</pre><strong>Commenter</strong>: Patrick Mullaney - pm.mullaney@gmail.com<br><strong>CommentLine</strong>: [sdk/node/test/unit/chain-tests.js#L51](https://github.com/hyperledger-gerrit-archive/fabric/blob/0cdef1b9c829ef3902b428508eb394b54d95d222/sdk/node/test/unit/chain-tests.js#L51)<br><strong>Comment</strong>: <pre>I agree but this change is not addressing that so I am not sure what needs to be done here? Perhaps this should fall under general ease of use improvement and not events support?</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [sdk/node/test/unit/chain-tests.js#L51](https://github.com/hyperledger-gerrit-archive/fabric/blob/0cdef1b9c829ef3902b428508eb394b54d95d222/sdk/node/test/unit/chain-tests.js#L51)<br><strong>Comment</strong>: <pre>I agreed in general unless the client configuration is currently being fetch from the peer, then we should follow  such pattern.
However, Keith mentioned using REST port. Let's not use REST, which is being deprecated.</pre><strong>Commenter</strong>: Keith Smith - keithsmithlfid@gmail.com<br><strong>CommentLine</strong>: [sdk/node/test/unit/chain-tests.js#L55](https://github.com/hyperledger-gerrit-archive/fabric/blob/0cdef1b9c829ef3902b428508eb394b54d95d222/sdk/node/test/unit/chain-tests.js#L55)<br><strong>Comment</strong>: <pre>I think this should be done by the SDK itself so the user doesn't have to worry about it.</pre><strong>Commenter</strong>: Patrick Mullaney - pm.mullaney@gmail.com<br><strong>CommentLine</strong>: [sdk/node/test/unit/chain-tests.js#L55](https://github.com/hyperledger-gerrit-archive/fabric/blob/0cdef1b9c829ef3902b428508eb394b54d95d222/sdk/node/test/unit/chain-tests.js#L55)<br><strong>Comment</strong>: <pre>I can hook this into the Chain constructor if thats what your are comfortable with?</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [sdk/node/test/unit/chain-tests.js#L55](https://github.com/hyperledger-gerrit-archive/fabric/blob/0cdef1b9c829ef3902b428508eb394b54d95d222/sdk/node/test/unit/chain-tests.js#L55)<br><strong>Comment</strong>: <pre>Do we need to clean up anything when process exists? The connection itself would be terminated automatically.</pre><strong>Commenter</strong>: Patrick Mullaney - pm.mullaney@gmail.com<br><strong>CommentLine</strong>: [sdk/node/test/unit/chain-tests.js#L55](https://github.com/hyperledger-gerrit-archive/fabric/blob/0cdef1b9c829ef3902b428508eb394b54d95d222/sdk/node/test/unit/chain-tests.js#L55)<br><strong>Comment</strong>: <pre>Unfortunately with the nodejs implementation of grpc we need to call close on the stream or the app hangs waiting on this open resource. One would think this would be handled but it appears to me its not. We should file a bug.</pre><strong>Commenter</strong>: Anna Derbakova - adderbak@us.ibm.com<br><strong>CommentLine</strong>: [sdk/node/test/unit/chain-tests.js#L143](https://github.com/hyperledger-gerrit-archive/fabric/blob/0cdef1b9c829ef3902b428508eb394b54d95d222/sdk/node/test/unit/chain-tests.js#L143)<br><strong>Comment</strong>: <pre>I am not sure why these two lines were put in here. They are being tested in the try/catch below. So they should come out.</pre><strong>Commenter</strong>: Patrick Mullaney - pm.mullaney@gmail.com<br><strong>CommentLine</strong>: [sdk/node/test/unit/chain-tests.js#L143](https://github.com/hyperledger-gerrit-archive/fabric/blob/0cdef1b9c829ef3902b428508eb394b54d95d222/sdk/node/test/unit/chain-tests.js#L143)<br><strong>Comment</strong>: <pre>Sorry this was purely my error rushing to get some tests enabled before the long weekend. I submitted a version without. Thanks!</pre></blockquote><h3>PatchSet Number: 3</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Patrick Mullaney - pm.mullaney@gmail.com<br><strong>Uploader</strong>: Patrick Mullaney - pm.mullaney@gmail.com<br><strong>Created</strong>: 9/6/2016, 6:42:55 PM<br><strong>UnmergedRevision</strong>: [15bd09761f3b04527df68d8db559830e51a45e02](https://github.com/hyperledger-gerrit-archive/fabric/commit/15bd09761f3b04527df68d8db559830e51a45e02)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 9/6/2016, 8:03:07 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 4</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Patrick Mullaney - pm.mullaney@gmail.com<br><strong>Uploader</strong>: Patrick Mullaney - pm.mullaney@gmail.com<br><strong>Created</strong>: 9/9/2016, 3:42:41 PM<br><strong>UnmergedRevision</strong>: [2bc25cf9d2b632d66edad482b18aaa1294c1113a](https://github.com/hyperledger-gerrit-archive/fabric/commit/2bc25cf9d2b632d66edad482b18aaa1294c1113a)<br><br><strong>Approver</strong>: Christopher Ferris - chris.ferris@gmail.com<br><strong>Approved</strong>: 9/12/2016, 10:31:01 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 9/9/2016, 4:45:49 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Gabor Hosszu - gabor@digitalasset.com<br><strong>Approved</strong>: 9/12/2016, 9:50:48 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Approved</strong>: 9/13/2016, 9:33:06 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Approved</strong>: 9/12/2016, 2:01:14 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [sdk/node/src/hfc.ts#L58](https://github.com/hyperledger-gerrit-archive/fabric/blob/2bc25cf9d2b632d66edad482b18aaa1294c1113a/sdk/node/src/hfc.ts#L58)<br><strong>Comment</strong>: <pre><soapbox>
this is why I think we should move to Node 6.x in the future so we get native es6 features
</soapbox></pre><strong>Commenter</strong>: Christopher Ferris - chris.ferris@gmail.com<br><strong>CommentLine</strong>: [sdk/node/src/hfc.ts#L58](https://github.com/hyperledger-gerrit-archive/fabric/blob/2bc25cf9d2b632d66edad482b18aaa1294c1113a/sdk/node/src/hfc.ts#L58)<br><strong>Comment</strong>: <pre>+1</pre><strong>Commenter</strong>: Patrick Mullaney - pm.mullaney@gmail.com<br><strong>CommentLine</strong>: [sdk/node/src/hfc.ts#L58](https://github.com/hyperledger-gerrit-archive/fabric/blob/2bc25cf9d2b632d66edad482b18aaa1294c1113a/sdk/node/src/hfc.ts#L58)<br><strong>Comment</strong>: <pre>+1</pre><strong>Commenter</strong>: Gabor Hosszu - gabor@digitalasset.com<br><strong>CommentLine</strong>: [sdk/node/src/hfc.ts#L1429](https://github.com/hyperledger-gerrit-archive/fabric/blob/2bc25cf9d2b632d66edad482b18aaa1294c1113a/sdk/node/src/hfc.ts#L1429)<br><strong>Comment</strong>: <pre>Just a nit: http://stackoverflow.com/questions/2125066/is-it-bad-practice-to-use-an-if-statement-without-brackets</pre><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [sdk/node/src/hfc.ts#L1429](https://github.com/hyperledger-gerrit-archive/fabric/blob/2bc25cf9d2b632d66edad482b18aaa1294c1113a/sdk/node/src/hfc.ts#L1429)<br><strong>Comment</strong>: <pre>agree - please use brackets here</pre><strong>Commenter</strong>: Patrick Mullaney - pm.mullaney@gmail.com<br><strong>CommentLine</strong>: [sdk/node/src/hfc.ts#L1429](https://github.com/hyperledger-gerrit-archive/fabric/blob/2bc25cf9d2b632d66edad482b18aaa1294c1113a/sdk/node/src/hfc.ts#L1429)<br><strong>Comment</strong>: <pre>Will change now.</pre><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [sdk/node/src/hfc.ts#L2785](https://github.com/hyperledger-gerrit-archive/fabric/blob/2bc25cf9d2b632d66edad482b18aaa1294c1113a/sdk/node/src/hfc.ts#L2785)<br><strong>Comment</strong>: <pre>future comment - we should really move this class into it's own library</pre><strong>Commenter</strong>: Patrick Mullaney - pm.mullaney@gmail.com<br><strong>CommentLine</strong>: [sdk/node/src/hfc.ts#L2785](https://github.com/hyperledger-gerrit-archive/fabric/blob/2bc25cf9d2b632d66edad482b18aaa1294c1113a/sdk/node/src/hfc.ts#L2785)<br><strong>Comment</strong>: <pre>Actually this was developed as a library and then integrated. This should be trivial to pull out again.</pre></blockquote><h3>PatchSet Number: 5</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Patrick Mullaney - pm.mullaney@gmail.com<br><strong>Uploader</strong>: Patrick Mullaney - pm.mullaney@gmail.com<br><strong>Created</strong>: 9/13/2016, 10:01:15 AM<br><strong>GitHubMergedRevision</strong>: [e9d3ac296de89a092b48990fd2e1b7bc4173a5c4](https://github.com/hyperledger-gerrit-archive/fabric/commit/e9d3ac296de89a092b48990fd2e1b7bc4173a5c4)<br><br><strong>Approver</strong>: Christopher Ferris - chris.ferris@gmail.com<br><strong>Approved</strong>: 9/13/2016, 2:09:10 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>MergedBy</strong>: Christopher Ferris<br><strong>Merged</strong>: 9/13/2016, 2:09:14 PM<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 9/13/2016, 11:11:01 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Approved</strong>: 9/13/2016, 12:29:27 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [sdk/node/src/hfc.ts#L1449](https://github.com/hyperledger-gerrit-archive/fabric/blob/e9d3ac296de89a092b48990fd2e1b7bc4173a5c4/sdk/node/src/hfc.ts#L1449)<br><strong>Comment</strong>: <pre>Perhaps a message here to signify default behavior (otherwise hard to know if we get notified or not ?)</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [sdk/node/src/hfc.ts#L2786](https://github.com/hyperledger-gerrit-archive/fabric/blob/e9d3ac296de89a092b48990fd2e1b7bc4173a5c4/sdk/node/src/hfc.ts#L2786)<br><strong>Comment</strong>: <pre>Some debug / error messages to help troubleshooting ?</pre></blockquote>
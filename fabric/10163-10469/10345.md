<strong>Project</strong>: fabric<br><strong>Branch</strong>: master<br><strong>ID</strong>: 10345<br><strong>Subject</strong>: [FAB-4080] TestMultipleOrgEndpointLeakage fix<br><strong>Status</strong>: MERGED<br><strong>Owner</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Assignee</strong>:<br><strong>Created</strong>: 6/8/2017, 10:41:53 AM<br><strong>LastUpdated</strong>: 6/12/2017, 3:00:42 PM<br><strong>CommitMessage</strong>:<br><pre>[FAB-4080] TestMultipleOrgEndpointLeakage fix

Changed sleep and check membership to periodical check with timeout

Test was failing because shot sleep period before checking membership, etc.
Now test changed to use periodical check of membership with global timeout,
so it able to wait more time, but in case membership established sooner,
it will finish faster that original test...

Change-Id: I8257e3705ea82ab935b179d9a635a8bee165ad49
Signed-off-by: Gennady Laventman <gennady@il.ibm.com>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Reviewed</strong>: 6/8/2017, 10:41:53 AM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Reviewed</strong>: 6/8/2017, 10:48:26 AM<br><strong>Message</strong>: <pre>Uploaded patch set 2: Patch Set 1 was rebased.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/8/2017, 10:48:56 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-z/8677/ (1/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/8/2017, 10:49:00 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/4544/ (2/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/8/2017, 10:49:01 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/13025/ (3/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/8/2017, 10:49:52 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/7073/ (4/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/8/2017, 10:51:37 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/4546/ (1/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/8/2017, 10:51:44 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/13027/ (2/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/8/2017, 10:52:27 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/7075/ (3/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/8/2017, 11:04:31 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-z/8679/ (4/4)</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 6/8/2017, 11:37:32 AM<br><strong>Message</strong>: <pre>Patch Set 2: Code-Review-1

(6 comments)

I have a few comments, also could you please extend a bit commit message to explain the fix and what was the problem?</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/8/2017, 11:57:16 AM<br><strong>Message</strong>: <pre>Patch Set 2: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-z/8679/ : FAILURE

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-z/8679

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/4546/ : SUCCESS

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-end-2-end-x86_64/4546

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/13027/ : SUCCESS

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-x86_64/13027

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/7075/ : SUCCESS

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-behave-x86_64/7075</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/8/2017, 12:01:35 PM<br><strong>Message</strong>: <pre>Patch Set 1: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-z/8677/ : FAILURE

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-z/8677

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/4544/ : SUCCESS

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-end-2-end-x86_64/4544

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/13025/ : SUCCESS

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-x86_64/13025

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/7073/ : SUCCESS

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-behave-x86_64/7073</pre><strong>Reviewer</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Reviewed</strong>: 6/9/2017, 5:14:24 AM<br><strong>Message</strong>: <pre>Patch Set 2:

(6 comments)</pre><strong>Reviewer</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Reviewed</strong>: 6/9/2017, 5:21:43 AM<br><strong>Message</strong>: <pre>Uploaded patch set 3.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/9/2017, 5:21:51 AM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-z/8787/ (1/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/9/2017, 5:23:49 AM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/4654/ (2/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/9/2017, 5:24:40 AM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/13136/ (3/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/9/2017, 5:24:41 AM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/7183/ (4/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/9/2017, 6:37:19 AM<br><strong>Message</strong>: <pre>Patch Set 3: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-z/8787/ : FAILURE

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-z/8787

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/4654/ : SUCCESS

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-end-2-end-x86_64/4654

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/13136/ : SUCCESS

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-x86_64/13136

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/7183/ : SUCCESS

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-behave-x86_64/7183</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 6/9/2017, 12:59:07 PM<br><strong>Message</strong>: <pre>Patch Set 4: Patch Set 3 was rebased</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/9/2017, 12:59:16 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-z/8818/ (1/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/9/2017, 1:01:16 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/4685/ (2/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/9/2017, 1:01:39 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/7214/ (4/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/9/2017, 1:01:39 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/13168/ (3/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/9/2017, 1:41:52 PM<br><strong>Message</strong>: <pre>Patch Set 4: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-z/8818/ : FAILURE

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-z/8818

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/13168/ : FAILURE

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-x86_64/13168

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/7214/ : FAILURE

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-behave-x86_64/7214

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/4685/ : SUCCESS

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-end-2-end-x86_64/4685</pre><strong>Reviewer</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Reviewed</strong>: 6/9/2017, 3:55:09 PM<br><strong>Message</strong>: <pre>Patch Set 4:

reverify</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/9/2017, 3:57:16 PM<br><strong>Message</strong>: <pre>Patch Set 4: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/4708/ (1/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/9/2017, 3:57:52 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/13191/ (2/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/9/2017, 3:59:12 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/7237/ (3/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/9/2017, 4:07:27 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-z/8842/ (4/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/9/2017, 5:37:08 PM<br><strong>Message</strong>: <pre>Patch Set 4: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-z/8842/ : FAILURE

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-z/8842

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/4708/ : SUCCESS

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-end-2-end-x86_64/4708

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/13191/ : SUCCESS

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-x86_64/13191

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/7237/ : SUCCESS

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-behave-x86_64/7237</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 6/9/2017, 5:40:39 PM<br><strong>Message</strong>: <pre>Patch Set 5: Patch Set 4 was rebased</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/9/2017, 5:40:50 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-z/8851/ (1/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/9/2017, 5:43:02 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/4717/ (2/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/9/2017, 5:43:15 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/13200/ (4/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/9/2017, 5:43:15 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/7246/ (3/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/9/2017, 7:03:36 PM<br><strong>Message</strong>: <pre>Patch Set 5: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-z/8851/ : FAILURE

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-z/8851

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/4717/ : SUCCESS

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-end-2-end-x86_64/4717

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/13200/ : SUCCESS

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-x86_64/13200

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/7246/ : SUCCESS

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-behave-x86_64/7246</pre><strong>Reviewer</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Reviewed</strong>: 6/10/2017, 3:24:36 PM<br><strong>Message</strong>: <pre>Patch Set 5:

reverify</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/10/2017, 3:24:42 PM<br><strong>Message</strong>: <pre>Patch Set 5: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-verify-z/8896/ (1/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/10/2017, 3:26:07 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/4762/ (2/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/10/2017, 3:26:45 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/13245/ (3/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/10/2017, 3:27:20 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/7291/ (4/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/10/2017, 4:26:03 PM<br><strong>Message</strong>: <pre>Patch Set 5: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/4762/ : SUCCESS

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-end-2-end-x86_64/4762

https://jenkins.hyperledger.org/job/fabric-verify-z/8896/ : SUCCESS

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-z/8896

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/13245/ : SUCCESS

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-x86_64/13245

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/7291/ : SUCCESS

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-behave-x86_64/7291</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 6/11/2017, 3:44:42 AM<br><strong>Message</strong>: <pre>Patch Set 5:

(5 comments)</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 6/11/2017, 6:22:20 AM<br><strong>Message</strong>: <pre>Patch Set 5: Code-Review-1

(1 comment)</pre><strong>Reviewer</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Reviewed</strong>: 6/11/2017, 10:10:43 AM<br><strong>Message</strong>: <pre>Patch Set 5:

(4 comments)</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 6/11/2017, 10:34:20 AM<br><strong>Message</strong>: <pre>Patch Set 2:

(1 comment)</pre><strong>Reviewer</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Reviewed</strong>: 6/12/2017, 4:30:08 AM<br><strong>Message</strong>: <pre>Uploaded patch set 6.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/12/2017, 4:30:18 AM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-z/8949/ (1/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/12/2017, 4:31:56 AM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/4815/ (2/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/12/2017, 4:32:43 AM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/13299/ (3/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/12/2017, 4:32:53 AM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/7347/ (4/4)</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 6/12/2017, 4:49:37 AM<br><strong>Message</strong>: <pre>Patch Set 6: Code-Review-1

(7 comments)</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 6/12/2017, 5:37:46 AM<br><strong>Message</strong>: <pre>Patch Set 6:

(1 comment)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/12/2017, 6:01:17 AM<br><strong>Message</strong>: <pre>Patch Set 6: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/13299/ : FAILURE

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-x86_64/13299

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/7347/ : FAILURE

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-behave-x86_64/7347

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/4815/ : SUCCESS

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-end-2-end-x86_64/4815

https://jenkins.hyperledger.org/job/fabric-verify-z/8949/ : SUCCESS

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-z/8949</pre><strong>Reviewer</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Reviewed</strong>: 6/12/2017, 7:48:10 AM<br><strong>Message</strong>: <pre>Patch Set 6:

(8 comments)</pre><strong>Reviewer</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Reviewed</strong>: 6/12/2017, 7:52:31 AM<br><strong>Message</strong>: <pre>Uploaded patch set 7.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/12/2017, 7:52:37 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-z/8957/ (1/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/12/2017, 7:54:05 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/4823/ (2/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/12/2017, 7:55:07 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/13307/ (3/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/12/2017, 7:55:40 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/7355/ (4/4)</pre><strong>Reviewer</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Reviewed</strong>: 6/12/2017, 8:57:46 AM<br><strong>Message</strong>: <pre>Uploaded patch set 8.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/12/2017, 8:57:54 AM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-z/8961/ (1/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/12/2017, 9:00:41 AM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/4827/ (2/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/12/2017, 9:01:00 AM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/13311/ (3/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/12/2017, 9:01:24 AM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/7359/ (4/4)</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 6/12/2017, 9:05:55 AM<br><strong>Message</strong>: <pre>Patch Set 8: Code-Review+2</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/12/2017, 9:09:28 AM<br><strong>Message</strong>: <pre>Patch Set 7: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/4823/ : SUCCESS

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-end-2-end-x86_64/4823

https://jenkins.hyperledger.org/job/fabric-verify-z/8957/ : SUCCESS

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-z/8957

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/13307/ : SUCCESS

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-x86_64/13307

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/7355/ : SUCCESS

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-behave-x86_64/7355</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/12/2017, 10:48:40 AM<br><strong>Message</strong>: <pre>Patch Set 8: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/4827/ : SUCCESS

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-end-2-end-x86_64/4827

https://jenkins.hyperledger.org/job/fabric-verify-z/8961/ : SUCCESS

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-z/8961

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/13311/ : SUCCESS

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-x86_64/13311

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/7359/ : SUCCESS

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-verify-behave-x86_64/7359</pre><strong>Reviewer</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Reviewed</strong>: 6/12/2017, 1:26:19 PM<br><strong>Message</strong>: <pre>Patch Set 8: Code-Review+2</pre><strong>Reviewer</strong>: Gerrit Code Review - gerrit@hyperledger.org<br><strong>Reviewed</strong>: 6/12/2017, 1:26:22 PM<br><strong>Message</strong>: <pre>Change has been successfully merged by Binh Nguyen</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/12/2017, 1:26:33 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-merge-z/1609/ (1/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/12/2017, 1:28:07 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-merge-end-2-end-x86_64/778/ (2/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/12/2017, 1:28:57 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-merge-behave-x86_64/1087/ (3/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/12/2017, 1:29:03 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-merge-x86_64/2097/ (4/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 6/12/2017, 3:00:42 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-merge-x86_64/2097/ : FAILURE

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-merge-x86_64/2097

https://jenkins.hyperledger.org/job/fabric-merge-z/1609/ : SUCCESS

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-merge-z/1609

https://jenkins.hyperledger.org/job/fabric-merge-end-2-end-x86_64/778/ : SUCCESS

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-merge-end-2-end-x86_64/778

https://jenkins.hyperledger.org/job/fabric-merge-behave-x86_64/1087/ : SUCCESS

Logs: https://logs.hyperledger.org/jobbuilder/vex-yul-hyp-jenkins-1/fabric-merge-behave-x86_64/1087</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Uploader</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Created</strong>: 6/8/2017, 10:41:53 AM<br><strong>UnmergedRevision</strong>: [66bc793aab2aca68d6390ec59a627731c6f7b476](https://github.com/hyperledger-gerrit-archive/fabric/commit/66bc793aab2aca68d6390ec59a627731c6f7b476)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 6/8/2017, 12:01:35 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: TRIVIAL_REBASE<br><strong>Author</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Uploader</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Created</strong>: 6/8/2017, 10:48:26 AM<br><strong>UnmergedRevision</strong>: [cc8581a7fc28b980d2be374fcc1688f010350da1](https://github.com/hyperledger-gerrit-archive/fabric/commit/cc8581a7fc28b980d2be374fcc1688f010350da1)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 6/8/2017, 11:57:16 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Approved</strong>: 6/8/2017, 11:37:32 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L224](https://github.com/hyperledger-gerrit-archive/fabric/blob/cc8581a7fc28b980d2be374fcc1688f010350da1/gossip/gossip/orgs_test.go#L224)<br><strong>Comment</strong>: <pre>I'm not sure why do you need to aggregate errors rather than just failing right away?</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L224](https://github.com/hyperledger-gerrit-archive/fabric/blob/cc8581a7fc28b980d2be374fcc1688f010350da1/gossip/gossip/orgs_test.go#L224)<br><strong>Comment</strong>: <pre>Now it can fail for different reasons. I want to be able to see those reasons, even I changed the way the waiting handled...</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L224](https://github.com/hyperledger-gerrit-archive/fabric/blob/cc8581a7fc28b980d2be374fcc1688f010350da1/gossip/gossip/orgs_test.go#L224)<br><strong>Comment</strong>: <pre>I do not understand why continue to collecting those reasons instead of simply failing and showing the first one. Rest of the reasons might be connected to the very first one, hence no sure why to collect all of them.</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L224](https://github.com/hyperledger-gerrit-archive/fabric/blob/cc8581a7fc28b980d2be374fcc1688f010350da1/gossip/gossip/orgs_test.go#L224)<br><strong>Comment</strong>: <pre>I think, that we can just make the function return a bool, and inside the function use: t.Log() to print the failures.
Then, if the test fails we would be able to see the time and the unsatisfied predicates - thus making postmortem analysis possible despite returning only a bool.

This also gives us the benefit of being able to use the standard, already-existing function that accepts a func() bool as an argument and we could remove the additional function introduced - "waitForCorrectMembership".</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L224](https://github.com/hyperledger-gerrit-archive/fabric/blob/cc8581a7fc28b980d2be374fcc1688f010350da1/gossip/gossip/orgs_test.go#L224)<br><strong>Comment</strong>: <pre>Failure of this function doesn't mean test failure. Test fails only if the function continue to fail until timeout reached. I can change this function to return only bool and make usable by waitUntilOrFail function in gossip_test.go, instead writing mine waitForCorrectMembership function, but in this case we will loose failure reasons - first or last one.</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L224](https://github.com/hyperledger-gerrit-archive/fabric/blob/cc8581a7fc28b980d2be374fcc1688f010350da1/gossip/gossip/orgs_test.go#L224)<br><strong>Comment</strong>: <pre>I don't agree at all... The function can fail multiple times until timeout, but we need only failure messages from last run of function. I can change this function to work with waitUntilOrFail</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L224](https://github.com/hyperledger-gerrit-archive/fabric/blob/cc8581a7fc28b980d2be374fcc1688f010350da1/gossip/gossip/orgs_test.go#L224)<br><strong>Comment</strong>: <pre>well, even if you want to collect all errors, you could have made the signature of the function be func() bool, and simply stored the errors in a slice that is defined in the test, and then in the test do: defer fmt.Println(errorSlice).
This way the only errors that will be printed in a case of failure are the last errors.</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L234](https://github.com/hyperledger-gerrit-archive/fabric/blob/cc8581a7fc28b980d2be374fcc1688f010350da1/gossip/gossip/orgs_test.go#L234)<br><strong>Comment</strong>: <pre>I think this could be replaced with simple assertion, like:

   assert.Equals(t, knowPeersNum, len(peersKnown))</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L234](https://github.com/hyperledger-gerrit-archive/fabric/blob/cc8581a7fc28b980d2be374fcc1688f010350da1/gossip/gossip/orgs_test.go#L234)<br><strong>Comment</strong>: <pre>Ok</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L266](https://github.com/hyperledger-gerrit-archive/fabric/blob/cc8581a7fc28b980d2be374fcc1688f010350da1/gossip/gossip/orgs_test.go#L266)<br><strong>Comment</strong>: <pre>I think we already have such function.</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L266](https://github.com/hyperledger-gerrit-archive/fabric/blob/cc8581a7fc28b980d2be374fcc1688f010350da1/gossip/gossip/orgs_test.go#L266)<br><strong>Comment</strong>: <pre>We have such function but with predicate that returns only bool. I want to keep all failure messages... See my first reply</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L266](https://github.com/hyperledger-gerrit-archive/fabric/blob/cc8581a7fc28b980d2be374fcc1688f010350da1/gossip/gossip/orgs_test.go#L266)<br><strong>Comment</strong>: <pre>I still do not understand why to collect all failures instead of stopping after the first one.</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L266](https://github.com/hyperledger-gerrit-archive/fabric/blob/cc8581a7fc28b980d2be374fcc1688f010350da1/gossip/gossip/orgs_test.go#L266)<br><strong>Comment</strong>: <pre>It is not relevant to this function logic.</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L267](https://github.com/hyperledger-gerrit-archive/fabric/blob/cc8581a7fc28b980d2be374fcc1688f010350da1/gossip/gossip/orgs_test.go#L267)<br><strong>Comment</strong>: <pre>It could be simple:


   30 * time.Second</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L267](https://github.com/hyperledger-gerrit-archive/fabric/blob/cc8581a7fc28b980d2be374fcc1688f010350da1/gossip/gossip/orgs_test.go#L267)<br><strong>Comment</strong>: <pre>Ok. BTW, this is the way all time operations done in file. I just wanted to keep it consistent with rest of the code in file. See lines 39, 110, etc</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L267](https://github.com/hyperledger-gerrit-archive/fabric/blob/cc8581a7fc28b980d2be374fcc1688f010350da1/gossip/gossip/orgs_test.go#L267)<br><strong>Comment</strong>: <pre>Well, no need to align with legacy if it could be done in better way :)</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L277](https://github.com/hyperledger-gerrit-archive/fabric/blob/cc8581a7fc28b980d2be374fcc1688f010350da1/gossip/gossip/orgs_test.go#L277)<br><strong>Comment</strong>: <pre>I do not understand this part, can you please explain? Will it return success if predicate eventually become true while got errors while waiting?</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L277](https://github.com/hyperledger-gerrit-archive/fabric/blob/cc8581a7fc28b980d2be374fcc1688f010350da1/gossip/gossip/orgs_test.go#L277)<br><strong>Comment</strong>: <pre>Yes, once predicate eventually comes true, it forgets about all previous attempts and returns.</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L277](https://github.com/hyperledger-gerrit-archive/fabric/blob/cc8581a7fc28b980d2be374fcc1688f010350da1/gossip/gossip/orgs_test.go#L277)<br><strong>Comment</strong>: <pre>Even though there was a failures?</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L277](https://github.com/hyperledger-gerrit-archive/fabric/blob/cc8581a7fc28b980d2be374fcc1688f010350da1/gossip/gossip/orgs_test.go#L277)<br><strong>Comment</strong>: <pre>Yes, this is the way it works. For example, lets take membership establishment - it take some period of time, so we check if membership is ok, if not, wait and check again, and again until timeout. So, once predicate eventually become true, we forgot about all previous failures and return. This is the reason I don't want to print all previous failure messages - they not relevant.</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L281](https://github.com/hyperledger-gerrit-archive/fabric/blob/cc8581a7fc28b980d2be374fcc1688f010350da1/gossip/gossip/orgs_test.go#L281)<br><strong>Comment</strong>: <pre>What is the purpose of stack trace here? Any way error happened in different place. Am I missing something?</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L281](https://github.com/hyperledger-gerrit-archive/fabric/blob/cc8581a7fc28b980d2be374fcc1688f010350da1/gossip/gossip/orgs_test.go#L281)<br><strong>Comment</strong>: <pre>Actually, I used as base for this function waitUntilOrFail function from gossip_test. It do have this StackTrace. I just copied...</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L281](https://github.com/hyperledger-gerrit-archive/fabric/blob/cc8581a7fc28b980d2be374fcc1688f010350da1/gossip/gossip/orgs_test.go#L281)<br><strong>Comment</strong>: <pre>Ok</pre></blockquote><h3>PatchSet Number: 3</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Uploader</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Created</strong>: 6/9/2017, 5:21:43 AM<br><strong>UnmergedRevision</strong>: [eeac3f1df2934eccb1420b9f926421df0a551ef0](https://github.com/hyperledger-gerrit-archive/fabric/commit/eeac3f1df2934eccb1420b9f926421df0a551ef0)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 6/9/2017, 6:37:19 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 4</h3><blockquote><strong>Type</strong>: TRIVIAL_REBASE<br><strong>Author</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Uploader</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Created</strong>: 6/9/2017, 12:59:07 PM<br><strong>UnmergedRevision</strong>: [19beea0d01bb474a69643faa9a4b2e5a665a125c](https://github.com/hyperledger-gerrit-archive/fabric/commit/19beea0d01bb474a69643faa9a4b2e5a665a125c)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 6/9/2017, 5:37:08 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 5</h3><blockquote><strong>Type</strong>: TRIVIAL_REBASE<br><strong>Author</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Uploader</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Created</strong>: 6/9/2017, 5:40:39 PM<br><strong>UnmergedRevision</strong>: [7482cebda3f7134ac8c4d331a50d85bd71031ce3](https://github.com/hyperledger-gerrit-archive/fabric/commit/7482cebda3f7134ac8c4d331a50d85bd71031ce3)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 6/10/2017, 4:26:03 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Approved</strong>: 6/11/2017, 6:22:20 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 6</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Uploader</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Created</strong>: 6/12/2017, 4:30:08 AM<br><strong>UnmergedRevision</strong>: [78d1145f471b8cf2013180cdc81e24f8fa0ed7e0](https://github.com/hyperledger-gerrit-archive/fabric/commit/78d1145f471b8cf2013180cdc81e24f8fa0ed7e0)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 6/12/2017, 6:01:17 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Approved</strong>: 6/12/2017, 4:49:37 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L221](https://github.com/hyperledger-gerrit-archive/fabric/blob/78d1145f471b8cf2013180cdc81e24f8fa0ed7e0/gossip/gossip/orgs_test.go#L221)<br><strong>Comment</strong>: <pre>you can remove this now when we have the wait waitUntilOrFail</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L221](https://github.com/hyperledger-gerrit-archive/fabric/blob/78d1145f471b8cf2013180cdc81e24f8fa0ed7e0/gossip/gossip/orgs_test.go#L221)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L225](https://github.com/hyperledger-gerrit-archive/fabric/blob/78d1145f471b8cf2013180cdc81e24f8fa0ed7e0/gossip/gossip/orgs_test.go#L225)<br><strong>Comment</strong>: <pre>so I think that everywhere where you have "res = false" - it's better just to return false, no?
No point in continuing the iteration further.</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L225](https://github.com/hyperledger-gerrit-archive/fabric/blob/78d1145f471b8cf2013180cdc81e24f8fa0ed7e0/gossip/gossip/orgs_test.go#L225)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L236](https://github.com/hyperledger-gerrit-archive/fabric/blob/78d1145f471b8cf2013180cdc81e24f8fa0ed7e0/gossip/gossip/orgs_test.go#L236)<br><strong>Comment</strong>: <pre>so here peer p shouldn't know about knownPeer, but does.
This should be an assertion.</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L236](https://github.com/hyperledger-gerrit-archive/fabric/blob/78d1145f471b8cf2013180cdc81e24f8fa0ed7e0/gossip/gossip/orgs_test.go#L236)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L238](https://github.com/hyperledger-gerrit-archive/fabric/blob/78d1145f471b8cf2013180cdc81e24f8fa0ed7e0/gossip/gossip/orgs_test.go#L238)<br><strong>Comment</strong>: <pre>know</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L238](https://github.com/hyperledger-gerrit-archive/fabric/blob/78d1145f471b8cf2013180cdc81e24f8fa0ed7e0/gossip/gossip/orgs_test.go#L238)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L240](https://github.com/hyperledger-gerrit-archive/fabric/blob/78d1145f471b8cf2013180cdc81e24f8fa0ed7e0/gossip/gossip/orgs_test.go#L240)<br><strong>Comment</strong>: <pre>So here we have a situation where peer p should know the internal endpoint of knownPeer, but doesn't.
I think this should be an assertion, otherwise the test might sometimes succeed while an iteration here wasn't satisfied.</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L240](https://github.com/hyperledger-gerrit-archive/fabric/blob/78d1145f471b8cf2013180cdc81e24f8fa0ed7e0/gossip/gossip/orgs_test.go#L240)<br><strong>Comment</strong>: <pre>It doesn't know for some time, I didn't dig into it, but after some time it does know</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L241](https://github.com/hyperledger-gerrit-archive/fabric/blob/78d1145f471b8cf2013180cdc81e24f8fa0ed7e0/gossip/gossip/orgs_test.go#L241)<br><strong>Comment</strong>: <pre>extract variable</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L241](https://github.com/hyperledger-gerrit-archive/fabric/blob/78d1145f471b8cf2013180cdc81e24f8fa0ed7e0/gossip/gossip/orgs_test.go#L241)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L246](https://github.com/hyperledger-gerrit-archive/fabric/blob/78d1145f471b8cf2013180cdc81e24f8fa0ed7e0/gossip/gossip/orgs_test.go#L246)<br><strong>Comment</strong>: <pre>extract variable</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L246](https://github.com/hyperledger-gerrit-archive/fabric/blob/78d1145f471b8cf2013180cdc81e24f8fa0ed7e0/gossip/gossip/orgs_test.go#L246)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L247](https://github.com/hyperledger-gerrit-archive/fabric/blob/78d1145f471b8cf2013180cdc81e24f8fa0ed7e0/gossip/gossip/orgs_test.go#L247)<br><strong>Comment</strong>: <pre>this is a fatal error, you should have an assertion here.
Otherwise the test might eventually succeed but fail at some iteration.</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/orgs_test.go#L247](https://github.com/hyperledger-gerrit-archive/fabric/blob/78d1145f471b8cf2013180cdc81e24f8fa0ed7e0/gossip/gossip/orgs_test.go#L247)<br><strong>Comment</strong>: <pre>Done</pre></blockquote><h3>PatchSet Number: 7</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Uploader</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Created</strong>: 6/12/2017, 7:52:31 AM<br><strong>UnmergedRevision</strong>: [39b48275cfba9f9f48e9ef9880fc5c366e040bbc](https://github.com/hyperledger-gerrit-archive/fabric/commit/39b48275cfba9f9f48e9ef9880fc5c366e040bbc)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 6/12/2017, 9:09:28 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 8</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Uploader</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Created</strong>: 6/12/2017, 8:57:46 AM<br><strong>GitHubMergedRevision</strong>: [4339bb86034a51bca8775774b53517faa7d2fd7d](https://github.com/hyperledger-gerrit-archive/fabric/commit/4339bb86034a51bca8775774b53517faa7d2fd7d)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 6/12/2017, 10:48:40 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Approved</strong>: 6/12/2017, 1:26:19 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>MergedBy</strong>: Binh Nguyen<br><strong>Merged</strong>: 6/12/2017, 1:26:22 PM<br><br><strong>Approver</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Approved</strong>: 6/12/2017, 9:05:55 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br></blockquote>
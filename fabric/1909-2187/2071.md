<strong>Project</strong>: fabric<br><strong>Branch</strong>: master<br><strong>ID</strong>: 2071<br><strong>Subject</strong>: Protobuf comments and minor changes<br><strong>Status</strong>: MERGED<br><strong>Owner</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Assignee</strong>:<br><strong>Created</strong>: 10/27/2016, 10:21:45 AM<br><strong>LastUpdated</strong>: 10/28/2016, 1:05:56 AM<br><strong>CommitMessage</strong>:<br><pre>Protobuf comments and minor changes

This change-set introduces comments to each of the protobuf for the next fabric
architecture (v1).

Change-Id: I36c556fc9feedf5819742eeb0556f786198b2ded
Signed-off-by: Alessandro Sorniotti <ale.linux@sopit.net>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 10/27/2016, 10:21:45 AM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 10/27/2016, 10:23:07 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/2117/ (1/2)</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 10/27/2016, 10:56:40 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(12 comments)</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 10/27/2016, 11:06:00 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(1 comment)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 10/27/2016, 11:39:01 AM<br><strong>Message</strong>: <pre>Patch Set 1: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/1012/ : FAILURE (skipped)

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/2117/ : SUCCESS</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 10/27/2016, 11:39:44 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(11 comments)</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 10/27/2016, 11:47:16 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(3 comments)</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 10/27/2016, 11:47:58 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(1 comment)</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 10/27/2016, 11:54:40 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(1 comment)</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 10/27/2016, 11:55:53 AM<br><strong>Message</strong>: <pre>Uploaded patch set 2.</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 10/27/2016, 12:03:20 PM<br><strong>Message</strong>: <pre>Patch Set 1:

(1 comment)</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 10/27/2016, 12:03:43 PM<br><strong>Message</strong>: <pre>Patch Set 1:

(4 comments)</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 10/27/2016, 12:07:25 PM<br><strong>Message</strong>: <pre>Patch Set 1:

(1 comment)</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 10/27/2016, 12:07:48 PM<br><strong>Message</strong>: <pre>Uploaded patch set 3.</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 10/27/2016, 12:24:08 PM<br><strong>Message</strong>: <pre>Patch Set 1:

(2 comments)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 10/27/2016, 12:28:19 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/1016/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 10/27/2016, 12:37:28 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/1016/ : FAILURE (skipped)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 10/27/2016, 12:37:30 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/2121/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 10/27/2016, 1:07:59 PM<br><strong>Message</strong>: <pre>Patch Set 3: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/2121/ : SUCCESS</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 10/27/2016, 1:08:00 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/1017/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 10/27/2016, 1:14:35 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/1017/ : FAILURE (skipped)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 10/27/2016, 1:14:36 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/2122/</pre><strong>Reviewer</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Reviewed</strong>: 10/27/2016, 1:36:08 PM<br><strong>Message</strong>: <pre>Patch Set 3: Code-Review-1

(4 comments)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 10/27/2016, 1:44:25 PM<br><strong>Message</strong>: <pre>Patch Set 2: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/2122/ : SUCCESS</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 10/27/2016, 2:46:08 PM<br><strong>Message</strong>: <pre>Patch Set 3:

(3 comments)</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 10/27/2016, 3:02:14 PM<br><strong>Message</strong>: <pre>Uploaded patch set 4.</pre><strong>Reviewer</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Reviewed</strong>: 10/27/2016, 5:16:58 PM<br><strong>Message</strong>: <pre>Patch Set 3:

(1 comment)</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 10/27/2016, 6:42:22 PM<br><strong>Message</strong>: <pre>Patch Set 4:

reverify</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 10/27/2016, 6:42:27 PM<br><strong>Message</strong>: <pre>Patch Set 4: Code-Review+2</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 10/27/2016, 7:40:21 PM<br><strong>Message</strong>: <pre>Patch Set 4: Code-Review+2 Verified+1

The reverify is not kicking in for some reason.  As none of these next/*.protos are used currently and in any way affect the code, will +1 verify it.</pre><strong>Reviewer</strong>: Gerrit Code Review - gerrit@hyperledger.org<br><strong>Reviewed</strong>: 10/27/2016, 7:40:34 PM<br><strong>Message</strong>: <pre>Change has been successfully merged by Srinivasan Muralidharan</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 10/27/2016, 7:50:38 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-merge-x86_64/278/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 10/27/2016, 7:53:11 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-merge-behave-x86_64/105/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 10/27/2016, 8:03:55 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/1020/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 10/27/2016, 8:03:57 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/2125/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 10/27/2016, 8:39:38 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-merge-behave-x86_64/105/ : FAILURE (skipped)

https://jenkins.hyperledger.org/job/fabric-merge-x86_64/278/ : SUCCESS</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 10/27/2016, 8:56:50 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/1020/ : FAILURE (skipped)

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/2125/ : SUCCESS</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 10/28/2016, 1:05:56 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(1 comment)</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Created</strong>: 10/27/2016, 10:21:45 AM<br><strong>UnmergedRevision</strong>: [307c1c7a2be0056e7245eca3f9d901e6e64a5751](https://github.com/hyperledger-gerrit-archive/fabric/commit/307c1c7a2be0056e7245eca3f9d901e6e64a5751)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 10/27/2016, 11:39:01 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [protos/next/fabric.proto#L22](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric.proto#L22)<br><strong>Comment</strong>: <pre>I would vote no, that this flow should be moved to the chaincode transaction message definitions</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [protos/next/fabric.proto#L22](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric.proto#L22)<br><strong>Comment</strong>: <pre>Makes sense - which one of the chaincode_ protobuf files?</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [protos/next/fabric.proto#L22](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric.proto#L22)<br><strong>Comment</strong>: <pre>I would think chaincode_transaction.proto, as I imagine this is the first place someone wanting to work with chaincode transactions would work?</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [protos/next/fabric.proto#L22](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric.proto#L22)<br><strong>Comment</strong>: <pre>Angelo suggested chaincode_proposal.proto and I've put it there - I can change if you disagree</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [protos/next/fabric.proto#L22](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric.proto#L22)<br><strong>Comment</strong>: <pre>That's fine, no strong opinion, just that it should be in the chaincode protos.</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [protos/next/fabric.proto#L79](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric.proto#L79)<br><strong>Comment</strong>: <pre>Shouldn't this be ChaincodeActionPayload (1) ?</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [protos/next/fabric.proto#L79](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric.proto#L79)<br><strong>Comment</strong>: <pre>yup, good catch, thanks! Changing</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [protos/next/fabric_proposal.proto#L50](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric_proposal.proto#L50)<br><strong>Comment</strong>: <pre>Although it is said in the comment above, I would make it explicit, that this signature is to be verified against the the creator identity contained in the header of the proposal marshaled as proposedBytes.</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [protos/next/fabric_proposal.proto#L50](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric_proposal.proto#L50)<br><strong>Comment</strong>: <pre>good call - done</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [protos/next/fabric_proposal_response.proto#L22](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric_proposal_response.proto#L22)<br><strong>Comment</strong>: <pre>Just as there is a flow for a chaincode transaction type, I'd really like to see a flow for a generic transaction type, something that has no extension, and just 'works' with the existing structures.</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [protos/next/fabric_proposal_response.proto#L22](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric_proposal_response.proto#L22)<br><strong>Comment</strong>: <pre>Good point... I'll work on one and push it, and then you can see if it fits the configuration messages/flows</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [protos/next/fabric_proposal_response.proto#L78](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric_proposal_response.proto#L78)<br><strong>Comment</strong>: <pre>messageis is a typo</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [protos/next/fabric_proposal_response.proto#L78](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric_proposal_response.proto#L78)<br><strong>Comment</strong>: <pre>nice catch - thx</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [protos/next/fabric_proposal_response.proto#L96](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric_proposal_response.proto#L96)<br><strong>Comment</strong>: <pre>Maybe this is intentionally vague, but the notion of how to determine what epoch to encode a message into has always been vague to me.  Is the assumption that this is based on a real clock? Or manually advanced? Any reason this is encoded as bytes instead of as a simple sequence number?</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [protos/next/fabric_proposal_response.proto#L96](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric_proposal_response.proto#L96)<br><strong>Comment</strong>: <pre>It is deliberately vague, yes. There seems to be consensus over using the ledger chain length as a way of having epochs progress, but it hasn't been written anywhere. Wall clock would be a bad idea. As to why bytes... good Q.. I think it comes from the vagueness of the definition. Are you suggesting an int? Or another structure?</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [protos/next/fabric_proposal_response.proto#L114](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric_proposal_response.proto#L114)<br><strong>Comment</strong>: <pre>Then don't we need to specify the marshaling scheme for the proposal response, otherwise the endorsements will be over different sets of bytes?</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [protos/next/fabric_proposal_response.proto#L114](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric_proposal_response.proto#L114)<br><strong>Comment</strong>: <pre>Shouldn't we just use deterministic marshalling (e.g. ASN.1 as suggested by Simon) for stuff that goes into the ledger and has to be preserved for posterity?</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [protos/next/fabric_transaction.proto#L34](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric_transaction.proto#L34)<br><strong>Comment</strong>: <pre>Perhaps this is a point where I am simply overruled, but I really do not like this logic.  It seems perfectly reasonable that someone might want to submit a set of transactionactions which have different creator headers.  Can the rest of the header be different? Or must they all be identical.  If they must all be identical, then they should probably not be repeated.</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [protos/next/fabric_transaction.proto#L34](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric_transaction.proto#L34)<br><strong>Comment</strong>: <pre>If we submit actions with different creators, who's signing off the transaction (and taking the blame for it)? Who stops someone from taking somebody else's actions and submitting it for them? The slope is slippery...

As to not repeating the headers: the creator *has* to be the same, other stuff (e.g. nonces) *have* to be different, which is why we have to repeat.

I don't particularly like this repetition either, but I can't think of any other way to do what we want to do..</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [protos/next/fabric_transaction.proto#L34](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric_transaction.proto#L34)<br><strong>Comment</strong>: <pre>I would say the top level signer is the one who takes responsibility for the submission?

I'm not sure what the problem is with someone else submitting someone else's actions, if they are valid, they will be accepted, if they are invalid, they will be rejected, and if it's DoS-y, the outer signer will ultimately be held responsible.  For the DoS case I don't see how this is any worse than the submitter setting the creator field correctly but filling the actions with garbage.</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [protos/next/fabric_transaction.proto#L34](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric_transaction.proto#L34)<br><strong>Comment</strong>: <pre>"Stealing" endorsed proposals might still happen though... a client submits a proposal, gets an endorsement, than changes their mind and tosses the tx before submitting it. Some malicious entity in the system captures this message (because it is legitimately sent to a bunch of them) and includes it in a transaction of their own. This is the first thing that came to my mind, there might be many others we don't see yet</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [protos/next/fabric_transaction.proto#L34](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric_transaction.proto#L34)<br><strong>Comment</strong>: <pre>That's certainly a valid point,though I would offer a counter proposal.  What if we required that every transaction is endorsed by the proposer? This seems like it would solve the problem of 'stolen' proposals.

If the network wanted to allow 'proxied' proposal submission (where there is a different transaction submitter than proposal creator) then this could still be supported.</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [protos/next/fabric_transaction.proto#L38](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric_transaction.proto#L38)<br><strong>Comment</strong>: <pre>This could use some better documentation, and perhaps should be moved to a different changeset since it is a new message?</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [protos/next/fabric_transaction.proto#L38](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric_transaction.proto#L38)<br><strong>Comment</strong>: <pre>One for Murali</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [protos/next/fabric_transaction.proto#L38](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric_transaction.proto#L38)<br><strong>Comment</strong>: <pre>I copied this from old fabric_next.proto. I believe it was introduced by Manish. will check with him</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [protos/next/fabric_transaction.proto#L38](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric_transaction.proto#L38)<br><strong>Comment</strong>: <pre>During validation of a transaction (at committer) - if a transaction is found invalid, the transaction is not included in the `final` block and this `InvalidTransaction` message is used to report back. The `transaction` field contains the invalidated transaction and the `cause` field  contains the reason of invalidation (e.g., TxIdAlreadyExists or RWConflictDuringCommit)

I had used this message in the `RemoveInvalidTransactionsAndPrepare()` method of `ValidatedLedger` in core/ledger/ledger_interface.go. Not sure how committer wants to use it further.</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [protos/next/fabric_transaction.proto#L53](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric_transaction.proto#L53)<br><strong>Comment</strong>: <pre>Asked above as well, but why only the creator? Why not the other fields?</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [protos/next/fabric_transaction.proto#L53](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric_transaction.proto#L53)<br><strong>Comment</strong>: <pre>undefined</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [protos/next/fabric_transaction.proto#L60](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric_transaction.proto#L60)<br><strong>Comment</strong>: <pre>I assume the addition of the '2' was accidental</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [protos/next/fabric_transaction.proto#L60](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric_transaction.proto#L60)<br><strong>Comment</strong>: <pre>Jason, the 2 is temporary. Currently there's a Transaction in 0.5 proto which is used everywhere in code. As a last step after integration we will get rid of the old Transaction.</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [protos/next/fabric_transaction_header.proto#L33](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric_transaction_header.proto#L33)<br><strong>Comment</strong>: <pre>This refers to a transaction containing a singular header, but it contains multiple.</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [protos/next/fabric_transaction_header.proto#L33](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric_transaction_header.proto#L33)<br><strong>Comment</strong>: <pre>Good catch, it needs to be reworded, I'll do that</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [protos/next/fabric_transaction_header.proto#L33](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric_transaction_header.proto#L33)<br><strong>Comment</strong>: <pre>Based on your other responses, it can't have the same byte-by-byte header because of nonces?</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [protos/next/fabric_transaction_header.proto#L33](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric_transaction_header.proto#L33)<br><strong>Comment</strong>: <pre>The nonce in the proposal can (and should) be reused in the corresponding transaction, that's fine in my understanding</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [protos/next/fabric_transaction_header.proto#L36](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric_transaction_header.proto#L36)<br><strong>Comment</strong>: <pre>I thought we named this TransactionHeader (or at least that was my interpretation) to say that a transaction would have 1 header but might contain multiple proposal/endorsements, which all pointed to the same transaction header. That is simple to understand for me; otherwise it would sound convoluted and confusing to the developers.</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [protos/next/fabric_transaction_header.proto#L57](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric_transaction_header.proto#L57)<br><strong>Comment</strong>: <pre>This confuses me, I thought the creator must be identical for all headers included in a transaction?</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [protos/next/fabric_transaction_header.proto#L57](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric_transaction_header.proto#L57)<br><strong>Comment</strong>: <pre>The point I was trying to make is that given that this message acts as the header for two types of messages, the creator may be the creator of both. In other words: if you have a Header, Header.creator identifies the creator of the encapsulating message, which could be a proposal or a transaction.

With this in mind, how would you change this comment to make it clearer?</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [protos/next/fabric_transaction_header.proto#L65](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric_transaction_header.proto#L65)<br><strong>Comment</strong>: <pre>Also, as a broader comment, we should make our proto style consistent.  Here we are using lowerCamelCase for field names, other places we use UpperCamelCase for field names, and the proto style guide says fields should be lower_underscore_separated.  I strongly believe we should use the proto style, though I've been told the project standard is UpperCamelCase.  Either way, we should be consistent.</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [protos/next/fabric_transaction_header.proto#L65](https://github.com/hyperledger-gerrit-archive/fabric/blob/307c1c7a2be0056e7245eca3f9d901e6e64a5751/protos/next/fabric_transaction_header.proto#L65)<br><strong>Comment</strong>: <pre>Yeah, I've noticed it myself, wanted to bring it up as well. UpperCamelCase everywhere?</pre></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Created</strong>: 10/27/2016, 11:55:53 AM<br><strong>UnmergedRevision</strong>: [427ce3eae32796567ef2763eeaa7dc6c789196af](https://github.com/hyperledger-gerrit-archive/fabric/commit/427ce3eae32796567ef2763eeaa7dc6c789196af)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 10/27/2016, 1:44:25 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 3</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Created</strong>: 10/27/2016, 12:07:48 PM<br><strong>UnmergedRevision</strong>: [42e05412e849c59e6d5d1f970dc6ac9e8b4bc331](https://github.com/hyperledger-gerrit-archive/fabric/commit/42e05412e849c59e6d5d1f970dc6ac9e8b4bc331)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 10/27/2016, 1:07:59 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Approved</strong>: 10/27/2016, 1:36:08 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [protos/next/fabric_transaction_header.proto#L36](https://github.com/hyperledger-gerrit-archive/fabric/blob/42e05412e849c59e6d5d1f970dc6ac9e8b4bc331/protos/next/fabric_transaction_header.proto#L36)<br><strong>Comment</strong>: <pre>I thought we named this TransactionHeader (or at least that was my interpretation) to say that a transaction would have 1 header but might contain multiple proposal/endorsements, which all pointed to the same transaction header. That is simple to understand for me; otherwise it would sound convoluted and confusing to the developers, where each proposal would have a header and the transaction also has a header, but somehow the fields must be the same.</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [protos/next/fabric_transaction_header.proto#L36](https://github.com/hyperledger-gerrit-archive/fabric/blob/42e05412e849c59e6d5d1f970dc6ac9e8b4bc331/protos/next/fabric_transaction_header.proto#L36)<br><strong>Comment</strong>: <pre>I wasn't aware of this. The reason that lead to this rename is that we felt it was weird to have a TransactionHeader in a Proposal. If this message is the header of both a proposal and a transaction, why not just call it Header?</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [protos/next/fabric_transaction_header.proto#L54](https://github.com/hyperledger-gerrit-archive/fabric/blob/42e05412e849c59e6d5d1f970dc6ac9e8b4bc331/protos/next/fabric_transaction_header.proto#L54)<br><strong>Comment</strong>: <pre>transaction  [remove proposal]</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [protos/next/fabric_transaction_header.proto#L54](https://github.com/hyperledger-gerrit-archive/fabric/blob/42e05412e849c59e6d5d1f970dc6ac9e8b4bc331/protos/next/fabric_transaction_header.proto#L54)<br><strong>Comment</strong>: <pre>Whenever this message is used as the header of a proposal, the creator is identifying the entity who submits a proposal, not a transaction.</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [protos/next/fabric_transaction_header.proto#L57](https://github.com/hyperledger-gerrit-archive/fabric/blob/42e05412e849c59e6d5d1f970dc6ac9e8b4bc331/protos/next/fabric_transaction_header.proto#L57)<br><strong>Comment</strong>: <pre>hmm, now we are saying that the header of tx is different from the proposals that are in the tx. I don't think that is what we want. It complicates than simplifies things unnecessarily. Is there a real use-case for this? 
A transactor creates a transaction, which requires endorsements. Why would we have 2 creators for a transaction?</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [protos/next/fabric_transaction_header.proto#L57](https://github.com/hyperledger-gerrit-archive/fabric/blob/42e05412e849c59e6d5d1f970dc6ac9e8b4bc331/protos/next/fabric_transaction_header.proto#L57)<br><strong>Comment</strong>: <pre>I was saying something different. This message structure can act as the header of two different things: a proposal and a transaction. If this header is the header of a proposal, Header.creator is the creator of the proposal. If this header is the header of a transaction, then Header.creator is the creator of the transaction.

How can I rephrase the comments to make it more clear?</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [protos/next/fabric_transaction_header.proto#L57](https://github.com/hyperledger-gerrit-archive/fabric/blob/42e05412e849c59e6d5d1f970dc6ac9e8b4bc331/protos/next/fabric_transaction_header.proto#L57)<br><strong>Comment</strong>: <pre>A transaction has a header and a payload, which depends on the type expressed in the header.  Some type might require endorsements.  Proposal doesn't have a header since it belongs to the transaction and uses its transaction's header.</pre></blockquote><h3>PatchSet Number: 4</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Created</strong>: 10/27/2016, 3:02:14 PM<br><strong>GitHubMergedRevision</strong>: [41e8113a7356d131308f06ba7db4607d384e2040](https://github.com/hyperledger-gerrit-archive/fabric/commit/41e8113a7356d131308f06ba7db4607d384e2040)<br><br><strong>Approver</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Approved</strong>: 10/27/2016, 7:40:21 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>MergedBy</strong>: Srinivasan Muralidharan<br><strong>Merged</strong>: 10/27/2016, 7:40:34 PM<br><br><strong>Approver</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Approved</strong>: 10/27/2016, 7:40:21 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Approved</strong>: 10/27/2016, 6:42:27 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br></blockquote>
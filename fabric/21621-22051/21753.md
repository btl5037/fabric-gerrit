<strong>Project</strong>: fabric<br><strong>Branch</strong>: master<br><strong>ID</strong>: 21753<br><strong>Subject</strong>: [FAB-7779] CouchDB indexes for private data<br><strong>Status</strong>: MERGED<br><strong>Owner</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Assignee</strong>:<br><strong>Created</strong>: 5/14/2018, 10:11:51 AM<br><strong>LastUpdated</strong>: 5/21/2018, 2:29:52 PM<br><strong>CommitMessage</strong>:<br><pre>[FAB-7779] CouchDB indexes for private data

Any couchdb indexes defined for a chaincode will be deployed in
the chaincode state database.  Indexes for collections of private
data should be applied in the chaincode's collection state database
rather than in the chaincode state database.

Added support for HandleChaincodeDeploy event to common_storage_db.  This
will now process the event from chain code deploy.  The move was necessary
for handling the private data namespace mapping.

Added new function to statecouchdb for processing index creation.

Added new interface to statedb for IndexCapable.  This allows the
common_storage_db to detect that the state database will accept index
creation events.

Updated index validation to allow for indexes under collections directories.

Change-Id: Icfda923c584d953ce5886023f7411bbddb59d595
Signed-off-by: Chris Elder <chris.elder@us.ibm.com>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Reviewed</strong>: 5/14/2018, 10:11:51 AM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/14/2018, 10:14:10 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/1626/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/14/2018, 10:14:30 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/14/2018, 10:18:42 AM<br><strong>Message</strong>: <pre>Patch Set 1: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run SmokeTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/14/2018, 10:19:02 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/1626/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/1626</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/14/2018, 10:21:01 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1100/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/14/2018, 10:21:28 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Starting smoke tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/14/2018, 10:33:28 AM<br><strong>Message</strong>: <pre>Patch Set 1: F2-SmokeTest+1

Succeeded, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/14/2018, 10:36:31 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/1866/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/14/2018, 10:37:00 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/14/2018, 10:44:15 AM<br><strong>Message</strong>: <pre>Patch Set 1: F3-UnitTest-1

Failed</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/14/2018, 10:44:53 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/1866/ : FAILURE (skipped)

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/1866/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/1866

https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1100/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-smoke-tests-x86_64/1100</pre><strong>Reviewer</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Reviewed</strong>: 5/14/2018, 8:41:43 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/14/2018, 8:43:58 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/1914/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/14/2018, 8:44:26 PM<br><strong>Message</strong>: <pre>Patch Set 1: -F3-UnitTest

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/14/2018, 8:50:16 PM<br><strong>Message</strong>: <pre>Patch Set 1: F3-UnitTest-1

Failed</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/14/2018, 8:50:44 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/1914/ : FAILURE (skipped)

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/1914/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/1914</pre><strong>Reviewer</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Reviewed</strong>: 5/15/2018, 1:53:02 PM<br><strong>Message</strong>: <pre>Uploaded patch set 2.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/15/2018, 1:56:01 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/1711/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/15/2018, 1:56:24 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/15/2018, 2:01:55 PM<br><strong>Message</strong>: <pre>Patch Set 2: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run SmokeTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/15/2018, 2:02:20 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/1711/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/1711</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/15/2018, 2:06:49 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1149/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/15/2018, 2:07:17 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Starting smoke tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/15/2018, 2:17:12 PM<br><strong>Message</strong>: <pre>Patch Set 2: F2-SmokeTest+1

Succeeded, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/15/2018, 2:21:12 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/1949/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/15/2018, 2:21:34 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/15/2018, 2:34:49 PM<br><strong>Message</strong>: <pre>Patch Set 2: F3-UnitTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/15/2018, 2:35:21 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1149/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-smoke-tests-x86_64/1149

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/1949/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/1949</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 5/15/2018, 4:03:42 PM<br><strong>Message</strong>: <pre>Patch Set 2:

(13 comments)

Chris, overall looks good. A few minor refactoring kind of comments.
I haven't looked the test file yet...</pre><strong>Reviewer</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Reviewed</strong>: 5/17/2018, 11:16:38 AM<br><strong>Message</strong>: <pre>Uploaded patch set 3.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/17/2018, 11:18:44 AM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/1802/</pre><strong>Reviewer</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Reviewed</strong>: 5/17/2018, 11:18:57 AM<br><strong>Message</strong>: <pre>Patch Set 3:

(13 comments)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/17/2018, 11:19:14 AM<br><strong>Message</strong>: <pre>Patch Set 3:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/17/2018, 11:24:52 AM<br><strong>Message</strong>: <pre>Patch Set 3: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run SmokeTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/17/2018, 11:25:14 AM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/1802/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/1802</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/17/2018, 11:27:48 AM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1222/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/17/2018, 11:28:18 AM<br><strong>Message</strong>: <pre>Patch Set 3:

Starting smoke tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/17/2018, 11:40:59 AM<br><strong>Message</strong>: <pre>Patch Set 3: F2-SmokeTest+1

Succeeded, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/17/2018, 11:41:08 AM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2047/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/17/2018, 11:41:36 AM<br><strong>Message</strong>: <pre>Patch Set 3:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/17/2018, 11:56:45 AM<br><strong>Message</strong>: <pre>Patch Set 3: F3-UnitTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/17/2018, 11:57:25 AM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1222/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-smoke-tests-x86_64/1222

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2047/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/2047</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 5/17/2018, 3:17:41 PM<br><strong>Message</strong>: <pre>Patch Set 3: Code-Review+2

(3 comments)

Chris, I am good with the changes but this needs some more work at tests level. That you can fix in a separate CR if you want.

Also, including Murali and Matt if they are fine with a small change in lscc.go.</pre><strong>Reviewer</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Reviewed</strong>: 5/17/2018, 3:48:44 PM<br><strong>Message</strong>: <pre>Patch Set 3: Code-Review-1

(13 comments)

A few things that I'm curious about before I'm comfortable with +1.</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 5/17/2018, 6:11:38 PM<br><strong>Message</strong>: <pre>Patch Set 3:

(1 comment)</pre><strong>Reviewer</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Reviewed</strong>: 5/18/2018, 11:45:05 AM<br><strong>Message</strong>: <pre>Uploaded patch set 4.</pre><strong>Reviewer</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Reviewed</strong>: 5/18/2018, 11:47:14 AM<br><strong>Message</strong>: <pre>Patch Set 3:

(16 comments)

Added unit tests for commondb and handle chain code deploy.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 11:47:18 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/1834/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 11:47:41 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 11:52:45 AM<br><strong>Message</strong>: <pre>Patch Set 4: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run SmokeTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 11:53:09 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/1834/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/1834</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 11:54:06 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1239/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 11:54:31 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Starting smoke tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 12:04:13 PM<br><strong>Message</strong>: <pre>Patch Set 4: F2-SmokeTest+1

Succeeded, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 12:05:36 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2075/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 12:05:59 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 12:11:32 PM<br><strong>Message</strong>: <pre>Patch Set 4: F3-UnitTest-1

Failed</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 12:11:55 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2075/ : FAILURE (skipped)

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2075/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/2075

https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1239/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-smoke-tests-x86_64/1239</pre><strong>Reviewer</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Reviewed</strong>: 5/18/2018, 12:34:29 PM<br><strong>Message</strong>: <pre>Patch Set 4:

(6 comments)</pre><strong>Reviewer</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Reviewed</strong>: 5/18/2018, 2:25:52 PM<br><strong>Message</strong>: <pre>Uploaded patch set 5.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 2:27:50 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/1841/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 2:28:07 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 2:32:47 PM<br><strong>Message</strong>: <pre>Patch Set 5: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run SmokeTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 2:33:09 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/1841/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/1841</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 2:34:57 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1242/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 2:35:23 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Starting smoke tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 2:49:29 PM<br><strong>Message</strong>: <pre>Patch Set 5: F2-SmokeTest+1

Succeeded, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 2:52:10 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2080/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 2:52:35 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 2:57:53 PM<br><strong>Message</strong>: <pre>Patch Set 5: F3-UnitTest-1

Failed</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 2:58:28 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2080/ : FAILURE (skipped)

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2080/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/2080

https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1242/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-smoke-tests-x86_64/1242</pre><strong>Reviewer</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Reviewed</strong>: 5/18/2018, 3:31:00 PM<br><strong>Message</strong>: <pre>Uploaded patch set 6.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 3:35:52 PM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/1849/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 3:36:13 PM<br><strong>Message</strong>: <pre>Patch Set 6:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 3:40:53 PM<br><strong>Message</strong>: <pre>Patch Set 6: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run SmokeTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 3:41:16 PM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/1849/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/1849</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 3:45:06 PM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1246/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 3:45:31 PM<br><strong>Message</strong>: <pre>Patch Set 6:

Starting smoke tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 3:55:18 PM<br><strong>Message</strong>: <pre>Patch Set 6: F2-SmokeTest+1

Succeeded, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 3:56:50 PM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2083/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 3:57:13 PM<br><strong>Message</strong>: <pre>Patch Set 6:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 4:03:03 PM<br><strong>Message</strong>: <pre>Patch Set 6: F3-UnitTest-1

Failed</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 4:03:28 PM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2083/ : FAILURE (skipped)

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2083/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/2083

https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1246/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-smoke-tests-x86_64/1246</pre><strong>Reviewer</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Reviewed</strong>: 5/18/2018, 4:26:52 PM<br><strong>Message</strong>: <pre>Uploaded patch set 7.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 4:27:44 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/1857/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 4:28:07 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 4:33:03 PM<br><strong>Message</strong>: <pre>Patch Set 7: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run SmokeTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 4:33:27 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/1857/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/1857</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 4:35:18 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1248/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 4:35:50 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Starting smoke tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 4:47:48 PM<br><strong>Message</strong>: <pre>Patch Set 7: F2-SmokeTest+1

Succeeded, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 4:49:54 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2085/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 4:50:19 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 5:05:02 PM<br><strong>Message</strong>: <pre>Patch Set 7: F3-UnitTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2018, 5:05:24 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1248/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-smoke-tests-x86_64/1248

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2085/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/2085</pre><strong>Reviewer</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Reviewed</strong>: 5/18/2018, 5:12:10 PM<br><strong>Message</strong>: <pre>Patch Set 7: Code-Review+1</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 5/19/2018, 3:49:26 PM<br><strong>Message</strong>: <pre>Patch Set 7: Code-Review+2

(7 comments)

Chris, I am good to merge this. However, would like to see some more cleanups in case if you want to fix them in a separate CR</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 5/19/2018, 4:01:26 PM<br><strong>Message</strong>: <pre>Patch Set 7:

(1 comment)</pre><strong>Reviewer</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>Reviewed</strong>: 5/19/2018, 9:43:34 PM<br><strong>Message</strong>: <pre>Patch Set 7: Code-Review-1

Discussing with Chris... there is a file extractor in LSCC during chaincode install that still looks for the prior path of "META-INF/statedb/couchdb/indexes" only.  Need to extend the file extractor to include the new collection indexes as well.</pre><strong>Reviewer</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>Reviewed</strong>: 5/20/2018, 6:08:55 AM<br><strong>Message</strong>: <pre>Patch Set 7: Code-Review-2

(1 comment)

Doesn't work end to end, see comments inline.</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 5/20/2018, 11:30:57 AM<br><strong>Message</strong>: <pre>Patch Set 7: -Code-Review

(1 comment)</pre><strong>Reviewer</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>Reviewed</strong>: 5/20/2018, 11:51:18 AM<br><strong>Message</strong>: <pre>Patch Set 7:

(1 comment)</pre><strong>Reviewer</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Reviewed</strong>: 5/20/2018, 2:24:54 PM<br><strong>Message</strong>: <pre>Patch Set 7:

(13 comments)</pre><strong>Reviewer</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Reviewed</strong>: 5/20/2018, 2:26:00 PM<br><strong>Message</strong>: <pre>Patch Set 7:

I think some of my comments with the patch are interleaved with Dave and Manish's.</pre><strong>Reviewer</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Reviewed</strong>: 5/20/2018, 2:32:49 PM<br><strong>Message</strong>: <pre>Uploaded patch set 8.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/20/2018, 2:36:09 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/1886/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/20/2018, 2:36:26 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/20/2018, 2:41:19 PM<br><strong>Message</strong>: <pre>Patch Set 8: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run SmokeTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/20/2018, 2:41:41 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/1886/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/1886</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/20/2018, 2:43:03 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1272/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/20/2018, 2:43:27 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Starting smoke tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/20/2018, 2:53:26 PM<br><strong>Message</strong>: <pre>Patch Set 8: F2-SmokeTest+1

Succeeded, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/20/2018, 2:56:39 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2108/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/20/2018, 2:56:58 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/20/2018, 3:10:23 PM<br><strong>Message</strong>: <pre>Patch Set 8: F3-UnitTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/20/2018, 3:10:46 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1272/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-smoke-tests-x86_64/1272

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2108/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/2108</pre><strong>Reviewer</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Reviewed</strong>: 5/20/2018, 3:59:59 PM<br><strong>Message</strong>: <pre>Uploaded patch set 9.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/20/2018, 4:03:19 PM<br><strong>Message</strong>: <pre>Patch Set 9:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/1889/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/20/2018, 4:03:40 PM<br><strong>Message</strong>: <pre>Patch Set 9:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/20/2018, 4:08:32 PM<br><strong>Message</strong>: <pre>Patch Set 9: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run SmokeTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/20/2018, 4:08:54 PM<br><strong>Message</strong>: <pre>Patch Set 9:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/1889/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/1889</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/20/2018, 4:11:24 PM<br><strong>Message</strong>: <pre>Patch Set 9:

Build Started https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1274/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/20/2018, 4:11:49 PM<br><strong>Message</strong>: <pre>Patch Set 9:

Starting smoke tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/20/2018, 4:21:46 PM<br><strong>Message</strong>: <pre>Patch Set 9: F2-SmokeTest+1

Succeeded, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/20/2018, 4:23:23 PM<br><strong>Message</strong>: <pre>Patch Set 9:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2112/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/20/2018, 4:23:47 PM<br><strong>Message</strong>: <pre>Patch Set 9:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/20/2018, 4:37:48 PM<br><strong>Message</strong>: <pre>Patch Set 9: F3-UnitTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/20/2018, 4:38:16 PM<br><strong>Message</strong>: <pre>Patch Set 9:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1274/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-smoke-tests-x86_64/1274

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2112/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/2112</pre><strong>Reviewer</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Reviewed</strong>: 5/20/2018, 5:00:39 PM<br><strong>Message</strong>: <pre>Patch Set 9:

Added a small change to lscc. 

Passing in an empty string for the database type will return all artifacts and remove any couchdb specific code in lscc.  

This also will provide a future path to validate all entries in the archive and still allow database specific retrieval in the handle deployments.</pre><strong>Reviewer</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Reviewed</strong>: 5/20/2018, 5:02:53 PM<br><strong>Message</strong>: <pre>Uploaded patch set 10.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/20/2018, 5:04:49 PM<br><strong>Message</strong>: <pre>Patch Set 10:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/1891/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/20/2018, 5:05:10 PM<br><strong>Message</strong>: <pre>Patch Set 10:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/20/2018, 5:10:03 PM<br><strong>Message</strong>: <pre>Patch Set 10: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run SmokeTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/20/2018, 5:10:25 PM<br><strong>Message</strong>: <pre>Patch Set 10:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/1891/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/1891</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/20/2018, 5:13:41 PM<br><strong>Message</strong>: <pre>Patch Set 10:

Build Started https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1276/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/20/2018, 5:14:12 PM<br><strong>Message</strong>: <pre>Patch Set 10:

Starting smoke tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/20/2018, 5:30:05 PM<br><strong>Message</strong>: <pre>Patch Set 10: F2-SmokeTest+1

Succeeded, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/20/2018, 5:31:50 PM<br><strong>Message</strong>: <pre>Patch Set 10:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2114/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/20/2018, 5:32:12 PM<br><strong>Message</strong>: <pre>Patch Set 10:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/20/2018, 5:45:26 PM<br><strong>Message</strong>: <pre>Patch Set 10: F3-UnitTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/20/2018, 5:45:51 PM<br><strong>Message</strong>: <pre>Patch Set 10:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1276/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-smoke-tests-x86_64/1276

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2114/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/2114</pre><strong>Reviewer</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>Reviewed</strong>: 5/20/2018, 10:25:04 PM<br><strong>Message</strong>: <pre>Patch Set 10: -Code-Review

(10 comments)</pre><strong>Reviewer</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>Reviewed</strong>: 5/20/2018, 10:26:07 PM<br><strong>Message</strong>: <pre>Patch Set 10:

Removing -2 as this now works e2e. Remaining comments are more minor.</pre><strong>Reviewer</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Reviewed</strong>: 5/21/2018, 10:56:57 AM<br><strong>Message</strong>: <pre>Uploaded patch set 11.</pre><strong>Reviewer</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Reviewed</strong>: 5/21/2018, 10:57:16 AM<br><strong>Message</strong>: <pre>Patch Set 11:

(9 comments)</pre><strong>Reviewer</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Reviewed</strong>: 5/21/2018, 10:58:00 AM<br><strong>Message</strong>: <pre>Patch Set 11:

(1 comment)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/21/2018, 10:59:16 AM<br><strong>Message</strong>: <pre>Patch Set 11:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/1911/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/21/2018, 10:59:38 AM<br><strong>Message</strong>: <pre>Patch Set 11:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/21/2018, 11:04:52 AM<br><strong>Message</strong>: <pre>Patch Set 11: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run SmokeTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/21/2018, 11:05:16 AM<br><strong>Message</strong>: <pre>Patch Set 11:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/1911/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/1911</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/21/2018, 11:07:57 AM<br><strong>Message</strong>: <pre>Patch Set 11:

Build Started https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1286/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/21/2018, 11:08:16 AM<br><strong>Message</strong>: <pre>Patch Set 11:

Starting smoke tests</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 5/21/2018, 11:18:01 AM<br><strong>Message</strong>: <pre>Patch Set 10:

(1 comment)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/21/2018, 11:18:04 AM<br><strong>Message</strong>: <pre>Patch Set 11: F2-SmokeTest+1

Succeeded, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/21/2018, 11:18:11 AM<br><strong>Message</strong>: <pre>Patch Set 11:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2128/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/21/2018, 11:18:40 AM<br><strong>Message</strong>: <pre>Patch Set 11:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/21/2018, 11:25:06 AM<br><strong>Message</strong>: <pre>Patch Set 11: F3-UnitTest-1

Failed</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/21/2018, 11:25:31 AM<br><strong>Message</strong>: <pre>Patch Set 11:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2128/ : FAILURE (skipped)

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2128/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/2128

https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1286/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-smoke-tests-x86_64/1286</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 5/21/2018, 11:52:29 AM<br><strong>Message</strong>: <pre>Patch Set 7:

(4 comments)

Chris, just a few comments that are mainly meant for future refactoring after 1.2...</pre><strong>Reviewer</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Reviewed</strong>: 5/21/2018, 1:09:57 PM<br><strong>Message</strong>: <pre>Uploaded patch set 12.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/21/2018, 1:11:29 PM<br><strong>Message</strong>: <pre>Patch Set 12:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/1914/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/21/2018, 1:11:49 PM<br><strong>Message</strong>: <pre>Patch Set 12:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/21/2018, 1:16:33 PM<br><strong>Message</strong>: <pre>Patch Set 12: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run SmokeTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/21/2018, 1:16:53 PM<br><strong>Message</strong>: <pre>Patch Set 12:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/1914/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/1914</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/21/2018, 1:18:04 PM<br><strong>Message</strong>: <pre>Patch Set 12:

Build Started https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1290/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/21/2018, 1:18:35 PM<br><strong>Message</strong>: <pre>Patch Set 12:

Starting smoke tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/21/2018, 1:33:30 PM<br><strong>Message</strong>: <pre>Patch Set 12: F2-SmokeTest+1

Succeeded, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/21/2018, 1:37:07 PM<br><strong>Message</strong>: <pre>Patch Set 12:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2131/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/21/2018, 1:37:29 PM<br><strong>Message</strong>: <pre>Patch Set 12:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/21/2018, 1:52:12 PM<br><strong>Message</strong>: <pre>Patch Set 12: F3-UnitTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/21/2018, 1:52:50 PM<br><strong>Message</strong>: <pre>Patch Set 12:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/1290/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-smoke-tests-x86_64/1290

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/2131/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/2131</pre><strong>Reviewer</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>Reviewed</strong>: 5/21/2018, 1:58:20 PM<br><strong>Message</strong>: <pre>Patch Set 12: Code-Review+2</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 5/21/2018, 2:11:11 PM<br><strong>Message</strong>: <pre>Patch Set 12: Code-Review+2</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 5/21/2018, 2:11:20 PM<br><strong>Message</strong>: <pre>Change has been successfully merged by Manish Sethi</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/21/2018, 2:13:23 PM<br><strong>Message</strong>: <pre>Patch Set 12:

Build Started https://jenkins.hyperledger.org/job/fabric-merge-x86_64/3867/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/21/2018, 2:14:17 PM<br><strong>Message</strong>: <pre>Patch Set 12:

Build Started https://jenkins.hyperledger.org/job/fabric-merge-end-2-end-x86_64/2538/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/21/2018, 2:29:52 PM<br><strong>Message</strong>: <pre>Patch Set 12:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-merge-end-2-end-x86_64/2538/ : FAILURE (skipped)

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-merge-end-2-end-x86_64/2538/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-merge-end-2-end-x86_64/2538

https://jenkins.hyperledger.org/job/fabric-merge-x86_64/3867/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-merge-x86_64/3867</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Uploader</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Created</strong>: 5/14/2018, 10:11:51 AM<br><strong>UnmergedRevision</strong>: [7b9ea4e87ded8f83ee368af5a3b854cb2c4e478d](https://github.com/hyperledger-gerrit-archive/fabric/commit/7b9ea4e87ded8f83ee368af5a3b854cb2c4e478d)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/14/2018, 10:18:42 AM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/14/2018, 10:18:42 AM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/14/2018, 10:33:28 AM<br><strong>Type</strong>: F2-SmokeTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/14/2018, 8:50:16 PM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Uploader</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Created</strong>: 5/15/2018, 1:53:02 PM<br><strong>UnmergedRevision</strong>: [99d3c4269812878f6b4826f4c32f9b3382854b70](https://github.com/hyperledger-gerrit-archive/fabric/commit/99d3c4269812878f6b4826f4c32f9b3382854b70)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/15/2018, 2:01:55 PM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/15/2018, 2:01:55 PM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/15/2018, 2:17:12 PM<br><strong>Type</strong>: F2-SmokeTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/15/2018, 2:34:49 PM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L24](https://github.com/hyperledger-gerrit-archive/fabric/blob/99d3c4269812878f6b4826f4c32f9b3382854b70/core/chaincode/platforms/ccmetadata/validators.go#L24)<br><strong>Comment</strong>: <pre>Better to define a constant for valid collection names pattern. As per another jira, lscc will also validate the names of the collection during chaincode deploy. So, we should define at a common place.

Further, as we are putting same naming restrictions as of chaincode (as per another jira), the chaincode naming rules allow '_', '-' as well. (https://github.com/hyperledger/fabric/blob/master/core/scc/lscc/lscc.go#L72.). Allowing same naming restriction will be easier for docs to consume as well.

Can you define an exported constant in lscc.go 
as "AllowedCharsCollectionName = allowedCharsChaincodeName" and use that here?</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L24](https://github.com/hyperledger-gerrit-archive/fabric/blob/99d3c4269812878f6b4826f4c32f9b3382854b70/core/chaincode/platforms/ccmetadata/validators.go#L24)<br><strong>Comment</strong>: <pre>Defining in lscc causes a dependency cycle.   I created the public variable inside ccmetadata, the referenced the variable in lscc.</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L59](https://github.com/hyperledger-gerrit-archive/fabric/blob/99d3c4269812878f6b4826f4c32f9b3382854b70/core/chaincode/platforms/ccmetadata/validators.go#L59)<br><strong>Comment</strong>: <pre>passing this argument seems unnecessary. It's var above in the same file. The called function can directly access this.</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L59](https://github.com/hyperledger-gerrit-archive/fabric/blob/99d3c4269812878f6b4826f4c32f9b3382854b70/core/chaincode/platforms/ccmetadata/validators.go#L59)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L76](https://github.com/hyperledger-gerrit-archive/fabric/blob/99d3c4269812878f6b4826f4c32f9b3382854b70/core/chaincode/platforms/ccmetadata/validators.go#L76)<br><strong>Comment</strong>: <pre>the second return type seems redundant. A nil check can work for the caller. For instance, this function doesn't return "nil, true" or "validator, false".</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L76](https://github.com/hyperledger-gerrit-archive/fabric/blob/99d3c4269812878f6b4826f4c32f9b3382854b70/core/chaincode/platforms/ccmetadata/validators.go#L76)<br><strong>Comment</strong>: <pre>want to rename to 'selectFileValidator'.?</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L76](https://github.com/hyperledger-gerrit-archive/fabric/blob/99d3c4269812878f6b4826f4c32f9b3382854b70/core/chaincode/platforms/ccmetadata/validators.go#L76)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L76](https://github.com/hyperledger-gerrit-archive/fabric/blob/99d3c4269812878f6b4826f4c32f9b3382854b70/core/chaincode/platforms/ccmetadata/validators.go#L76)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L80](https://github.com/hyperledger-gerrit-archive/fabric/blob/99d3c4269812878f6b4826f4c32f9b3382854b70/core/chaincode/platforms/ccmetadata/validators.go#L80)<br><strong>Comment</strong>: <pre>better to precompile once in a var in this file above</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L80](https://github.com/hyperledger-gerrit-archive/fabric/blob/99d3c4269812878f6b4826f4c32f9b3382854b70/core/chaincode/platforms/ccmetadata/validators.go#L80)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L131](https://github.com/hyperledger-gerrit-archive/fabric/blob/99d3c4269812878f6b4826f4c32f9b3382854b70/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L131)<br><strong>Comment</strong>: <pre>you want to use here the new interface 'IndexCapable...'. Like you do below at line 207</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L131](https://github.com/hyperledger-gerrit-archive/fabric/blob/99d3c4269812878f6b4826f4c32f9b3382854b70/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L131)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L233](https://github.com/hyperledger-gerrit-archive/fabric/blob/99d3c4269812878f6b4826f4c32f9b3382854b70/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L233)<br><strong>Comment</strong>: <pre>This can be removed - see comment in the below function.</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L233](https://github.com/hyperledger-gerrit-archive/fabric/blob/99d3c4269812878f6b4826f4c32f9b3382854b70/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L233)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L261](https://github.com/hyperledger-gerrit-archive/fabric/blob/99d3c4269812878f6b4826f4c32f9b3382854b70/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L261)<br><strong>Comment</strong>: <pre>See the comment below.. I think that its better to make this function as retrieveIndexArtifacts.</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L261](https://github.com/hyperledger-gerrit-archive/fabric/blob/99d3c4269812878f6b4826f4c32f9b3382854b70/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L261)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L285](https://github.com/hyperledger-gerrit-archive/fabric/blob/99d3c4269812878f6b4826f4c32f9b3382854b70/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L285)<br><strong>Comment</strong>: <pre>I would prefer to swap the condition check around && because, you access [2] in the array and that will be safer after checking the length. [- Although, we are safe given the path scheme we have in place].</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L285](https://github.com/hyperledger-gerrit-archive/fabric/blob/99d3c4269812878f6b4826f4c32f9b3382854b70/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L285)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L286](https://github.com/hyperledger-gerrit-archive/fabric/blob/99d3c4269812878f6b4826f4c32f9b3382854b70/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L286)<br><strong>Comment</strong>: <pre>Instead of adding just the path here, it is better to include the tar file content as well (instead of bool in the value portion of map). Because, anyways you have already iterated through the tar file and there is no point just sending the names of the entries and then in the caller, pulling those entries by passing a filer of this name.</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L286](https://github.com/hyperledger-gerrit-archive/fabric/blob/99d3c4269812878f6b4826f4c32f9b3382854b70/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L286)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb.go#L30](https://github.com/hyperledger-gerrit-archive/fabric/blob/99d3c4269812878f6b4826f4c32f9b3382854b70/core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb.go#L30)<br><strong>Comment</strong>: <pre>Forgot to remove this commented line?</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb.go#L30](https://github.com/hyperledger-gerrit-archive/fabric/blob/99d3c4269812878f6b4826f4c32f9b3382854b70/core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb.go#L30)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb.go#L151](https://github.com/hyperledger-gerrit-archive/fabric/blob/99d3c4269812878f6b4826f4c32f9b3382854b70/core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb.go#L151)<br><strong>Comment</strong>: <pre>Do we still need these functions here? Because, now commonstatedb is just going to check for the other interface that you introduced - 'IndexCapable...'</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb.go#L151](https://github.com/hyperledger-gerrit-archive/fabric/blob/99d3c4269812878f6b4826f4c32f9b3382854b70/core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb.go#L151)<br><strong>Comment</strong>: <pre>Very good catch.   Missed that one completely.  New interface cleaned things up quite a bit.</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/statedb/statedb.go#L68](https://github.com/hyperledger-gerrit-archive/fabric/blob/99d3c4269812878f6b4826f4c32f9b3382854b70/core/ledger/kvledger/txmgmt/statedb/statedb.go#L68)<br><strong>Comment</strong>: <pre>Adding this new interface here for a restricted communication between commonstatedb and a specific impl is a good choice - thanks.</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/statedb/statedb.go#L68](https://github.com/hyperledger-gerrit-archive/fabric/blob/99d3c4269812878f6b4826f4c32f9b3382854b70/core/ledger/kvledger/txmgmt/statedb/statedb.go#L68)<br><strong>Comment</strong>: <pre>Manish,  thank you for the feedback.  I looked at several solutions and this seemed to be the most clean.</pre></blockquote><h3>PatchSet Number: 3</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Uploader</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Created</strong>: 5/17/2018, 11:16:38 AM<br><strong>UnmergedRevision</strong>: [5cc4988d6e27463755324482d4ae74313c475790](https://github.com/hyperledger-gerrit-archive/fabric/commit/5cc4988d6e27463755324482d4ae74313c475790)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/17/2018, 11:24:52 AM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/17/2018, 11:24:52 AM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/17/2018, 11:40:59 AM<br><strong>Type</strong>: F2-SmokeTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/17/2018, 11:56:45 AM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Approved</strong>: 5/17/2018, 3:17:41 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Approved</strong>: 5/17/2018, 3:48:44 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L23](https://github.com/hyperledger-gerrit-archive/fabric/blob/5cc4988d6e27463755324482d4ae74313c475790/core/chaincode/platforms/ccmetadata/validators.go#L23)<br><strong>Comment</strong>: <pre>Why has the question mark been added? It now matches on "indexe" and "indexes" - not sure I understand.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L23](https://github.com/hyperledger-gerrit-archive/fabric/blob/5cc4988d6e27463755324482d4ae74313c475790/core/chaincode/platforms/ccmetadata/validators.go#L23)<br><strong>Comment</strong>: <pre>Is an anchor needed here for beginning of the string? This would match on MY-META-INF/statedb/couchdb/indexes.</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L23](https://github.com/hyperledger-gerrit-archive/fabric/blob/5cc4988d6e27463755324482d4ae74313c475790/core/chaincode/platforms/ccmetadata/validators.go#L23)<br><strong>Comment</strong>: <pre>Thanks Matt for catching this. I missed this change of '?'
Chris, if I am not mistaken, the tight pattern ideally will be - "^META-INF/statedb/couchdb/indexes/.*[.]json"</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L23](https://github.com/hyperledger-gerrit-archive/fabric/blob/5cc4988d6e27463755324482d4ae74313c475790/core/chaincode/platforms/ccmetadata/validators.go#L23)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L23](https://github.com/hyperledger-gerrit-archive/fabric/blob/5cc4988d6e27463755324482d4ae74313c475790/core/chaincode/platforms/ccmetadata/validators.go#L23)<br><strong>Comment</strong>: <pre>Corrected</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L23](https://github.com/hyperledger-gerrit-archive/fabric/blob/5cc4988d6e27463755324482d4ae74313c475790/core/chaincode/platforms/ccmetadata/validators.go#L23)<br><strong>Comment</strong>: <pre>Corrected</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L63](https://github.com/hyperledger-gerrit-archive/fabric/blob/5cc4988d6e27463755324482d4ae74313c475790/core/chaincode/platforms/ccmetadata/validators.go#L63)<br><strong>Comment</strong>: <pre>errors should not include messages that are capitalized</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L63](https://github.com/hyperledger-gerrit-archive/fabric/blob/5cc4988d6e27463755324482d4ae74313c475790/core/chaincode/platforms/ccmetadata/validators.go#L63)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L99](https://github.com/hyperledger-gerrit-archive/fabric/blob/5cc4988d6e27463755324482d4ae74313c475790/core/chaincode/platforms/ccmetadata/validators.go#L99)<br><strong>Comment</strong>: <pre>Errors should not include messages that are capitalized.</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L99](https://github.com/hyperledger-gerrit-archive/fabric/blob/5cc4988d6e27463755324482d4ae74313c475790/core/chaincode/platforms/ccmetadata/validators.go#L99)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L36](https://github.com/hyperledger-gerrit-archive/fabric/blob/5cc4988d6e27463755324482d4ae74313c475790/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L36)<br><strong>Comment</strong>: <pre>these offer little value and are very confusing when referenced in the code.</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L36](https://github.com/hyperledger-gerrit-archive/fabric/blob/5cc4988d6e27463755324482d4ae74313c475790/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L36)<br><strong>Comment</strong>: <pre>Removed</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L205](https://github.com/hyperledger-gerrit-archive/fabric/blob/5cc4988d6e27463755324482d4ae74313c475790/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L205)<br><strong>Comment</strong>: <pre>Now since this function is moved here. It will be worth a unit test in this package that includes the chaincode and collection level indexes.</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L205](https://github.com/hyperledger-gerrit-archive/fabric/blob/5cc4988d6e27463755324482d4ae74313c475790/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L205)<br><strong>Comment</strong>: <pre>Added unit tests</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L215](https://github.com/hyperledger-gerrit-archive/fabric/blob/5cc4988d6e27463755324482d4ae74313c475790/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L215)<br><strong>Comment</strong>: <pre>"found nil?" Why not "chaincode definition not found"?</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L215](https://github.com/hyperledger-gerrit-archive/fabric/blob/5cc4988d6e27463755324482d4ae74313c475790/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L215)<br><strong>Comment</strong>: <pre>That is a much better message</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L220](https://github.com/hyperledger-gerrit-archive/fabric/blob/5cc4988d6e27463755324482d4ae74313c475790/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L220)<br><strong>Comment</strong>: <pre>Strings in errors shouldn't be capitalized. Also, I haven't spent a lot of time in this package. Should we be using pkg/errors instead of fmt.Errorf?</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L220](https://github.com/hyperledger-gerrit-archive/fabric/blob/5cc4988d6e27463755324482d4ae74313c475790/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L220)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L252](https://github.com/hyperledger-gerrit-archive/fabric/blob/5cc4988d6e27463755324482d4ae74313c475790/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L252)<br><strong>Comment</strong>: <pre>Are there tests? I don't see them.</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L252](https://github.com/hyperledger-gerrit-archive/fabric/blob/5cc4988d6e27463755324482d4ae74313c475790/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L252)<br><strong>Comment</strong>: <pre>Unit tests added</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb.go#L117](https://github.com/hyperledger-gerrit-archive/fabric/blob/5cc4988d6e27463755324482d4ae74313c475790/core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb.go#L117)<br><strong>Comment</strong>: <pre>Space after comment delimiter. The idea (even if it's not done in our code) is that "// " implies a comment while "//directive" is for tooling directives like "//go:generate ..."</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb.go#L117](https://github.com/hyperledger-gerrit-archive/fabric/blob/5cc4988d6e27463755324482d4ae74313c475790/core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb.go#L117)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb.go#L130](https://github.com/hyperledger-gerrit-archive/fabric/blob/5cc4988d6e27463755324482d4ae74313c475790/core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb.go#L130)<br><strong>Comment</strong>: <pre>error strings shouldn't be capitalized</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb.go#L130](https://github.com/hyperledger-gerrit-archive/fabric/blob/5cc4988d6e27463755324482d4ae74313c475790/core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb.go#L130)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb_test.go#L349](https://github.com/hyperledger-gerrit-archive/fabric/blob/5cc4988d6e27463755324482d4ae74313c475790/core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb_test.go#L349)<br><strong>Comment</strong>: <pre>I had added this check explicitly in the test because once mistakenly some how the function signature got changed and this test passed.</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb_test.go#L370](https://github.com/hyperledger-gerrit-archive/fabric/blob/5cc4988d6e27463755324482d4ae74313c475790/core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb_test.go#L370)<br><strong>Comment</strong>: <pre>Do you plan to move these tests to commondb package now?</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb_test.go#L370](https://github.com/hyperledger-gerrit-archive/fabric/blob/5cc4988d6e27463755324482d4ae74313c475790/core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb_test.go#L370)<br><strong>Comment</strong>: <pre>These have been moved to the commondb package</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb_test.go#L347](https://github.com/hyperledger-gerrit-archive/fabric/blob/5cc4988d6e27463755324482d4ae74313c475790/core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb_test.go#L347)<br><strong>Comment</strong>: <pre>why the extra block 347-357?</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb_test.go#L347](https://github.com/hyperledger-gerrit-archive/fabric/blob/5cc4988d6e27463755324482d4ae74313c475790/core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb_test.go#L347)<br><strong>Comment</strong>: <pre>The handle db implements the VersionedDB interface.  The ProcessIndexesForChaincodeDeploy is part of the IndexCapable interface and is only used by databases that make use of indexes.   The extra block is need to cast the db handle to the IndexCapable interface.

I added a change to return an error if the interface is not implemented and removed the block.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb_test.go#L347](https://github.com/hyperledger-gerrit-archive/fabric/blob/5cc4988d6e27463755324482d4ae74313c475790/core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb_test.go#L347)<br><strong>Comment</strong>: <pre>That explains the type assertion - I was asking about the extra '{' and '}' around the "if ok" block. Doesn't matter, though, looks like it's gone now.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb_test.go#L410](https://github.com/hyperledger-gerrit-archive/fabric/blob/5cc4988d6e27463755324482d4ae74313c475790/core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb_test.go#L410)<br><strong>Comment</strong>: <pre>Why the extra block?</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb_test.go#L410](https://github.com/hyperledger-gerrit-archive/fabric/blob/5cc4988d6e27463755324482d4ae74313c475790/core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb_test.go#L410)<br><strong>Comment</strong>: <pre>Same as above</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/scc/lscc/lscc.go#L72](https://github.com/hyperledger-gerrit-archive/fabric/blob/5cc4988d6e27463755324482d4ae74313c475790/core/scc/lscc/lscc.go#L72)<br><strong>Comment</strong>: <pre>Please explain the relationship between the chaincode name and the collection name? I don't see why collection name requirements are used to evaluate the chaincode name.</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/scc/lscc/lscc.go#L72](https://github.com/hyperledger-gerrit-archive/fabric/blob/5cc4988d6e27463755324482d4ae74313c475790/core/scc/lscc/lscc.go#L72)<br><strong>Comment</strong>: <pre>The chain code name and the collection name are both used in the database name.  The allowed characters are restricted by allowable characters in the database naming.  It might be more correct to rename the variables.  The only relationship is that both must be valid for database naming.</pre></blockquote><h3>PatchSet Number: 4</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Uploader</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Created</strong>: 5/18/2018, 11:45:05 AM<br><strong>UnmergedRevision</strong>: [e68ef505ccbf2edbf69eed5a3187227f8b9ac784](https://github.com/hyperledger-gerrit-archive/fabric/commit/e68ef505ccbf2edbf69eed5a3187227f8b9ac784)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/18/2018, 11:52:45 AM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/18/2018, 11:52:45 AM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/18/2018, 12:04:13 PM<br><strong>Type</strong>: F2-SmokeTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/18/2018, 12:11:32 PM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L58](https://github.com/hyperledger-gerrit-archive/fabric/blob/e68ef505ccbf2edbf69eed5a3187227f8b9ac784/core/chaincode/platforms/ccmetadata/validators.go#L58)<br><strong>Comment</strong>: <pre>Why commented out instead of removed?</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L58](https://github.com/hyperledger-gerrit-archive/fabric/blob/e68ef505ccbf2edbf69eed5a3187227f8b9ac784/core/chaincode/platforms/ccmetadata/validators.go#L58)<br><strong>Comment</strong>: <pre>Corrected</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L77](https://github.com/hyperledger-gerrit-archive/fabric/blob/e68ef505ccbf2edbf69eed5a3187227f8b9ac784/core/chaincode/platforms/ccmetadata/validators.go#L77)<br><strong>Comment</strong>: <pre>It's a nit but there seems to be a lot of vertical whitespace for this little block. I'd expect it to be as simple as:

    for validateExp, fileValidator := range fileValidators {
        if validateExp.MatchString(fileName) {
            return fileValidator
        }
    }

    return nil

Not something you need to change unless you want to and need to resubmit anyway.</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L77](https://github.com/hyperledger-gerrit-archive/fabric/blob/e68ef505ccbf2edbf69eed5a3187227f8b9ac784/core/chaincode/platforms/ccmetadata/validators.go#L77)<br><strong>Comment</strong>: <pre>Removed extra white space.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L99](https://github.com/hyperledger-gerrit-archive/fabric/blob/e68ef505ccbf2edbf69eed5a3187227f8b9ac784/core/chaincode/platforms/ccmetadata/validators.go#L99)<br><strong>Comment</strong>: <pre>Isn't this covered by the regex now?</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L99](https://github.com/hyperledger-gerrit-archive/fabric/blob/e68ef505ccbf2edbf69eed5a3187227f8b9ac784/core/chaincode/platforms/ccmetadata/validators.go#L99)<br><strong>Comment</strong>: <pre>You are correct.   Removing this check.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb_test.go#L389](https://github.com/hyperledger-gerrit-archive/fabric/blob/e68ef505ccbf2edbf69eed5a3187227f8b9ac784/core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb_test.go#L389)<br><strong>Comment</strong>: <pre>Why is this commented out?</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb_test.go#L389](https://github.com/hyperledger-gerrit-archive/fabric/blob/e68ef505ccbf2edbf69eed5a3187227f8b9ac784/core/ledger/kvledger/txmgmt/statedb/statecouchdb/statecouchdb_test.go#L389)<br><strong>Comment</strong>: <pre>Mistake left over from testing.   Corrected.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [core/scc/lscc/lscc.go#L72](https://github.com/hyperledger-gerrit-archive/fabric/blob/e68ef505ccbf2edbf69eed5a3187227f8b9ac784/core/scc/lscc/lscc.go#L72)<br><strong>Comment</strong>: <pre>Still not sure I understand this.  They may be the same value but they still feel like orthogonal constraints.</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/scc/lscc/lscc.go#L72](https://github.com/hyperledger-gerrit-archive/fabric/blob/e68ef505ccbf2edbf69eed5a3187227f8b9ac784/core/scc/lscc/lscc.go#L72)<br><strong>Comment</strong>: <pre>Reverted to original</pre></blockquote><h3>PatchSet Number: 5</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Uploader</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Created</strong>: 5/18/2018, 2:25:52 PM<br><strong>UnmergedRevision</strong>: [45175efd41468571c3f46e743323fbe77b53b264](https://github.com/hyperledger-gerrit-archive/fabric/commit/45175efd41468571c3f46e743323fbe77b53b264)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/18/2018, 2:32:47 PM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/18/2018, 2:32:47 PM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/18/2018, 2:49:29 PM<br><strong>Type</strong>: F2-SmokeTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/18/2018, 2:57:53 PM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 6</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Uploader</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Created</strong>: 5/18/2018, 3:31:00 PM<br><strong>UnmergedRevision</strong>: [4e66be3673d0725850c1d03b3212c099fedaff61](https://github.com/hyperledger-gerrit-archive/fabric/commit/4e66be3673d0725850c1d03b3212c099fedaff61)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/18/2018, 3:40:53 PM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/18/2018, 3:40:53 PM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/18/2018, 3:55:18 PM<br><strong>Type</strong>: F2-SmokeTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/18/2018, 4:03:03 PM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 7</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Uploader</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Created</strong>: 5/18/2018, 4:26:52 PM<br><strong>UnmergedRevision</strong>: [c738b384530027bcbb6611c596478262ecaebd54](https://github.com/hyperledger-gerrit-archive/fabric/commit/c738b384530027bcbb6611c596478262ecaebd54)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/18/2018, 4:33:03 PM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/18/2018, 4:33:03 PM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/18/2018, 4:47:48 PM<br><strong>Type</strong>: F2-SmokeTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/18/2018, 5:05:02 PM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>Approved</strong>: 5/20/2018, 6:08:55 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Approved</strong>: 5/18/2018, 5:12:10 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L50](https://github.com/hyperledger-gerrit-archive/fabric/blob/c738b384530027bcbb6611c596478262ecaebd54/core/chaincode/platforms/ccmetadata/validators.go#L50)<br><strong>Comment</strong>: <pre>It used to be that the validator was chosen based on the passed in metadataType, which represented the directory.  I think it still makes sense to base the validation on the directory.  All the clients currently pass a cleaned directory name.

If you really want to switch it to be based on the fileName rather than the directory, then the change needs to be made everywhere, specifically:
- metadataType would be removed as an argument and no longer be passed by clients
- the function comment should be updated
- fileName should be changed to filePathName
- LSCC calls ValidateMetadataFile and still passes the file name only, it would have to change and pass the file path name in order to work.</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L50](https://github.com/hyperledger-gerrit-archive/fabric/blob/c738b384530027bcbb6611c596478262ecaebd54/core/chaincode/platforms/ccmetadata/validators.go#L50)<br><strong>Comment</strong>: <pre>This reminds me that I had anticipated these kind of problems of broken linkages and had mentioned in one of the comments that on the initial commits regarding this but somehow we never addressed that.

https://gerrit.hyperledger.org/r/#/c/18193/6/core/scc/lscc/lscc.go@370 

The basic problem is that we wanted to design this validator as a single place to validate that accepts just the [META-INF] and all the callers should not be aware of a specific file but somehow lscc ended up using 'couch' as a hardcoded...

Dave, was there some basic problem that would have prevented you in keeping the callers agnostics of couchdb and such...</pre><strong>Commenter</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L50](https://github.com/hyperledger-gerrit-archive/fabric/blob/c738b384530027bcbb6611c596478262ecaebd54/core/chaincode/platforms/ccmetadata/validators.go#L50)<br><strong>Comment</strong>: <pre>Manish, I think you've convinced me that ExtractFileEntries() should not filter the metadata files.  The validator could simply check all metadata files.

And I'm ok if ValidateMetadataFile() doesn't accept a metadataType, and rather just uses the filePathName (first argument) to determine the specific validator based on the path.  I mostly was not ok with going halfway to a new design, where clients still passed metadataType but it was no longer used for validation decisions.  The design should be one way or the other, not a hybrid.</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L50](https://github.com/hyperledger-gerrit-archive/fabric/blob/c738b384530027bcbb6611c596478262ecaebd54/core/chaincode/platforms/ccmetadata/validators.go#L50)<br><strong>Comment</strong>: <pre>I would have agreed that validation on directory made sense.   The feedback to change the validation expressions to the following changed the focus to the file and not the directory:

var fileValidators = map[*regexp.Regexp]fileValidator{
	regexp.MustCompile("^META-INF/statedb/couchdb/indexes/.*[.]json"):                                                couchdbIndexFileValidator,
	regexp.MustCompile("^META-INF/statedb/couchdb/collections/" + allowedCharsCollectionName + "/indexes/.*[.]json"): couchdbIndexFileValidator,
}

I have made the other changes to make the validation consistent.   I think this change coupled with the change to make the extraction by a top level database type will make this more consistent overall.</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L204](https://github.com/hyperledger-gerrit-archive/fabric/blob/c738b384530027bcbb6611c596478262ecaebd54/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L204)<br><strong>Comment</strong>: <pre>Like one of the previous comments from Matt, this function also contains unusual extra vertical spaces...</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L217](https://github.com/hyperledger-gerrit-archive/fabric/blob/c738b384530027bcbb6611c596478262ecaebd54/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L217)<br><strong>Comment</strong>: <pre>This should be coming from a function (say `GetDBType`) in the interface 'IndexCapable'</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L217](https://github.com/hyperledger-gerrit-archive/fabric/blob/c738b384530027bcbb6611c596478262ecaebd54/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L217)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L251](https://github.com/hyperledger-gerrit-archive/fabric/blob/c738b384530027bcbb6611c596478262ecaebd54/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L251)<br><strong>Comment</strong>: <pre>For a quick reference, it's worth adding to the comment here that the sample file paths in the tarBytes could be 
"META-INF/statedb/couchdb/indexes/indexColorSortName.json" for the chaincode scope indexes

and this could be 

"META-INF/statedb/couchdb/collections/collectionMarbles/indexes/indexCollMarbles.json" for the collection scoped indexes</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L251](https://github.com/hyperledger-gerrit-archive/fabric/blob/c738b384530027bcbb6611c596478262ecaebd54/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L251)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L252](https://github.com/hyperledger-gerrit-archive/fabric/blob/c738b384530027bcbb6611c596478262ecaebd54/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L252)<br><strong>Comment</strong>: <pre>Extra vertical spaces in the function</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L252](https://github.com/hyperledger-gerrit-archive/fabric/blob/c738b384530027bcbb6611c596478262ecaebd54/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L252)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L276](https://github.com/hyperledger-gerrit-archive/fabric/blob/c738b384530027bcbb6611c596478262ecaebd54/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L276)<br><strong>Comment</strong>: <pre>Since this is common db layer, I would prefer not having checks for couch specific content.

Ideally, we should simply check whether the dir path starts with "META-INF/statedb/couchdb/collections" or with "META-INF/statedb/couchdb/[anything other than collections]"

Further, based on the path, I'll suggest that compute the final namespace right here and make that as the key of the map.</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L276](https://github.com/hyperledger-gerrit-archive/fabric/blob/c738b384530027bcbb6611c596478262ecaebd54/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L276)<br><strong>Comment</strong>: <pre>in this comment, in the file paths, read "couchdb" as "dbType"</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L276](https://github.com/hyperledger-gerrit-archive/fabric/blob/c738b384530027bcbb6611c596478262ecaebd54/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L276)<br><strong>Comment</strong>: <pre>I think this can be even simpler.  The retrieve should pull all files under the "dbType".  Validation will identify any erroneous files.</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L276](https://github.com/hyperledger-gerrit-archive/fabric/blob/c738b384530027bcbb6611c596478262ecaebd54/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L276)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L291](https://github.com/hyperledger-gerrit-archive/fabric/blob/c738b384530027bcbb6611c596478262ecaebd54/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L291)<br><strong>Comment</strong>: <pre>you can remove this highlighted code and just retain the line 289 - and in that line replace 'tarFileArray' by 'indexArtifacts[dir]'.

golang 'append' function works on a nil slice and create the slice if found nil</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L291](https://github.com/hyperledger-gerrit-archive/fabric/blob/c738b384530027bcbb6611c596478262ecaebd54/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L291)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/db_test.go#L460](https://github.com/hyperledger-gerrit-archive/fabric/blob/c738b384530027bcbb6611c596478262ecaebd54/core/ledger/kvledger/txmgmt/privacyenabledstate/db_test.go#L460)<br><strong>Comment</strong>: <pre>Before this line, like you added a check in the couchstatedb, I would suggest to add a check to make sure that this commondb implements this interface.</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/db_test.go#L460](https://github.com/hyperledger-gerrit-archive/fabric/blob/c738b384530027bcbb6611c596478262ecaebd54/core/ledger/kvledger/txmgmt/privacyenabledstate/db_test.go#L460)<br><strong>Comment</strong>: <pre>I don't think this is necessary.  This method is part of the DB interface, not the indexCapable interface.</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/db_test.go#L460](https://github.com/hyperledger-gerrit-archive/fabric/blob/c738b384530027bcbb6611c596478262ecaebd54/core/ledger/kvledger/txmgmt/privacyenabledstate/db_test.go#L460)<br><strong>Comment</strong>: <pre>Chris you misunderstood my comment. The interface is defined at https://github.com/hyperledger/fabric/blob/master/core/ledger/cceventmgmt/defs.go#L30 and the common db is expected to implement this.. (earlier statecouchdb implemented this)</pre></blockquote><h3>PatchSet Number: 8</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Uploader</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Created</strong>: 5/20/2018, 2:32:49 PM<br><strong>UnmergedRevision</strong>: [d9cdfcffd31ea640e6a8145586695b7f82370339](https://github.com/hyperledger-gerrit-archive/fabric/commit/d9cdfcffd31ea640e6a8145586695b7f82370339)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/20/2018, 2:41:19 PM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/20/2018, 2:41:19 PM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/20/2018, 2:53:26 PM<br><strong>Type</strong>: F2-SmokeTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/20/2018, 3:10:23 PM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>Approved</strong>: 5/20/2018, 6:08:55 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 9</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Uploader</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Created</strong>: 5/20/2018, 3:59:59 PM<br><strong>UnmergedRevision</strong>: [b3e7549842cd1002b96dbe0f068e68566cdbab99](https://github.com/hyperledger-gerrit-archive/fabric/commit/b3e7549842cd1002b96dbe0f068e68566cdbab99)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/20/2018, 4:08:32 PM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/20/2018, 4:08:32 PM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/20/2018, 4:21:46 PM<br><strong>Type</strong>: F2-SmokeTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/20/2018, 4:37:48 PM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>Approved</strong>: 5/20/2018, 6:08:55 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 10</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Uploader</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Created</strong>: 5/20/2018, 5:02:53 PM<br><strong>UnmergedRevision</strong>: [403122ba350cae3fbc277c3658fd6d8f2bac9734](https://github.com/hyperledger-gerrit-archive/fabric/commit/403122ba350cae3fbc277c3658fd6d8f2bac9734)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/20/2018, 5:10:03 PM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/20/2018, 5:10:03 PM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/20/2018, 5:30:05 PM<br><strong>Type</strong>: F2-SmokeTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/20/2018, 5:45:26 PM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L26](https://github.com/hyperledger-gerrit-archive/fabric/blob/403122ba350cae3fbc277c3658fd6d8f2bac9734/core/chaincode/platforms/ccmetadata/validators.go#L26)<br><strong>Comment</strong>: <pre>If the client does a chaincode install with an invalid collection name, they will get an error "metadata not supported in directory".
This will cause confusion... would be better to get a more specific error about the invalid collection name.

Manish, do you intend to improve this in FAB-9996 (Add validation for names of private data collections).</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L26](https://github.com/hyperledger-gerrit-archive/fabric/blob/403122ba350cae3fbc277c3658fd6d8f2bac9734/core/chaincode/platforms/ccmetadata/validators.go#L26)<br><strong>Comment</strong>: <pre>Added a validation step to break down the error.</pre><strong>Commenter</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L48](https://github.com/hyperledger-gerrit-archive/fabric/blob/403122ba350cae3fbc277c3658fd6d8f2bac9734/core/chaincode/platforms/ccmetadata/validators.go#L48)<br><strong>Comment</strong>: <pre>file's directory</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L48](https://github.com/hyperledger-gerrit-archive/fabric/blob/403122ba350cae3fbc277c3658fd6d8f2bac9734/core/chaincode/platforms/ccmetadata/validators.go#L48)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L59](https://github.com/hyperledger-gerrit-archive/fabric/blob/403122ba350cae3fbc277c3658fd6d8f2bac9734/core/chaincode/platforms/ccmetadata/validators.go#L59)<br><strong>Comment</strong>: <pre>directory-based validator</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L59](https://github.com/hyperledger-gerrit-archive/fabric/blob/403122ba350cae3fbc277c3658fd6d8f2bac9734/core/chaincode/platforms/ccmetadata/validators.go#L59)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>CommentLine</strong>: [core/common/ccprovider/cc_statedb_artifacts_provider.go#L64](https://github.com/hyperledger-gerrit-archive/fabric/blob/403122ba350cae3fbc277c3658fd6d8f2bac9734/core/common/ccprovider/cc_statedb_artifacts_provider.go#L64)<br><strong>Comment</strong>: <pre>chaincode</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/common/ccprovider/cc_statedb_artifacts_provider.go#L64](https://github.com/hyperledger-gerrit-archive/fabric/blob/403122ba350cae3fbc277c3658fd6d8f2bac9734/core/common/ccprovider/cc_statedb_artifacts_provider.go#L64)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>CommentLine</strong>: [core/common/ccprovider/cc_statedb_artifacts_provider.go#L65](https://github.com/hyperledger-gerrit-archive/fabric/blob/403122ba350cae3fbc277c3658fd6d8f2bac9734/core/common/ccprovider/cc_statedb_artifacts_provider.go#L65)<br><strong>Comment</strong>: <pre>Repetitive based on prior line.</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/common/ccprovider/cc_statedb_artifacts_provider.go#L65](https://github.com/hyperledger-gerrit-archive/fabric/blob/403122ba350cae3fbc277c3658fd6d8f2bac9734/core/common/ccprovider/cc_statedb_artifacts_provider.go#L65)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>CommentLine</strong>: [core/common/ccprovider/cc_statedb_artifacts_provider.go#L67](https://github.com/hyperledger-gerrit-archive/fabric/blob/403122ba350cae3fbc277c3658fd6d8f2bac9734/core/common/ccprovider/cc_statedb_artifacts_provider.go#L67)<br><strong>Comment</strong>: <pre>Repetitive based on prior line.</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/common/ccprovider/cc_statedb_artifacts_provider.go#L67](https://github.com/hyperledger-gerrit-archive/fabric/blob/403122ba350cae3fbc277c3658fd6d8f2bac9734/core/common/ccprovider/cc_statedb_artifacts_provider.go#L67)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>CommentLine</strong>: [core/common/ccprovider/cc_statedb_artifacts_provider.go#L68](https://github.com/hyperledger-gerrit-archive/fabric/blob/403122ba350cae3fbc277c3658fd6d8f2bac9734/core/common/ccprovider/cc_statedb_artifacts_provider.go#L68)<br><strong>Comment</strong>: <pre>statedb metadata</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/common/ccprovider/cc_statedb_artifacts_provider.go#L68](https://github.com/hyperledger-gerrit-archive/fabric/blob/403122ba350cae3fbc277c3658fd6d8f2bac9734/core/common/ccprovider/cc_statedb_artifacts_provider.go#L68)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L211](https://github.com/hyperledger-gerrit-archive/fabric/blob/403122ba350cae3fbc277c3658fd6d8f2bac9734/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L211)<br><strong>Comment</strong>: <pre>remove</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L211](https://github.com/hyperledger-gerrit-archive/fabric/blob/403122ba350cae3fbc277c3658fd6d8f2bac9734/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L211)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L212](https://github.com/hyperledger-gerrit-archive/fabric/blob/403122ba350cae3fbc277c3658fd6d8f2bac9734/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L212)<br><strong>Comment</strong>: <pre>I think there's no need to make this couchdb specific... might as well pass empty string and extract all files.</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L212](https://github.com/hyperledger-gerrit-archive/fabric/blob/403122ba350cae3fbc277c3658fd6d8f2bac9734/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L212)<br><strong>Comment</strong>: <pre>Dave, this was a testing step when I added the GetDBType to the index interface.  This needs to be database specific, but we can remove the CouchDB specific call and have the implementation provide the name through GetDBType().  It's true it is not needed now, but it could be in the future.</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L212](https://github.com/hyperledger-gerrit-archive/fabric/blob/403122ba350cae3fbc277c3658fd6d8f2bac9734/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L212)<br><strong>Comment</strong>: <pre>Yes, this should rather be just replaced by 'GetDBType()'</pre><strong>Commenter</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>CommentLine</strong>: [core/scc/lscc/lscc.go#L351](https://github.com/hyperledger-gerrit-archive/fabric/blob/403122ba350cae3fbc277c3658fd6d8f2bac9734/core/scc/lscc/lscc.go#L351)<br><strong>Comment</strong>: <pre>archive</pre><strong>Commenter</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>CommentLine</strong>: [core/scc/lscc/lscc.go#L351](https://github.com/hyperledger-gerrit-archive/fabric/blob/403122ba350cae3fbc277c3658fd6d8f2bac9734/core/scc/lscc/lscc.go#L351)<br><strong>Comment</strong>: <pre>Done</pre></blockquote><h3>PatchSet Number: 11</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Uploader</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Created</strong>: 5/21/2018, 10:56:57 AM<br><strong>UnmergedRevision</strong>: [5da877629d40a64a305488c23fd68f767c087cbf](https://github.com/hyperledger-gerrit-archive/fabric/commit/5da877629d40a64a305488c23fd68f767c087cbf)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/21/2018, 11:04:52 AM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/21/2018, 11:04:52 AM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/21/2018, 11:18:04 AM<br><strong>Type</strong>: F2-SmokeTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/21/2018, 11:25:06 AM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/chaincode/platforms/ccmetadata/validators.go#L25](https://github.com/hyperledger-gerrit-archive/fabric/blob/5da877629d40a64a305488c23fd68f767c087cbf/core/chaincode/platforms/ccmetadata/validators.go#L25)<br><strong>Comment</strong>: <pre>Future refactoring: Keeping couchdb in mind these entries look fine. However, this will be good to have a db specific handler and at this level just register that and then all the dirs that starts with 'META-INF/statedb/dbType/' or 'META-INF/statedb/dbType/collections/collname should be passed to the db specific handler.</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L226](https://github.com/hyperledger-gerrit-archive/fabric/blob/5da877629d40a64a305488c23fd68f767c087cbf/core/ledger/kvledger/txmgmt/privacyenabledstate/common_storage_db.go#L226)<br><strong>Comment</strong>: <pre>Future Refactoring: As commented on a previous patch - https://gerrit.hyperledger.org/r/#/c/18193/6/core/scc/lscc/lscc.go@370

Ideally, we should not be checking specific directories such as 'index'. Rather we should be restrictive to simply checking whether the dirpath starts with 
- "META-INF/statedb/GetDBType()/collections" 
- or with "META-INF/statedb/GetDBType()/[anything other than collections]"

This path checking should just be used to compute the namespace and then entire sub-directory content should be passes as is to the lower layer and leave up to the lower layer to decide whether it wants to process one by one or all together.</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/scc/lscc/lscc.go#L366](https://github.com/hyperledger-gerrit-archive/fabric/blob/5da877629d40a64a305488c23fd68f767c087cbf/core/scc/lscc/lscc.go#L366)<br><strong>Comment</strong>: <pre>Future refactoring: This for loop at lscc level assumes the validation of one file at at time. As at this level, we are assuming no knowledge of the db and the associated metadata, we should simply pass 'META-INF/' content to the function 'ccmetadata.ValidateMetadataFile'</pre></blockquote><h3>PatchSet Number: 12</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Uploader</strong>: Chris Elder - chris.elder@us.ibm.com<br><strong>Created</strong>: 5/21/2018, 1:09:57 PM<br><strong>GitHubMergedRevision</strong>: [9a3b1811d19d621e9936656880fe80dda4266222](https://github.com/hyperledger-gerrit-archive/fabric/commit/9a3b1811d19d621e9936656880fe80dda4266222)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/21/2018, 1:16:33 PM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/21/2018, 1:16:33 PM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/21/2018, 1:33:30 PM<br><strong>Type</strong>: F2-SmokeTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/21/2018, 1:52:12 PM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Approved</strong>: 5/21/2018, 2:11:11 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>MergedBy</strong>: Manish Sethi<br><strong>Merged</strong>: 5/21/2018, 2:11:20 PM<br><br><strong>Approver</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>Approved</strong>: 5/21/2018, 1:58:20 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br></blockquote>
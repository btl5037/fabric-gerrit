<strong>Project</strong>: fabric<br><strong>Branch</strong>: master<br><strong>ID</strong>: 2605<br><strong>Subject</strong>: [FAB-666] [WIP]  Orderer bootstrap flow<br><strong>Status</strong>: ABANDONED<br><strong>Owner</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>Assignee</strong>:<br><strong>Created</strong>: 11/18/2016, 3:42:46 PM<br><strong>LastUpdated</strong>: 12/13/2016, 3:53:34 PM<br><strong>CommitMessage</strong>:<br><pre>[FAB-666] [WIP]  Orderer bootstrap flow

Update orderer main() to read genesis block
from file

Update config to read config data from
genesis block rather than the .yaml file when
using the -bootstrap command line flag

Update kafka to use inputted genesis block
rather than create fake one.

In the .yaml file, set GenesisMethod=file and
GenesisFile to the file containing the block.

12/12/2016  rebase on Jason's and Jeff's latest changesets
            comment out localconfig UT until I find out
            why the uni tests hang
12/13/2016  rebase off master. All unit tests now run

Change-Id: I732445780a4bd09e404e9b072a921364df635f4d
Signed-off-by: tuand27613 <tdang@us.ibm.com>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>Reviewed</strong>: 11/18/2016, 3:42:46 PM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 11/18/2016, 3:42:55 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/1812/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 11/18/2016, 3:46:36 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/2969/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 11/18/2016, 4:12:07 PM<br><strong>Message</strong>: <pre>Patch Set 1: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/1812/ : FAILURE (skipped)

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/2969/ : FAILURE</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 11/18/2016, 9:42:03 PM<br><strong>Message</strong>: <pre>Patch Set 1: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/1824/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 11/18/2016, 9:44:53 PM<br><strong>Message</strong>: <pre>Patch Set 1: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/1824/ : FAILURE (skipped)

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/2983/ : FAILURE</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 11/18/2016, 9:44:59 PM<br><strong>Message</strong>: <pre>Patch Set 1: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/2987/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 11/18/2016, 10:13:08 PM<br><strong>Message</strong>: <pre>Patch Set 1: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/1824/ : FAILURE (skipped)

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/2987/ : FAILURE</pre><strong>Reviewer</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Reviewed</strong>: 11/19/2016, 3:46:11 PM<br><strong>Message</strong>: <pre>Patch Set 1: Code-Review-1

(18 comments)</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 11/22/2016, 9:51:24 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(1 comment)</pre><strong>Reviewer</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>Reviewed</strong>: 11/22/2016, 11:56:53 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(16 comments)</pre><strong>Reviewer</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>Reviewed</strong>: 11/22/2016, 11:57:15 AM<br><strong>Message</strong>: <pre>Uploaded patch set 2.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 11/22/2016, 11:33:08 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/1978/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 11/22/2016, 11:33:35 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3144/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 11/22/2016, 11:38:54 PM<br><strong>Message</strong>: <pre>Patch Set 2: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/1978/ : FAILURE (skipped)

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3144/ : FAILURE</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 11/23/2016, 11:42:43 AM<br><strong>Message</strong>: <pre>Patch Set 2: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/2033/ : FAILURE (skipped)

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3198/ : SUCCESS</pre><strong>Reviewer</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>Reviewed</strong>: 12/12/2016, 7:28:45 PM<br><strong>Message</strong>: <pre>Uploaded patch set 3.</pre><strong>Reviewer</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>Reviewed</strong>: 12/12/2016, 7:31:08 PM<br><strong>Message</strong>: <pre>Uploaded patch set 4: Commit message was updated.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/12/2016, 7:32:20 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3977/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/12/2016, 7:35:23 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3978/</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 12/12/2016, 7:48:32 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Looks like it is coming along.  I realize it's a work in progress, but for clarity of review, I'd appreciate it if you could simply remove the commented sections.  Based on what you've presented here, I'm guessing your final list of modified files will be 'orderer/common/bootstrap/file/*', 'orderer/main.go', and 'orderer/localconfig/config.go', or not, but it's harder for me to evaluate with the extraneous code still there.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/12/2016, 7:57:12 PM<br><strong>Message</strong>: <pre>Patch Set 3: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3977/ : SUCCESS</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/12/2016, 8:02:35 PM<br><strong>Message</strong>: <pre>Patch Set 4: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3978/ : SUCCESS</pre><strong>Reviewer</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>Reviewed</strong>: 12/13/2016, 10:05:24 AM<br><strong>Message</strong>: <pre>Uploaded patch set 5.</pre><strong>Reviewer</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>Reviewed</strong>: 12/13/2016, 10:08:01 AM<br><strong>Message</strong>: <pre>Patch Set 5:

I commented out code that might be used to parse out the genesis block.
Moved the commented code to the bottom so things will be easier to read.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/13/2016, 10:08:55 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3990/</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 12/13/2016, 10:17:39 AM<br><strong>Message</strong>: <pre>Patch Set 5:

(3 comments)</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 12/13/2016, 10:27:31 AM<br><strong>Message</strong>: <pre>Patch Set 5:

(1 comment)</pre><strong>Reviewer</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>Reviewed</strong>: 12/13/2016, 10:40:23 AM<br><strong>Message</strong>: <pre>Uploaded patch set 6.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/13/2016, 10:40:34 AM<br><strong>Message</strong>: <pre>Patch Set 5: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3990/ : SUCCESS</pre><strong>Reviewer</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>Reviewed</strong>: 12/13/2016, 10:41:49 AM<br><strong>Message</strong>: <pre>Patch Set 5:

(4 comments)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/13/2016, 10:44:28 AM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3992/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/13/2016, 11:17:39 AM<br><strong>Message</strong>: <pre>Patch Set 6: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3992/ : SUCCESS</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 12/13/2016, 1:01:01 PM<br><strong>Message</strong>: <pre>Patch Set 6:

(3 comments)</pre><strong>Reviewer</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>Reviewed</strong>: 12/13/2016, 1:52:57 PM<br><strong>Message</strong>: <pre>Uploaded patch set 7.</pre><strong>Reviewer</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>Reviewed</strong>: 12/13/2016, 1:53:39 PM<br><strong>Message</strong>: <pre>Patch Set 6:

(3 comments)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/13/2016, 1:57:31 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4019/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/13/2016, 2:24:40 PM<br><strong>Message</strong>: <pre>Patch Set 7: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4019/ : SUCCESS</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 12/13/2016, 2:42:08 PM<br><strong>Message</strong>: <pre>Patch Set 7:

(1 comment)</pre><strong>Reviewer</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Reviewed</strong>: 12/13/2016, 2:42:23 PM<br><strong>Message</strong>: <pre>Patch Set 7:

My two cents on how to proceed this so we can unstuck ourselves here.

Checkout https://gerrit.hyperledger.org/r/#/c/3207/ (or go all in and checkout https://gerrit.hyperledger.org/r/#/c/3269/) which offers a (hopefully decent and clean) refactoring of orderer/main.go. Then add your "file" case in the "switch conf.General.GenesisMethod" statement in there.</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 12/13/2016, 2:49:01 PM<br><strong>Message</strong>: <pre>Patch Set 7:

> My two cents on how to proceed this so we can unstuck ourselves
 > here.
 > 
 > Checkout https://gerrit.hyperledger.org/r/#/c/3207/ (or go all in
 > and checkout https://gerrit.hyperledger.org/r/#/c/3269/) which
 > offers a (hopefully decent and clean) refactoring of
 > orderer/main.go. Then add your "file" case in the "switch
 > conf.General.GenesisMethod" statement in there.

+1</pre><strong>Reviewer</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Reviewed</strong>: 12/13/2016, 3:37:08 PM<br><strong>Message</strong>: <pre>Patch Set 7: Code-Review-1

(6 comments)</pre><strong>Reviewer</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>Reviewed</strong>: 12/13/2016, 3:53:34 PM<br><strong>Message</strong>: <pre>Abandoned

abandoned in favor of http://gerrit.hyperledger.org/r/3275 to pick up the changesets from Kostas</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: tuand27613 - tdang@us.ibm.com<br><strong>Uploader</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>Created</strong>: 11/18/2016, 3:42:46 PM<br><strong>UnmergedRevision</strong>: [de02db8d85fe98c80c98c43fa04147b1d02fea87](https://github.com/hyperledger-gerrit-archive/fabric/commit/de02db8d85fe98c80c98c43fa04147b1d02fea87)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 11/18/2016, 10:13:08 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Approved</strong>: 11/19/2016, 3:46:11 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Kostas Christidis - kostas@gmail.com<br><strong>CommentLine</strong>: [/COMMIT_MSG#L13](https://github.com/hyperledger-gerrit-archive/fabric/blob/de02db8d85fe98c80c98c43fa04147b1d02fea87//COMMIT_MSG#L13)<br><strong>Comment</strong>: <pre>Always? That's what I get from reading this.</pre><strong>Commenter</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>CommentLine</strong>: [/COMMIT_MSG#L13](https://github.com/hyperledger-gerrit-archive/fabric/blob/de02db8d85fe98c80c98c43fa04147b1d02fea87//COMMIT_MSG#L13)<br><strong>Comment</strong>: <pre>added more descriptive text</pre><strong>Commenter</strong>: Kostas Christidis - kostas@gmail.com<br><strong>CommentLine</strong>: [/COMMIT_MSG#L21](https://github.com/hyperledger-gerrit-archive/fabric/blob/de02db8d85fe98c80c98c43fa04147b1d02fea87//COMMIT_MSG#L21)<br><strong>Comment</strong>: <pre>Do you need to specify a path? Can you include a sample invocation in the commit message?</pre><strong>Commenter</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>CommentLine</strong>: [/COMMIT_MSG#L21](https://github.com/hyperledger-gerrit-archive/fabric/blob/de02db8d85fe98c80c98c43fa04147b1d02fea87//COMMIT_MSG#L21)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Kostas Christidis - kostas@gmail.com<br><strong>CommentLine</strong>: [orderer/common/bootstrap/filebootstrap/bootstrap.go#L17](https://github.com/hyperledger-gerrit-archive/fabric/blob/de02db8d85fe98c80c98c43fa04147b1d02fea87/orderer/common/bootstrap/filebootstrap/bootstrap.go#L17)<br><strong>Comment</strong>: <pre>Given that the static bootstrapper lives in package "static", for symmetry I'd expect this to live in a "disk" or "file" package or something along these lines.</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [orderer/common/bootstrap/filebootstrap/bootstrap.go#L17](https://github.com/hyperledger-gerrit-archive/fabric/blob/de02db8d85fe98c80c98c43fa04147b1d02fea87/orderer/common/bootstrap/filebootstrap/bootstrap.go#L17)<br><strong>Comment</strong>: <pre>Will wait to do a more thorough review until you have addressed the rest of the comments, but this jumped out at me too, as this name makes the fully qualified path stutter.</pre><strong>Commenter</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>CommentLine</strong>: [orderer/common/bootstrap/filebootstrap/bootstrap.go#L17](https://github.com/hyperledger-gerrit-archive/fabric/blob/de02db8d85fe98c80c98c43fa04147b1d02fea87/orderer/common/bootstrap/filebootstrap/bootstrap.go#L17)<br><strong>Comment</strong>: <pre>rename to "file" in next patch set</pre><strong>Commenter</strong>: Kostas Christidis - kostas@gmail.com<br><strong>CommentLine</strong>: [orderer/common/bootstrap/filebootstrap/bootstrap.go#L52](https://github.com/hyperledger-gerrit-archive/fabric/blob/de02db8d85fe98c80c98c43fa04147b1d02fea87/orderer/common/bootstrap/filebootstrap/bootstrap.go#L52)<br><strong>Comment</strong>: <pre>Curious as to why you always \newline your error messages? In general you should touch them as less as possible.</pre><strong>Commenter</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>CommentLine</strong>: [orderer/common/bootstrap/filebootstrap/bootstrap.go#L52](https://github.com/hyperledger-gerrit-archive/fabric/blob/de02db8d85fe98c80c98c43fa04147b1d02fea87/orderer/common/bootstrap/filebootstrap/bootstrap.go#L52)<br><strong>Comment</strong>: <pre>finger memory as I put a \n on anything that might be printed.</pre><strong>Commenter</strong>: Kostas Christidis - kostas@gmail.com<br><strong>CommentLine</strong>: [orderer/common/bootstrap/filebootstrap/bootstrap.go#L56](https://github.com/hyperledger-gerrit-archive/fabric/blob/de02db8d85fe98c80c98c43fa04147b1d02fea87/orderer/common/bootstrap/filebootstrap/bootstrap.go#L56)<br><strong>Comment</strong>: <pre>Let's go with the idiomatic Go way of handling this.

if err := proto.Unmarshal; err != nil {
...
}</pre><strong>Commenter</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>CommentLine</strong>: [orderer/common/bootstrap/filebootstrap/bootstrap.go#L56](https://github.com/hyperledger-gerrit-archive/fabric/blob/de02db8d85fe98c80c98c43fa04147b1d02fea87/orderer/common/bootstrap/filebootstrap/bootstrap.go#L56)<br><strong>Comment</strong>: <pre>done in next patchset</pre><strong>Commenter</strong>: Kostas Christidis - kostas@gmail.com<br><strong>CommentLine</strong>: [orderer/config/config.go#L251](https://github.com/hyperledger-gerrit-archive/fabric/blob/de02db8d85fe98c80c98c43fa04147b1d02fea87/orderer/config/config.go#L251)<br><strong>Comment</strong>: <pre>This is duplicate code from the Load() function above. Let's rewrite so as to avoid code duplication.</pre><strong>Commenter</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>CommentLine</strong>: [orderer/config/config.go#L251](https://github.com/hyperledger-gerrit-archive/fabric/blob/de02db8d85fe98c80c98c43fa04147b1d02fea87/orderer/config/config.go#L251)<br><strong>Comment</strong>: <pre>done in next patchset</pre><strong>Commenter</strong>: Kostas Christidis - kostas@gmail.com<br><strong>CommentLine</strong>: [orderer/kafka/broadcast.go#L202](https://github.com/hyperledger-gerrit-archive/fabric/blob/de02db8d85fe98c80c98c43fa04147b1d02fea87/orderer/kafka/broadcast.go#L202)<br><strong>Comment</strong>: <pre>All of these changes should be cherry-picked from Luis's changeset.</pre><strong>Commenter</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>CommentLine</strong>: [orderer/kafka/broadcast.go#L202](https://github.com/hyperledger-gerrit-archive/fabric/blob/de02db8d85fe98c80c98c43fa04147b1d02fea87/orderer/kafka/broadcast.go#L202)<br><strong>Comment</strong>: <pre>I'll rebase once all other changes are cleared ?</pre><strong>Commenter</strong>: Kostas Christidis - kostas@gmail.com<br><strong>CommentLine</strong>: [orderer/kafka/broadcast_test.go#L51](https://github.com/hyperledger-gerrit-archive/fabric/blob/de02db8d85fe98c80c98c43fa04147b1d02fea87/orderer/kafka/broadcast_test.go#L51)<br><strong>Comment</strong>: <pre>This is called a checkpoint and not a genesis block on purpose. The mock package assumes an orderer that starts with block 100, and so the block there is a reconfig/checkpoint block, not a genesis one.</pre><strong>Commenter</strong>: Kostas Christidis - kostas@gmail.com<br><strong>CommentLine</strong>: [orderer/kafka/broadcast_test.go#L142](https://github.com/hyperledger-gerrit-archive/fabric/blob/de02db8d85fe98c80c98c43fa04147b1d02fea87/orderer/kafka/broadcast_test.go#L142)<br><strong>Comment</strong>: <pre>This has been merged in Luis's changeset already. Can you cherry-pick his commit and resubmit?</pre><strong>Commenter</strong>: Kostas Christidis - kostas@gmail.com<br><strong>CommentLine</strong>: [orderer/kafka/config_test.go#L31](https://github.com/hyperledger-gerrit-archive/fabric/blob/de02db8d85fe98c80c98c43fa04147b1d02fea87/orderer/kafka/config_test.go#L31)<br><strong>Comment</strong>: <pre>Why is this needed?</pre><strong>Commenter</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>CommentLine</strong>: [orderer/kafka/config_test.go#L31](https://github.com/hyperledger-gerrit-archive/fabric/blob/de02db8d85fe98c80c98c43fa04147b1d02fea87/orderer/kafka/config_test.go#L31)<br><strong>Comment</strong>: <pre>mockNewBroadcaster was not compiling with undefined var in the create of &boradcasterImp</pre><strong>Commenter</strong>: Kostas Christidis - kostas@gmail.com<br><strong>CommentLine</strong>: [orderer/main.go#L16](https://github.com/hyperledger-gerrit-archive/fabric/blob/de02db8d85fe98c80c98c43fa04147b1d02fea87/orderer/main.go#L16)<br><strong>Comment</strong>: <pre>?</pre><strong>Commenter</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>CommentLine</strong>: [orderer/main.go#L16](https://github.com/hyperledger-gerrit-archive/fabric/blob/de02db8d85fe98c80c98c43fa04147b1d02fea87/orderer/main.go#L16)<br><strong>Comment</strong>: <pre>forgot to delete. Gone in next patchset</pre><strong>Commenter</strong>: Kostas Christidis - kostas@gmail.com<br><strong>CommentLine</strong>: [orderer/main.go#L34](https://github.com/hyperledger-gerrit-archive/fabric/blob/de02db8d85fe98c80c98c43fa04147b1d02fea87/orderer/main.go#L34)<br><strong>Comment</strong>: <pre>Can you check your linter settings? This import reference actually belongs to the last group, as it were originally.</pre><strong>Commenter</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>CommentLine</strong>: [orderer/main.go#L34](https://github.com/hyperledger-gerrit-archive/fabric/blob/de02db8d85fe98c80c98c43fa04147b1d02fea87/orderer/main.go#L34)<br><strong>Comment</strong>: <pre>I'll dive deeper into this.  Not seeing what in atom in doing this yet.</pre><strong>Commenter</strong>: Kostas Christidis - kostas@gmail.com<br><strong>CommentLine</strong>: [orderer/main.go#L64](https://github.com/hyperledger-gerrit-archive/fabric/blob/de02db8d85fe98c80c98c43fa04147b1d02fea87/orderer/main.go#L64)<br><strong>Comment</strong>: <pre>Any reason for not providing a default suggested value here?</pre><strong>Commenter</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>CommentLine</strong>: [orderer/main.go#L64](https://github.com/hyperledger-gerrit-archive/fabric/blob/de02db8d85fe98c80c98c43fa04147b1d02fea87/orderer/main.go#L64)<br><strong>Comment</strong>: <pre>for now, if -bootstrap is not there, we go with static.  

If we want to have a default bootstrap file,  I would say let's do that as part of another jira issue</pre><strong>Commenter</strong>: Kostas Christidis - kostas@gmail.com<br><strong>CommentLine</strong>: [orderer/main.go#L72](https://github.com/hyperledger-gerrit-archive/fabric/blob/de02db8d85fe98c80c98c43fa04147b1d02fea87/orderer/main.go#L72)<br><strong>Comment</strong>: <pre>I don't understand this comment.</pre><strong>Commenter</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>CommentLine</strong>: [orderer/main.go#L72](https://github.com/hyperledger-gerrit-archive/fabric/blob/de02db8d85fe98c80c98c43fa04147b1d02fea87/orderer/main.go#L72)<br><strong>Comment</strong>: <pre>I'm not sure if we want to keep static in the future. A reminder to handle before we merge</pre><strong>Commenter</strong>: Kostas Christidis - kostas@gmail.com<br><strong>CommentLine</strong>: [orderer/main.go#L83](https://github.com/hyperledger-gerrit-archive/fabric/blob/de02db8d85fe98c80c98c43fa04147b1d02fea87/orderer/main.go#L83)<br><strong>Comment</strong>: <pre>I don't understand why you need two switch statements (this one *and* the one starting in line 73) to decode the genesisFile flag value.</pre><strong>Commenter</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>CommentLine</strong>: [orderer/main.go#L83](https://github.com/hyperledger-gerrit-archive/fabric/blob/de02db8d85fe98c80c98c43fa04147b1d02fea87/orderer/main.go#L83)<br><strong>Comment</strong>: <pre>cleaned up in next patchset</pre><strong>Commenter</strong>: Kostas Christidis - kostas@gmail.com<br><strong>CommentLine</strong>: [orderer/main.go#L89](https://github.com/hyperledger-gerrit-archive/fabric/blob/de02db8d85fe98c80c98c43fa04147b1d02fea87/orderer/main.go#L89)<br><strong>Comment</strong>: <pre>The norm is to exit with a short and simple message (e.g. "Unknown genesis method"), then print the defaults: https://golang.org/pkg/flag/#PrintDefaults.

This implies that the descriptions for each flag should be descriptive enough.</pre><strong>Commenter</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>CommentLine</strong>: [orderer/main.go#L89](https://github.com/hyperledger-gerrit-archive/fabric/blob/de02db8d85fe98c80c98c43fa04147b1d02fea87/orderer/main.go#L89)<br><strong>Comment</strong>: <pre>cleaned up.</pre><strong>Commenter</strong>: Kostas Christidis - kostas@gmail.com<br><strong>CommentLine</strong>: [orderer/main.go#L94](https://github.com/hyperledger-gerrit-archive/fabric/blob/de02db8d85fe98c80c98c43fa04147b1d02fea87/orderer/main.go#L94)<br><strong>Comment</strong>: <pre>If you/we are the one(s) writing all the bootstrappers, when do we ever exepct to get an error from the GenesisBlock() method? And if that's the case (say something terrible has happened and we cannot access a file that's stored in the disk) why don't we panic in the GenesisBlock() method?</pre><strong>Commenter</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>CommentLine</strong>: [orderer/main.go#L94](https://github.com/hyperledger-gerrit-archive/fabric/blob/de02db8d85fe98c80c98c43fa04147b1d02fea87/orderer/main.go#L94)<br><strong>Comment</strong>: <pre>trying to follow the Helper interface.  

If we want the HelperImpl to handle the errors, let's remove the error return from the genesisBLock() call</pre><strong>Commenter</strong>: Kostas Christidis - kostas@gmail.com<br><strong>CommentLine</strong>: [orderer/main.go#L118](https://github.com/hyperledger-gerrit-archive/fabric/blob/de02db8d85fe98c80c98c43fa04147b1d02fea87/orderer/main.go#L118)<br><strong>Comment</strong>: <pre>I cannot follow the logic here, things should be clearer. What are we trying to do?</pre><strong>Commenter</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>CommentLine</strong>: [orderer/main.go#L118](https://github.com/hyperledger-gerrit-archive/fabric/blob/de02db8d85fe98c80c98c43fa04147b1d02fea87/orderer/main.go#L118)<br><strong>Comment</strong>: <pre>adding a comment.

We're getting the consensus configuration from the block instead of orderer.yaml.
Once the MSP discussions are done,  We'll probably have to handle more of the configurationItems here.</pre></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: tuand27613 - tdang@us.ibm.com<br><strong>Uploader</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>Created</strong>: 11/22/2016, 11:57:15 AM<br><strong>UnmergedRevision</strong>: [054a8f65dbe25aeab69115d588cf8bb8b7c567c7](https://github.com/hyperledger-gerrit-archive/fabric/commit/054a8f65dbe25aeab69115d588cf8bb8b7c567c7)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 11/23/2016, 11:42:43 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 3</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: tuand27613 - tdang@us.ibm.com<br><strong>Uploader</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>Created</strong>: 12/12/2016, 7:28:45 PM<br><strong>UnmergedRevision</strong>: [f10dec2ac0432737ff1140217ec8fe5f3aa53cf5](https://github.com/hyperledger-gerrit-archive/fabric/commit/f10dec2ac0432737ff1140217ec8fe5f3aa53cf5)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/12/2016, 7:57:12 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 4</h3><blockquote><strong>Type</strong>: NO_CODE_CHANGE<br><strong>Author</strong>: tuand27613 - tdang@us.ibm.com<br><strong>Uploader</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>Created</strong>: 12/12/2016, 7:31:08 PM<br><strong>UnmergedRevision</strong>: [5f8e2619cec26500b1e2b38289927b1859afbe58](https://github.com/hyperledger-gerrit-archive/fabric/commit/5f8e2619cec26500b1e2b38289927b1859afbe58)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/12/2016, 8:02:35 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 5</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: tuand27613 - tdang@us.ibm.com<br><strong>Uploader</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>Created</strong>: 12/13/2016, 10:05:24 AM<br><strong>UnmergedRevision</strong>: [5f9c1bdfd815271c58f4e09476fa256637fd324f](https://github.com/hyperledger-gerrit-archive/fabric/commit/5f9c1bdfd815271c58f4e09476fa256637fd324f)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/13/2016, 10:40:34 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [orderer/kafka/broadcast.go#L50](https://github.com/hyperledger-gerrit-archive/fabric/blob/5f9c1bdfd815271c58f4e09476fa256637fd324f/orderer/kafka/broadcast.go#L50)<br><strong>Comment</strong>: <pre>Thinking more on this, I actually think it would be better to revert this file, and leave Kafka in a 'static bootstrap only' state as before this changeset.  Kostas' changes are definitely going to conflict here, and it's just going to cause conflicts that need to be resolved, let's focus on the 'launchGeneric' case which will only get solo for the moment, but will get Kafka once Kostas' changes merge.</pre><strong>Commenter</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>CommentLine</strong>: [orderer/kafka/broadcast.go#L50](https://github.com/hyperledger-gerrit-archive/fabric/blob/5f9c1bdfd815271c58f4e09476fa256637fd324f/orderer/kafka/broadcast.go#L50)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [orderer/localconfig/config.go#L252](https://github.com/hyperledger-gerrit-archive/fabric/blob/5f9c1bdfd815271c58f4e09476fa256637fd324f/orderer/localconfig/config.go#L252)<br><strong>Comment</strong>: <pre>Looks like the restructuring here at the bottom of the file is no longer necessary, can we remove this to shrink the diff?</pre><strong>Commenter</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>CommentLine</strong>: [orderer/localconfig/config.go#L252](https://github.com/hyperledger-gerrit-archive/fabric/blob/5f9c1bdfd815271c58f4e09476fa256637fd324f/orderer/localconfig/config.go#L252)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [orderer/localconfig/config_test.go#L31](https://github.com/hyperledger-gerrit-archive/fabric/blob/5f9c1bdfd815271c58f4e09476fa256637fd324f/orderer/localconfig/config_test.go#L31)<br><strong>Comment</strong>: <pre>This also seems unnecessary now</pre><strong>Commenter</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>CommentLine</strong>: [orderer/localconfig/config_test.go#L31](https://github.com/hyperledger-gerrit-archive/fabric/blob/5f9c1bdfd815271c58f4e09476fa256637fd324f/orderer/localconfig/config_test.go#L31)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [orderer/main.go#L183](https://github.com/hyperledger-gerrit-archive/fabric/blob/5f9c1bdfd815271c58f4e09476fa256637fd324f/orderer/main.go#L183)<br><strong>Comment</strong>: <pre>I'm not sure why you're keeping this around and commented?</pre><strong>Commenter</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>CommentLine</strong>: [orderer/main.go#L183](https://github.com/hyperledger-gerrit-archive/fabric/blob/5f9c1bdfd815271c58f4e09476fa256637fd324f/orderer/main.go#L183)<br><strong>Comment</strong>: <pre>Done</pre></blockquote><h3>PatchSet Number: 6</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: tuand27613 - tdang@us.ibm.com<br><strong>Uploader</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>Created</strong>: 12/13/2016, 10:40:23 AM<br><strong>UnmergedRevision</strong>: [288dc3a4a4d41841f5aab39020a0f9b682b240de](https://github.com/hyperledger-gerrit-archive/fabric/commit/288dc3a4a4d41841f5aab39020a0f9b682b240de)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/13/2016, 11:17:39 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [orderer/kafka/broadcast.go#L26](https://github.com/hyperledger-gerrit-archive/fabric/blob/288dc3a4a4d41841f5aab39020a0f9b682b240de/orderer/kafka/broadcast.go#L26)<br><strong>Comment</strong>: <pre>Unneeded</pre><strong>Commenter</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>CommentLine</strong>: [orderer/kafka/broadcast.go#L26](https://github.com/hyperledger-gerrit-archive/fabric/blob/288dc3a4a4d41841f5aab39020a0f9b682b240de/orderer/kafka/broadcast.go#L26)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [orderer/kafka/config_test.go#L31](https://github.com/hyperledger-gerrit-archive/fabric/blob/288dc3a4a4d41841f5aab39020a0f9b682b240de/orderer/kafka/config_test.go#L31)<br><strong>Comment</strong>: <pre>All changes unneeded</pre><strong>Commenter</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>CommentLine</strong>: [orderer/kafka/config_test.go#L31](https://github.com/hyperledger-gerrit-archive/fabric/blob/288dc3a4a4d41841f5aab39020a0f9b682b240de/orderer/kafka/config_test.go#L31)<br><strong>Comment</strong>: <pre>I'm going to wait until I rebase off of Kostas' changeset</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [orderer/main.go#L86](https://github.com/hyperledger-gerrit-archive/fabric/blob/288dc3a4a4d41841f5aab39020a0f9b682b240de/orderer/main.go#L86)<br><strong>Comment</strong>: <pre>This case is going away, it's not the end of the world to pass the genesis block to it, but to reduce merge conflicts, I would leave it as is rather than pass in a genesis block.</pre><strong>Commenter</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>CommentLine</strong>: [orderer/main.go#L86](https://github.com/hyperledger-gerrit-archive/fabric/blob/288dc3a4a4d41841f5aab39020a0f9b682b240de/orderer/main.go#L86)<br><strong>Comment</strong>: <pre>Done</pre></blockquote><h3>PatchSet Number: 7</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: tuand27613 - tdang@us.ibm.com<br><strong>Uploader</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>Created</strong>: 12/13/2016, 1:52:57 PM<br><strong>UnmergedRevision</strong>: [b2a91a840d6548418a6517e8e73365ec52b29407](https://github.com/hyperledger-gerrit-archive/fabric/commit/b2a91a840d6548418a6517e8e73365ec52b29407)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/13/2016, 2:24:40 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Approved</strong>: 12/13/2016, 3:37:08 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [orderer/common/bootstrap/file/bootstrap.go#L30](https://github.com/hyperledger-gerrit-archive/fabric/blob/b2a91a840d6548418a6517e8e73365ec52b29407/orderer/common/bootstrap/file/bootstrap.go#L30)<br><strong>Comment</strong>: <pre>the file location should be defined in yaml, and we do need the file to see the format and what can be done.

For CI, we should have a file in code where bootstrap_test.go is. The test code can redefine the location in yaml.</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [orderer/common/bootstrap/file/bootstrap.go#L40](https://github.com/hyperledger-gerrit-archive/fabric/blob/b2a91a840d6548418a6517e8e73365ec52b29407/orderer/common/bootstrap/file/bootstrap.go#L40)<br><strong>Comment</strong>: <pre>The chainID is encoded in the genesis block, no need to generate one.</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [orderer/common/bootstrap/file/bootstrap_test.go#L83](https://github.com/hyperledger-gerrit-archive/fabric/blob/b2a91a840d6548418a6517e8e73365ec52b29407/orderer/common/bootstrap/file/bootstrap_test.go#L83)<br><strong>Comment</strong>: <pre>This should be t.Fatalf(.) since we don't want to continue execution of this test.</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [orderer/common/bootstrap/file/bootstrap_test.go#L87](https://github.com/hyperledger-gerrit-archive/fabric/blob/b2a91a840d6548418a6517e8e73365ec52b29407/orderer/common/bootstrap/file/bootstrap_test.go#L87)<br><strong>Comment</strong>: <pre>same as above</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [orderer/common/bootstrap/file/bootstrap_test.go#L91](https://github.com/hyperledger-gerrit-archive/fabric/blob/b2a91a840d6548418a6517e8e73365ec52b29407/orderer/common/bootstrap/file/bootstrap_test.go#L91)<br><strong>Comment</strong>: <pre>same as above</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [orderer/localconfig/config.go#L110](https://github.com/hyperledger-gerrit-archive/fabric/blob/b2a91a840d6548418a6517e8e73365ec52b29407/orderer/localconfig/config.go#L110)<br><strong>Comment</strong>: <pre>Why would the default like this?  It should be from yaml.</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [orderer/main.go#L94](https://github.com/hyperledger-gerrit-archive/fabric/blob/b2a91a840d6548418a6517e8e73365ec52b29407/orderer/main.go#L94)<br><strong>Comment</strong>: <pre>Should be set in yaml, and can be override with cli or env parameter. See how done on peer for consistency.</pre></blockquote>
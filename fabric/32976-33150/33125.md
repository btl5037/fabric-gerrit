<strong>Project</strong>: fabric<br><strong>Branch</strong>: master<br><strong>ID</strong>: 33125<br><strong>Subject</strong>: [FAB-16391] Flatten and extend tx.Envelope<br><strong>Status</strong>: MERGED<br><strong>Owner</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Assignee</strong>:<br><strong>Created</strong>: 8/22/2019, 10:59:16 AM<br><strong>LastUpdated</strong>: 8/25/2019, 8:29:54 PM<br><strong>CommitMessage</strong>:<br><pre>[FAB-16391] Flatten and extend tx.Envelope

Change-Id: I8a77b6c7734cb080859998a9b0e5361e38e0b4bd
Signed-off-by: Alessandro Sorniotti <ale.linux@sopit.net>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 8/22/2019, 10:59:16 AM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/22/2019, 11:02:08 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/16707/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/22/2019, 11:02:58 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/22/2019, 11:07:25 AM<br><strong>Message</strong>: <pre>Patch Set 1: F1-VerifyBuild-1

code checks are failed</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/22/2019, 11:08:16 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/16707/ : FAILURE (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/16707</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 8/22/2019, 12:07:51 PM<br><strong>Message</strong>: <pre>Uploaded patch set 2.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/22/2019, 12:11:48 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/16711/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/22/2019, 12:12:46 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/22/2019, 12:20:15 PM<br><strong>Message</strong>: <pre>Patch Set 2: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run IntegrationTest, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/22/2019, 12:21:11 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/16711/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/16711</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/22/2019, 12:23:54 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/14763/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/22/2019, 12:24:34 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/11392/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/22/2019, 12:24:38 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/22/2019, 12:25:38 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Starting Integration tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/22/2019, 12:48:25 PM<br><strong>Message</strong>: <pre>Patch Set 2: F3-UnitTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/22/2019, 1:38:05 PM<br><strong>Message</strong>: <pre>Patch Set 2: F3-IntegrationTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/22/2019, 1:38:50 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/14763/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/14763

https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/11392/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-integration-tests-x86_64/11392</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 8/22/2019, 6:27:31 PM<br><strong>Message</strong>: <pre>Patch Set 2: Code-Review+2</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 8/23/2019, 6:40:26 AM<br><strong>Message</strong>: <pre>Patch Set 2: Code-Review-1

So not directly related to this as it layers on top of a prior commit, but why are we back to defining interfaces in common packages again?

Also ... perhaps people were not aware, but "pkg" is for client linkable code not for packages which are used internally.  For that, you should use `internal/pkg`</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 8/23/2019, 8:25:16 AM<br><strong>Message</strong>: <pre>Patch Set 2:

1) this CR doesn't touch any interface
2) the interface you're (probably) talking about was merged here

https://gerrit.hyperledger.org/r/#/c/fabric/+/32804/

which is actually the follow-up from

https://gerrit.hyperledger.org/r/#/c/fabric/+/29132/

The CR has received extensive reviews from Matt, Dave, Jason, Manish, Murali, Sheehan among others. Just to catch you up on the points you brought up

1) we define interface in common packages because they are supposed to be implemented multiple times in different parts of the code and serve as an API contract

2) the interface is defined in pkg on purpose to make the API contract public so that new transaction processors may be defined by 3rd parties.</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 8/23/2019, 2:09:03 PM<br><strong>Message</strong>: <pre>Patch Set 2: -Code-Review

> 1) this CR doesn't touch any interface
 > 2) the interface you're (probably) talking about was merged here
 > 
 > https://gerrit.hyperledger.org/r/#/c/fabric/+/32804/
 > 
 > which is actually the follow-up from
 > 
 > https://gerrit.hyperledger.org/r/#/c/fabric/+/29132/
 > 
 > The CR has received extensive reviews from Matt, Dave, Jason,
 > Manish, Murali, Sheehan among others. Just to catch you up on the
 > points you brought up
 > 
 > 1) we define interface in common packages because they are supposed
 > to be implemented multiple times in different parts of the code and
 > serve as an API contract
 > 
 > 2) the interface is defined in pkg on purpose to make the API
 > contract public so that new transaction processors may be defined
 > by 3rd parties.

I'll buy the 3rd party part ... but generally speaking you implement interfaces ... there is really no need to define them the way you do in Java</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 8/23/2019, 2:20:40 PM<br><strong>Message</strong>: <pre>Patch Set 2:

> > 1) this CR doesn't touch any interface
 > > 2) the interface you're (probably) talking about was merged here
 > >
 > > https://gerrit.hyperledger.org/r/#/c/fabric/+/32804/
 > >
 > > which is actually the follow-up from
 > >
 > > https://gerrit.hyperledger.org/r/#/c/fabric/+/29132/
 > >
 > > The CR has received extensive reviews from Matt, Dave, Jason,
 > > Manish, Murali, Sheehan among others. Just to catch you up on the
 > > points you brought up
 > >
 > > 1) we define interface in common packages because they are
 > supposed
 > > to be implemented multiple times in different parts of the code
 > and
 > > serve as an API contract
 > >
 > > 2) the interface is defined in pkg on purpose to make the API
 > > contract public so that new transaction processors may be defined
 > > by 3rd parties.
 > 
 > I'll buy the 3rd party part ... but generally speaking you
 > implement interfaces ... there is really no need to define them the
 > way you do in Java

I meant to say an implementation satisfies an interface.  But in any case, this was in reference to the initial CR which created this stuff.</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 8/23/2019, 3:07:14 PM<br><strong>Message</strong>: <pre>Patch Set 2:

To be honest I was also confused by the fact that we started the validation refactoring work by defining an interface - and I brought it up. But I was assured that this would be one of those cases where the definition of an interface away from its implementation would make sense as a way of defining a common interface that would be implemented multiple times (and also possibly in parallel) - case in point, we're working in parallel on an implementation of this interface to handle endorser transaction and another one to handle config transaction.</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 8/25/2019, 7:53:19 PM<br><strong>Message</strong>: <pre>Patch Set 2: Code-Review+2</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 8/25/2019, 7:53:30 PM<br><strong>Message</strong>: <pre>Change has been successfully merged by Artem Barger</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/25/2019, 7:53:41 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-merge-x86_64/7518/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/25/2019, 7:53:41 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-merge-end-2-end-x86_64/6215/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/25/2019, 8:29:54 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-merge-end-2-end-x86_64/6215/ : FAILURE (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-merge-end-2-end-x86_64/6215

https://jenkins.hyperledger.org/job/fabric-merge-x86_64/7518/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-merge-x86_64/7518</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Created</strong>: 1566485956<br><strong>GitHubRevision</strong>: [b78ac429ec0194d3490698aa6f2fc22ee90a68d9](https://github.com/hyperledger/fabric/commit/b78ac429ec0194d3490698aa6f2fc22ee90a68d9)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 8/22/2019, 11:07:25 AM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Created</strong>: 1566490071<br><strong>GitHubRevision</strong>: [1885ac2e0338c23370bcf23d67727c408a260c4b](https://github.com/hyperledger/fabric/commit/1885ac2e0338c23370bcf23d67727c408a260c4b)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 8/22/2019, 12:20:15 PM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 8/22/2019, 12:20:15 PM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 8/22/2019, 1:38:05 PM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 8/22/2019, 12:48:25 PM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Approved</strong>: 8/22/2019, 6:27:31 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Approved</strong>: 8/25/2019, 7:53:19 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>MergedBy</strong>: Artem Barger<br><strong>Merged</strong>: 8/25/2019, 7:53:30 PM<br><br></blockquote>
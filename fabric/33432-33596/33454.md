<strong>Project</strong>: fabric<br><strong>Branch</strong>: master<br><strong>ID</strong>: 33454<br><strong>Subject</strong>: [FAB-16560] []SignedData to []Identity converter<br><strong>Status</strong>: MERGED<br><strong>Owner</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Assignee</strong>:<br><strong>Created</strong>: 9/11/2019, 9:41:36 AM<br><strong>LastUpdated</strong>: 10/15/2019, 3:53:55 PM<br><strong>CommitMessage</strong>:<br><pre>[FAB-16560] []SignedData to []Identity converter

As part of the policy rework, we need a helper function to convert a slice of
signed data into a slice of identities, such that each identity in the slice
is valid according to the supplied identity deserialiser and it produced a
valid signature over the message. Furthermore, the converter deduplicates
identities.

Change-Id: I26f381024527b449b5d1567fe89e14a46fd61d48
Signed-off-by: Alessandro Sorniotti <ale.linux@sopit.net>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 9/11/2019, 9:41:36 AM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/11/2019, 9:46:48 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/17074/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/11/2019, 9:47:35 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/11/2019, 9:54:33 AM<br><strong>Message</strong>: <pre>Patch Set 1: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run IntegrationTest, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/11/2019, 9:55:30 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/17074/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/17074</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/11/2019, 9:57:48 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/15056/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/11/2019, 9:57:48 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/11688/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/11/2019, 9:58:37 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/11/2019, 9:58:39 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Starting Integration tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/11/2019, 10:26:51 AM<br><strong>Message</strong>: <pre>Patch Set 1: F3-UnitTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/11/2019, 11:13:54 AM<br><strong>Message</strong>: <pre>Patch Set 1: F3-IntegrationTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/11/2019, 11:14:48 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/11688/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-integration-tests-x86_64/11688

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/15056/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/15056</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 9/11/2019, 1:15:46 PM<br><strong>Message</strong>: <pre>Uploaded patch set 2.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/11/2019, 1:18:26 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/17078/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/11/2019, 1:19:22 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/11/2019, 1:26:57 PM<br><strong>Message</strong>: <pre>Patch Set 2: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run IntegrationTest, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/11/2019, 1:27:51 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/17078/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/17078</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/11/2019, 1:29:55 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/11692/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/11/2019, 1:30:41 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/15060/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/11/2019, 1:30:41 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Starting Integration tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/11/2019, 1:31:30 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/11/2019, 2:02:22 PM<br><strong>Message</strong>: <pre>Patch Set 2: F3-UnitTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/11/2019, 2:43:57 PM<br><strong>Message</strong>: <pre>Patch Set 2: F3-IntegrationTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 9/11/2019, 2:44:45 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/11692/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-integration-tests-x86_64/11692

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/15060/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/15060</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 9/26/2019, 10:59:07 AM<br><strong>Message</strong>: <pre>Patch Set 2: Code-Review-1

(5 comments)

Much of this code looks familiar https://gerrit.hyperledger.org/r/c/fabric/+/12077 :), the originator really didn't know what he was doing.</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 10/7/2019, 5:31:26 AM<br><strong>Message</strong>: <pre>Patch Set 2:

(5 comments)

Thx Jason - see below + new drop at the top of the stack</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 10/7/2019, 5:32:36 AM<br><strong>Message</strong>: <pre>Patch Set 3: Patch Set 2 was rebased</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 10/7/2019, 11:05:05 AM<br><strong>Message</strong>: <pre>Patch Set 3:

(3 comments)</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 10/7/2019, 11:14:08 AM<br><strong>Message</strong>: <pre>Patch Set 3: Code-Review+2</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 10/12/2019, 4:15:38 AM<br><strong>Message</strong>: <pre>Patch Set 3: Code-Review+2

(3 comments)

I think that my comments on comments should be addressed but fine if done in a later change</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 10/12/2019, 4:34:44 AM<br><strong>Message</strong>: <pre>Patch Set 4: Patch Set 3 was rebased</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 10/12/2019, 5:45:47 AM<br><strong>Message</strong>: <pre>Patch Set 4:

(3 comments)</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 10/14/2019, 3:46:44 AM<br><strong>Message</strong>: <pre>Patch Set 3:

(1 comment)</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 10/15/2019, 6:41:07 AM<br><strong>Message</strong>: <pre>Patch Set 4:

(1 comment)</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 10/15/2019, 3:20:52 PM<br><strong>Message</strong>: <pre>Change has been successfully merged by Gari Singh</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 10/15/2019, 3:23:16 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-merge-x86_64/7858/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 10/15/2019, 3:23:26 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-merge-end-2-end-x86_64/6562/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 10/15/2019, 3:53:55 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-merge-end-2-end-x86_64/6562/ : FAILURE (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-merge-end-2-end-x86_64/6562

https://jenkins.hyperledger.org/job/fabric-merge-x86_64/7858/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-merge-x86_64/7858</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Created</strong>: 9/11/2019, 9:41:36 AM<br><strong>UnmergedRevision</strong>: [9173327532a7e1e4ed66036141bb321fc7af1ca3](https://github.com/hyperledger-gerrit-archive/fabric/commit/9173327532a7e1e4ed66036141bb321fc7af1ca3)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 9/11/2019, 9:54:33 AM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 9/11/2019, 9:54:33 AM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 9/11/2019, 11:13:54 AM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 9/11/2019, 10:26:51 AM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Created</strong>: 9/11/2019, 1:15:46 PM<br><strong>UnmergedRevision</strong>: [04d3f06ca2d79fd23b38622f3941917e49a61984](https://github.com/hyperledger-gerrit-archive/fabric/commit/04d3f06ca2d79fd23b38622f3941917e49a61984)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 9/11/2019, 1:26:57 PM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 9/11/2019, 1:26:57 PM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 9/11/2019, 2:43:57 PM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 9/11/2019, 2:02:22 PM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Approved</strong>: 9/26/2019, 10:59:07 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [common/policies/policy.go#L337](https://github.com/hyperledger-gerrit-archive/fabric/blob/04d3f06ca2d79fd23b38622f3941917e49a61984/common/policies/policy.go#L337)<br><strong>Comment</strong>: <pre>The comment should also mention that we deduplicate the identities.</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [common/policies/policy.go#L337](https://github.com/hyperledger-gerrit-archive/fabric/blob/04d3f06ca2d79fd23b38622f3941917e49a61984/common/policies/policy.go#L337)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [common/policies/policy.go#L339](https://github.com/hyperledger-gerrit-archive/fabric/blob/04d3f06ca2d79fd23b38622f3941917e49a61984/common/policies/policy.go#L339)<br><strong>Comment</strong>: <pre>Super-nit, but this could simply be made a literal:

 map[string]struct{}{}</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [common/policies/policy.go#L339](https://github.com/hyperledger-gerrit-archive/fabric/blob/04d3f06ca2d79fd23b38622f3941917e49a61984/common/policies/policy.go#L339)<br><strong>Comment</strong>: <pre>Done. But, FYI, I suspected that the generated code would anyway be identical and verified with "go tool objdump" that indeed the generated code is indeed identical.</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [common/policies/policy.go#L339](https://github.com/hyperledger-gerrit-archive/fabric/blob/04d3f06ca2d79fd23b38622f3941917e49a61984/common/policies/policy.go#L339)<br><strong>Comment</strong>: <pre>As I mentioned, extremely nit-picky, almost didn't mention it.  But, just slightly more idiomatic not to use 'make' for map initialization, or so I'm told.</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [common/policies/policy.go#L354](https://github.com/hyperledger-gerrit-archive/fabric/blob/04d3f06ca2d79fd23b38622f3941917e49a61984/common/policies/policy.go#L354)<br><strong>Comment</strong>: <pre>This is a string, no? Why the %+v?</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [common/policies/policy.go#L354](https://github.com/hyperledger-gerrit-archive/fabric/blob/04d3f06ca2d79fd23b38622f3941917e49a61984/common/policies/policy.go#L354)<br><strong>Comment</strong>: <pre>Ah yes, copy/paste hiccup there - thx</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [common/policies/policy.go#L360](https://github.com/hyperledger-gerrit-archive/fabric/blob/04d3f06ca2d79fd23b38622f3941917e49a61984/common/policies/policy.go#L360)<br><strong>Comment</strong>: <pre>If we are bothering printing the pointer here, we should probably add is to the othre log statements as well.</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [common/policies/policy.go#L360](https://github.com/hyperledger-gerrit-archive/fabric/blob/04d3f06ca2d79fd23b38622f3941917e49a61984/common/policies/policy.go#L360)<br><strong>Comment</strong>: <pre>I actually changed the format string to avoid printing the pointer - doesn't add much imho</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [common/policies/policy.go#L360](https://github.com/hyperledger-gerrit-archive/fabric/blob/04d3f06ca2d79fd23b38622f3941917e49a61984/common/policies/policy.go#L360)<br><strong>Comment</strong>: <pre>Yes, I think that's generally true.  The original idea had been that if we were evaluating policies in parallel, the pointer would give us a better idea which lines were associated with which evaluation.  This would be better handled with an injected logger.</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [common/policies/policy_test.go#L248](https://github.com/hyperledger-gerrit-archive/fabric/blob/04d3f06ca2d79fd23b38622f3941917e49a61984/common/policies/policy_test.go#L248)<br><strong>Comment</strong>: <pre>Let's not introduce any new bespoke mocks.  Let's generate a proper counterfeiter mock instead.</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [common/policies/policy_test.go#L248](https://github.com/hyperledger-gerrit-archive/fabric/blob/04d3f06ca2d79fd23b38622f3941917e49a61984/common/policies/policy_test.go#L248)<br><strong>Comment</strong>: <pre>Sure thing, will fix at the top of the stack</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [common/policies/policy_test.go#L248](https://github.com/hyperledger-gerrit-archive/fabric/blob/04d3f06ca2d79fd23b38622f3941917e49a61984/common/policies/policy_test.go#L248)<br><strong>Comment</strong>: <pre>For such a substantive change, and since there are no +2-s to lose, I'd think it's more appropriate to fix in place.  I suppose I need to get used to the 'change it on top' model if we're moving to github.</pre></blockquote><h3>PatchSet Number: 3</h3><blockquote><strong>Type</strong>: TRIVIAL_REBASE<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Created</strong>: 10/7/2019, 5:32:36 AM<br><strong>UnmergedRevision</strong>: [74fe65fd847f711e196a384b0b17336e7b5992d0](https://github.com/hyperledger-gerrit-archive/fabric/commit/74fe65fd847f711e196a384b0b17336e7b5992d0)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 9/11/2019, 1:26:57 PM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 9/11/2019, 1:26:57 PM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 9/11/2019, 2:43:57 PM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 9/11/2019, 2:02:22 PM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Approved</strong>: 10/7/2019, 11:14:08 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Approved</strong>: 10/12/2019, 4:15:38 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [common/policies/policy.go#L345](https://github.com/hyperledger-gerrit-archive/fabric/blob/74fe65fd847f711e196a384b0b17336e7b5992d0/common/policies/policy.go#L345)<br><strong>Comment</strong>: <pre>I don't really think we need to log here, but if anything this should be at debug level</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [common/policies/policy.go#L345](https://github.com/hyperledger-gerrit-archive/fabric/blob/74fe65fd847f711e196a384b0b17336e7b5992d0/common/policies/policy.go#L345)<br><strong>Comment</strong>: <pre>Let's think about it: a principal deserialisation error here would mean that we are possibly committing a tx with garbage in the creator or endorser field. Is that really something for a debug log only?</pre><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [common/policies/policy.go#L345](https://github.com/hyperledger-gerrit-archive/fabric/blob/74fe65fd847f711e196a384b0b17336e7b5992d0/common/policies/policy.go#L345)<br><strong>Comment</strong>: <pre>Let me add some more color here.  The text of this log message and the lack of context for this log message do not provide any meaningful information for someone to act on.  If you really want to do this, then the function itself should actually return a list of warnings to the caller and this would need to be passed up the stack such that it can be logged in the context of the block / transaction actually being processed.</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [common/policies/policy.go#L345](https://github.com/hyperledger-gerrit-archive/fabric/blob/74fe65fd847f711e196a384b0b17336e7b5992d0/common/policies/policy.go#L345)<br><strong>Comment</strong>: <pre>That's a good point, although (at least for tx validation), peer logs will display a debug/info line stating that validation of tx with ID .... has started, and after that we'll see any warning concerning that txid.

Still, I believe it would be even better to have the txid directly attached to the message, so I've opened FAB-16835 to track the work.</pre><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [common/policies/policy.go#L354](https://github.com/hyperledger-gerrit-archive/fabric/blob/74fe65fd847f711e196a384b0b17336e7b5992d0/common/policies/policy.go#L354)<br><strong>Comment</strong>: <pre>same comment ... debug if anything</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [common/policies/policy.go#L354](https://github.com/hyperledger-gerrit-archive/fabric/blob/74fe65fd847f711e196a384b0b17336e7b5992d0/common/policies/policy.go#L354)<br><strong>Comment</strong>: <pre>Even more suspicious - somebody has packed two endorsements from the same entity in the same tx - I think it deserves a warning</pre><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [common/policies/policy.go#L363](https://github.com/hyperledger-gerrit-archive/fabric/blob/74fe65fd847f711e196a384b0b17336e7b5992d0/common/policies/policy.go#L363)<br><strong>Comment</strong>: <pre>I don't think we need this message</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [common/policies/policy.go#L363](https://github.com/hyperledger-gerrit-archive/fabric/blob/74fe65fd847f711e196a384b0b17336e7b5992d0/common/policies/policy.go#L363)<br><strong>Comment</strong>: <pre>agreed - will fix at the top of the stack</pre></blockquote><h3>PatchSet Number: 4</h3><blockquote><strong>Type</strong>: TRIVIAL_REBASE<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Created</strong>: 10/12/2019, 4:34:44 AM<br><strong>GitHubMergedRevision</strong>: [55941be6a3a3d05d34b6ce86fc8c8a2e37c0dee4](https://github.com/hyperledger-gerrit-archive/fabric/commit/55941be6a3a3d05d34b6ce86fc8c8a2e37c0dee4)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 9/11/2019, 1:26:57 PM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 9/11/2019, 1:26:57 PM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 9/11/2019, 2:43:57 PM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 9/11/2019, 2:02:22 PM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Approved</strong>: 10/7/2019, 11:14:08 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Approved</strong>: 10/12/2019, 4:15:38 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>MergedBy</strong>: Gari Singh<br><strong>Merged</strong>: 10/15/2019, 3:20:52 PM<br><br></blockquote>
<strong>Project</strong>: fabric<br><strong>Branch</strong>: master<br><strong>ID</strong>: 4877<br><strong>Subject</strong>: [FAB-1648] Enable BCCSP configuration w. JSON/YAML<br><strong>Status</strong>: MERGED<br><strong>Owner</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Assignee</strong>:<br><strong>Created</strong>: 1/26/2017, 11:21:16 AM<br><strong>LastUpdated</strong>: 2/19/2017, 5:12:46 PM<br><strong>CommitMessage</strong>:<br><pre>[FAB-1648] Enable BCCSP configuration w. JSON/YAML

Require call to
   func InitFactories(config *FactoryOpts)

That takes a config file appropriate for json.Unmarshall() and
viper.UnmarshallKey()

Removed ability from factory.go to get BCCSP instances on new Opts.

Factory API is now:
   func GetDefault() (bccsp.BCCSP, error)
   func GetBCCSP(name string) (bccsp.BCCSP, error)

InitFactories reads the config, initializes a hashmap for GetBCCSP
and initializes pointer for GetDefault()

To break up this change into digestible pieces, this change
calls InitFactories(nil) as a workaround. Next set of changes will
deal with modifying yaml files and calling InitFactories() with
real data

Change-Id: I7c68e52c75fc6751c7e758bf06dcaa88219aa6a9
Signed-off-by: Volodymyr Paprotski <vpaprots@ca.ibm.com>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Reviewed</strong>: 1/26/2017, 11:21:16 AM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/26/2017, 11:25:51 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/5734/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/26/2017, 11:31:26 AM<br><strong>Message</strong>: <pre>Patch Set 1: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/5734/ : FAILURE</pre><strong>Reviewer</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Reviewed</strong>: 1/26/2017, 1:45:43 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Patch Set 1 is intentionally broken. Pushed so I can discuss if this approach is appropriate. 

bccsp/factory directory is complete, but needs to be integrated into peer & orderer</pre><strong>Reviewer</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Reviewed</strong>: 1/26/2017, 7:39:58 PM<br><strong>Message</strong>: <pre>Uploaded patch set 2.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/26/2017, 7:43:16 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/5771/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/26/2017, 7:54:50 PM<br><strong>Message</strong>: <pre>Patch Set 2: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/5771/ : FAILURE</pre><strong>Reviewer</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>Reviewed</strong>: 1/26/2017, 7:58:32 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Please can we mark this as WIP ?</pre><strong>Reviewer</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>Reviewed</strong>: 1/26/2017, 7:58:56 PM<br><strong>Message</strong>: <pre>Patch Set 2:

As long as it is still WIP :-)</pre><strong>Reviewer</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Reviewed</strong>: 1/26/2017, 8:41:45 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Hmm.. it wasnt supposed to be WIP any more with patch 2! odd failure too.. will investigate</pre><strong>Reviewer</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Reviewed</strong>: 1/27/2017, 10:31:34 AM<br><strong>Message</strong>: <pre>Uploaded patch set 3: Patch Set 2 was rebased.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/27/2017, 10:35:18 AM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/5794/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/27/2017, 11:18:40 AM<br><strong>Message</strong>: <pre>Patch Set 3: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/5794/ : FAILURE</pre><strong>Reviewer</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Reviewed</strong>: 1/27/2017, 3:19:54 PM<br><strong>Message</strong>: <pre>Patch Set 4: Patch Set 3 was rebased</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/27/2017, 3:23:19 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/5823/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/27/2017, 3:33:26 PM<br><strong>Message</strong>: <pre>Patch Set 4: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/5823/ : FAILURE</pre><strong>Reviewer</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Reviewed</strong>: 2/6/2017, 2:04:12 PM<br><strong>Message</strong>: <pre>Patch Set 5: Patch Set 4 was rebased</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/6/2017, 2:07:10 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/6244/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/6/2017, 2:10:39 PM<br><strong>Message</strong>: <pre>Patch Set 5: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/6244/ : FAILURE</pre><strong>Reviewer</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Reviewed</strong>: 2/11/2017, 10:22:25 PM<br><strong>Message</strong>: <pre>Uploaded patch set 6.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/11/2017, 10:27:09 PM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/6759/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/11/2017, 11:37:47 PM<br><strong>Message</strong>: <pre>Patch Set 6: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/6759/ : SUCCESS</pre><strong>Reviewer</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Reviewed</strong>: 2/12/2017, 12:05:40 AM<br><strong>Message</strong>: <pre>Patch Set 7: Patch Set 6 was rebased</pre><strong>Reviewer</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Reviewed</strong>: 2/12/2017, 12:07:23 AM<br><strong>Message</strong>: <pre>Patch Set 8: Commit message was updated.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/12/2017, 12:08:31 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/6762/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/12/2017, 12:10:29 AM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/6763/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/12/2017, 1:06:07 AM<br><strong>Message</strong>: <pre>Patch Set 8: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/6763/ : SUCCESS</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/12/2017, 1:21:12 AM<br><strong>Message</strong>: <pre>Patch Set 7: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/6762/ : SUCCESS</pre><strong>Reviewer</strong>: Angelo De Caro - adc@zurich.ibm.com<br><strong>Reviewed</strong>: 2/13/2017, 7:23:38 AM<br><strong>Message</strong>: <pre>Patch Set 8:

Hi Volodymyr, where is InitFactories called? Without that call, GetDefault will fail, no?</pre><strong>Reviewer</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Reviewed</strong>: 2/13/2017, 9:44:41 AM<br><strong>Message</strong>: <pre>Patch Set 8:

> Hi Volodymyr, where is InitFactories called? Without that call,
 > GetDefault will fail, no?

 > Hi Volodymyr, where is InitFactories called? Without that call,
 > GetDefault will fail, no?

In this patch set, the call is in opts.go. 

Please also have a look in the related change. Thats where I am proposing to have InitFactories 'for real this time'. (I am stuck there however, since the tests also have to call InitFactories(), trying to figure out how to do it without changing every single test!)</pre><strong>Reviewer</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Reviewed</strong>: 2/13/2017, 10:39:42 PM<br><strong>Message</strong>: <pre>Patch Set 9: Patch Set 8 was rebased</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/13/2017, 10:43:11 PM<br><strong>Message</strong>: <pre>Patch Set 9:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/6933/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/13/2017, 10:48:50 PM<br><strong>Message</strong>: <pre>Patch Set 9: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/6933/ : FAILURE</pre><strong>Reviewer</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Reviewed</strong>: 2/14/2017, 7:09:33 AM<br><strong>Message</strong>: <pre>Uploaded patch set 10.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/14/2017, 7:12:40 AM<br><strong>Message</strong>: <pre>Patch Set 10:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/6950/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/14/2017, 7:54:28 AM<br><strong>Message</strong>: <pre>Patch Set 10: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/6950/ : FAILURE</pre><strong>Reviewer</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Reviewed</strong>: 2/14/2017, 11:11:59 AM<br><strong>Message</strong>: <pre>Uploaded patch set 11.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/14/2017, 11:16:06 AM<br><strong>Message</strong>: <pre>Patch Set 11:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/6964/</pre><strong>Reviewer</strong>: Angelo De Caro - adc@zurich.ibm.com<br><strong>Reviewed</strong>: 2/14/2017, 11:56:23 AM<br><strong>Message</strong>: <pre>Patch Set 11:

(1 comment)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/14/2017, 12:13:01 PM<br><strong>Message</strong>: <pre>Patch Set 11: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/6964/ : SUCCESS</pre><strong>Reviewer</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Reviewed</strong>: 2/14/2017, 12:38:49 PM<br><strong>Message</strong>: <pre>Patch Set 11:

(1 comment)</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 2/14/2017, 1:47:01 PM<br><strong>Message</strong>: <pre>Patch Set 11: Code-Review+1

didn't have time to test but overall look pretty good.  would like some other eyes as well</pre><strong>Reviewer</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>Reviewed</strong>: 2/14/2017, 1:49:18 PM<br><strong>Message</strong>: <pre>Patch Set 11:

Gari: OK. V: will cast a full review over this after you address @adc's. Thanks.</pre><strong>Reviewer</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Reviewed</strong>: 2/14/2017, 2:43:45 PM<br><strong>Message</strong>: <pre>Uploaded patch set 12.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/14/2017, 2:47:21 PM<br><strong>Message</strong>: <pre>Patch Set 12:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/6982/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/14/2017, 3:46:14 PM<br><strong>Message</strong>: <pre>Patch Set 12: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/6982/ : SUCCESS</pre><strong>Reviewer</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Reviewed</strong>: 2/17/2017, 12:38:13 AM<br><strong>Message</strong>: <pre>Uploaded patch set 13.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/17/2017, 12:39:05 AM<br><strong>Message</strong>: <pre>Patch Set 13:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/7097/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/17/2017, 1:33:35 AM<br><strong>Message</strong>: <pre>Patch Set 13: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/7097/ : SUCCESS</pre><strong>Reviewer</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Reviewed</strong>: 2/17/2017, 1:38:19 PM<br><strong>Message</strong>: <pre>Uploaded patch set 14.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/17/2017, 1:38:26 PM<br><strong>Message</strong>: <pre>Patch Set 14:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-z/2766/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/17/2017, 1:40:09 PM<br><strong>Message</strong>: <pre>Patch Set 14:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/7132/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/17/2017, 2:41:00 PM<br><strong>Message</strong>: <pre>Patch Set 14: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-z/2766/ : SUCCESS

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/7132/ : SUCCESS</pre><strong>Reviewer</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>Reviewed</strong>: 2/17/2017, 6:31:03 PM<br><strong>Message</strong>: <pre>Patch Set 14: Code-Review-1

(9 comments)

Hi V, I know I promised to go over this before the weekend - so please find a few (friendly!) comments/suggestions inline...

The biggest thing (design-wise) is actually whether or not we would prefer to"panic" or otherwise. See inline and let me know what you think?</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 2/17/2017, 7:19:52 PM<br><strong>Message</strong>: <pre>Patch Set 14:

(1 comment)</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 2/17/2017, 7:26:30 PM<br><strong>Message</strong>: <pre>Patch Set 14:

(1 comment)</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 2/17/2017, 7:30:27 PM<br><strong>Message</strong>: <pre>Patch Set 14:

(1 comment)</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 2/17/2017, 7:33:15 PM<br><strong>Message</strong>: <pre>Patch Set 14:

(1 comment)</pre><strong>Reviewer</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Reviewed</strong>: 2/17/2017, 9:01:08 PM<br><strong>Message</strong>: <pre>Patch Set 14:

(6 comments)

"Will upload new patch for comments I failed to reply to " U "Will upload new patch for comments that say so"</pre><strong>Reviewer</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Reviewed</strong>: 2/19/2017, 12:32:08 PM<br><strong>Message</strong>: <pre>Uploaded patch set 15.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/19/2017, 12:32:15 PM<br><strong>Message</strong>: <pre>Patch Set 15:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-z/2900/ (1/2)</pre><strong>Reviewer</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Reviewed</strong>: 2/19/2017, 12:32:33 PM<br><strong>Message</strong>: <pre>Patch Set 14:

(4 comments)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/19/2017, 12:35:57 PM<br><strong>Message</strong>: <pre>Patch Set 15:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/7265/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/19/2017, 1:39:58 PM<br><strong>Message</strong>: <pre>Patch Set 15: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-z/2900/ : SUCCESS

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/7265/ : SUCCESS</pre><strong>Reviewer</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>Reviewed</strong>: 2/19/2017, 3:20:25 PM<br><strong>Message</strong>: <pre>Patch Set 15: Code-Review+2

(5 comments)

I think/agree that if we can't get the "Default" to work - the process should fail... and sooner rather than later.</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 2/19/2017, 4:05:20 PM<br><strong>Message</strong>: <pre>Patch Set 15: Code-Review+2</pre><strong>Reviewer</strong>: Gerrit Code Review - gerrit@hyperledger.org<br><strong>Reviewed</strong>: 2/19/2017, 4:05:22 PM<br><strong>Message</strong>: <pre>Change has been successfully merged by Gari Singh</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/19/2017, 4:05:32 PM<br><strong>Message</strong>: <pre>Patch Set 15:

Build Started https://jenkins.hyperledger.org/job/fabric-merge-z/499/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/19/2017, 4:08:37 PM<br><strong>Message</strong>: <pre>Patch Set 15:

Build Started https://jenkins.hyperledger.org/job/fabric-merge-x86_64/1132/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/19/2017, 5:12:46 PM<br><strong>Message</strong>: <pre>Patch Set 15:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-merge-x86_64/1132/ : SUCCESS

https://jenkins.hyperledger.org/job/fabric-merge-z/499/ : SUCCESS</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Uploader</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Created</strong>: 1/26/2017, 11:21:16 AM<br><strong>UnmergedRevision</strong>: [a1d3eb94ce53f7f5543ab7eaa55bb227de1da69b](https://github.com/hyperledger-gerrit-archive/fabric/commit/a1d3eb94ce53f7f5543ab7eaa55bb227de1da69b)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/26/2017, 11:31:26 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Uploader</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Created</strong>: 1/26/2017, 7:39:58 PM<br><strong>UnmergedRevision</strong>: [e1fd5c52057f5c49a231af329ba055f774895e50](https://github.com/hyperledger-gerrit-archive/fabric/commit/e1fd5c52057f5c49a231af329ba055f774895e50)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/26/2017, 7:54:50 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 3</h3><blockquote><strong>Type</strong>: TRIVIAL_REBASE<br><strong>Author</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Uploader</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Created</strong>: 1/27/2017, 10:31:34 AM<br><strong>UnmergedRevision</strong>: [fd7ba3beb5f55c4b0646a3ff2c05087247603973](https://github.com/hyperledger-gerrit-archive/fabric/commit/fd7ba3beb5f55c4b0646a3ff2c05087247603973)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/27/2017, 11:18:40 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 4</h3><blockquote><strong>Type</strong>: TRIVIAL_REBASE<br><strong>Author</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Uploader</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Created</strong>: 1/27/2017, 3:19:54 PM<br><strong>UnmergedRevision</strong>: [c8251fd95becfb92bd4503a3ac3b57f4b0472a9e](https://github.com/hyperledger-gerrit-archive/fabric/commit/c8251fd95becfb92bd4503a3ac3b57f4b0472a9e)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/27/2017, 3:33:26 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 5</h3><blockquote><strong>Type</strong>: TRIVIAL_REBASE<br><strong>Author</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Uploader</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Created</strong>: 2/6/2017, 2:04:12 PM<br><strong>UnmergedRevision</strong>: [9b2f9db5450489089d564660506a327bed35a17d](https://github.com/hyperledger-gerrit-archive/fabric/commit/9b2f9db5450489089d564660506a327bed35a17d)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 2/6/2017, 2:10:39 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 6</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Uploader</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Created</strong>: 2/11/2017, 10:22:25 PM<br><strong>UnmergedRevision</strong>: [fe5b2008888ccf6370704f21127b00d951f79228](https://github.com/hyperledger-gerrit-archive/fabric/commit/fe5b2008888ccf6370704f21127b00d951f79228)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 2/11/2017, 11:37:47 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 7</h3><blockquote><strong>Type</strong>: TRIVIAL_REBASE<br><strong>Author</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Uploader</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Created</strong>: 2/12/2017, 12:05:40 AM<br><strong>UnmergedRevision</strong>: [e79800def26edfb4d142d5239930e4cd7329fd75](https://github.com/hyperledger-gerrit-archive/fabric/commit/e79800def26edfb4d142d5239930e4cd7329fd75)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 2/12/2017, 1:21:12 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 8</h3><blockquote><strong>Type</strong>: NO_CODE_CHANGE<br><strong>Author</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Uploader</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Created</strong>: 2/12/2017, 12:07:23 AM<br><strong>UnmergedRevision</strong>: [9144705abf6ec22c491ec43778ece07feda81368](https://github.com/hyperledger-gerrit-archive/fabric/commit/9144705abf6ec22c491ec43778ece07feda81368)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 2/12/2017, 1:06:07 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 9</h3><blockquote><strong>Type</strong>: TRIVIAL_REBASE<br><strong>Author</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Uploader</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Created</strong>: 2/13/2017, 10:39:42 PM<br><strong>UnmergedRevision</strong>: [22cb5fcf2ecb56f6f87ab4e88df8f822257773a7](https://github.com/hyperledger-gerrit-archive/fabric/commit/22cb5fcf2ecb56f6f87ab4e88df8f822257773a7)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 2/13/2017, 10:48:50 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 10</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Uploader</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Created</strong>: 2/14/2017, 7:09:33 AM<br><strong>UnmergedRevision</strong>: [a54bca8e0aaf606972f23d89b0b76b9224631209](https://github.com/hyperledger-gerrit-archive/fabric/commit/a54bca8e0aaf606972f23d89b0b76b9224631209)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 2/14/2017, 7:54:28 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 11</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Uploader</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Created</strong>: 2/14/2017, 11:11:59 AM<br><strong>UnmergedRevision</strong>: [680acc510aed293a2fb9d476b33b39d3e76910f1](https://github.com/hyperledger-gerrit-archive/fabric/commit/680acc510aed293a2fb9d476b33b39d3e76910f1)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 2/14/2017, 12:13:01 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Approved</strong>: 2/14/2017, 1:47:01 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Angelo De Caro - adc@zurich.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/rwset/query_results_helper.go#L131](https://github.com/hyperledger-gerrit-archive/fabric/blob/680acc510aed293a2fb9d476b33b39d3e76910f1/core/ledger/kvledger/txmgmt/rwset/query_results_helper.go#L131)<br><strong>Comment</strong>: <pre>shall you return err here?</pre><strong>Commenter</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/rwset/query_results_helper.go#L131](https://github.com/hyperledger-gerrit-archive/fabric/blob/680acc510aed293a2fb9d476b33b39d3e76910f1/core/ledger/kvledger/txmgmt/rwset/query_results_helper.go#L131)<br><strong>Comment</strong>: <pre>Good catch! not sure hot sure how I missed this! I think I was thinking that GetDefault() does not need an err any more.. Fixing.</pre></blockquote><h3>PatchSet Number: 12</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Uploader</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Created</strong>: 2/14/2017, 2:43:45 PM<br><strong>UnmergedRevision</strong>: [d685bb7fe68b02bd7786f7d9abf50fe502c8b951](https://github.com/hyperledger-gerrit-archive/fabric/commit/d685bb7fe68b02bd7786f7d9abf50fe502c8b951)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 2/14/2017, 3:46:14 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 13</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Uploader</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Created</strong>: 2/17/2017, 12:38:13 AM<br><strong>UnmergedRevision</strong>: [c5a34b04851834afc9795111d2692a33f9ecb8e2](https://github.com/hyperledger-gerrit-archive/fabric/commit/c5a34b04851834afc9795111d2692a33f9ecb8e2)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 2/17/2017, 1:33:35 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 14</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Uploader</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Created</strong>: 2/17/2017, 1:38:19 PM<br><strong>UnmergedRevision</strong>: [2e98be8d297cd082a5620417225322ddab1d2944](https://github.com/hyperledger-gerrit-archive/fabric/commit/2e98be8d297cd082a5620417225322ddab1d2944)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 2/17/2017, 2:41:00 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>Approved</strong>: 2/17/2017, 6:31:03 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [bccsp/factory/factory.go#L56](https://github.com/hyperledger-gerrit-archive/fabric/blob/2e98be8d297cd082a5620417225322ddab1d2944/bccsp/factory/factory.go#L56)<br><strong>Comment</strong>: <pre>I must be missing something.
If you panic here when the defaultBCCSP is nil, why not also panic when trying to set defaultBCCSP's value in line 107?</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [bccsp/factory/factory.go#L56](https://github.com/hyperledger-gerrit-archive/fabric/blob/2e98be8d297cd082a5620417225322ddab1d2944/bccsp/factory/factory.go#L56)<br><strong>Comment</strong>: <pre>(I mean obviously, when you fail to do so)</pre><strong>Commenter</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>CommentLine</strong>: [bccsp/factory/factory.go#L56](https://github.com/hyperledger-gerrit-archive/fabric/blob/2e98be8d297cd082a5620417225322ddab1d2944/bccsp/factory/factory.go#L56)<br><strong>Comment</strong>: <pre>The usage that I originally wanted to see was, `GetDefault()` always succeeds. In fact, I didn't have that panic() call in there before. Then I thought, well.. as a developer, I would much rather get a panic() error message with some 'helpful/searchable' text, then some random Null Pointer Exception.. 

What I really wanted was to use this panic() to catch all the offenders that now should be really calling InitFabric() so that there is a backtrace to fix to.

I had noticed that many of the missing InitFabric() calls where from places that didnt really need to care about BCCSP (like test cases). So I figured I would let InitFabric(nil) to default to whatever defaults fabric uses today.

After dozen and a half rebases.. now not even sure if that is all that useful any more.. I had made DefaultOpt a package-public variable, so one can just use that and I can ignore the error checking in InitFactories.</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [bccsp/factory/factory.go#L103](https://github.com/hyperledger-gerrit-archive/fabric/blob/2e98be8d297cd082a5620417225322ddab1d2944/bccsp/factory/factory.go#L103)<br><strong>Comment</strong>: <pre>V, be careful - you may have a "factoriesInitError" set here, and then you may override it with a different error message (regarding the BCCSP or otherwise @line 109.</pre><strong>Commenter</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>CommentLine</strong>: [bccsp/factory/factory.go#L103](https://github.com/hyperledger-gerrit-archive/fabric/blob/2e98be8d297cd082a5620417225322ddab1d2944/bccsp/factory/factory.go#L103)<br><strong>Comment</strong>: <pre>You know how there are clever things that actually make the code harder to grock later on? this might be one of them..

I wanted to initialize all the factories/BCCSPs. Well.. So errors are stacked.. notice the "%s\n...", factoriesInitError on line 102 and 109.</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [bccsp/factory/pkcs11factory.go#L66](https://github.com/hyperledger-gerrit-archive/fabric/blob/2e98be8d297cd082a5620417225322ddab1d2944/bccsp/factory/pkcs11factory.go#L66)<br><strong>Comment</strong>: <pre>"Failed initializing"
->
"Failed to initialize"</pre><strong>Commenter</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>CommentLine</strong>: [bccsp/factory/pkcs11factory.go#L66](https://github.com/hyperledger-gerrit-archive/fabric/blob/2e98be8d297cd082a5620417225322ddab1d2944/bccsp/factory/pkcs11factory.go#L66)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [bccsp/factory/swfactory.go#L55](https://github.com/hyperledger-gerrit-archive/fabric/blob/2e98be8d297cd082a5620417225322ddab1d2944/bccsp/factory/swfactory.go#L55)<br><strong>Comment</strong>: <pre>"Failed to initialize ..."</pre><strong>Commenter</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>CommentLine</strong>: [bccsp/factory/swfactory.go#L55](https://github.com/hyperledger-gerrit-archive/fabric/blob/2e98be8d297cd082a5620417225322ddab1d2944/bccsp/factory/swfactory.go#L55)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [bccsp/pkcs11/pkcs11.go#L40](https://github.com/hyperledger-gerrit-archive/fabric/blob/2e98be8d297cd082a5620417225322ddab1d2944/bccsp/pkcs11/pkcs11.go#L40)<br><strong>Comment</strong>: <pre>Yes to public Init(s) ! (where applicable)</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/rwset/query_results_helper_test.go#L136](https://github.com/hyperledger-gerrit-archive/fabric/blob/2e98be8d297cd082a5620417225322ddab1d2944/core/ledger/kvledger/txmgmt/rwset/query_results_helper_test.go#L136)<br><strong>Comment</strong>: <pre>So,

I know that currently [ (URL enclosed) "bccspfactory.GetDefault()" ] won't throw - as worst-case, it "panic()"s.


But I don't know if I would like a process to panic when all I tried to do is ask for a hash calculation...</pre><strong>Commenter</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/rwset/query_results_helper_test.go#L136](https://github.com/hyperledger-gerrit-archive/fabric/blob/2e98be8d297cd082a5620417225322ddab1d2944/core/ledger/kvledger/txmgmt/rwset/query_results_helper_test.go#L136)<br><strong>Comment</strong>: <pre>See my (lenghty?) reply to Yacov... The short (err.. not after I typed it all..) of it, I would like to think that once BCCSP is set up, one should _always_ be able to get a default. If you get a panic, it really means the 'contract' with BCCSP apis was not satisfied and its not in a usable state. 
Or another way, it is a marker/defect for me, "Vlad, there is still a bug in the code somewhere that is not using BCCSP properly".</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/rwset/query_results_helper_test.go#L136](https://github.com/hyperledger-gerrit-archive/fabric/blob/2e98be8d297cd082a5620417225322ddab1d2944/core/ledger/kvledger/txmgmt/rwset/query_results_helper_test.go#L136)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/rwset/query_results_helper_test.go#L136](https://github.com/hyperledger-gerrit-archive/fabric/blob/2e98be8d297cd082a5620417225322ddab1d2944/core/ledger/kvledger/txmgmt/rwset/query_results_helper_test.go#L136)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [msp/mspimpl.go#L211](https://github.com/hyperledger-gerrit-archive/fabric/blob/2e98be8d297cd082a5620417225322ddab1d2944/msp/mspimpl.go#L211)<br><strong>Comment</strong>: <pre>Wait, we pass in a cert, right?

While I know it's not a public method, and I don't want to be a "pain"... [ BUT ;-) ]

This method validates/checks/verifies or so a "Certificate" much more than a "CA"... let's name it accordingly?

We are not really checking if the "Certificate Authority is properly formed"... if you see what I mean?</pre><strong>Commenter</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>CommentLine</strong>: [msp/mspimpl.go#L211](https://github.com/hyperledger-gerrit-archive/fabric/blob/2e98be8d297cd082a5620417225322ddab1d2944/msp/mspimpl.go#L211)<br><strong>Comment</strong>: <pre>Since its not code I dropped.. it must be perfect already! :) Maybe the intent was to add more checks later? How about `isCACert`?</pre><strong>Commenter</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>CommentLine</strong>: [msp/mspimpl.go#L211](https://github.com/hyperledger-gerrit-archive/fabric/blob/2e98be8d297cd082a5620417225322ddab1d2944/msp/mspimpl.go#L211)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [msp/mspimpl.go#L211](https://github.com/hyperledger-gerrit-archive/fabric/blob/2e98be8d297cd082a5620417225322ddab1d2944/msp/mspimpl.go#L211)<br><strong>Comment</strong>: <pre>Yes, sure - isCACert works, thanks.</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [msp/mspimpl.go#L219](https://github.com/hyperledger-gerrit-archive/fabric/blob/2e98be8d297cd082a5620417225322ddab1d2944/msp/mspimpl.go#L219)<br><strong>Comment</strong>: <pre>What happened to our branch-prediction-ability? ;-)

You can (also) combine the two if()s to one, returning false... o.w. return true.</pre><strong>Commenter</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>CommentLine</strong>: [msp/mspimpl.go#L219](https://github.com/hyperledger-gerrit-archive/fabric/blob/2e98be8d297cd082a5620417225322ddab1d2944/msp/mspimpl.go#L219)<br><strong>Comment</strong>: <pre>Actually.. I like this style!! I let the compiler do all that magic boolean logic.. You should see some 'lovely' C++ code with 10-20 line conditional statements.. with assignments as well as boolean operators. Whomever wrote this code, must have shared my experience!</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [msp/mspimpl.go#L219](https://github.com/hyperledger-gerrit-archive/fabric/blob/2e98be8d297cd082a5620417225322ddab1d2944/msp/mspimpl.go#L219)<br><strong>Comment</strong>: <pre>Sure, I don't have a strong preference either way, really.</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [peer/gossip/mcs/mcs.go#L85](https://github.com/hyperledger-gerrit-archive/fabric/blob/2e98be8d297cd082a5620417225322ddab1d2944/peer/gossip/mcs/mcs.go#L85)<br><strong>Comment</strong>: <pre>Similarly: 

So I know that currently [ (URL enclosed) "bccspfactory.GetDefault()" ] won't throw - as worst-case, it "panic()s" !

But I don't know if I would like a process to panic when all I tried to do is ask for a hash calculation...</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [peer/gossip/mcs/mcs.go#L85](https://github.com/hyperledger-gerrit-archive/fabric/blob/2e98be8d297cd082a5620417225322ddab1d2944/peer/gossip/mcs/mcs.go#L85)<br><strong>Comment</strong>: <pre>If I may chime in and add a second opinion - I see no reason not to panic if you can't obtain the factory instance. Underneath what is done is initializing all kinds of file-backed keystores, which is done only once.
After the 1st time, the same instance is returned so the only chance of panicking, IIUC is if you can't initialize the factory at boot time. Therefore, I think that it is best to make a peer crash at boot time if there is indeed some critical problem such as this.</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [peer/gossip/mcs/mcs.go#L85](https://github.com/hyperledger-gerrit-archive/fabric/blob/2e98be8d297cd082a5620417225322ddab1d2944/peer/gossip/mcs/mcs.go#L85)<br><strong>Comment</strong>: <pre>Now I see that in the change set, he separated the logic of initializing, and getting the instance itself.
I think that panic here is a good thing because otherwise, the method would return nil and we currently have no unit tests that bind BCCSP-MSP with gossip, and gossip is the sole user of this method- hence the unit tests would pass in CI and a bug would be introduced and will be a pain to debug.</pre><strong>Commenter</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>CommentLine</strong>: [peer/gossip/mcs/mcs.go#L85](https://github.com/hyperledger-gerrit-archive/fabric/blob/2e98be8d297cd082a5620417225322ddab1d2944/peer/gossip/mcs/mcs.go#L85)<br><strong>Comment</strong>: <pre>Ah, but I wrote all that long reply and you already got your answer yourself! Heh :D</pre><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [protos/utils/txutils.go#L307](https://github.com/hyperledger-gerrit-archive/fabric/blob/2e98be8d297cd082a5620417225322ddab1d2944/protos/utils/txutils.go#L307)<br><strong>Comment</strong>: <pre>NP.</pre><strong>Commenter</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>CommentLine</strong>: [protos/utils/txutils.go#L307](https://github.com/hyperledger-gerrit-archive/fabric/blob/2e98be8d297cd082a5620417225322ddab1d2944/protos/utils/txutils.go#L307)<br><strong>Comment</strong>: <pre>Done</pre></blockquote><h3>PatchSet Number: 15</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Uploader</strong>: Volodymyr Paprotski - vpaprots@ca.ibm.com<br><strong>Created</strong>: 2/19/2017, 12:32:08 PM<br><strong>GitHubMergedRevision</strong>: [5159e6e8e2428fd5a0389fd1bcfcacee46a55c50](https://github.com/hyperledger-gerrit-archive/fabric/commit/5159e6e8e2428fd5a0389fd1bcfcacee46a55c50)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 2/19/2017, 1:39:58 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>Approved</strong>: 2/19/2017, 3:20:25 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Approved</strong>: 2/19/2017, 4:05:20 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>MergedBy</strong>: Gari Singh<br><strong>Merged</strong>: 2/19/2017, 4:05:22 PM<br><br><h2>Comments</h2><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [bccsp/factory/factory.go#L23](https://github.com/hyperledger-gerrit-archive/fabric/blob/5159e6e8e2428fd5a0389fd1bcfcacee46a55c50/bccsp/factory/factory.go#L23)<br><strong>Comment</strong>: <pre>As discussed, we may re-visit this, but let's go ahead.</pre></blockquote>
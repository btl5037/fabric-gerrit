<strong>Project</strong>: fabric<br><strong>Branch</strong>: master<br><strong>ID</strong>: 9551<br><strong>Subject</strong>: [FAB-3790] Ledger perf. test w/ diff. parallel txs<br><strong>Status</strong>: ABANDONED<br><strong>Owner</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Assignee</strong>:<br><strong>Created</strong>: 5/18/2017, 5:29:36 PM<br><strong>LastUpdated</strong>: 5/24/2017, 3:47:17 PM<br><strong>CommitMessage</strong>:<br><pre>[FAB-3790] Ledger perf. test w/ diff. parallel txs

WIP.

Change-Id: Iec060220c83affd1e03824e9060ecec625c10797
Signed-off-by: Adnan Choudhury <adnan.choudhury@itpeoplecorp.com>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Reviewed</strong>: 5/18/2017, 5:29:36 PM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Reviewed</strong>: 5/18/2017, 5:54:11 PM<br><strong>Message</strong>: <pre>Uploaded patch set 2.</pre><strong>Reviewer</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Reviewed</strong>: 5/18/2017, 6:30:45 PM<br><strong>Message</strong>: <pre>Patch Set 2: Code-Review-1

(3 comments)</pre><strong>Reviewer</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Reviewed</strong>: 5/19/2017, 9:43:14 AM<br><strong>Message</strong>: <pre>Uploaded patch set 3.</pre><strong>Reviewer</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Reviewed</strong>: 5/19/2017, 9:44:52 AM<br><strong>Message</strong>: <pre>Patch Set 3:

(3 comments)</pre><strong>Reviewer</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Reviewed</strong>: 5/19/2017, 10:10:23 AM<br><strong>Message</strong>: <pre>Uploaded patch set 4.</pre><strong>Reviewer</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Reviewed</strong>: 5/19/2017, 10:57:40 AM<br><strong>Message</strong>: <pre>Uploaded patch set 5.</pre><strong>Reviewer</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Reviewed</strong>: 5/19/2017, 5:16:29 PM<br><strong>Message</strong>: <pre>Patch Set 5: Code-Review-1

(2 comments)</pre><strong>Reviewer</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Reviewed</strong>: 5/22/2017, 11:04:47 AM<br><strong>Message</strong>: <pre>Uploaded patch set 6.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/22/2017, 11:04:56 AM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-z/7622/ (1/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/22/2017, 11:06:24 AM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/3501/ (2/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/22/2017, 11:07:51 AM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/11970/ (3/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/22/2017, 11:08:04 AM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/6030/ (4/5)</pre><strong>Reviewer</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Reviewed</strong>: 5/22/2017, 11:09:31 AM<br><strong>Message</strong>: <pre>Uploaded patch set 7.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/22/2017, 11:09:41 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/3502/ (1/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/22/2017, 11:14:01 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/11971/ (2/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/22/2017, 11:14:15 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/6031/ (3/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/22/2017, 11:26:20 AM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-merge-z/1353/ (5/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/22/2017, 11:35:39 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-z/7623/ (4/5)</pre><strong>Reviewer</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Reviewed</strong>: 5/22/2017, 11:38:21 AM<br><strong>Message</strong>: <pre>Patch Set 7: Code-Review-1

(2 comments)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/22/2017, 11:38:50 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-merge-z/1354/ (5/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/22/2017, 12:14:21 PM<br><strong>Message</strong>: <pre>Patch Set 6: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-z/7622/ : SUCCESS

https://jenkins.hyperledger.org/job/fabric-merge-z/1353/ : SUCCESS

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/3501/ : SUCCESS

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/11970/ : SUCCESS

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/6030/ : SUCCESS</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/22/2017, 12:27:50 PM<br><strong>Message</strong>: <pre>Patch Set 7: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/11971/ : FAILURE

https://jenkins.hyperledger.org/job/fabric-verify-z/7623/ : SUCCESS

https://jenkins.hyperledger.org/job/fabric-merge-z/1354/ : SUCCESS

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/3502/ : SUCCESS

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/6031/ : SUCCESS</pre><strong>Reviewer</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Reviewed</strong>: 5/23/2017, 11:33:36 AM<br><strong>Message</strong>: <pre>Patch Set 7:

> (2 comments)

I now think that this changeset should be separated into two parts 1) Update the tool (LTE) and 2) include python wrapper tests that invoke these tests. I have uploaded a patchset for the first part (LTE update) that addresses the latest concerns. (https://gerrit.hyperledger.org/r/#/c/9657/)</pre><strong>Reviewer</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Reviewed</strong>: 5/24/2017, 3:47:17 PM<br><strong>Message</strong>: <pre>Abandoned

As discussed, this will be abandoned, and separated into two patchsets 
1) https://gerrit.hyperledger.org/r/#/c/9657/
2) https://gerrit.hyperledger.org/r/#/c/9761/</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Uploader</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Created</strong>: 5/18/2017, 5:29:36 PM<br><strong>UnmergedRevision</strong>: [61189a7ee5c53d07f8e196957fbc768167578fcc](https://github.com/hyperledger-gerrit-archive/fabric/commit/61189a7ee5c53d07f8e196957fbc768167578fcc)<br><br></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Uploader</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Created</strong>: 5/18/2017, 5:54:11 PM<br><strong>UnmergedRevision</strong>: [60f8b1a7557348767c3b7d394834e13d4cbb4846](https://github.com/hyperledger-gerrit-archive/fabric/commit/60f8b1a7557348767c3b7d394834e13d4cbb4846)<br><br><strong>Approver</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Approved</strong>: 5/18/2017, 6:30:45 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [test/regression/daily/ledgerperftests/ledger_lte.py#L20](https://github.com/hyperledger-gerrit-archive/fabric/blob/60f8b1a7557348767c3b7d394834e13d4cbb4846/test/regression/daily/ledgerperftests/ledger_lte.py#L20)<br><strong>Comment</strong>: <pre>You say the test will observe the performance, and talks about the tps, but What determines a pass or failure? You do not display tps and confirm if it reaches a certain threshold. It looks like this test will pass if transactions are completed successfully, regardless of the tps. Also, it looks like you may be running multiple tests (and could obtain different tps numbers for all of them). Then again, you may see different TPS on different machines with different processors, so it might be hard to determine a good number. What do you think? Is this possible to check the tps numbers and confirm if acceptable?</pre><strong>Commenter</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>CommentLine</strong>: [test/regression/daily/ledgerperftests/ledger_lte.py#L20](https://github.com/hyperledger-gerrit-archive/fabric/blob/60f8b1a7557348767c3b7d394834e13d4cbb4846/test/regression/daily/ledgerperftests/ledger_lte.py#L20)<br><strong>Comment</strong>: <pre>Coming up with a good number is possible if we confine ourselves to the CI environment. It can be reasonably assumed that hardware will remain "constant". To that end, first task would be to collect the logs from the CI runs and come up with a reasonable number. And before we establish a good number, a successful completion of the test constitutes a pass IMO.</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [test/regression/daily/ledgerperftests/ledger_lte.py#L42](https://github.com/hyperledger-gerrit-archive/fabric/blob/60f8b1a7557348767c3b7d394834e13d4cbb4846/test/regression/daily/ledgerperftests/ledger_lte.py#L42)<br><strong>Comment</strong>: <pre>remove whitespace at end of lines</pre><strong>Commenter</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>CommentLine</strong>: [test/regression/daily/ledgerperftests/ledger_lte.py#L42](https://github.com/hyperledger-gerrit-archive/fabric/blob/60f8b1a7557348767c3b7d394834e13d4cbb4846/test/regression/daily/ledgerperftests/ledger_lte.py#L42)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [test/regression/daily/ledgerperftests/ledger_lte.py#L50](https://github.com/hyperledger-gerrit-archive/fabric/blob/60f8b1a7557348767c3b7d394834e13d4cbb4846/test/regression/daily/ledgerperftests/ledger_lte.py#L50)<br><strong>Comment</strong>: <pre>use only one 's' in parallelism. here and elsewhere.</pre><strong>Commenter</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>CommentLine</strong>: [test/regression/daily/ledgerperftests/ledger_lte.py#L50](https://github.com/hyperledger-gerrit-archive/fabric/blob/60f8b1a7557348767c3b7d394834e13d4cbb4846/test/regression/daily/ledgerperftests/ledger_lte.py#L50)<br><strong>Comment</strong>: <pre>Done</pre></blockquote><h3>PatchSet Number: 3</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Uploader</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Created</strong>: 5/19/2017, 9:43:14 AM<br><strong>UnmergedRevision</strong>: [07c559eb89c60600730aeacbd0094edb1557d021](https://github.com/hyperledger-gerrit-archive/fabric/commit/07c559eb89c60600730aeacbd0094edb1557d021)<br><br></blockquote><h3>PatchSet Number: 4</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Uploader</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Created</strong>: 5/19/2017, 10:10:23 AM<br><strong>UnmergedRevision</strong>: [4a7378f069077162b5b88047ecf2ff6433d7759e](https://github.com/hyperledger-gerrit-archive/fabric/commit/4a7378f069077162b5b88047ecf2ff6433d7759e)<br><br></blockquote><h3>PatchSet Number: 5</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Uploader</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Created</strong>: 5/19/2017, 10:57:40 AM<br><strong>UnmergedRevision</strong>: [4e58ad549bcfe7e1f836ba3fc0f274af994a6026](https://github.com/hyperledger-gerrit-archive/fabric/commit/4e58ad549bcfe7e1f836ba3fc0f274af994a6026)<br><br><strong>Approver</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Approved</strong>: 5/19/2017, 5:16:29 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [test/regression/daily/ledgerperftests/ledger_lte.py#L0](https://github.com/hyperledger-gerrit-archive/fabric/blob/4e58ad549bcfe7e1f836ba3fc0f274af994a6026/test/regression/daily/ledgerperftests/ledger_lte.py#L0)<br><strong>Comment</strong>: <pre>As discussed, let's move this script up a level, and remove directory ledgerperftests. (And modify the runDailyTestSuite.sh script accordingly.)</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [test/tools/ledgerbenchmarks/scripts/runbenchmarks.sh#L9](https://github.com/hyperledger-gerrit-archive/fabric/blob/4e58ad549bcfe7e1f836ba3fc0f274af994a6026/test/tools/ledgerbenchmarks/scripts/runbenchmarks.sh#L9)<br><strong>Comment</strong>: <pre>can we move these two lines into the main thread, so we can remove them from every one of these functions? As discussed, if someone wishes to use these functions, they probably should just execute "runbenchmarks.sh argument=functionname" instead of "source runbenchmarks.sh && functionname()".</pre></blockquote><h3>PatchSet Number: 6</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Uploader</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Created</strong>: 5/22/2017, 11:04:47 AM<br><strong>UnmergedRevision</strong>: [049e31d9fd2be5b831d16c8c1a46504fda644523](https://github.com/hyperledger-gerrit-archive/fabric/commit/049e31d9fd2be5b831d16c8c1a46504fda644523)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/22/2017, 12:14:21 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 7</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Uploader</strong>: Adnan C - adnan.choudhury@itpeoplecorp.com<br><strong>Created</strong>: 5/22/2017, 11:09:31 AM<br><strong>UnmergedRevision</strong>: [441385200e386ffccfe4217f1f2cdd8d81632af3](https://github.com/hyperledger-gerrit-archive/fabric/commit/441385200e386ffccfe4217f1f2cdd8d81632af3)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/22/2017, 12:27:50 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>Approved</strong>: 5/22/2017, 11:38:21 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [test/regression/daily/ledger_lte.py#L20](https://github.com/hyperledger-gerrit-archive/fabric/blob/441385200e386ffccfe4217f1f2cdd8d81632af3/test/regression/daily/ledger_lte.py#L20)<br><strong>Comment</strong>: <pre>Renaming ledgerbenchmarks to LTE, as previously discussed, means we need to change this line in all these testcases too.
The readme in that directory can explain how to use the tool for ledger benchmark tests.</pre><strong>Commenter</strong>: Scott Zwierzynski - scottz@us.ibm.com<br><strong>CommentLine</strong>: [test/tools/ledgerbenchmarks/scripts/testparams.sh#L0](https://github.com/hyperledger-gerrit-archive/fabric/blob/441385200e386ffccfe4217f1f2cdd8d81632af3/test/tools/ledgerbenchmarks/scripts/testparams.sh#L0)<br><strong>Comment</strong>: <pre>These test params are for the initial benchmark tests of the daily test suite. Can we name the file more appropriately? Once people create more testparam files, we will need to be able to identify this one for what it is.</pre></blockquote>
<strong>Project</strong>: fabric<br><strong>Branch</strong>: master<br><strong>ID</strong>: 9029<br><strong>Subject</strong>: [FAB-3735] Increase test coverage for config pkg<br><strong>Status</strong>: MERGED<br><strong>Owner</strong>: AnilKumar Ambati - aambati@hotmail.com<br><strong>Assignee</strong>:<br><strong>Created</strong>: 5/5/2017, 3:10:41 PM<br><strong>LastUpdated</strong>: 5/26/2017, 8:50:29 AM<br><strong>CommitMessage</strong>:<br><pre>[FAB-3735] Increase test coverage for config pkg

Added additional tests for functions in the
core/config package

Change-Id: I1d386034430e2d52f5187aad6941a75df6f79fc2
Signed-off-by: Anil Ambati <aambati@us.ibm.com>
</pre><h1>Comments</h1><strong>Reviewer</strong>: AnilKumar Ambati - aambati@hotmail.com<br><strong>Reviewed</strong>: 5/5/2017, 3:10:41 PM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/5/2017, 3:12:11 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/2749/ (1/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/5/2017, 3:12:43 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/11220/ (2/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/5/2017, 3:13:29 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/5279/ (3/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/5/2017, 4:23:51 PM<br><strong>Message</strong>: <pre>Patch Set 1: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/2749/ : FAILURE (skipped)

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/11220/ : FAILURE

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/5279/ : FAILURE (skipped)</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 5/6/2017, 5:17:36 AM<br><strong>Message</strong>: <pre>Patch Set 2: Patch Set 1 was rebased</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/6/2017, 5:20:03 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/2760/ (1/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/6/2017, 5:20:15 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/11231/ (2/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/6/2017, 5:20:20 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/5290/ (3/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/6/2017, 7:01:48 AM<br><strong>Message</strong>: <pre>Patch Set 2: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/2760/ : FAILURE (skipped)

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/5290/ : FAILURE (skipped)

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/11231/ : SUCCESS</pre><strong>Reviewer</strong>: Christopher Ferris - chris.ferris@gmail.com<br><strong>Reviewed</strong>: 5/6/2017, 7:59:58 AM<br><strong>Message</strong>: <pre>Patch Set 2:

(1 comment)</pre><strong>Reviewer</strong>: AnilKumar Ambati - aambati@hotmail.com<br><strong>Reviewed</strong>: 5/8/2017, 3:32:34 PM<br><strong>Message</strong>: <pre>Uploaded patch set 3.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/8/2017, 3:35:19 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/5357/ (1/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/8/2017, 3:36:41 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/11298/ (2/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/8/2017, 3:38:04 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/2827/ (3/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/8/2017, 5:04:42 PM<br><strong>Message</strong>: <pre>Patch Set 3: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/5357/ : FAILURE (skipped)

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/2827/ : FAILURE (skipped)

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/11298/ : SUCCESS</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 5/17/2017, 6:50:18 PM<br><strong>Message</strong>: <pre>Patch Set 2:

(1 comment)</pre><strong>Reviewer</strong>: AnilKumar Ambati - aambati@hotmail.com<br><strong>Reviewed</strong>: 5/18/2017, 10:58:36 AM<br><strong>Message</strong>: <pre>Patch Set 2:

(1 comment)</pre><strong>Reviewer</strong>: AnilKumar Ambati - aambati@hotmail.com<br><strong>Reviewed</strong>: 5/18/2017, 12:04:07 PM<br><strong>Message</strong>: <pre>Uploaded patch set 4.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2017, 12:04:18 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-z/7440/ (1/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2017, 12:06:32 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/11788/ (2/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2017, 12:06:48 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/3319/ (3/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2017, 12:07:10 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/5848/ (4/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/18/2017, 1:48:05 PM<br><strong>Message</strong>: <pre>Patch Set 4: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/5848/ : FAILURE (skipped)

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/11788/ : SUCCESS

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/3319/ : SUCCESS

https://jenkins.hyperledger.org/job/fabric-verify-z/7440/ : SUCCESS</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 5/18/2017, 8:58:25 PM<br><strong>Message</strong>: <pre>Patch Set 4:

(1 comment)</pre><strong>Reviewer</strong>: AnilKumar Ambati - aambati@hotmail.com<br><strong>Reviewed</strong>: 5/19/2017, 1:30:12 PM<br><strong>Message</strong>: <pre>Patch Set 4:

> (1 comment)

i am not creating a file in this case. I did use that pattern in other instances</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 5/19/2017, 2:48:43 PM<br><strong>Message</strong>: <pre>Patch Set 4:

I see. you are just checking for existence of a file...not creating one.</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 5/19/2017, 2:49:05 PM<br><strong>Message</strong>: <pre>Patch Set 4: Code-Review+2</pre><strong>Reviewer</strong>: Christopher Ferris - chris.ferris@gmail.com<br><strong>Reviewed</strong>: 5/26/2017, 8:01:23 AM<br><strong>Message</strong>: <pre>Patch Set 4: Code-Review+2</pre><strong>Reviewer</strong>: Gerrit Code Review - gerrit@hyperledger.org<br><strong>Reviewed</strong>: 5/26/2017, 8:01:25 AM<br><strong>Message</strong>: <pre>Change has been successfully merged by Christopher Ferris</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/26/2017, 8:01:36 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-merge-z/1414/ (1/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/26/2017, 8:02:27 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-merge-end-2-end-x86_64/582/ (2/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/26/2017, 8:03:16 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-merge-x86_64/1900/ (3/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/26/2017, 8:04:06 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-merge-behave-x86_64/893/ (4/4)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 5/26/2017, 8:50:29 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-merge-end-2-end-x86_64/582/ : FAILURE

https://jenkins.hyperledger.org/job/fabric-merge-x86_64/1900/ : FAILURE

https://jenkins.hyperledger.org/job/fabric-merge-behave-x86_64/893/ : FAILURE

https://jenkins.hyperledger.org/job/fabric-merge-z/1414/ : SUCCESS</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Anil Ambati - aambati@us.ibm.com<br><strong>Uploader</strong>: AnilKumar Ambati - aambati@hotmail.com<br><strong>Created</strong>: 5/5/2017, 3:10:41 PM<br><strong>UnmergedRevision</strong>: [ebc4e326afc305e4db8784ecd80c348444c82b98](https://github.com/hyperledger-gerrit-archive/fabric/commit/ebc4e326afc305e4db8784ecd80c348444c82b98)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/5/2017, 4:23:51 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: TRIVIAL_REBASE<br><strong>Author</strong>: Anil Ambati - aambati@us.ibm.com<br><strong>Uploader</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Created</strong>: 5/6/2017, 5:17:36 AM<br><strong>UnmergedRevision</strong>: [f4d743c57c0483e72adc9416cb55a7c04b7c0dae](https://github.com/hyperledger-gerrit-archive/fabric/commit/f4d743c57c0483e72adc9416cb55a7c04b7c0dae)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/6/2017, 7:01:48 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Christopher Ferris - chris.ferris@gmail.com<br><strong>CommentLine</strong>: [core/config/config_test.go#L17](https://github.com/hyperledger-gerrit-archive/fabric/blob/f4d743c57c0483e72adc9416cb55a7c04b7c0dae/core/config/config_test.go#L17)<br><strong>Comment</strong>: <pre>you are assuming that no one has created a directory /blah on their system? Maybe just make it even more unlikely please.</pre><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [core/config/config_test.go#L18](https://github.com/hyperledger-gerrit-archive/fabric/blob/f4d743c57c0483e72adc9416cb55a7c04b7c0dae/core/config/config_test.go#L18)<br><strong>Comment</strong>: <pre>suggest `filepath.join(tmpF,"blah")`  based on Chris's comment above</pre><strong>Commenter</strong>: AnilKumar Ambati - aambati@hotmail.com<br><strong>CommentLine</strong>: [core/config/config_test.go#L18](https://github.com/hyperledger-gerrit-archive/fabric/blob/f4d743c57c0483e72adc9416cb55a7c04b7c0dae/core/config/config_test.go#L18)<br><strong>Comment</strong>: <pre>I made this change based on Chris' comment in the patch set #3:

tmpF = "/blah-" + time.Now().Format(time.RFC3339Nano)
exists = dirExists(tmpF)

This way file name is randomized and chances of being present is close negligible. 

Not sure if yo have seen this change.</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [core/config/config_test.go#L18](https://github.com/hyperledger-gerrit-archive/fabric/blob/f4d743c57c0483e72adc9416cb55a7c04b7c0dae/core/config/config_test.go#L18)<br><strong>Comment</strong>: <pre>suggest a simpler approach would be to follow the pattern elsewhere
   testdir := ioutil.TempDir(os.TempDir(),"mytest")
   defer os.RemoveAll(testdir)

and put any files you need under testdir...</pre></blockquote><h3>PatchSet Number: 3</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Anil Ambati - aambati@us.ibm.com<br><strong>Uploader</strong>: AnilKumar Ambati - aambati@hotmail.com<br><strong>Created</strong>: 5/8/2017, 3:32:34 PM<br><strong>UnmergedRevision</strong>: [24f580795af7ca0337b271211b8d1e1803562717](https://github.com/hyperledger-gerrit-archive/fabric/commit/24f580795af7ca0337b271211b8d1e1803562717)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/8/2017, 5:04:42 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 4</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Anil Ambati - aambati@us.ibm.com<br><strong>Uploader</strong>: AnilKumar Ambati - aambati@hotmail.com<br><strong>Created</strong>: 5/18/2017, 12:04:07 PM<br><strong>GitHubMergedRevision</strong>: [73a950a06785c82b6ae07782f2c41a917922c03f](https://github.com/hyperledger-gerrit-archive/fabric/commit/73a950a06785c82b6ae07782f2c41a917922c03f)<br><br><strong>Approver</strong>: Christopher Ferris - chris.ferris@gmail.com<br><strong>Approved</strong>: 5/26/2017, 8:01:23 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>MergedBy</strong>: Christopher Ferris<br><strong>Merged</strong>: 5/26/2017, 8:01:25 AM<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 5/18/2017, 1:48:05 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Approved</strong>: 5/19/2017, 2:49:05 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br></blockquote>
<strong>Project</strong>: fabric<br><strong>Branch</strong>: master<br><strong>ID</strong>: 4975<br><strong>Subject</strong>: [FAB-1790, FAB-1791] Chaincode calling chaincode<br><strong>Status</strong>: MERGED<br><strong>Owner</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Assignee</strong>:<br><strong>Created</strong>: 1/28/2017, 5:55:00 PM<br><strong>LastUpdated</strong>: 1/30/2017, 5:25:45 PM<br><strong>CommitMessage</strong>:<br><pre>[FAB-1790, FAB-1791] Chaincode calling chaincode

This changeset enables chaincode calling chaincode on the same channel
or different channel read-only. The called chaincode operates in the
same transaction context of the caller chaincode. See the chaincode
API for details.

Change shim.InvokeChaincode API to accept a channel.

Fix up the chaincode_example04 so that the current unit tests can
exercise both query and invoke.

Also update a number of files for better logging, including removing
repeating log in loop and info log in heavy transaction path.

Change-Id: I9b67b91311482d7c47cf66a0849c2f29594621f5
Signed-off-by: Binh Q. Nguyen <binhn@us.ibm.com>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Reviewed</strong>: 1/28/2017, 5:55:00 PM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/28/2017, 5:56:11 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/5861/</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 1/28/2017, 6:54:43 PM<br><strong>Message</strong>: <pre>Patch Set 1:

(1 comment)</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 1/28/2017, 7:00:20 PM<br><strong>Message</strong>: <pre>Patch Set 1:

(1 comment)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/28/2017, 7:01:14 PM<br><strong>Message</strong>: <pre>Patch Set 1: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/5861/ : SUCCESS</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 1/28/2017, 7:24:32 PM<br><strong>Message</strong>: <pre>Patch Set 1:

(1 comment)</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 1/28/2017, 7:25:51 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Barring the above comment, LGTM (the main change is in handler.go, rest cosmetic).</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 1/28/2017, 7:26:09 PM<br><strong>Message</strong>: <pre>Patch Set 1:

(5 comments)</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 1/28/2017, 7:29:29 PM<br><strong>Message</strong>: <pre>Patch Set 1:

(1 comment)</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 1/29/2017, 5:15:02 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(5 comments)</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 1/29/2017, 5:27:25 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(1 comment)</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 1/29/2017, 8:46:59 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(3 comments)

As I +2ed earlier, thought should respond to some of these :-)</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 1/29/2017, 8:48:31 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Correction... I *thought*  I had +2ed but noticed I didn't. Still I did review it earlier.</pre><strong>Reviewer</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Reviewed</strong>: 1/29/2017, 11:38:18 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(14 comments)

Thanks all for commenting. I'll address them on the next patch</pre><strong>Reviewer</strong>: Angelo De Caro - adc@zurich.ibm.com<br><strong>Reviewed</strong>: 1/29/2017, 12:07:20 PM<br><strong>Message</strong>: <pre>Patch Set 1:

(2 comments)</pre><strong>Reviewer</strong>: Angelo De Caro - adc@zurich.ibm.com<br><strong>Reviewed</strong>: 1/29/2017, 2:26:05 PM<br><strong>Message</strong>: <pre>Patch Set 1:

(1 comment)</pre><strong>Reviewer</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Reviewed</strong>: 1/29/2017, 4:19:33 PM<br><strong>Message</strong>: <pre>Uploaded patch set 2.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/29/2017, 4:21:59 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/5901/</pre><strong>Reviewer</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Reviewed</strong>: 1/29/2017, 4:22:54 PM<br><strong>Message</strong>: <pre>Patch Set 1:

(1 comment)</pre><strong>Reviewer</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Reviewed</strong>: 1/29/2017, 4:24:51 PM<br><strong>Message</strong>: <pre>Patch Set 1:

(1 comment)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/29/2017, 4:43:10 PM<br><strong>Message</strong>: <pre>Patch Set 2: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/5901/ : FAILURE</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 1/29/2017, 11:26:28 PM<br><strong>Message</strong>: <pre>Patch Set 2:

(1 comment)</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 1/29/2017, 11:26:48 PM<br><strong>Message</strong>:<br><strong>Reviewer</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Reviewed</strong>: 1/30/2017, 12:21:57 PM<br><strong>Message</strong>: <pre>Uploaded patch set 3.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/30/2017, 12:26:34 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/5932/</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 1/30/2017, 1:13:56 PM<br><strong>Message</strong>: <pre>Patch Set 3: Code-Review+1

+1 for now waiting on past reviewers.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/30/2017, 1:45:21 PM<br><strong>Message</strong>: <pre>Patch Set 3: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/5932/ : SUCCESS</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 1/30/2017, 2:07:17 PM<br><strong>Message</strong>: <pre>Patch Set 3: Code-Review+1</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 1/30/2017, 2:23:19 PM<br><strong>Message</strong>: <pre>Patch Set 1:

(2 comments)</pre><strong>Reviewer</strong>: Angelo De Caro - adc@zurich.ibm.com<br><strong>Reviewed</strong>: 1/30/2017, 2:51:46 PM<br><strong>Message</strong>: <pre>Patch Set 3:

I'm fine. Thanks :)</pre><strong>Reviewer</strong>: Angelo De Caro - adc@zurich.ibm.com<br><strong>Reviewed</strong>: 1/30/2017, 2:53:05 PM<br><strong>Message</strong>: <pre>Patch Set 3: Code-Review+1

It's fine. Thanks.</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 1/30/2017, 3:11:13 PM<br><strong>Message</strong>: <pre>Patch Set 3: Code-Review+2</pre><strong>Reviewer</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Reviewed</strong>: 1/30/2017, 3:59:27 PM<br><strong>Message</strong>: <pre>Patch Set 3:

(1 comment)</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 1/30/2017, 4:01:33 PM<br><strong>Message</strong>: <pre>Patch Set 1:

(1 comment)</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 1/30/2017, 4:12:42 PM<br><strong>Message</strong>: <pre>Patch Set 3: Code-Review+2</pre><strong>Reviewer</strong>: Gerrit Code Review - gerrit@hyperledger.org<br><strong>Reviewed</strong>: 1/30/2017, 4:12:45 PM<br><strong>Message</strong>: <pre>Change has been successfully merged by Yacov Manevich</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/30/2017, 4:17:09 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-merge-x86_64/916/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/30/2017, 5:25:45 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-merge-x86_64/916/ : SUCCESS</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Binh Q. Nguyen - binhn@us.ibm.com<br><strong>Uploader</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Created</strong>: 1/28/2017, 5:55:00 PM<br><strong>UnmergedRevision</strong>: [9a0bf2d677b20ebed77b76125b23cc514877546d](https://github.com/hyperledger-gerrit-archive/fabric/commit/9a0bf2d677b20ebed77b76125b23cc514877546d)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/28/2017, 7:01:14 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [core/chaincode/chaincode_support.go#L432](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/core/chaincode/chaincode_support.go#L432)<br><strong>Comment</strong>: <pre>Can you elaborate on this // sir := ? It seems you forgot to delete this line, but, the // don't remove chaincode container is now misleading.</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [core/chaincode/chaincode_support.go#L432](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/core/chaincode/chaincode_support.go#L432)<br><strong>Comment</strong>: <pre>This is what we keep telling dev to do if they want to keep containers around. I guess this was left as a convenient comment for others to use. Agreed that the comment could be more descriptive say "Use this instead while debugging if you want to leave the container around".

Note that there's a CR out there that directs CC logs and so this will be less needed in future.</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [core/chaincode/chaincode_support.go#L432](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/core/chaincode/chaincode_support.go#L432)<br><strong>Comment</strong>: <pre>Yes, I decided to leave the code there for convenient, but will beef up the comment a bit more</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [core/chaincode/handler.go#L123](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/core/chaincode/handler.go#L123)<br><strong>Comment</strong>: <pre>this 3-value return with the same type is a bit confusing, and IMO may lead to mistaken incorrect use. Perhaps move them into a struct with fields?</pre><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [core/chaincode/handler.go#L123](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/core/chaincode/handler.go#L123)<br><strong>Comment</strong>: <pre>I agree here</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [core/chaincode/handler.go#L123](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/core/chaincode/handler.go#L123)<br><strong>Comment</strong>: <pre>I suppose we coud just return &ccParts{} directly...</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [core/chaincode/handler.go#L123](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/core/chaincode/handler.go#L123)<br><strong>Comment</strong>: <pre>good idea</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [core/chaincode/handler.go#L123](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/core/chaincode/handler.go#L123)<br><strong>Comment</strong>: <pre>reaaly? Not me :-)

ok, i can use struct. Thx</pre><strong>Commenter</strong>: Angelo De Caro - adc@zurich.ibm.com<br><strong>CommentLine</strong>: [core/chaincode/handler.go#L1106](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/core/chaincode/handler.go#L1106)<br><strong>Comment</strong>: <pre>Just to be sure: The chaincode invoked by another chaincode will get access to the proposal that fired the invocations chain. Is this correct? I ask because the chaincodes in the invocations chain might need to get the values of fields like the creator and the transient in order to perform certain operations (i.e. access control, enc/dec and so on)</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [core/chaincode/handler.go#L1106](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/core/chaincode/handler.go#L1106)<br><strong>Comment</strong>: <pre>yes, the called chaincode get the entire origin proposal in the context</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [core/chaincode/handler.go#L1141](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/core/chaincode/handler.go#L1141)<br><strong>Comment</strong>: <pre>We might want to pass a "from channel" to the called chaincode so it can do strict checks and prevent state changing calls (Put,Delete, etc) to enforce a stricter "read only" semantics. Of course, this should be done in a separate CR. Perhaps a JIRA for this ?</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [core/chaincode/handler.go#L1141](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/core/chaincode/handler.go#L1141)<br><strong>Comment</strong>: <pre>right, we really should throw error if the called function does putState, but no harm at this point.  I added subtask 4 to story https://jira.hyperledger.org/browse/FAB-1788</pre><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [core/chaincode/shim/interfaces.go#L54](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/core/chaincode/shim/interfaces.go#L54)<br><strong>Comment</strong>: <pre>typo - although see other comment as I think we should make chainID an explicit parameter</pre><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [core/chaincode/shim/interfaces.go#L57](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/core/chaincode/shim/interfaces.go#L57)<br><strong>Comment</strong>: <pre>I think you should add chainID as an explicit parameter here.It is much cleaner</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [core/chaincode/shim/interfaces.go#L57](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/core/chaincode/shim/interfaces.go#L57)<br><strong>Comment</strong>: <pre>Either way is fine with me ... but now that we are changing CC interface anyway, it does make sense.</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [core/chaincode/shim/interfaces.go#L57](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/core/chaincode/shim/interfaces.go#L57)<br><strong>Comment</strong>: <pre>If we say the chaincode name is not a composite thing ( = cc+version+channel though we don't allow version yet on the call) then I'd rather split them all now so that we don't change this later. 

@Murali, this is the form you wanted to begin with, so I want to make sure you are fine doing it this way.</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [core/chaincode/shim/interfaces.go#L57](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/core/chaincode/shim/interfaces.go#L57)<br><strong>Comment</strong>: <pre>Riding on the "chaincodeID" by appending channel name was good for testing purposes (you can pass any string you want) but better to use ccname, channel as separate parameters so we don't have to expose chaincode namespace to end users. There are +/- to both approches but (ccname, channel) will avoid confusion and there'll be less thing to explain/go wrong.</pre><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [core/scc/lccc/lccc.go#L392](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/core/scc/lccc/lccc.go#L392)<br><strong>Comment</strong>: <pre>"ChaincodeID: %s does not exist on channel: %s"</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [core/scc/lccc/lccc.go#L392](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/core/scc/lccc/lccc.go#L392)<br><strong>Comment</strong>: <pre>better - thanks</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/state/state.go#L332](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/gossip/state/state.go#L332)<br><strong>Comment</strong>: <pre>This one remained here, since didn't payed attention, while merging conflicts, however I think we should not remove the message from the line 340. Also it should be possible to silent logs of the specific module changing to INFO log level for example.</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [gossip/state/state.go#L332](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/gossip/state/state.go#L332)<br><strong>Comment</strong>: <pre>Ok, this was the one causing problem in debug log</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/state/state.go#L332](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/gossip/state/state.go#L332)<br><strong>Comment</strong>: <pre>Right and thank for taking care to remove it.</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/state/state.go#L340](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/gossip/state/state.go#L340)<br><strong>Comment</strong>: <pre>Why is this removed? I think this message should be left.</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [gossip/state/state.go#L340](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/gossip/state/state.go#L340)<br><strong>Comment</strong>: <pre>I disagree here Yacov. This code runs in a goroutine, and if I understood correctly, we exit the goroutine here as the peer exits, which means we should either not logging (because it would give no value) or find the reason why we stop and log warning/info. There is nothing left to debug here.</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/state/state.go#L340](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/gossip/state/state.go#L340)<br><strong>Comment</strong>: <pre>If something goes wrong, I'd like to debug the code. This printout has no potential value in day to day work, while it might provide a useful hint tracing down bugs. I'd vote for keeping this message in place.</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [gossip/state/state.go#L340](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/gossip/state/state.go#L340)<br><strong>Comment</strong>: <pre>Artem and I agreed to do this in a different CR (https://gerrit.hyperledger.org/r/#/c/3793/) and change the log level to INFO for this since it is exiting the peer process.</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/state/state.go#L340](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/gossip/state/state.go#L340)<br><strong>Comment</strong>: <pre>Indeed :)</pre><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [msp/identities.go#L33](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/msp/identities.go#L33)<br><strong>Comment</strong>: <pre>I don't understand what this has to do with the changeset.  these changes should be handled separately</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [msp/identities.go#L33](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/msp/identities.go#L33)<br><strong>Comment</strong>: <pre>I agreed by the book, but I was here and I had to get rid of "mspLogger.Debugf("Verify: msg = %s", hex.Dump(msg))" which spit out hundreds of pages. 

I don't follow process for process sake, and this is one of those bc I can't stand the code :-)</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [msp/identities.go#L93](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/msp/identities.go#L93)<br><strong>Comment</strong>: <pre>This is a very good point (whether are these ok to log). Perhaps adc and aso can shed some light on this?</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [msp/identities.go#L93](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/msp/identities.go#L93)<br><strong>Comment</strong>: <pre>I added https://jira.hyperledger.org/browse/FAB-1929</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [msp/identities.go#L96](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/msp/identities.go#L96)<br><strong>Comment</strong>: <pre>Suggestion- perhaps log these (only) upon failure (lines 99-104)?</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [msp/identities.go#L96](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/msp/identities.go#L96)<br><strong>Comment</strong>: <pre>Maybe that's the right location. @adc @aso</pre><strong>Commenter</strong>: Angelo De Caro - adc@zurich.ibm.com<br><strong>CommentLine</strong>: [msp/identities.go#L96](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/msp/identities.go#L96)<br><strong>Comment</strong>: <pre>So, notice that also the digest might leak information if the message digested doesn't have enough entropy. 

So, I'm fine with the location. Perhaps you may want to have a more distinguishable message in such a way these lines can be filtered out easily if security concerns arises.</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [msp/identities.go#L96](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/msp/identities.go#L96)<br><strong>Comment</strong>: <pre>let's take care of this in https://jira.hyperledger.org/browse/FAB-1929.
I added your comment there.
thanks.</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [msp/identities.go#L121](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/msp/identities.go#L121)<br><strong>Comment</strong>: <pre>Perhaps we should either delete the log messages here and in lines 148, 154 and not comment them out, or at least make them Debugf instead of Infof?</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [msp/identities.go#L121](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/msp/identities.go#L121)<br><strong>Comment</strong>: <pre>I added https://jira.hyperledger.org/browse/FAB-1929</pre><strong>Commenter</strong>: Angelo De Caro - adc@zurich.ibm.com<br><strong>CommentLine</strong>: [msp/identities.go#L121](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/msp/identities.go#L121)<br><strong>Comment</strong>: <pre>Again, you might want to have a very distinguishable message in such a way it can filtered out if needed.</pre><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [msp/mgmt/config.go#L41](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/msp/mgmt/config.go#L41)<br><strong>Comment</strong>: <pre>not sure what this has to do with this CR for cc to cc</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [msp/mgmt/config.go#L41](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/msp/mgmt/config.go#L41)<br><strong>Comment</strong>: <pre>This is part of the config sage that no one could run the code as-is without having to muck around with core.yaml -- I could not run the cc2cc tests from the CLI. 

This change ensures the code can run with CLI without any modification.</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [msp/mgmt/config.go#L54](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/msp/mgmt/config.go#L54)<br><strong>Comment</strong>: <pre>This dir = is the same as in line 48, and os.State(dir) is invoked in both cases of the "if" in line 45.
Perhaps consider refactoring and extracting dir and os.Stat dir to the line 44?</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [msp/mgmt/config.go#L54](https://github.com/hyperledger-gerrit-archive/fabric/blob/9a0bf2d677b20ebed77b76125b23cc514877546d/msp/mgmt/config.go#L54)<br><strong>Comment</strong>: <pre>Yeah, got lazy there... I'll tighten it up.  Thx.</pre></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Binh Q. Nguyen - binhn@us.ibm.com<br><strong>Uploader</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Created</strong>: 1/29/2017, 4:19:33 PM<br><strong>UnmergedRevision</strong>: [728afac71d4d4f0bbc8eedf031ad2c7d1291a76d](https://github.com/hyperledger-gerrit-archive/fabric/commit/728afac71d4d4f0bbc8eedf031ad2c7d1291a76d)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/29/2017, 4:43:10 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 3</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Binh Q. Nguyen - binhn@us.ibm.com<br><strong>Uploader</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Created</strong>: 1/30/2017, 12:21:57 PM<br><strong>GitHubMergedRevision</strong>: [1bd5b2bb8e37729f13e819c291cbf0125366c488](https://github.com/hyperledger-gerrit-archive/fabric/commit/1bd5b2bb8e37729f13e819c291cbf0125366c488)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/30/2017, 1:45:21 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Approved</strong>: 1/30/2017, 3:11:13 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Approved</strong>: 1/30/2017, 4:12:42 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>MergedBy</strong>: Yacov Manevich<br><strong>Merged</strong>: 1/30/2017, 4:12:45 PM<br><br><strong>Approver</strong>: Angelo De Caro - adc@zurich.ibm.com<br><strong>Approved</strong>: 1/30/2017, 2:53:05 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br></blockquote>
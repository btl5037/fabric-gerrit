<strong>Project</strong>: fabric<br><strong>Branch</strong>: master<br><strong>ID</strong>: 5181<br><strong>Subject</strong>: Document endorsement policies<br><strong>Status</strong>: MERGED<br><strong>Owner</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Assignee</strong>:<br><strong>Created</strong>: 2/1/2017, 4:25:29 AM<br><strong>LastUpdated</strong>: 2/2/2017, 6:01:12 PM<br><strong>CommitMessage</strong>:<br><pre>Document endorsement policies

Change-Id: Iac56fe7253eba2e82bc31d7725af5a8ec53e6360
Signed-off-by: Alessandro Sorniotti <ale.linux@sopit.net>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 2/1/2017, 4:25:29 AM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/1/2017, 4:28:21 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/6074/</pre><strong>Reviewer</strong>: Elli Androulaki - lli@zurich.ibm.com<br><strong>Reviewed</strong>: 2/1/2017, 4:31:46 AM<br><strong>Message</strong>: <pre>Patch Set 1: Code-Review+1

(1 comment)

Hi,

Just a general comment here reflecting more on where else we can use this language and its support for by-organizationunit classification of organization membership.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/1/2017, 5:33:22 AM<br><strong>Message</strong>: <pre>Patch Set 1: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/6074/ : SUCCESS</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 2/1/2017, 7:51:21 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(2 comments)</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 2/1/2017, 9:44:37 AM<br><strong>Message</strong>: <pre>Uploaded patch set 2.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/1/2017, 9:45:27 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/6088/</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 2/1/2017, 9:46:34 AM<br><strong>Message</strong>: <pre>Patch Set 2:

(3 comments)

Thanks Elli and Murali, see below how I've addressed your comments</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/1/2017, 10:48:54 AM<br><strong>Message</strong>: <pre>Patch Set 2: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/6088/ : SUCCESS</pre><strong>Reviewer</strong>: Elli Androulaki - lli@zurich.ibm.com<br><strong>Reviewed</strong>: 2/1/2017, 12:19:27 PM<br><strong>Message</strong>: <pre>Patch Set 2: Code-Review+1

Thanks Ale, LGTM!</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 2/1/2017, 2:54:17 PM<br><strong>Message</strong>: <pre>Patch Set 1:

(5 comments)

few more Ale ..</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 2/1/2017, 3:42:46 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Thx Murali - tell me when you are through the whole document and I'll address all your comments in one shot!</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 2/1/2017, 3:56:58 PM<br><strong>Message</strong>: <pre>Patch Set 2:

I'm done Ale (notice comments till the end this time :-) ) ... I had to stop in the middle to wait for the reorg ...</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 2/2/2017, 2:49:14 PM<br><strong>Message</strong>: <pre>Uploaded patch set 3.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/2/2017, 2:52:23 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/6154/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/2/2017, 3:44:47 PM<br><strong>Message</strong>: <pre>Patch Set 3: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/6154/ : SUCCESS</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 2/2/2017, 4:37:43 PM<br><strong>Message</strong>: <pre>Patch Set 3: Code-Review+2

Close enough I think (maybe can be condensed a bit ... does the end user need to know about all the details in "Endorsement policy design" ?).

But looks good otherwise..</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 2/2/2017, 5:09:19 PM<br><strong>Message</strong>: <pre>Patch Set 3: Code-Review+2</pre><strong>Reviewer</strong>: Gerrit Code Review - gerrit@hyperledger.org<br><strong>Reviewed</strong>: 2/2/2017, 5:09:26 PM<br><strong>Message</strong>: <pre>Change has been successfully merged by Yacov Manevich</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/2/2017, 5:13:26 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-merge-x86_64/947/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 2/2/2017, 6:01:12 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-merge-x86_64/947/ : SUCCESS</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Created</strong>: 2/1/2017, 4:25:29 AM<br><strong>UnmergedRevision</strong>: [29f19c9b9a519575de2de925b72db7b4044f4124](https://github.com/hyperledger-gerrit-archive/fabric/commit/29f19c9b9a519575de2de925b72db7b4044f4124)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 2/1/2017, 5:33:22 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Elli Androulaki - lli@zurich.ibm.com<br><strong>Approved</strong>: 2/1/2017, 4:31:46 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [docs/endorsement-policies.md#L4](https://github.com/hyperledger-gerrit-archive/fabric/blob/29f19c9b9a519575de2de925b72db7b4044f4124/docs/endorsement-policies.md#L4)<br><strong>Comment</strong>: <pre>perhaps "invokes the VSCC (Validation System Chaincode) associated with the transaction's Chaincode" ?</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [docs/endorsement-policies.md#L4](https://github.com/hyperledger-gerrit-archive/fabric/blob/29f19c9b9a519575de2de925b72db7b4044f4124/docs/endorsement-policies.md#L4)<br><strong>Comment</strong>: <pre>Done!</pre><strong>Commenter</strong>: Elli Androulaki - lli@zurich.ibm.com<br><strong>CommentLine</strong>: [docs/endorsement-policies.md#L22](https://github.com/hyperledger-gerrit-archive/fabric/blob/29f19c9b9a519575de2de925b72db7b4044f4124/docs/endorsement-policies.md#L22)<br><strong>Comment</strong>: <pre>So, a question perhaps for thought. MSPPrincipals are soon to support a "By organization Unit" classification that would allow us to have a more fine grained division of a membership inside an organization. Would you think that we extend endorsement policy language to support say policies that allow for defining this type of MSPPrincipals? 
It is fine if not, at this point, but if so, we could leverage this language also at the application level.
If we do, we may want to add a TODO here so that we do not forget this.</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [docs/endorsement-policies.md#L22](https://github.com/hyperledger-gerrit-archive/fabric/blob/29f19c9b9a519575de2de925b72db7b4044f4124/docs/endorsement-policies.md#L22)<br><strong>Comment</strong>: <pre>I've added a next steps section at the bottom where I've captured this, thx for the reminder!</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [docs/endorsement-policies.md#L23](https://github.com/hyperledger-gerrit-archive/fabric/blob/29f19c9b9a519575de2de925b72db7b4044f4124/docs/endorsement-policies.md#L23)<br><strong>Comment</strong>: <pre>Isn't introduction of "syntax" too soon, too abrupt ? After all this is a CLI construct only. I'd take about this in terms of Semantics and introduce the syntax as a CLI specific UI exposure.

I'd say this is a key thing to separate out. We don't know how what the SDK's UI exposure will be. Better to talk semantics in this section. Basically examples of policies we would like to express (like in the examples below) in fabric terms (As opposed to CLI syntax). then end the section with how "this needs to be expressed in various interfaces . Rest of this document discuss the CLI implementation for this UI"</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [docs/endorsement-policies.md#L23](https://github.com/hyperledger-gerrit-archive/fabric/blob/29f19c9b9a519575de2de925b72db7b4044f4124/docs/endorsement-policies.md#L23)<br><strong>Comment</strong>: <pre>I've moved this in the section below and kept this one high level - is that ok?</pre></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Created</strong>: 2/1/2017, 9:44:37 AM<br><strong>UnmergedRevision</strong>: [bd24b477bdc3ce5e82b6b4a547d286d92611cf5a](https://github.com/hyperledger-gerrit-archive/fabric/commit/bd24b477bdc3ce5e82b6b4a547d286d92611cf5a)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 2/1/2017, 10:48:54 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Elli Androulaki - lli@zurich.ibm.com<br><strong>Approved</strong>: 2/1/2017, 12:19:27 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [docs/endorsement-policies.md#L32](https://github.com/hyperledger-gerrit-archive/fabric/blob/bd24b477bdc3ce5e82b6b4a547d286d92611cf5a/docs/endorsement-policies.md#L32)<br><strong>Comment</strong>: <pre>I'd just use CLI "Endorsement policy syntax in the CLI"</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [docs/endorsement-policies.md#L37](https://github.com/hyperledger-gerrit-archive/fabric/blob/bd24b477bdc3ce5e82b6b4a547d286d92611cf5a/docs/endorsement-policies.md#L37)<br><strong>Comment</strong>: <pre>How about "In the CLI, a simple language is used to express policies in terms of boolean expressions over principals".</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [docs/endorsement-policies.md#L42](https://github.com/hyperledger-gerrit-archive/fabric/blob/bd24b477bdc3ce5e82b6b4a547d286d92611cf5a/docs/endorsement-policies.md#L42)<br><strong>Comment</strong>: <pre>How about 
Principals are described as `MSP`.`ROLE`, where `MSP` is the MSP ID that is required, and `ROLE` is either one of the two strings `member` and `admin`.</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [docs/endorsement-policies.md#L65](https://github.com/hyperledger-gerrit-archive/fabric/blob/bd24b477bdc3ce5e82b6b4a547d286d92611cf5a/docs/endorsement-policies.md#L65)<br><strong>Comment</strong>: <pre>How about breaking up the above :

Using this language, a chaincode deployer can request that the endorsements for a chaincode be  validated against the specified policy.

NOTE - the default policy requires one signature from a member of the `DEFAULT` MSP). This is used if a policy is not specified in the CLI.</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [docs/endorsement-policies.md#L76](https://github.com/hyperledger-gerrit-archive/fabric/blob/bd24b477bdc3ce5e82b6b4a547d286d92611cf5a/docs/endorsement-policies.md#L76)<br><strong>Comment</strong>: <pre>"Future enhancements" instead of "Next steps" ? 

Removing this section would be fine too.</pre></blockquote><h3>PatchSet Number: 3</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Created</strong>: 2/2/2017, 2:49:14 PM<br><strong>GitHubMergedRevision</strong>: [3ed6194d2a95293c8380ac4d64f6d568d0cb3c0d](https://github.com/hyperledger-gerrit-archive/fabric/commit/3ed6194d2a95293c8380ac4d64f6d568d0cb3c0d)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 2/2/2017, 3:44:47 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Approved</strong>: 2/2/2017, 4:37:43 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Approved</strong>: 2/2/2017, 5:09:19 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>MergedBy</strong>: Yacov Manevich<br><strong>Merged</strong>: 2/2/2017, 5:09:26 PM<br><br></blockquote>
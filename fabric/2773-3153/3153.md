<strong>Project</strong>: fabric<br><strong>Branch</strong>: master<br><strong>ID</strong>: 3153<br><strong>Subject</strong>: Refactor MSP package and msp config w/o json<br><strong>Status</strong>: MERGED<br><strong>Owner</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Assignee</strong>:<br><strong>Created</strong>: 12/9/2016, 6:12:47 AM<br><strong>LastUpdated</strong>: 12/10/2016, 3:15:15 PM<br><strong>CommitMessage</strong>:<br><pre>Refactor MSP package and msp config w/o json

This change-set presents a better organisation of the MSP package: code that
belongs to msp proper is in fabric/msp, whereas core that instantiates and
manages msps for the peer was moved in fabric/core/peer (a new package was
created to avoid import cycles). Furthermore, configuration of the local
MSP no longer requires a specific json file: it is sufficient to place
certificates and keys in a directory with the appropriate structure (sample in
msp/sampleconfig).

Change-Id: Ic0c696a6e0fb406d8e482240e24e5d5774efc5c5
Signed-off-by: Alessandro Sorniotti <ale.linux@sopit.net>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 12/9/2016, 6:12:47 AM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/9/2016, 6:15:53 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3805/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/9/2016, 6:20:45 AM<br><strong>Message</strong>: <pre>Patch Set 1: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3805/ : FAILURE</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 12/9/2016, 7:04:40 AM<br><strong>Message</strong>: <pre>Uploaded patch set 2: Commit message was updated.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/9/2016, 7:06:02 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3806/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/9/2016, 7:12:18 AM<br><strong>Message</strong>: <pre>Patch Set 2: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3806/ : FAILURE</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 12/9/2016, 8:02:36 AM<br><strong>Message</strong>: <pre>Uploaded patch set 3.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/9/2016, 8:06:01 AM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3809/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/9/2016, 8:37:26 AM<br><strong>Message</strong>: <pre>Patch Set 3: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3809/ : FAILURE</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 12/9/2016, 8:52:12 AM<br><strong>Message</strong>: <pre>Uploaded patch set 4.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/9/2016, 8:54:13 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3810/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/9/2016, 9:21:52 AM<br><strong>Message</strong>: <pre>Patch Set 4: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3810/ : SUCCESS</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 12/9/2016, 10:49:21 AM<br><strong>Message</strong>: <pre>Uploaded patch set 5.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/9/2016, 10:52:45 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3819/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/9/2016, 11:20:13 AM<br><strong>Message</strong>: <pre>Patch Set 5: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3819/ : SUCCESS</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 12/9/2016, 12:16:44 PM<br><strong>Message</strong>: <pre>Patch Set 5: Code-Review-1

(7 comments)

a few comments.</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 12/9/2016, 12:25:01 PM<br><strong>Message</strong>: <pre>Patch Set 5:

(7 comments)

Thanks, see below and will push shortly with all the fixes required</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 12/9/2016, 12:27:52 PM<br><strong>Message</strong>: <pre>Uploaded patch set 6.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/9/2016, 12:29:09 PM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3823/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/9/2016, 12:57:14 PM<br><strong>Message</strong>: <pre>Patch Set 6: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3823/ : SUCCESS</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 12/9/2016, 1:30:44 PM<br><strong>Message</strong>: <pre>Patch Set 6: Code-Review+2

(1 comment)

thanks, Alessandro. LGTM</pre><strong>Reviewer</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Reviewed</strong>: 12/9/2016, 3:11:03 PM<br><strong>Message</strong>: <pre>Patch Set 6: Code-Review-2

(14 comments)</pre><strong>Reviewer</strong>: Christopher Ferris - chris.ferris@gmail.com<br><strong>Reviewed</strong>: 12/9/2016, 3:18:04 PM<br><strong>Message</strong>: <pre>Patch Set 6: Code-Review-1

this is a rather large change with no associated JIRA. Possibly that is an omission?</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 12/10/2016, 5:47:10 AM<br><strong>Message</strong>: <pre>Patch Set 6:

(13 comments)

Thanks Binh and Chris.

@Chris: I'm not aware of any JIRA item for this change-set, Binh, Murali and I decided that this rework was required on Thursday over the phone and I don't think anyone had the time to create a JIRA for it - I'm just *that* fast :P

@Binh: see my responses below and a new drop addressing your comments</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 12/10/2016, 5:47:25 AM<br><strong>Message</strong>: <pre>Uploaded patch set 7.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/10/2016, 5:48:56 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3831/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/10/2016, 6:13:30 AM<br><strong>Message</strong>: <pre>Patch Set 7: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3831/ : FAILURE</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 12/10/2016, 6:22:13 AM<br><strong>Message</strong>: <pre>Uploaded patch set 8: Commit message was updated.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/10/2016, 6:23:06 AM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3832/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/10/2016, 6:46:23 AM<br><strong>Message</strong>: <pre>Patch Set 8: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3832/ : SUCCESS</pre><strong>Reviewer</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Reviewed</strong>: 12/10/2016, 10:38:25 AM<br><strong>Message</strong>: <pre>Patch Set 6:

(3 comments)</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 12/10/2016, 12:00:23 PM<br><strong>Message</strong>: <pre>Uploaded patch set 9.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/10/2016, 12:02:23 PM<br><strong>Message</strong>: <pre>Patch Set 9:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3834/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/10/2016, 12:27:21 PM<br><strong>Message</strong>: <pre>Patch Set 9: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3834/ : SUCCESS</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 12/10/2016, 1:43:41 PM<br><strong>Message</strong>: <pre>Uploaded patch set 10.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/10/2016, 1:44:57 PM<br><strong>Message</strong>: <pre>Patch Set 10:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3836/</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 12/10/2016, 2:03:17 PM<br><strong>Message</strong>: <pre>Uploaded patch set 11.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/10/2016, 2:06:31 PM<br><strong>Message</strong>: <pre>Patch Set 11:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3837/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/10/2016, 2:11:43 PM<br><strong>Message</strong>: <pre>Patch Set 10: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3836/ : SUCCESS</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/10/2016, 2:34:20 PM<br><strong>Message</strong>: <pre>Patch Set 11: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3837/ : SUCCESS</pre><strong>Reviewer</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Reviewed</strong>: 12/10/2016, 2:41:28 PM<br><strong>Message</strong>: <pre>Patch Set 11: Code-Review+2

(1 comment)

some minor things that we will fix in the next iteration</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 12/10/2016, 2:41:55 PM<br><strong>Message</strong>: <pre>Patch Set 11: Code-Review+2</pre><strong>Reviewer</strong>: Gerrit Code Review - gerrit@hyperledger.org<br><strong>Reviewed</strong>: 12/10/2016, 2:42:01 PM<br><strong>Message</strong>: <pre>Change has been successfully merged by Srinivasan Muralidharan</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/10/2016, 2:43:30 PM<br><strong>Message</strong>: <pre>Patch Set 11:

Build Started https://jenkins.hyperledger.org/job/fabric-merge-x86_64/541/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/10/2016, 3:15:15 PM<br><strong>Message</strong>: <pre>Patch Set 11:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-merge-x86_64/541/ : SUCCESS</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Created</strong>: 12/9/2016, 6:12:47 AM<br><strong>UnmergedRevision</strong>: [62c37dddca5e4489d053a5b74d628c2ccbae0363](https://github.com/hyperledger-gerrit-archive/fabric/commit/62c37dddca5e4489d053a5b74d628c2ccbae0363)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/9/2016, 6:20:45 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: NO_CODE_CHANGE<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Created</strong>: 12/9/2016, 7:04:40 AM<br><strong>UnmergedRevision</strong>: [fb6a0b650207118280f8ff0716eb02c9daf56b1b](https://github.com/hyperledger-gerrit-archive/fabric/commit/fb6a0b650207118280f8ff0716eb02c9daf56b1b)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/9/2016, 7:12:18 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 3</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Created</strong>: 12/9/2016, 8:02:36 AM<br><strong>UnmergedRevision</strong>: [bedd17977f3c9ab95748ba72ccfc0f61e0cf9637](https://github.com/hyperledger-gerrit-archive/fabric/commit/bedd17977f3c9ab95748ba72ccfc0f61e0cf9637)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/9/2016, 8:37:26 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 4</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Created</strong>: 12/9/2016, 8:52:12 AM<br><strong>UnmergedRevision</strong>: [0c00826a35c19c9bcb359f757cda51b65583ae13](https://github.com/hyperledger-gerrit-archive/fabric/commit/0c00826a35c19c9bcb359f757cda51b65583ae13)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/9/2016, 9:21:52 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 5</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Created</strong>: 12/9/2016, 10:49:21 AM<br><strong>UnmergedRevision</strong>: [5495bb2b6f1bd2e22b47836a9f020c85b103c50f](https://github.com/hyperledger-gerrit-archive/fabric/commit/5495bb2b6f1bd2e22b47836a9f020c85b103c50f)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/9/2016, 11:20:13 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Approved</strong>: 12/9/2016, 12:16:44 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [core/peer/msp/config.go#L74](https://github.com/hyperledger-gerrit-archive/fabric/blob/5495bb2b6f1bd2e22b47836a9f020c85b103c50f/core/peer/msp/config.go#L74)<br><strong>Comment</strong>: <pre>above shoukd be replaced with the more idiomatic panic</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [core/peer/msp/config.go#L74](https://github.com/hyperledger-gerrit-archive/fabric/blob/5495bb2b6f1bd2e22b47836a9f020c85b103c50f/core/peer/msp/config.go#L74)<br><strong>Comment</strong>: <pre>thx, will change!</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [core/peer/msp/mgmt.go#L20](https://github.com/hyperledger-gerrit-archive/fabric/blob/5495bb2b6f1bd2e22b47836a9f020c85b103c50f/core/peer/msp/mgmt.go#L20)<br><strong>Comment</strong>: <pre>A //TODO to indicated this will disapper ?</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [core/peer/msp/mgmt.go#L20](https://github.com/hyperledger-gerrit-archive/fabric/blob/5495bb2b6f1bd2e22b47836a9f020c85b103c50f/core/peer/msp/mgmt.go#L20)<br><strong>Comment</strong>: <pre>I've left one on lines 10 through 13, should I add another one?</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [core/peer/msp/mgmt.go#L20](https://github.com/hyperledger-gerrit-archive/fabric/blob/5495bb2b6f1bd2e22b47836a9f020c85b103c50f/core/peer/msp/mgmt.go#L20)<br><strong>Comment</strong>: <pre>Ok. That was a just a suggestion if you see it fit....</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [core/peer/msp/peermsp_test.go#L21](https://github.com/hyperledger-gerrit-archive/fabric/blob/5495bb2b6f1bd2e22b47836a9f020c85b103c50f/core/peer/msp/peermsp_test.go#L21)<br><strong>Comment</strong>: <pre>perhaps a //TODO here to remind this will also go away after peer join is fully in ?</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [core/peer/msp/peermsp_test.go#L21](https://github.com/hyperledger-gerrit-archive/fabric/blob/5495bb2b6f1bd2e22b47836a9f020c85b103c50f/core/peer/msp/peermsp_test.go#L21)<br><strong>Comment</strong>: <pre>Ah yes, good point, will do</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [images/peer/Dockerfile.in#L11](https://github.com/hyperledger-gerrit-archive/fabric/blob/5495bb2b6f1bd2e22b47836a9f020c85b103c50f/images/peer/Dockerfile.in#L11)<br><strong>Comment</strong>: <pre>I like the use of PEER_CFG_PATH!</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [images/peer/Dockerfile.in#L11](https://github.com/hyperledger-gerrit-archive/fabric/blob/5495bb2b6f1bd2e22b47836a9f020c85b103c50f/images/peer/Dockerfile.in#L11)<br><strong>Comment</strong>: <pre>:)</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [msp/identities.go#L33](https://github.com/hyperledger-gerrit-archive/fabric/blob/5495bb2b6f1bd2e22b47836a9f020c85b103c50f/msp/identities.go#L33)<br><strong>Comment</strong>: <pre>some coments for this important structure please ?</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [msp/identities.go#L33](https://github.com/hyperledger-gerrit-archive/fabric/blob/5495bb2b6f1bd2e22b47836a9f020c85b103c50f/msp/identities.go#L33)<br><strong>Comment</strong>: <pre>whoops, let me do that!</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [msp/msp.go#L78](https://github.com/hyperledger-gerrit-archive/fabric/blob/5495bb2b6f1bd2e22b47836a9f020c85b103c50f/msp/msp.go#L78)<br><strong>Comment</strong>: <pre>This comment can go away ?</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [msp/msp.go#L78](https://github.com/hyperledger-gerrit-archive/fabric/blob/5495bb2b6f1bd2e22b47836a9f020c85b103c50f/msp/msp.go#L78)<br><strong>Comment</strong>: <pre>done!</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [msp/mspimpl.go#L54](https://github.com/hyperledger-gerrit-archive/fabric/blob/5495bb2b6f1bd2e22b47836a9f020c85b103c50f/msp/mspimpl.go#L54)<br><strong>Comment</strong>: <pre>Needs function annotation //NewBccspMsp ... also some of your usual excellant comments to indicate usage would be welcome! :-)</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [msp/mspimpl.go#L54](https://github.com/hyperledger-gerrit-archive/fabric/blob/5495bb2b6f1bd2e22b47836a9f020c85b103c50f/msp/mspimpl.go#L54)<br><strong>Comment</strong>: <pre>:) gotcha, will add them, thx!</pre></blockquote><h3>PatchSet Number: 6</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Created</strong>: 12/9/2016, 12:27:52 PM<br><strong>UnmergedRevision</strong>: [c323b3b36a200085e121db2bfda202acfd341bc1](https://github.com/hyperledger-gerrit-archive/fabric/commit/c323b3b36a200085e121db2bfda202acfd341bc1)<br><br><strong>Approver</strong>: Christopher Ferris - chris.ferris@gmail.com<br><strong>Approved</strong>: 12/9/2016, 3:18:04 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/9/2016, 12:57:14 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Approved</strong>: 12/9/2016, 3:11:03 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Approved</strong>: 12/9/2016, 1:30:44 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [msp/msp.go#L53](https://github.com/hyperledger-gerrit-archive/fabric/blob/c323b3b36a200085e121db2bfda202acfd341bc1/msp/msp.go#L53)<br><strong>Comment</strong>: <pre>Please change to GetMSPs(.)</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [msp/msp.go#L53](https://github.com/hyperledger-gerrit-archive/fabric/blob/c323b3b36a200085e121db2bfda202acfd341bc1/msp/msp.go#L53)<br><strong>Comment</strong>: <pre>Thanks, done!</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [msp/msp.go#L69](https://github.com/hyperledger-gerrit-archive/fabric/blob/c323b3b36a200085e121db2bfda202acfd341bc1/msp/msp.go#L69)<br><strong>Comment</strong>: <pre>Any differences between this function and MSP.ImportSigningIdentity ? I am not clear on why would we need this from a mgr.  Does each mgr have a signing identity?</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [msp/msp.go#L69](https://github.com/hyperledger-gerrit-archive/fabric/blob/c323b3b36a200085e121db2bfda202acfd341bc1/msp/msp.go#L69)<br><strong>Comment</strong>: <pre>The idea is that the manager is the entry point for all calls. It then routes calls to the appropriate MSP by inspecting the argument, determining the MSP responsible for the request, looking it up in its internal data structures and issuing the call to it.</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [msp/msp.go#L69](https://github.com/hyperledger-gerrit-archive/fabric/blob/c323b3b36a200085e121db2bfda202acfd341bc1/msp/msp.go#L69)<br><strong>Comment</strong>: <pre>So it should have been ImportSigningIdentityForMSP. 

But we have no use-case for this. In fact, this would cause a lot of problems because this imported signing identity would not be reflected in the configuration block, right?  Someone could just call this function and set an identity without the network knowing anything about.</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [msp/msp.go#L75](https://github.com/hyperledger-gerrit-archive/fabric/blob/c323b3b36a200085e121db2bfda202acfd341bc1/msp/msp.go#L75)<br><strong>Comment</strong>: <pre>Why would we need to return bool? Error or not error would be enough in my mind.</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [msp/msp.go#L75](https://github.com/hyperledger-gerrit-archive/fabric/blob/c323b3b36a200085e121db2bfda202acfd341bc1/msp/msp.go#L75)<br><strong>Comment</strong>: <pre>You are right, I'll change it. Thx!</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [msp/msp.go#L102](https://github.com/hyperledger-gerrit-archive/fabric/blob/c323b3b36a200085e121db2bfda202acfd341bc1/msp/msp.go#L102)<br><strong>Comment</strong>: <pre>I am not clear on the usage of this function as Import versus Set. Are there multiple signing identities?  The getter below only returns 1 identity.</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [msp/msp.go#L102](https://github.com/hyperledger-gerrit-archive/fabric/blob/c323b3b36a200085e121db2bfda202acfd341bc1/msp/msp.go#L102)<br><strong>Comment</strong>: <pre>Currently there is only a single signing identity, which is loaded when the MSP is initially setup. That signing identity, which is the default one, can be retrieved by calling GetDefaultSigningIdentity. However the idea is to cater for MSPs that handle multiple signing identities, for instance because a peer might want to sign with different keys on different chains or for different cc's. Furthermore, I believe that we also wanted to cater for the possibility of loading identities *after* the initial setup. ImportSigningIdentity was designed to handle this particular case.</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [msp/msp.go#L102](https://github.com/hyperledger-gerrit-archive/fabric/blob/c323b3b36a200085e121db2bfda202acfd341bc1/msp/msp.go#L102)<br><strong>Comment</strong>: <pre>This use-case has not been thought through - half baked at best. What would happen to these signing identities when peer restarts?  We never write configurations back to the yaml</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [msp/msp.go#L105](https://github.com/hyperledger-gerrit-archive/fabric/blob/c323b3b36a200085e121db2bfda202acfd341bc1/msp/msp.go#L105)<br><strong>Comment</strong>: <pre>Why some getter functions in the form of Noun() and other GetNoun() ? I would be consistent and just prepend Get/Set and be done.</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [msp/msp.go#L105](https://github.com/hyperledger-gerrit-archive/fabric/blob/c323b3b36a200085e121db2bfda202acfd341bc1/msp/msp.go#L105)<br><strong>Comment</strong>: <pre>Good point, I'll do that.</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [msp/msp.go#L117](https://github.com/hyperledger-gerrit-archive/fabric/blob/c323b3b36a200085e121db2bfda202acfd341bc1/msp/msp.go#L117)<br><strong>Comment</strong>: <pre>This is difficult to use. We should just return bool and 'false' if error. Imagine writing code like this:
if valid, err := IsValid(id); err != nil || ! valid {
    handleError()
}</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [msp/msp.go#L117](https://github.com/hyperledger-gerrit-archive/fabric/blob/c323b3b36a200085e121db2bfda202acfd341bc1/msp/msp.go#L117)<br><strong>Comment</strong>: <pre>In my mind there are 3 cases to handle:
1) success - the identity was valid
2) failure - the identity was invalid (because it was revoked, because its validity period expired, because we don't trust the issuer....)
3) undetermined - we couldn't tell whether the identity is valid or not because it is in a format that we couldn't interpret or some other internal error occurred (but we don't want to panic())

This is why imho just bool doesn't cut it - RAS on cert validity will be enhanced if we know what happened here.</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [msp/msp.go#L117](https://github.com/hyperledger-gerrit-archive/fabric/blob/c323b3b36a200085e121db2bfda202acfd341bc1/msp/msp.go#L117)<br><strong>Comment</strong>: <pre>so both 2 and 3 mean not valid, leaving 1 to be valid.  If you don't want to return bool only, return error, and change the function to
`Validate(identity) error`. Would it violate security to return the explicit reasons why failure here?</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [msp/msp.go#L141](https://github.com/hyperledger-gerrit-archive/fabric/blob/c323b3b36a200085e121db2bfda202acfd341bc1/msp/msp.go#L141)<br><strong>Comment</strong>: <pre>Same comment as above re  returning bool and error.</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [msp/msp.go#L141](https://github.com/hyperledger-gerrit-archive/fabric/blob/c323b3b36a200085e121db2bfda202acfd341bc1/msp/msp.go#L141)<br><strong>Comment</strong>: <pre>See previous comment.</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [msp/msp.go#L161](https://github.com/hyperledger-gerrit-archive/fabric/blob/c323b3b36a200085e121db2bfda202acfd341bc1/msp/msp.go#L161)<br><strong>Comment</strong>: <pre>Same comment as above re returning bool and error</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [msp/msp.go#L161](https://github.com/hyperledger-gerrit-archive/fabric/blob/c323b3b36a200085e121db2bfda202acfd341bc1/msp/msp.go#L161)<br><strong>Comment</strong>: <pre>See above</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [msp/mspimpl.go#L147](https://github.com/hyperledger-gerrit-archive/fabric/blob/c323b3b36a200085e121db2bfda202acfd341bc1/msp/mspimpl.go#L147)<br><strong>Comment</strong>: <pre>We shouldn't log this message as the caller will have to handle.</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [msp/mspimpl.go#L147](https://github.com/hyperledger-gerrit-archive/fabric/blob/c323b3b36a200085e121db2bfda202acfd341bc1/msp/mspimpl.go#L147)<br><strong>Comment</strong>: <pre>Yup, I'll remove this pattern throughout</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [msp/mspimpl.go#L155](https://github.com/hyperledger-gerrit-archive/fabric/blob/c323b3b36a200085e121db2bfda202acfd341bc1/msp/mspimpl.go#L155)<br><strong>Comment</strong>: <pre>This pattern (as above) is bad practice. We should log debug here to help serviceability, not echoing the error msg that we are propagating to the caller who will either log and/or continue on propagating.</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [msp/mspimpl.go#L155](https://github.com/hyperledger-gerrit-archive/fabric/blob/c323b3b36a200085e121db2bfda202acfd341bc1/msp/mspimpl.go#L155)<br><strong>Comment</strong>: <pre>My bad, I initially wrote it like this to get some debug output and then forgot to remove it - thx for catching it.</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [msp/mspimpl.go#L255](https://github.com/hyperledger-gerrit-archive/fabric/blob/c323b3b36a200085e121db2bfda202acfd341bc1/msp/mspimpl.go#L255)<br><strong>Comment</strong>: <pre>Why are we using log info instead of debug?  I am not sure what we can get out of this as the statement below already handle err and output the info.  But I don't like the log info below either because it doesn't give any additional info.  We should strive to help serviceability when logging execution.</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [msp/mspimpl.go#L255](https://github.com/hyperledger-gerrit-archive/fabric/blob/c323b3b36a200085e121db2bfda202acfd341bc1/msp/mspimpl.go#L255)<br><strong>Comment</strong>: <pre>Yup, I think they are still remnants of my initial drop where it was useful for me to see how the code worked (or failed). Then I sort of never bothered to tidy up - thx for catching</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [msp/mspmgrimpl.go#L46](https://github.com/hyperledger-gerrit-archive/fabric/blob/c323b3b36a200085e121db2bfda202acfd341bc1/msp/mspmgrimpl.go#L46)<br><strong>Comment</strong>: <pre>Why warning?  It looks like our code expects and handles it.</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [msp/mspmgrimpl.go#L51](https://github.com/hyperledger-gerrit-archive/fabric/blob/c323b3b36a200085e121db2bfda202acfd341bc1/msp/mspmgrimpl.go#L51)<br><strong>Comment</strong>: <pre>Remove this please</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [msp/mspmgrimpl.go#L51](https://github.com/hyperledger-gerrit-archive/fabric/blob/c323b3b36a200085e121db2bfda202acfd341bc1/msp/mspmgrimpl.go#L51)<br><strong>Comment</strong>: <pre>Yup</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [msp/mspmgrimpl.go#L65](https://github.com/hyperledger-gerrit-archive/fabric/blob/c323b3b36a200085e121db2bfda202acfd341bc1/msp/mspmgrimpl.go#L65)<br><strong>Comment</strong>: <pre>Same pattern.   I am stopping here, and wait to have this pattern clean up.</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [msp/mspmgrimpl.go#L65](https://github.com/hyperledger-gerrit-archive/fabric/blob/c323b3b36a200085e121db2bfda202acfd341bc1/msp/mspmgrimpl.go#L65)<br><strong>Comment</strong>: <pre>Done</pre></blockquote><h3>PatchSet Number: 7</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Created</strong>: 12/10/2016, 5:47:25 AM<br><strong>UnmergedRevision</strong>: [3313d6d2d2f784b1706772c6e33526976e46487c](https://github.com/hyperledger-gerrit-archive/fabric/commit/3313d6d2d2f784b1706772c6e33526976e46487c)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/10/2016, 6:13:30 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Approved</strong>: 12/9/2016, 3:11:03 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 8</h3><blockquote><strong>Type</strong>: NO_CODE_CHANGE<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Created</strong>: 12/10/2016, 6:22:13 AM<br><strong>UnmergedRevision</strong>: [97b89f25629e2693a4aba6a3c68ae3f36ab5b2fe](https://github.com/hyperledger-gerrit-archive/fabric/commit/97b89f25629e2693a4aba6a3c68ae3f36ab5b2fe)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/10/2016, 6:46:23 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Approved</strong>: 12/9/2016, 3:11:03 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 9</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Created</strong>: 12/10/2016, 12:00:23 PM<br><strong>UnmergedRevision</strong>: [621536ff59607fe8fec9ef52a60768fb0876b403](https://github.com/hyperledger-gerrit-archive/fabric/commit/621536ff59607fe8fec9ef52a60768fb0876b403)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/10/2016, 12:27:21 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Approved</strong>: 12/9/2016, 3:11:03 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 10</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Created</strong>: 12/10/2016, 1:43:41 PM<br><strong>UnmergedRevision</strong>: [e1f3972c232b10e4da46173da2bd3ae117180058](https://github.com/hyperledger-gerrit-archive/fabric/commit/e1f3972c232b10e4da46173da2bd3ae117180058)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/10/2016, 2:11:43 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Approved</strong>: 12/9/2016, 3:11:03 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 11</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Created</strong>: 12/10/2016, 2:03:17 PM<br><strong>GitHubMergedRevision</strong>: [1f4b004a943bd50f6aa959e8078a8d34130e4014](https://github.com/hyperledger-gerrit-archive/fabric/commit/1f4b004a943bd50f6aa959e8078a8d34130e4014)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/10/2016, 2:34:20 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Approved</strong>: 12/10/2016, 2:41:28 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Approved</strong>: 12/10/2016, 2:41:55 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>MergedBy</strong>: Srinivasan Muralidharan<br><strong>Merged</strong>: 12/10/2016, 2:42:01 PM<br><br><h2>Comments</h2><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [msp/msp.go#L93](https://github.com/hyperledger-gerrit-archive/fabric/blob/1f4b004a943bd50f6aa959e8078a8d34130e4014/msp/msp.go#L93)<br><strong>Comment</strong>: <pre>The comment has a different function name</pre></blockquote>
<strong>Project</strong>: fabric<br><strong>Branch</strong>: master<br><strong>ID</strong>: 2969<br><strong>Subject</strong>: FAB-1166 Gossip leader election<br><strong>Status</strong>: ABANDONED<br><strong>Owner</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Assignee</strong>:<br><strong>Created</strong>: 12/5/2016, 2:42:06 AM<br><strong>LastUpdated</strong>: 1/17/2017, 7:37:44 AM<br><strong>CommitMessage</strong>:<br><pre>FAB-1166 Gossip leader election

Naive leader election implementation:
While leader is alive, no peer tries to become leader and leader
periodically sends Leadership messages about his leadership.
If leader does not exist, the peer with the lowest lexicographical
value proposes itself to become leader. If it learns about another
peer with a lower lexicographical value that wants to become leader,
it gives up and accepts this other peer as leader.

Data about peers inside organisation and leader proposals is passed
using in-org and channel Leadership gossip messages.

Gossip is used as media to pass messages and know about all peers.

Change-Id: Ia49c6615ab94bb131bf127922cc2231de1b2d5fc
Signed-off-by: Gennady Laventman <gennady@il.ibm.com>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Reviewed</strong>: 12/5/2016, 2:42:06 AM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/5/2016, 2:43:25 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3627/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/5/2016, 2:45:46 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/2458/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/5/2016, 3:12:06 AM<br><strong>Message</strong>: <pre>Patch Set 1: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/2458/ : FAILURE (skipped)

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3627/ : SUCCESS</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 12/5/2016, 3:25:47 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(13 comments)</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 12/5/2016, 3:26:44 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(2 comments)</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 12/5/2016, 3:41:02 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(1 comment)</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 12/5/2016, 3:55:08 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(4 comments)</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 12/5/2016, 4:05:45 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(3 comments)</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 12/5/2016, 4:50:01 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(3 comments)</pre><strong>Reviewer</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Reviewed</strong>: 12/5/2016, 7:04:40 AM<br><strong>Message</strong>: <pre>Uploaded patch set 2.</pre><strong>Reviewer</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Reviewed</strong>: 12/5/2016, 7:04:51 AM<br><strong>Message</strong>: <pre>Patch Set 2:

(23 comments)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/5/2016, 7:06:54 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3635/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/5/2016, 7:09:05 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/2466/ (2/2)</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 12/5/2016, 7:15:18 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(2 comments)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/5/2016, 7:45:04 AM<br><strong>Message</strong>: <pre>Patch Set 2: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3635/ : FAILURE

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/2466/ : FAILURE (skipped)</pre><strong>Reviewer</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Reviewed</strong>: 12/5/2016, 1:12:05 PM<br><strong>Message</strong>: <pre>Uploaded patch set 3.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/5/2016, 1:12:11 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3648/ (1/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/5/2016, 1:12:28 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-app-image-verify-docker-ppc64le/4/ (2/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/5/2016, 1:12:29 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-app-image-verify-docker-s390x/4/ (3/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/5/2016, 1:13:56 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/2479/ (4/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/5/2016, 1:16:50 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-app-image-verify-docker-x86_64/4/ (5/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/5/2016, 1:45:14 PM<br><strong>Message</strong>: <pre>Patch Set 3: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3648/ : FAILURE

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/2479/ : FAILURE (skipped)

https://jenkins.hyperledger.org/job/fabric-app-image-verify-docker-ppc64le/4/ : FAILURE

https://jenkins.hyperledger.org/job/fabric-app-image-verify-docker-s390x/4/ : FAILURE

https://jenkins.hyperledger.org/job/fabric-app-image-verify-docker-x86_64/4/ : FAILURE</pre><strong>Reviewer</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Reviewed</strong>: 12/29/2016, 10:31:26 AM<br><strong>Message</strong>: <pre>Uploaded patch set 4.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/29/2016, 10:35:45 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4514/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/29/2016, 10:39:07 AM<br><strong>Message</strong>: <pre>Patch Set 4: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4514/ : FAILURE</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 12/29/2016, 6:20:54 PM<br><strong>Message</strong>: <pre>Patch Set 4:

(2 comments)</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 1/2/2017, 9:28:54 AM<br><strong>Message</strong>: <pre>Patch Set 4:

(5 comments)</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 1/2/2017, 9:48:47 AM<br><strong>Message</strong>: <pre>Patch Set 4:

(4 comments)</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 1/2/2017, 10:05:21 AM<br><strong>Message</strong>: <pre>Patch Set 4:

(3 comments)</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 1/2/2017, 10:06:08 AM<br><strong>Message</strong>: <pre>Patch Set 4:

reverify</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/2/2017, 10:09:59 AM<br><strong>Message</strong>: <pre>Patch Set 4: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4531/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/2/2017, 10:16:36 AM<br><strong>Message</strong>: <pre>Patch Set 4: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4531/ : FAILURE</pre><strong>Reviewer</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Reviewed</strong>: 1/3/2017, 9:41:38 AM<br><strong>Message</strong>: <pre>Patch Set 4:

(12 comments)</pre><strong>Reviewer</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Reviewed</strong>: 1/3/2017, 10:08:18 AM<br><strong>Message</strong>: <pre>Uploaded patch set 5.</pre><strong>Reviewer</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Reviewed</strong>: 1/3/2017, 10:08:45 AM<br><strong>Message</strong>: <pre>Uploaded patch set 6: Commit message was updated.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/3/2017, 10:11:25 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4549/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/3/2017, 10:15:01 AM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4550/</pre><strong>Reviewer</strong>: Gabor Hosszu - gabor@digitalasset.com<br><strong>Reviewed</strong>: 1/3/2017, 10:18:22 AM<br><strong>Message</strong>: <pre>Patch Set 6:

(2 comments)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/3/2017, 11:25:57 AM<br><strong>Message</strong>: <pre>Patch Set 6: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4550/ : FAILURE</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/3/2017, 11:40:44 AM<br><strong>Message</strong>: <pre>Patch Set 5: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4549/ : FAILURE</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/3/2017, 12:53:51 PM<br><strong>Message</strong>: <pre>Patch Set 6: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4568/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/3/2017, 1:42:27 PM<br><strong>Message</strong>: <pre>Patch Set 6: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4568/ : FAILURE</pre><strong>Reviewer</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Reviewed</strong>: 1/4/2017, 6:51:22 AM<br><strong>Message</strong>: <pre>Patch Set 4:

(2 comments)</pre><strong>Reviewer</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Reviewed</strong>: 1/4/2017, 6:52:00 AM<br><strong>Message</strong>: <pre>Uploaded patch set 7.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/4/2017, 6:55:39 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4600/</pre><strong>Reviewer</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Reviewed</strong>: 1/4/2017, 7:31:59 AM<br><strong>Message</strong>: <pre>Uploaded patch set 8.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/4/2017, 7:37:07 AM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4607/</pre><strong>Reviewer</strong>: Gabor Hosszu - gabor@digitalasset.com<br><strong>Reviewed</strong>: 1/4/2017, 7:51:28 AM<br><strong>Message</strong>: <pre>Patch Set 8: Code-Review+2

(1 comment)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/4/2017, 8:43:48 AM<br><strong>Message</strong>: <pre>Patch Set 7: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4600/ : FAILURE</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/4/2017, 8:44:39 AM<br><strong>Message</strong>: <pre>Patch Set 8: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4607/ : FAILURE</pre><strong>Reviewer</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Reviewed</strong>: 1/4/2017, 9:38:34 AM<br><strong>Message</strong>: <pre>Uploaded patch set 9.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/4/2017, 9:46:04 AM<br><strong>Message</strong>: <pre>Patch Set 9:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4615/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/4/2017, 12:00:33 PM<br><strong>Message</strong>: <pre>Patch Set 9: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4615/ : FAILURE</pre><strong>Reviewer</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Reviewed</strong>: 1/5/2017, 6:56:12 AM<br><strong>Message</strong>: <pre>Uploaded patch set 10.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/5/2017, 6:59:26 AM<br><strong>Message</strong>: <pre>Patch Set 10:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4667/</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 1/5/2017, 7:11:57 AM<br><strong>Message</strong>: <pre>Patch Set 4:

(3 comments)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/5/2017, 7:15:27 AM<br><strong>Message</strong>: <pre>Patch Set 10: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4667/ : FAILURE</pre><strong>Reviewer</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Reviewed</strong>: 1/5/2017, 9:28:44 AM<br><strong>Message</strong>: <pre>Patch Set 4:

(5 comments)</pre><strong>Reviewer</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Reviewed</strong>: 1/5/2017, 9:29:30 AM<br><strong>Message</strong>: <pre>Uploaded patch set 11.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/5/2017, 9:32:41 AM<br><strong>Message</strong>: <pre>Patch Set 11:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4685/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/5/2017, 10:11:15 AM<br><strong>Message</strong>: <pre>Patch Set 11: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4685/ : FAILURE</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 1/5/2017, 11:41:47 AM<br><strong>Message</strong>: <pre>Patch Set 11:

(13 comments)</pre><strong>Reviewer</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Reviewed</strong>: 1/6/2017, 11:10:36 AM<br><strong>Message</strong>: <pre>Patch Set 4:

(13 comments)</pre><strong>Reviewer</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Reviewed</strong>: 1/6/2017, 11:12:00 AM<br><strong>Message</strong>: <pre>Uploaded patch set 12.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/6/2017, 11:16:03 AM<br><strong>Message</strong>: <pre>Patch Set 12:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4766/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/6/2017, 11:50:11 AM<br><strong>Message</strong>: <pre>Patch Set 12: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4766/ : FAILURE</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 1/6/2017, 3:38:10 PM<br><strong>Message</strong>: <pre>Patch Set 12:

(8 comments)</pre><strong>Reviewer</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Reviewed</strong>: 1/7/2017, 3:35:53 PM<br><strong>Message</strong>: <pre>Patch Set 12:

(7 comments)</pre><strong>Reviewer</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Reviewed</strong>: 1/7/2017, 3:37:32 PM<br><strong>Message</strong>: <pre>Uploaded patch set 13.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/7/2017, 3:38:56 PM<br><strong>Message</strong>: <pre>Patch Set 13:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4789/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/7/2017, 4:05:16 PM<br><strong>Message</strong>: <pre>Patch Set 13: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4789/ : FAILURE</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 1/7/2017, 5:05:56 PM<br><strong>Message</strong>: <pre>Patch Set 13:

(4 comments)</pre><strong>Reviewer</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Reviewed</strong>: 1/8/2017, 12:28:56 PM<br><strong>Message</strong>: <pre>Uploaded patch set 14.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/8/2017, 12:32:10 PM<br><strong>Message</strong>: <pre>Patch Set 14:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4807/</pre><strong>Reviewer</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Reviewed</strong>: 1/8/2017, 12:33:29 PM<br><strong>Message</strong>: <pre>Patch Set 14:

(4 comments)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/8/2017, 1:11:09 PM<br><strong>Message</strong>: <pre>Patch Set 14: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4807/ : FAILURE</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 1/9/2017, 6:46:56 AM<br><strong>Message</strong>: <pre>Patch Set 14:

(5 comments)</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 1/17/2017, 7:37:44 AM<br><strong>Message</strong>: <pre>Abandoned

.</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Uploader</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Created</strong>: 12/5/2016, 2:42:06 AM<br><strong>UnmergedRevision</strong>: [ddffca017eb29ece102d2f5a56ac2baf867d4b96](https://github.com/hyperledger-gerrit-archive/fabric/commit/ddffca017eb29ece102d2f5a56ac2baf867d4b96)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/5/2016, 3:12:06 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/comm/comm_test.go#L176](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/comm/comm_test.go#L176)<br><strong>Comment</strong>: <pre>Can you please, revert this change, since it's not part of your commit?</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/comm/comm_test.go#L176](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/comm/comm_test.go#L176)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/discovery/discovery.go#L21](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/discovery/discovery.go#L21)<br><strong>Comment</strong>: <pre>Can you please, revert this change, since it's not part of your commit?</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/discovery/discovery.go#L21](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/discovery/discovery.go#L21)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election.go#L53](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election.go#L53)<br><strong>Comment</strong>: <pre>Can you please remove the impl details from this file?</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election.go#L53](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election.go#L53)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L14](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_impl.go#L14)<br><strong>Comment</strong>: <pre>I guess you didn't mean to expose this struct publicly? Can you make it private?</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L19](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_impl.go#L19)<br><strong>Comment</strong>: <pre>I think it's worth to *consider* removing the locks, and instead- changing the isLeader bool to an int32 type, and using atomic operations(https://golang.org/pkg/sync/atomic/).</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L55](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_impl.go#L55)<br><strong>Comment</strong>: <pre>I think this is missing here:


s.lock.RLock()
defer s.lock.RUnLock()</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L55](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_impl.go#L55)<br><strong>Comment</strong>: <pre>Doesn't it atomic? Lets talk about it</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L55](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_impl.go#L55)<br><strong>Comment</strong>: <pre>Nope according to https://golang.org/ref/mem</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L63](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_impl.go#L63)<br><strong>Comment</strong>: <pre>I think that to generalize the use case of leader election it's better to introduce Tags as a ElectionServiceImpl field and allow to setup it via construction rather than use GossipMessage_ORG_ONLY hard coded. IMO something like:

   message.(*proto.GossipMessage).Tag == s.Tag...</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L63](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_impl.go#L63)<br><strong>Comment</strong>: <pre>In general, I want to all this function to be passed as argument in future</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L63](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_impl.go#L63)<br><strong>Comment</strong>: <pre>Well, in the future I guess this function should be encapsulated with another one which will hide any relation to gossip interface.</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L69](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_impl.go#L69)<br><strong>Comment</strong>: <pre>Can you please extract it to package level constant?</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L69](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_impl.go#L69)<br><strong>Comment</strong>: <pre>This needs to be extracted to a parameter so in unit tests we could use milliseconds and not seconds, to make them faster.</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L69](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_impl.go#L69)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L69](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_impl.go#L69)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L77](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_impl.go#L77)<br><strong>Comment</strong>: <pre>This can be nil. the channel returned from the adapter can be closed (theoretically) before the for loop has exited, and reading from a closed channel returns nil. 
So we should add a check for nil here.</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L77](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_impl.go#L77)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L79](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_impl.go#L79)<br><strong>Comment</strong>: <pre>We going to have a lot of these, probably change info log level with debug?</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L79](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_impl.go#L79)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L84](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_impl.go#L84)<br><strong>Comment</strong>: <pre>to</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L84](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_impl.go#L84)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L85](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_impl.go#L85)<br><strong>Comment</strong>: <pre>%s is s.self.Endpoint, so [%s] and I doesn't make sense. Or maybe I didn't understand</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L85](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_impl.go#L85)<br><strong>Comment</strong>: <pre>I put [%s] is in each debug message start, to see what peer print it (in tests)</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L104](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_impl.go#L104)<br><strong>Comment</strong>: <pre>I think these message should be in debug and not info, since it will create a lot of contamination in messaging.</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L104](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_impl.go#L104)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L119](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_impl.go#L119)<br><strong>Comment</strong>: <pre>I think you can put here:

defer s.lock.Unlock()</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L119](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_impl.go#L119)<br><strong>Comment</strong>: <pre>Regular Unlock + defer Unlock will fail. And nothing should happens here...</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L126](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_impl.go#L126)<br><strong>Comment</strong>: <pre>Don't you need to set:

s.IsLeader = false

You found the leader and discovered that it's not current node, don't you need to update it?</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L126](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_impl.go#L126)<br><strong>Comment</strong>: <pre>s.isLeader can become true only if I put want to become leader - send message or I already leader. This cover for almost non existing case then node come up and get its own Alive msg from previous incarnation. Setting it to false done in incoming Alive message handling. Actually, remove previous s.isLeader=true can be more correct. But this lead to think about another issue I may have...</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L154](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_impl.go#L154)<br><strong>Comment</strong>: <pre>golint will probably complain here: metadata := []byte{} or var metadata []byte</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L154](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_impl.go#L154)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L160](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_impl.go#L160)<br><strong>Comment</strong>: <pre>debug?</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L160](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_impl.go#L160)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L169](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_impl.go#L169)<br><strong>Comment</strong>: <pre>this , _ isn't needed.</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L169](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_impl.go#L169)<br><strong>Comment</strong>: <pre>Didn't knew it.Done</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L179](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_impl.go#L179)<br><strong>Comment</strong>: <pre>defer?</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L179](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_impl.go#L179)<br><strong>Comment</strong>: <pre>See previous response...</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_test.go#L27](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_test.go#L27)<br><strong>Comment</strong>: <pre>I think that if the RWMutexes are value types and not pointer types, there is no need for init(), they're initialized at compilation time.</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_test.go#L35](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_test.go#L35)<br><strong>Comment</strong>: <pre>perhaps use defers?</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_test.go#L35](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_test.go#L35)<br><strong>Comment</strong>: <pre>I want main goroutine to sleep and service to run and I want multiple peers, so it will not work...</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_test.go#L61](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_test.go#L61)<br><strong>Comment</strong>: <pre>30 seconds is too much IMO.</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_test.go#L61](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_test.go#L61)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_test.go#L70](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_test.go#L70)<br><strong>Comment</strong>: <pre>can we make the times less? so the test will run quicker.
Also- what is the role of the sleep here?</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_test.go#L70](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/election/election_test.go#L70)<br><strong>Comment</strong>: <pre>Want to make sure that leader election round runs...</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/state/metastate.go#L62](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/state/metastate.go#L62)<br><strong>Comment</strong>: <pre>Can you please, revert this change, since it's not part of your commit?</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/state/metastate.go#L62](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/state/metastate.go#L62)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/state/metastate_test.go#L21](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/state/metastate_test.go#L21)<br><strong>Comment</strong>: <pre>Can you please, revert this change, since it's not part of your commit?</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/state/metastate_test.go#L21](https://github.com/hyperledger-gerrit-archive/fabric/blob/ddffca017eb29ece102d2f5a56ac2baf867d4b96/gossip/state/metastate_test.go#L21)<br><strong>Comment</strong>: <pre>Done</pre></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Uploader</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Created</strong>: 12/5/2016, 7:04:40 AM<br><strong>UnmergedRevision</strong>: [da1c060560cfee265fad994828c0052b6d75d460](https://github.com/hyperledger-gerrit-archive/fabric/commit/da1c060560cfee265fad994828c0052b6d75d460)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/5/2016, 7:45:04 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 3</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Uploader</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Created</strong>: 12/5/2016, 1:12:05 PM<br><strong>UnmergedRevision</strong>: [0f8467127911f5a3d40989b3f712b93c3efce03c](https://github.com/hyperledger-gerrit-archive/fabric/commit/0f8467127911f5a3d40989b3f712b93c3efce03c)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/5/2016, 1:45:14 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 4</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Uploader</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Created</strong>: 12/29/2016, 10:31:26 AM<br><strong>UnmergedRevision</strong>: [1e2537ab0d24b65036f093492ccf46e52e0a15a9](https://github.com/hyperledger-gerrit-archive/fabric/commit/1e2537ab0d24b65036f093492ccf46e52e0a15a9)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/2/2017, 10:16:36 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election.go#L39](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election.go#L39)<br><strong>Comment</strong>: <pre>Please, correct to "the".</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election.go#L39](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election.go#L39)<br><strong>Comment</strong>: <pre>Done long time ago</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L13](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election_impl.go#L13)<br><strong>Comment</strong>: <pre>As far as I know, this won't pass golint.</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L13](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election_impl.go#L13)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L22](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election_impl.go#L22)<br><strong>Comment</strong>: <pre>Guess, to encapsulate implementation details you will do this struct private, are you?</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L22](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election_impl.go#L22)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L118](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election_impl.go#L118)<br><strong>Comment</strong>: <pre>Unreachable code</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L118](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election_impl.go#L118)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L145](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election_impl.go#L145)<br><strong>Comment</strong>: <pre>Why the atomic reference? This variable is accessed only by 1 goroutine.</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L145](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election_impl.go#L145)<br><strong>Comment</strong>: <pre>I used it in tests, not anymore, so I can easily make it bool again</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L145](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election_impl.go#L145)<br><strong>Comment</strong>: <pre>Can you make it bool then? no reason for the atomic operation here.</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L183](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election_impl.go#L183)<br><strong>Comment</strong>: <pre>Why do you clear these maps if you could have received messages into them during the select phase that calls the electLeader?</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L183](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election_impl.go#L183)<br><strong>Comment</strong>: <pre>leadershipMessages - i want to reset because I only care for new message arrived during leader election phase.
same about proposeMessages.</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L235](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election_impl.go#L235)<br><strong>Comment</strong>: <pre>Unreachable code</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L235](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election_impl.go#L235)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L246](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election_impl.go#L246)<br><strong>Comment</strong>: <pre>Unreachable code</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L246](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election_impl.go#L246)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L283](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election_impl.go#L283)<br><strong>Comment</strong>: <pre>exits or exists? :)</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L283](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election_impl.go#L283)<br><strong>Comment</strong>: <pre>exists</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_test.go#L20](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election_test.go#L20)<br><strong>Comment</strong>: <pre>I think it can be good if tests would be independant completely.</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_test.go#L20](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election_test.go#L20)<br><strong>Comment</strong>: <pre>Didn't get what you mean - they are independent</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_test.go#L20](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election_test.go#L20)<br><strong>Comment</strong>: <pre>well, you have global variables here. I think it's better if tests would have the global variables inside the tests functions bodies, so it would be easy to understand and refactor things in the future.</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_test.go#L20](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election_test.go#L20)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_test.go#L23](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election_test.go#L23)<br><strong>Comment</strong>: <pre>This test runs 45 seconds on my machine. This is way too much time for a test that tests a module. 
Suggestions:
1) Parallelize all tests, make them run concurrently to save time.
2) Make the TestElectionServiceImpl_FivePeersStartStop run less than 30 seconds. It's the "longest link" in the chain.</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_test.go#L23](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election_test.go#L23)<br><strong>Comment</strong>: <pre>14 seconds now</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_test.go#L23](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election_test.go#L23)<br><strong>Comment</strong>: <pre>Can we parallelize-them please?</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_test.go#L23](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election_test.go#L23)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_test.go#L196](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election_test.go#L196)<br><strong>Comment</strong>: <pre>runId is string yet you do %d</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_test.go#L196](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election_test.go#L196)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_test.go#L222](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election_test.go#L222)<br><strong>Comment</strong>: <pre>What is the purpose of this select? it is equivalent to time.Sleep(leaderElectionInterval * 3)</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_test.go#L222](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election_test.go#L222)<br><strong>Comment</strong>: <pre>Exactly, it is. I replaced sleep after I had problems with scheduler - the one I showed you, to see if they behave differently - they behave exactly same</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_test.go#L222](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election_test.go#L222)<br><strong>Comment</strong>: <pre>yes but this needs to be replaced with sleep.</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_test.go#L222](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election_test.go#L222)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_test.go#L242](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election_test.go#L242)<br><strong>Comment</strong>: <pre>ditto</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_test.go#L242](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election_test.go#L242)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_test.go#L260](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election_test.go#L260)<br><strong>Comment</strong>: <pre>ditto^2</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_test.go#L260](https://github.com/hyperledger-gerrit-archive/fabric/blob/1e2537ab0d24b65036f093492ccf46e52e0a15a9/gossip/election/election_test.go#L260)<br><strong>Comment</strong>: <pre>Done</pre></blockquote><h3>PatchSet Number: 5</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Uploader</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Created</strong>: 1/3/2017, 10:08:18 AM<br><strong>UnmergedRevision</strong>: [f3941b29a98f0ceddc7a80fb470796ffa63eb478](https://github.com/hyperledger-gerrit-archive/fabric/commit/f3941b29a98f0ceddc7a80fb470796ffa63eb478)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/3/2017, 11:40:44 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 6</h3><blockquote><strong>Type</strong>: NO_CODE_CHANGE<br><strong>Author</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Uploader</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Created</strong>: 1/3/2017, 10:08:45 AM<br><strong>UnmergedRevision</strong>: [6c1e50ebf8ac909f41df3bee75eb8265f0aad294](https://github.com/hyperledger-gerrit-archive/fabric/commit/6c1e50ebf8ac909f41df3bee75eb8265f0aad294)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/3/2017, 1:42:27 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Gabor Hosszu - gabor@digitalasset.com<br><strong>CommentLine</strong>: [/COMMIT_MSG#L9](https://github.com/hyperledger-gerrit-archive/fabric/blob/6c1e50ebf8ac909f41df3bee75eb8265f0aad294//COMMIT_MSG#L9)<br><strong>Comment</strong>: <pre>I would suggest rewriting this a little bit: While leader is alive, no peer tries to become leader and leader periodically sends Leadership messages about his leadership. If leader does not exist, the peer with the lowest lexicographical value proposes itself to become leader. If it learns about another peer with a lower lexicographical value that wants to become leader, it gives up and accepts this other peer as leader.
Data about peers inside organisation and leader proposals is passed using in-org Leadership gossip messages.
Gossip is used as media to pass messages and know about all peers.</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [/COMMIT_MSG#L9](https://github.com/hyperledger-gerrit-archive/fabric/blob/6c1e50ebf8ac909f41df3bee75eb8265f0aad294//COMMIT_MSG#L9)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Gabor Hosszu - gabor@digitalasset.com<br><strong>CommentLine</strong>: [gossip/election/election.go#L39](https://github.com/hyperledger-gerrit-archive/fabric/blob/6c1e50ebf8ac909f41df3bee75eb8265f0aad294/gossip/election/election.go#L39)<br><strong>Comment</strong>: <pre>the</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election.go#L39](https://github.com/hyperledger-gerrit-archive/fabric/blob/6c1e50ebf8ac909f41df3bee75eb8265f0aad294/gossip/election/election.go#L39)<br><strong>Comment</strong>: <pre>Done</pre></blockquote><h3>PatchSet Number: 7</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Uploader</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Created</strong>: 1/4/2017, 6:52:00 AM<br><strong>UnmergedRevision</strong>: [294f70910a1a8deb60f0ac3df9069c7e1d49bcf1](https://github.com/hyperledger-gerrit-archive/fabric/commit/294f70910a1a8deb60f0ac3df9069c7e1d49bcf1)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/4/2017, 8:43:48 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Gabor Hosszu - gabor@digitalasset.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L81](https://github.com/hyperledger-gerrit-archive/fabric/blob/294f70910a1a8deb60f0ac3df9069c7e1d49bcf1/gossip/election/election_impl.go#L81)<br><strong>Comment</strong>: <pre>starting</pre></blockquote><h3>PatchSet Number: 8</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Uploader</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Created</strong>: 1/4/2017, 7:31:59 AM<br><strong>UnmergedRevision</strong>: [99924ada178adf7d7cd591d838e4452bf188db6b](https://github.com/hyperledger-gerrit-archive/fabric/commit/99924ada178adf7d7cd591d838e4452bf188db6b)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/4/2017, 8:44:39 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Gabor Hosszu - gabor@digitalasset.com<br><strong>Approved</strong>: 1/4/2017, 7:51:28 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 9</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Uploader</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Created</strong>: 1/4/2017, 9:38:34 AM<br><strong>UnmergedRevision</strong>: [712f1f2d466b896b2c4f49981200a7fa75e87330](https://github.com/hyperledger-gerrit-archive/fabric/commit/712f1f2d466b896b2c4f49981200a7fa75e87330)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/4/2017, 12:00:33 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 10</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Uploader</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Created</strong>: 1/5/2017, 6:56:12 AM<br><strong>UnmergedRevision</strong>: [d0547965bce0e5d6168105a2e83352d51dccd97e](https://github.com/hyperledger-gerrit-archive/fabric/commit/d0547965bce0e5d6168105a2e83352d51dccd97e)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/5/2017, 7:15:27 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 11</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Uploader</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Created</strong>: 1/5/2017, 9:29:30 AM<br><strong>UnmergedRevision</strong>: [d0084733f2429345152a1440bd48f97327c5ab01](https://github.com/hyperledger-gerrit-archive/fabric/commit/d0084733f2429345152a1440bd48f97327c5ab01)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/5/2017, 10:11:15 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L21](https://github.com/hyperledger-gerrit-archive/fabric/blob/d0084733f2429345152a1440bd48f97327c5ab01/gossip/election/election_impl.go#L21)<br><strong>Comment</strong>: <pre>Can you please document these and state what is the difference between them?</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L21](https://github.com/hyperledger-gerrit-archive/fabric/blob/d0084733f2429345152a1440bd48f97327c5ab01/gossip/election/election_impl.go#L21)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L53](https://github.com/hyperledger-gerrit-archive/fabric/blob/d0084733f2429345152a1440bd48f97327c5ab01/gossip/election/election_impl.go#L53)<br><strong>Comment</strong>: <pre>This shouldn't hard coded, logging level configured in core.yaml.</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L53](https://github.com/hyperledger-gerrit-archive/fabric/blob/d0084733f2429345152a1440bd48f97327c5ab01/gossip/election/election_impl.go#L53)<br><strong>Comment</strong>: <pre>Removed. Done.</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L97](https://github.com/hyperledger-gerrit-archive/fabric/blob/d0084733f2429345152a1440bd48f97327c5ab01/gossip/election/election_impl.go#L97)<br><strong>Comment</strong>: <pre>I think that it's much better to have indicator telling whenever somebody called stop function and shutdowns the module. Rather having this function with such heavy side effect. E.g.

   s.bootstrap()
   if !s.isDone {
     s.steadyState()
   }

Hence no need for bootstrap to return boolean flag which serves that purpose. I'd expect that s.bootsrap() returning false when something bad has happened. While stopping service if perfectly legal.</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L97](https://github.com/hyperledger-gerrit-archive/fabric/blob/d0084733f2429345152a1440bd48f97327c5ab01/gossip/election/election_impl.go#L97)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L98](https://github.com/hyperledger-gerrit-archive/fabric/blob/d0084733f2429345152a1440bd48f97327c5ab01/gossip/election/election_impl.go#L98)<br><strong>Comment</strong>: <pre>Why it returns a value while no one is using it?</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L98](https://github.com/hyperledger-gerrit-archive/fabric/blob/d0084733f2429345152a1440bd48f97327c5ab01/gossip/election/election_impl.go#L98)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L102](https://github.com/hyperledger-gerrit-archive/fabric/blob/d0084733f2429345152a1440bd48f97327c5ab01/gossip/election/election_impl.go#L102)<br><strong>Comment</strong>: <pre>See comment above.</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L102](https://github.com/hyperledger-gerrit-archive/fabric/blob/d0084733f2429345152a1440bd48f97327c5ab01/gossip/election/election_impl.go#L102)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L116](https://github.com/hyperledger-gerrit-archive/fabric/blob/d0084733f2429345152a1440bd48f97327c5ab01/gossip/election/election_impl.go#L116)<br><strong>Comment</strong>: <pre>The only function to affect and evident for leader election during the timeout is 

     s.handlerMsgDuringBootstrap(newLeadershipMsg.GetLeadershipMsg())

which has right after it

	if s.leaderFound() {
		s.logger.Debug("leader exist after processing msg")
		return true
	}

so I'm not sure why do you need additional check here? IMO it is redundant, am I missed something?</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L116](https://github.com/hyperledger-gerrit-archive/fabric/blob/d0084733f2429345152a1440bd48f97327c5ab01/gossip/election/election_impl.go#L116)<br><strong>Comment</strong>: <pre>I changed logic, so here we take care of leadership messages that arrived from peer who not in view at time of their arrival. Done.</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L121](https://github.com/hyperledger-gerrit-archive/fabric/blob/d0084733f2429345152a1440bd48f97327c5ab01/gossip/election/election_impl.go#L121)<br><strong>Comment</strong>: <pre>I guess my comments from above about function returning boolean to indicate service shutdown applies also here.</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L121](https://github.com/hyperledger-gerrit-archive/fabric/blob/d0084733f2429345152a1440bd48f97327c5ab01/gossip/election/election_impl.go#L121)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L135](https://github.com/hyperledger-gerrit-archive/fabric/blob/d0084733f2429345152a1440bd48f97327c5ab01/gossip/election/election_impl.go#L135)<br><strong>Comment</strong>: <pre>Didn't find anyone who reads the bool return value, did I miss it?</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L135](https://github.com/hyperledger-gerrit-archive/fabric/blob/d0084733f2429345152a1440bd48f97327c5ab01/gossip/election/election_impl.go#L135)<br><strong>Comment</strong>: <pre>Removed, done.</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L145](https://github.com/hyperledger-gerrit-archive/fabric/blob/d0084733f2429345152a1440bd48f97327c5ab01/gossip/election/election_impl.go#L145)<br><strong>Comment</strong>: <pre>Why do you call it msg timeout?</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L145](https://github.com/hyperledger-gerrit-archive/fabric/blob/d0084733f2429345152a1440bd48f97327c5ab01/gossip/election/election_impl.go#L145)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L150](https://github.com/hyperledger-gerrit-archive/fabric/blob/d0084733f2429345152a1440bd48f97327c5ab01/gossip/election/election_impl.go#L150)<br><strong>Comment</strong>: <pre>If you are the leader, why leaderExist flag is not 1?</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L150](https://github.com/hyperledger-gerrit-archive/fabric/blob/d0084733f2429345152a1440bd48f97327c5ab01/gossip/election/election_impl.go#L150)<br><strong>Comment</strong>: <pre>Just extra validation.</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L154](https://github.com/hyperledger-gerrit-archive/fabric/blob/d0084733f2429345152a1440bd48f97327c5ab01/gossip/election/election_impl.go#L154)<br><strong>Comment</strong>: <pre>I think this better to be rephrased with:

"Didn't received leadership message for %d time"</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L154](https://github.com/hyperledger-gerrit-archive/fabric/blob/d0084733f2429345152a1440bd48f97327c5ab01/gossip/election/election_impl.go#L154)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L157](https://github.com/hyperledger-gerrit-archive/fabric/blob/d0084733f2429345152a1440bd48f97327c5ab01/gossip/election/election_impl.go#L157)<br><strong>Comment</strong>: <pre>Based on line 150, why do you making second time assignment here?

Also you might be getting leadership messages from host which is not in peer current view, so the fact you have 

  s.leadershipMessages > 0

doesn't really mean you can use it as evidence.</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L157](https://github.com/hyperledger-gerrit-archive/fabric/blob/d0084733f2429345152a1440bd48f97327c5ab01/gossip/election/election_impl.go#L157)<br><strong>Comment</strong>: <pre>During steady state, only leadership messages from live peers enters list of messages, so if len > 0, it mean I got message from somebody alive and I know about leader and I am not leader...</pre></blockquote><h3>PatchSet Number: 12</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Uploader</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Created</strong>: 1/6/2017, 11:12:00 AM<br><strong>UnmergedRevision</strong>: [a494728327573420eba85a8195add1f03a4c0f24](https://github.com/hyperledger-gerrit-archive/fabric/commit/a494728327573420eba85a8195add1f03a4c0f24)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/6/2017, 11:50:11 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [/COMMIT_MSG#L18](https://github.com/hyperledger-gerrit-archive/fabric/blob/a494728327573420eba85a8195add1f03a4c0f24//COMMIT_MSG#L18)<br><strong>Comment</strong>: <pre>and in channel</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [/COMMIT_MSG#L18](https://github.com/hyperledger-gerrit-archive/fabric/blob/a494728327573420eba85a8195add1f03a4c0f24//COMMIT_MSG#L18)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L18](https://github.com/hyperledger-gerrit-archive/fabric/blob/a494728327573420eba85a8195add1f03a4c0f24/gossip/election/election_impl.go#L18)<br><strong>Comment</strong>: <pre>beat</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L18](https://github.com/hyperledger-gerrit-archive/fabric/blob/a494728327573420eba85a8195add1f03a4c0f24/gossip/election/election_impl.go#L18)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L19](https://github.com/hyperledger-gerrit-archive/fabric/blob/a494728327573420eba85a8195add1f03a4c0f24/gossip/election/election_impl.go#L19)<br><strong>Comment</strong>: <pre>beat</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L19](https://github.com/hyperledger-gerrit-archive/fabric/blob/a494728327573420eba85a8195add1f03a4c0f24/gossip/election/election_impl.go#L19)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L23](https://github.com/hyperledger-gerrit-archive/fabric/blob/a494728327573420eba85a8195add1f03a4c0f24/gossip/election/election_impl.go#L23)<br><strong>Comment</strong>: <pre>beat</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L23](https://github.com/hyperledger-gerrit-archive/fabric/blob/a494728327573420eba85a8195add1f03a4c0f24/gossip/election/election_impl.go#L23)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L29](https://github.com/hyperledger-gerrit-archive/fabric/blob/a494728327573420eba85a8195add1f03a4c0f24/gossip/election/election_impl.go#L29)<br><strong>Comment</strong>: <pre>It's more adopted to use an empty struct{}
https://dave.cheney.net/2014/03/25/the-empty-struct</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L29](https://github.com/hyperledger-gerrit-archive/fabric/blob/a494728327573420eba85a8195add1f03a4c0f24/gossip/election/election_impl.go#L29)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L161](https://github.com/hyperledger-gerrit-archive/fabric/blob/a494728327573420eba85a8195add1f03a4c0f24/gossip/election/election_impl.go#L161)<br><strong>Comment</strong>: <pre>beat</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L161](https://github.com/hyperledger-gerrit-archive/fabric/blob/a494728327573420eba85a8195add1f03a4c0f24/gossip/election/election_impl.go#L161)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L334](https://github.com/hyperledger-gerrit-archive/fabric/blob/a494728327573420eba85a8195add1f03a4c0f24/gossip/election/election_impl.go#L334)<br><strong>Comment</strong>: <pre>perhaps use Bytes.Equal?
https://golang.org/pkg/bytes/#Equal</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L334](https://github.com/hyperledger-gerrit-archive/fabric/blob/a494728327573420eba85a8195add1f03a4c0f24/gossip/election/election_impl.go#L334)<br><strong>Comment</strong>: <pre>Done</pre></blockquote><h3>PatchSet Number: 13</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Uploader</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Created</strong>: 1/7/2017, 3:37:32 PM<br><strong>UnmergedRevision</strong>: [48ab0dbdcf97e90b1420068b144144879e2e832c](https://github.com/hyperledger-gerrit-archive/fabric/commit/48ab0dbdcf97e90b1420068b144144879e2e832c)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/7/2017, 4:05:16 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L106](https://github.com/hyperledger-gerrit-archive/fabric/blob/48ab0dbdcf97e90b1420068b144144879e2e832c/gossip/election/election_impl.go#L106)<br><strong>Comment</strong>: <pre>stopped...</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L106](https://github.com/hyperledger-gerrit-archive/fabric/blob/48ab0dbdcf97e90b1420068b144144879e2e832c/gossip/election/election_impl.go#L106)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L124](https://github.com/hyperledger-gerrit-archive/fabric/blob/48ab0dbdcf97e90b1420068b144144879e2e832c/gossip/election/election_impl.go#L124)<br><strong>Comment</strong>: <pre>I think this is redundant, for-range should be enough.</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L124](https://github.com/hyperledger-gerrit-archive/fabric/blob/48ab0dbdcf97e90b1420068b144144879e2e832c/gossip/election/election_impl.go#L124)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L175](https://github.com/hyperledger-gerrit-archive/fabric/blob/48ab0dbdcf97e90b1420068b144144879e2e832c/gossip/election/election_impl.go#L175)<br><strong>Comment</strong>: <pre>You might be receiving leadership message transitively, from the node which in partition or already dead. Not, sure but it seems that additional check need to be added. What do you think?</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L175](https://github.com/hyperledger-gerrit-archive/fabric/blob/48ab0dbdcf97e90b1420068b144144879e2e832c/gossip/election/election_impl.go#L175)<br><strong>Comment</strong>: <pre>It is never ending circle..</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L184](https://github.com/hyperledger-gerrit-archive/fabric/blob/48ab0dbdcf97e90b1420068b144144879e2e832c/gossip/election/election_impl.go#L184)<br><strong>Comment</strong>: <pre>IMO, you do not need this check here, isStop changed in line 157, no one else could affect it.</pre><strong>Commenter</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L184](https://github.com/hyperledger-gerrit-archive/fabric/blob/48ab0dbdcf97e90b1420068b144144879e2e832c/gossip/election/election_impl.go#L184)<br><strong>Comment</strong>: <pre>I think you right</pre></blockquote><h3>PatchSet Number: 14</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Uploader</strong>: Gennady Laventman - gennady@il.ibm.com<br><strong>Created</strong>: 1/8/2017, 12:28:56 PM<br><strong>UnmergedRevision</strong>: [e1560ef50732dbfc93bbd0160ad399af5c1e1aff](https://github.com/hyperledger-gerrit-archive/fabric/commit/e1560ef50732dbfc93bbd0160ad399af5c1e1aff)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/8/2017, 1:11:09 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L171](https://github.com/hyperledger-gerrit-archive/fabric/blob/e1560ef50732dbfc93bbd0160ad399af5c1e1aff/gossip/election/election_impl.go#L171)<br><strong>Comment</strong>: <pre>I think this is simply redundant here.</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L184](https://github.com/hyperledger-gerrit-archive/fabric/blob/e1560ef50732dbfc93bbd0160ad399af5c1e1aff/gossip/election/election_impl.go#L184)<br><strong>Comment</strong>: <pre>Can you please explain why do you need this part in case peer is considered as leader, namely s.IsLeader() returns true.</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L187](https://github.com/hyperledger-gerrit-archive/fabric/blob/e1560ef50732dbfc93bbd0160ad399af5c1e1aff/gossip/election/election_impl.go#L187)<br><strong>Comment</strong>: <pre>(*) - Bookmark for latter comment.</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L203](https://github.com/hyperledger-gerrit-archive/fabric/blob/e1560ef50732dbfc93bbd0160ad399af5c1e1aff/gossip/election/election_impl.go#L203)<br><strong>Comment</strong>: <pre>(**) - Continue bookmark (*)

Can you please to extract (*) and (**) into separate methods?</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/election/election_impl.go#L207](https://github.com/hyperledger-gerrit-archive/fabric/blob/e1560ef50732dbfc93bbd0160ad399af5c1e1aff/gossip/election/election_impl.go#L207)<br><strong>Comment</strong>: <pre>I think that map of leadership messages support to be empty once you enter here, am I correct? If so, this could be a nice assertion and probably worth indicating in the logs with warning level that leader election start while having leadership messages. What do you think?</pre></blockquote>
<strong>Project</strong>: fabric<br><strong>Branch</strong>: master<br><strong>ID</strong>: 16549<br><strong>Subject</strong>: [FAB-7581] Enabling couchdb index creation<br><strong>Status</strong>: MERGED<br><strong>Owner</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Assignee</strong>:<br><strong>Created</strong>: 1/3/2018, 12:12:21 PM<br><strong>LastUpdated</strong>: 1/15/2018, 5:35:15 PM<br><strong>CommitMessage</strong>:<br><pre>[FAB-7581] Enabling couchdb index creation

This CR introduces
1) 'ChaincodeLifecycleEventListener' - this needs to be implemented
by couchdb implementation in order to get a chance to create indexes
upon chaincode install or deploy. This function will be invoked for a
chain + chaincode combination only if the latest chaincode event
(i.e., deploy on a chain or install on peer) makes the state such that
the chaincode is deployed on the chain and is installed on the peer.

2) Chaincode event management module - this exposes two functions that
are to be invoked from chaincode deploy and chaincode install path
respectively. Internally, it synchronizes the channel creation,
chaincode install, and chaincode deploy so that we do not miss events
for index creation

3) Functions for getting the status of a chaincode (deployed/installed).
Further, if installed - extract the statedb artifacts from the chaincode
package. These functions are used by the module listed in (2) above

4) statelistener functionality - This allows for registering an arbitrary
listener for state changes over a namesapce. This is used for listening
the changes over 'lscc' namespace that indicate the deployment of one or more
chaincodes in a block

5) Enabling couchdb index creation upon chaincode deploy using the all above

6) In a separate CR, one function (namely, 'HandleChaincodeInstall') needs
to be invoked from chaincode install code path so that index creation is
enabled during chaincode install as well

Change-Id: I928f6ffd10f7985cbef63a70f76da920a4ca4c56
Signed-off-by: manish <manish.sethi@gmail.com>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/3/2018, 12:12:21 PM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/3/2018, 12:17:25 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-s390x/1141/ (1/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/3/2018, 12:18:57 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/19968/ (2/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/3/2018, 12:19:03 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/446/ (5/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/3/2018, 12:19:03 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/11671/ (3/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/3/2018, 12:19:03 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/14055/ (4/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/3/2018, 1:35:40 PM<br><strong>Message</strong>: <pre>Patch Set 1: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/14055/ : FAILURE

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/14055/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-behave-x86_64/14055

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/446/ : FAILURE (skipped)

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/446/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/446

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/19968/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-x86_64/19968

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/11671/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-end-2-end-x86_64/11671

https://jenkins.hyperledger.org/job/fabric-verify-s390x/1141/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-s390x/1141</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/5/2018, 10:43:38 AM<br><strong>Message</strong>: <pre>Uploaded patch set 2.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/5/2018, 10:43:47 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-s390x/1173/ (1/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/5/2018, 10:48:42 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/11702/ (2/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/5/2018, 10:48:46 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/14091/ (3/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/5/2018, 10:48:47 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/19999/ (4/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/5/2018, 10:49:44 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/475/ (5/5)</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/5/2018, 10:55:09 AM<br><strong>Message</strong>: <pre>Patch Set 2: Code-Review-1

WIP</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/5/2018, 10:57:54 AM<br><strong>Message</strong>: <pre>Patch Set 2: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/11702/ : FAILURE

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/11702/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-end-2-end-x86_64/11702

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/14091/ : FAILURE

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/14091/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-behave-x86_64/14091

https://jenkins.hyperledger.org/job/fabric-verify-s390x/1173/ : FAILURE

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-s390x/1173/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-s390x/1173

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/19999/ : FAILURE

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-x86_64/19999/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-x86_64/19999

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/475/ : FAILURE (skipped)

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/475/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/475</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/5/2018, 4:55:57 PM<br><strong>Message</strong>: <pre>Uploaded patch set 3.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/5/2018, 4:56:07 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-s390x/1188/ (1/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/5/2018, 4:58:07 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/11715/ (2/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/5/2018, 4:58:12 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/14102/ (3/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/5/2018, 4:58:56 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20013/ (4/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/5/2018, 4:59:07 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/486/ (5/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/5/2018, 5:41:31 PM<br><strong>Message</strong>: <pre>Patch Set 3: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20013/ : FAILURE

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20013/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-x86_64/20013

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/486/ : FAILURE (skipped)

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/486/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/486

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/11715/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-end-2-end-x86_64/11715

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/14102/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-behave-x86_64/14102

https://jenkins.hyperledger.org/job/fabric-verify-s390x/1188/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-s390x/1188</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/7/2018, 10:36:12 PM<br><strong>Message</strong>: <pre>Uploaded patch set 4.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/7/2018, 10:36:23 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-s390x/1250/ (1/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/7/2018, 10:37:29 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/11776/ (2/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/7/2018, 10:38:02 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/14157/ (3/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/7/2018, 10:38:03 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20065/ (4/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/7/2018, 10:38:06 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/535/ (5/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/7/2018, 11:25:41 PM<br><strong>Message</strong>: <pre>Patch Set 4: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/535/ : FAILURE (skipped)

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/535/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/535

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/11776/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-end-2-end-x86_64/11776

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/14157/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-behave-x86_64/14157

https://jenkins.hyperledger.org/job/fabric-verify-s390x/1250/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-s390x/1250

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20065/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-x86_64/20065</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/8/2018, 3:37:44 PM<br><strong>Message</strong>: <pre>Uploaded patch set 5.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/8/2018, 3:37:54 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-s390x/1301/ (1/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/8/2018, 3:40:10 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/11826/ (2/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/8/2018, 3:40:25 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/14208/ (3/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/8/2018, 3:40:28 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20116/ (4/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/8/2018, 4:29:33 PM<br><strong>Message</strong>: <pre>Patch Set 5: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/11826/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-end-2-end-x86_64/11826

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/14208/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-behave-x86_64/14208

https://jenkins.hyperledger.org/job/fabric-verify-s390x/1301/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-s390x/1301

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20116/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-x86_64/20116

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/583/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/583</pre><strong>Reviewer</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>Reviewed</strong>: 1/9/2018, 8:42:33 AM<br><strong>Message</strong>: <pre>Patch Set 5:

(1 comment)

We could use Debug statements at the beginning of each function and at important decision points, to make the e2e scenario easier to troubleshoot.</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/9/2018, 10:56:40 AM<br><strong>Message</strong>: <pre>Patch Set 5:

(1 comment)</pre><strong>Reviewer</strong>: Senthilnathan N - cendhu@gmail.com<br><strong>Reviewed</strong>: 1/9/2018, 11:29:57 AM<br><strong>Message</strong>: <pre>Patch Set 5:

(3 comments)</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/9/2018, 12:30:32 PM<br><strong>Message</strong>: <pre>Uploaded patch set 6.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2018, 12:30:42 PM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-s390x/1342/ (1/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2018, 12:34:06 PM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/14251/ (3/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2018, 12:34:06 PM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/11864/ (2/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2018, 12:35:15 PM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20154/ (4/5)</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/9/2018, 12:36:11 PM<br><strong>Message</strong>: <pre>Patch Set 5:

(3 comments)</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/9/2018, 12:37:35 PM<br><strong>Message</strong>: <pre>Uploaded patch set 7.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2018, 12:37:42 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-s390x/1344/ (1/5)</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/9/2018, 12:38:19 PM<br><strong>Message</strong>: <pre>Patch Set 5:

(2 comments)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2018, 12:38:55 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/11866/ (2/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2018, 12:38:55 PM<br><strong>Message</strong>: <pre>Patch Set 6: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/11864/ : ABORTED

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/11864/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-end-2-end-x86_64/11864

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/14251/ : ABORTED

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/14251/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-behave-x86_64/14251

https://jenkins.hyperledger.org/job/fabric-verify-s390x/1342/ : ABORTED

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-s390x/1342/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-s390x/1342

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20154/ : ABORTED

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20154/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-x86_64/20154

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/620/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/620</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2018, 12:39:01 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20156/ (4/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2018, 12:39:01 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/14253/ (3/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2018, 1:12:30 PM<br><strong>Message</strong>: <pre>Patch Set 7: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/14253/ : FAILURE

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/14253/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-behave-x86_64/14253

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20156/ : FAILURE

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20156/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-x86_64/20156

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/11866/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-end-2-end-x86_64/11866

https://jenkins.hyperledger.org/job/fabric-verify-s390x/1344/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-s390x/1344

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/621/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/621</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/9/2018, 1:39:03 PM<br><strong>Message</strong>: <pre>Patch Set 7:

rebuild-x86</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/9/2018, 1:41:24 PM<br><strong>Message</strong>: <pre>Patch Set 7:

rebuild-x</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2018, 1:43:12 PM<br><strong>Message</strong>: <pre>Patch Set 7: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20158/</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/9/2018, 1:44:38 PM<br><strong>Message</strong>: <pre>Patch Set 7:

rebuild-behave</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2018, 1:44:49 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/14259/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2018, 2:13:34 PM<br><strong>Message</strong>: <pre>Patch Set 7: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20158/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-x86_64/20158

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/14259/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-behave-x86_64/14259</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/9/2018, 3:12:28 PM<br><strong>Message</strong>: <pre>Uploaded patch set 8: Commit message was updated.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2018, 3:12:36 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/14265/ (2/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2018, 3:12:36 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/11872/ (3/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2018, 3:12:37 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-s390x/1350/ (1/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2018, 3:13:43 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20162/ (4/5)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2018, 3:39:11 PM<br><strong>Message</strong>: <pre>Patch Set 8: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/14265/ : FAILURE

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/14265/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-behave-x86_64/14265

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20162/ : FAILURE

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20162/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-x86_64/20162

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/11872/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-end-2-end-x86_64/11872

https://jenkins.hyperledger.org/job/fabric-verify-s390x/1350/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-s390x/1350

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/626/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/626</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/9/2018, 3:59:47 PM<br><strong>Message</strong>: <pre>Patch Set 8:

rebuild-x</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/9/2018, 4:00:02 PM<br><strong>Message</strong>: <pre>Patch Set 8:

rebuild-behave</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/9/2018, 4:03:39 PM<br><strong>Message</strong>: <pre>Patch Set 8:

rebuild-x</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2018, 4:03:41 PM<br><strong>Message</strong>: <pre>Patch Set 8: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/14272/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2018, 4:03:41 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20167/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2018, 4:34:52 PM<br><strong>Message</strong>: <pre>Patch Set 8: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/14272/ : FAILURE

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/14272/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-behave-x86_64/14272

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20167/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-x86_64/20167</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/9/2018, 9:45:47 PM<br><strong>Message</strong>: <pre>Patch Set 8:

rebuild-behave</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2018, 9:47:46 PM<br><strong>Message</strong>: <pre>Patch Set 8: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/14281/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2018, 10:03:36 PM<br><strong>Message</strong>: <pre>Patch Set 8: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/14281/ : FAILURE

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/14281/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-behave-x86_64/14281</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/10/2018, 12:05:19 AM<br><strong>Message</strong>: <pre>Patch Set 8:

rebuild-behave</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/10/2018, 12:08:52 AM<br><strong>Message</strong>: <pre>Patch Set 8: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/14283/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/10/2018, 12:30:42 AM<br><strong>Message</strong>: <pre>Patch Set 8: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/14283/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-behave-x86_64/14283</pre><strong>Reviewer</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>Reviewed</strong>: 1/10/2018, 1:41:38 AM<br><strong>Message</strong>: <pre>Patch Set 8: Code-Review+2

Tested successfully in combination with https://gerrit.hyperledger.org/r/#/c/16183/ (statecouchdb index management) and https://gerrit.hyperledger.org/r/#/c/16697/ (add indexes to chaincode install package).</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 1/11/2018, 10:55:17 AM<br><strong>Message</strong>: <pre>Patch Set 8: Code-Review-1

-1 for now Manish... not because of this CR but because I did a -1 on https://gerrit.hyperledger.org/r/#/c/16697/ pending resolution to my comments there. These two CRs go together don't they ?</pre><strong>Reviewer</strong>: Christopher Ferris - chris.ferris@gmail.com<br><strong>Reviewed</strong>: 1/11/2018, 4:47:16 PM<br><strong>Message</strong>: <pre>Patch Set 8:

> Patch Set 8: Code-Review-1
> 
> -1 for now Manish... not because of this CR but because I did a -1 on https://gerrit.hyperledger.org/r/#/c/16697/ pending resolution to my comments there. These two CRs go together don't they ?

Murali, I fail to see why these need to be joined at the hip. If there are no objections, please +2. The other CR may be tangentially related, but not submitted together.</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 1/11/2018, 4:55:10 PM<br><strong>Message</strong>: <pre>Patch Set 8:

> > Patch Set 8: Code-Review-1
 > >
 > > -1 for now Manish... not because of this CR but because I did a
 > -1 on https://gerrit.hyperledger.org/r/#/c/16697/ pending
 > resolution to my comments there. These two CRs go together don't
 > they ?
 > 
 > Murali, I fail to see why these need to be joined at the hip. If
 > there are no objections, please +2. The other CR may be
 > tangentially related, but not submitted together.

Chris, I think Manish's CR refers to the index created by Dave's CR (in cc_statedb_artifacts_provider.go). Chatting with Dave on the later.</pre><strong>Reviewer</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>Reviewed</strong>: 1/12/2018, 1:02:36 PM<br><strong>Message</strong>: <pre>Removed Code-Review-1 by Srinivasan Muralidharan <srinivasan.muralidharan99@gmail.com>
</pre><strong>Reviewer</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>Reviewed</strong>: 1/12/2018, 1:02:51 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Note that Murali has removed -1 in https://gerrit.hyperledger.org/r/#/c/16697/ .</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/12/2018, 2:38:27 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Murali, since there is an agreement on the packaging structure, can you please remove -1 from this CR?</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 1/12/2018, 2:40:25 PM<br><strong>Message</strong>: <pre>Patch Set 8: Code-Review-1

(6 comments)</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/12/2018, 3:48:04 PM<br><strong>Message</strong>: <pre>Patch Set 8:

(5 comments)</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 1/12/2018, 4:44:30 PM<br><strong>Message</strong>: <pre>Patch Set 8:

(1 comment)</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/12/2018, 5:11:20 PM<br><strong>Message</strong>: <pre>Patch Set 8:

(1 comment)</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/12/2018, 5:35:33 PM<br><strong>Message</strong>: <pre>Patch Set 8:

(1 comment)</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/12/2018, 5:35:53 PM<br><strong>Message</strong>: <pre>Uploaded patch set 9.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/12/2018, 5:37:50 PM<br><strong>Message</strong>: <pre>Patch Set 9:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/11971/ (1/3)</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/12/2018, 5:38:15 PM<br><strong>Message</strong>: <pre>Patch Set 8:

(4 comments)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/12/2018, 5:40:17 PM<br><strong>Message</strong>: <pre>Patch Set 9:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20250/ (2/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/12/2018, 6:08:14 PM<br><strong>Message</strong>: <pre>Patch Set 9: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20250/ : FAILURE

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20250/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-x86_64/20250

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/11971/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-end-2-end-x86_64/11971

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/705/ : fabric-verify-build-checks-x86_64 finish successful - $TRIGGER_COMMENT

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/705</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/12/2018, 6:27:15 PM<br><strong>Message</strong>: <pre>Patch Set 9:

rebuild-x86</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/12/2018, 6:28:57 PM<br><strong>Message</strong>: <pre>Patch Set 9: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20251/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/12/2018, 6:54:36 PM<br><strong>Message</strong>: <pre>Patch Set 9: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20251/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-x86_64/20251</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 1/12/2018, 7:03:58 PM<br><strong>Message</strong>: <pre>Patch Set 9: Code-Review-1

(1 comment)</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/12/2018, 7:33:04 PM<br><strong>Message</strong>: <pre>Patch Set 8:

(1 comment)</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 1/12/2018, 7:52:40 PM<br><strong>Message</strong>: <pre>Patch Set 9:

(1 comment)

> Patch Set 8:
> 
> (1 comment)</pre><strong>Reviewer</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>Reviewed</strong>: 1/13/2018, 10:13:22 AM<br><strong>Message</strong>: <pre>Patch Set 9:

(1 comment)

Added a small comment about metadata directory.

Concerning the larger discussion of singletons and unit test vs integration test, that is a topic that spans all peer code and we need to make some decisions as a project and write down some guidelines. I don't think we'll resolve that here, therefore don't think we should hold up this CR for following some of the same precedents that exist throughout peer.

Manish, are you intending to make any smaller/tactical changes here? Or do you prefer to hold off on any refactoring until we have a chance to discuss more general guidelines and test approach?</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/13/2018, 3:59:38 PM<br><strong>Message</strong>: <pre>Patch Set 9:

> (1 comment)
 > 
 > Added a small comment about metadata directory.
 > 
 > Concerning the larger discussion of singletons and unit test vs
 > integration test, that is a topic that spans all peer code and we
 > need to make some decisions as a project and write down some
 > guidelines. I don't think we'll resolve that here, therefore don't
 > think we should hold up this CR for following some of the same
 > precedents that exist throughout peer.
 > 
 > Manish, are you intending to make any smaller/tactical changes
 > here? Or do you prefer to hold off on any refactoring until we have
 > a chance to discuss more general guidelines and test approach?

Dave - I also think that this discussion has much larger scope and should be discussed separately, specially when there is no project wide agreement. However, if removing the 'test_export.go' file breaks the logjam here, I am open to that refactoring in this CR. But if it about the singleton usage, I am not sure that we can change that in this CR. We have to synchronize across the code paths of 'chaincode install' and 'chaincode deploy' - they have to meet at some place.</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/14/2018, 12:34:37 AM<br><strong>Message</strong>: <pre>Uploaded patch set 10.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/14/2018, 12:36:22 AM<br><strong>Message</strong>: <pre>Patch Set 10:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/11986/ (1/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/14/2018, 12:36:33 AM<br><strong>Message</strong>: <pre>Patch Set 10:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20265/ (2/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/14/2018, 12:46:12 AM<br><strong>Message</strong>: <pre>Patch Set 10: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20265/ : FAILURE

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20265/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-x86_64/20265

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/718/ : FAILURE (skipped)

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/718/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/718

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/11986/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-end-2-end-x86_64/11986</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/14/2018, 12:56:33 AM<br><strong>Message</strong>: <pre>Uploaded patch set 11.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/14/2018, 12:58:13 AM<br><strong>Message</strong>: <pre>Patch Set 11:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/11987/ (1/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/14/2018, 12:58:53 AM<br><strong>Message</strong>: <pre>Patch Set 11:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20266/ (2/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/14/2018, 1:25:19 AM<br><strong>Message</strong>: <pre>Patch Set 11: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/719/ : FAILURE (skipped)

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/719/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/719

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/11987/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-end-2-end-x86_64/11987

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20266/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-x86_64/20266</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/14/2018, 1:59:42 AM<br><strong>Message</strong>: <pre>Patch Set 11:

In the latest patch 
 - Removed the test_export file 
 - Removed the statelistenermgmt package to remove the singleton concerns about this - Instead changed the LedgerProvider interface to take the StateListeners in it's initialization
 - cceventmgmt package is largely the same and is still singleton as it needs to be.

Dave - you would have to work in your CR for mocking the stuff for the unit test that depends on earlier exposed cceventmgmt test_export</pre><strong>Reviewer</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>Reviewed</strong>: 1/14/2018, 4:38:14 PM<br><strong>Message</strong>: <pre>Patch Set 11: Code-Review+2

Thanks for making the updates Manish.  I think we can address the larger discussion as part of an overall test strategy post-alpha.

I'm good with this CR for alpha, and have tested end-to-end using both couchdb (where there is a listener that deploys the indexes) and leveldb (where there is no listener and indexes are ignored).</pre><strong>Reviewer</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>Reviewed</strong>: 1/15/2018, 2:32:17 AM<br><strong>Message</strong>: <pre>Patch Set 11: Code-Review-1

(1 comment)

Jason Yellick, will you be so kind as to take another pass at this?</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/15/2018, 11:44:19 AM<br><strong>Message</strong>: <pre>Uploaded patch set 12.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/15/2018, 11:46:00 AM<br><strong>Message</strong>: <pre>Patch Set 12:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/11999/ (1/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/15/2018, 11:46:36 AM<br><strong>Message</strong>: <pre>Patch Set 12:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20280/ (2/3)</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/15/2018, 11:46:52 AM<br><strong>Message</strong>: <pre>Patch Set 11:

(1 comment)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/15/2018, 11:58:51 AM<br><strong>Message</strong>: <pre>Patch Set 12: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20280/ : FAILURE

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20280/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-x86_64/20280

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/731/ : FAILURE (skipped)

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/731/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/731

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/11999/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-end-2-end-x86_64/11999</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/15/2018, 12:02:56 PM<br><strong>Message</strong>: <pre>Patch Set 12:

rebuild-x86</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/15/2018, 12:05:07 PM<br><strong>Message</strong>: <pre>Patch Set 12: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20281/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/15/2018, 12:29:50 PM<br><strong>Message</strong>: <pre>Patch Set 12: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20281/ : FAILURE

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20281/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-x86_64/20281</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/15/2018, 12:33:45 PM<br><strong>Message</strong>: <pre>Patch Set 12:

rebuild-x86</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/15/2018, 12:36:35 PM<br><strong>Message</strong>: <pre>Patch Set 12: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20282/</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 1/15/2018, 12:59:57 PM<br><strong>Message</strong>: <pre>Patch Set 12:

(4 comments)

Although I</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/15/2018, 1:01:07 PM<br><strong>Message</strong>: <pre>Patch Set 12: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20282/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-x86_64/20282</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/15/2018, 2:05:51 PM<br><strong>Message</strong>: <pre>Uploaded patch set 13.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/15/2018, 2:06:50 PM<br><strong>Message</strong>: <pre>Patch Set 13:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/12002/ (1/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/15/2018, 2:07:32 PM<br><strong>Message</strong>: <pre>Patch Set 13:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20285/ (2/3)</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/15/2018, 2:07:58 PM<br><strong>Message</strong>: <pre>Patch Set 11:

(3 comments)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/15/2018, 2:17:54 PM<br><strong>Message</strong>: <pre>Patch Set 13: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20285/ : FAILURE

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20285/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-x86_64/20285

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/733/ : FAILURE (skipped)

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/733/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/733

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/12002/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-end-2-end-x86_64/12002</pre><strong>Reviewer</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>Reviewed</strong>: 1/15/2018, 2:38:47 PM<br><strong>Message</strong>: <pre>Patch Set 13:

rebuild-x</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/15/2018, 2:42:15 PM<br><strong>Message</strong>: <pre>Patch Set 13: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20288/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/15/2018, 2:52:04 PM<br><strong>Message</strong>: <pre>Patch Set 13: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20288/ : FAILURE

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20288/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-x86_64/20288</pre><strong>Reviewer</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Reviewed</strong>: 1/15/2018, 4:00:39 PM<br><strong>Message</strong>: <pre>Uploaded patch set 14.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/15/2018, 4:01:41 PM<br><strong>Message</strong>: <pre>Patch Set 14:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/12004/ (1/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/15/2018, 4:02:12 PM<br><strong>Message</strong>: <pre>Patch Set 14:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20289/ (2/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/15/2018, 4:25:13 PM<br><strong>Message</strong>: <pre>Patch Set 14: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/735/ : FAILURE (skipped)

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/735/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/735

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/12004/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-end-2-end-x86_64/12004

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/20289/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-x86_64/20289</pre><strong>Reviewer</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>Reviewed</strong>: 1/15/2018, 4:26:51 PM<br><strong>Message</strong>: <pre>Patch Set 14: Code-Review+2</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 1/15/2018, 4:35:00 PM<br><strong>Message</strong>: <pre>Patch Set 8:

(1 comment)</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 1/15/2018, 5:07:29 PM<br><strong>Message</strong>: <pre>Patch Set 14: Code-Review+2

(1 comment)

Still not the happiest about this new singleton, but I understand the reasoning.</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 1/15/2018, 5:08:38 PM<br><strong>Message</strong>: <pre>Change has been successfully merged by Jason Yellick</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 1/15/2018, 5:30:15 PM<br><strong>Message</strong>: <pre>Patch Set 8:

(1 comment)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/15/2018, 5:35:15 PM<br><strong>Message</strong>: <pre>Patch Set 14:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-merge-end-2-end-x86_64/1738/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-merge-end-2-end-x86_64/1738

https://jenkins.hyperledger.org/job/fabric-merge-x86_64/3063/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-merge-x86_64/3063</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Uploader</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Created</strong>: 1/3/2018, 12:12:21 PM<br><strong>UnmergedRevision</strong>: [c1ce5fb3229125192adb292c132d3ac00edd48ea](https://github.com/hyperledger-gerrit-archive/fabric/commit/c1ce5fb3229125192adb292c132d3ac00edd48ea)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/3/2018, 1:35:40 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Uploader</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Created</strong>: 1/5/2018, 10:43:38 AM<br><strong>UnmergedRevision</strong>: [29b45fc2052e283658a2223bea58d66a24a5a20b](https://github.com/hyperledger-gerrit-archive/fabric/commit/29b45fc2052e283658a2223bea58d66a24a5a20b)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/5/2018, 10:57:54 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Approved</strong>: 1/5/2018, 10:55:09 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 3</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Uploader</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Created</strong>: 1/5/2018, 4:55:57 PM<br><strong>UnmergedRevision</strong>: [fd8f4c92d068ad34bec2bbe6102b1b8e4eef309a](https://github.com/hyperledger-gerrit-archive/fabric/commit/fd8f4c92d068ad34bec2bbe6102b1b8e4eef309a)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/5/2018, 5:41:31 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 4</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Uploader</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Created</strong>: 1/7/2018, 10:36:12 PM<br><strong>UnmergedRevision</strong>: [c6a7d63ba4f003a982f671f3734851c5d0c3a9bc](https://github.com/hyperledger-gerrit-archive/fabric/commit/c6a7d63ba4f003a982f671f3734851c5d0c3a9bc)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/7/2018, 11:25:41 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 5</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Uploader</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Created</strong>: 1/8/2018, 3:37:44 PM<br><strong>UnmergedRevision</strong>: [be4de07906f38043fe7e6a316e0f79b2848a05d4](https://github.com/hyperledger-gerrit-archive/fabric/commit/be4de07906f38043fe7e6a316e0f79b2848a05d4)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/8/2018, 4:29:33 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Senthilnathan N - cendhu@gmail.com<br><strong>CommentLine</strong>: [core/ledger/cceventmgmt/lsccstate_listener.go#L38](https://github.com/hyperledger-gerrit-archive/fabric/blob/be4de07906f38043fe7e6a316e0f79b2848a05d4/core/ledger/cceventmgmt/lsccstate_listener.go#L38)<br><strong>Comment</strong>: <pre>Even if it is an update of existing chaincode, we are calling it as deploy right?</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/cceventmgmt/lsccstate_listener.go#L38](https://github.com/hyperledger-gerrit-archive/fabric/blob/be4de07906f38043fe7e6a316e0f79b2848a05d4/core/ledger/cceventmgmt/lsccstate_listener.go#L38)<br><strong>Comment</strong>: <pre>yes</pre><strong>Commenter</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/kv_ledger_provider.go#L153](https://github.com/hyperledger-gerrit-archive/fabric/blob/be4de07906f38043fe7e6a316e0f79b2848a05d4/core/ledger/kvledger/kv_ledger_provider.go#L153)<br><strong>Comment</strong>: <pre>In my trial along with statecouchdb CR 16183, this is evaluating to false and therefore statecouchdb is not getting registered as a listener.  Not sure why the type assertion is not working as expected...

The rest of the pieces seem to work as expected, but the failure to register the listener here is blocking the e2e scenario currently.</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/kv_ledger_provider.go#L153](https://github.com/hyperledger-gerrit-archive/fabric/blob/be4de07906f38043fe7e6a316e0f79b2848a05d4/core/ledger/kvledger/kv_ledger_provider.go#L153)<br><strong>Comment</strong>: <pre>I got the reason for this coming as false. This is because there is another layer I had added on top of stateDB for pvt data stuff. Will fix this and add debug logs in next patch.</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/kv_ledger_provider.go#L153](https://github.com/hyperledger-gerrit-archive/fabric/blob/be4de07906f38043fe7e6a316e0f79b2848a05d4/core/ledger/kvledger/kv_ledger_provider.go#L153)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Senthilnathan N - cendhu@gmail.com<br><strong>CommentLine</strong>: [core/ledger/statelistenermgmt/interface.go#L15](https://github.com/hyperledger-gerrit-archive/fabric/blob/be4de07906f38043fe7e6a316e0f79b2848a05d4/core/ledger/statelistenermgmt/interface.go#L15)<br><strong>Comment</strong>: <pre>HandleStateUpdates seems to be the correct name.</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/statelistenermgmt/interface.go#L15](https://github.com/hyperledger-gerrit-archive/fabric/blob/be4de07906f38043fe7e6a316e0f79b2848a05d4/core/ledger/statelistenermgmt/interface.go#L15)<br><strong>Comment</strong>: <pre>yes, good catch. Will fix this</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/statelistenermgmt/interface.go#L15](https://github.com/hyperledger-gerrit-archive/fabric/blob/be4de07906f38043fe7e6a316e0f79b2848a05d4/core/ledger/statelistenermgmt/interface.go#L15)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Senthilnathan N - cendhu@gmail.com<br><strong>CommentLine</strong>: [core/ledger/statelistenermgmt/listeners_mgmt.go#L15](https://github.com/hyperledger-gerrit-archive/fabric/blob/be4de07906f38043fe7e6a316e0f79b2848a05d4/core/ledger/statelistenermgmt/listeners_mgmt.go#L15)<br><strong>Comment</strong>: <pre>As we are interested in changes made only in lscc (on all channels), we aren't adding channel-id to the listener right?</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/statelistenermgmt/listeners_mgmt.go#L15](https://github.com/hyperledger-gerrit-archive/fabric/blob/be4de07906f38043fe7e6a316e0f79b2848a05d4/core/ledger/statelistenermgmt/listeners_mgmt.go#L15)<br><strong>Comment</strong>: <pre>State Listener is generic enough, not specific to lscc. The channel name is passed (along with the state changes) when the StateListener is invoked - if we were to decide something based on channel id.</pre></blockquote><h3>PatchSet Number: 6</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Uploader</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Created</strong>: 1/9/2018, 12:30:32 PM<br><strong>UnmergedRevision</strong>: [f1525e0e450961efb276975f18ab1f8bbf131e9f](https://github.com/hyperledger-gerrit-archive/fabric/commit/f1525e0e450961efb276975f18ab1f8bbf131e9f)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/9/2018, 12:38:55 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 7</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Uploader</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Created</strong>: 1/9/2018, 12:37:35 PM<br><strong>UnmergedRevision</strong>: [e4c49c30794c2a602f9f3427a57e0196cd156ce6](https://github.com/hyperledger-gerrit-archive/fabric/commit/e4c49c30794c2a602f9f3427a57e0196cd156ce6)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/9/2018, 2:13:34 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 8</h3><blockquote><strong>Type</strong>: NO_CODE_CHANGE<br><strong>Author</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Uploader</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Created</strong>: 1/9/2018, 3:12:28 PM<br><strong>UnmergedRevision</strong>: [62d39944a1d0ded0b0f5696b52c98eddd0f6ecc0](https://github.com/hyperledger-gerrit-archive/fabric/commit/62d39944a1d0ded0b0f5696b52c98eddd0f6ecc0)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/10/2018, 12:30:42 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Approved</strong>: 1/12/2018, 2:40:25 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>Approved</strong>: 1/10/2018, 1:41:38 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/cceventmgmt/lsccstate_listener.go#L24](https://github.com/hyperledger-gerrit-archive/fabric/blob/62d39944a1d0ded0b0f5696b52c98eddd0f6ecc0/core/ledger/cceventmgmt/lsccstate_listener.go#L24)<br><strong>Comment</strong>: <pre>artifacts</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/cceventmgmt/lsccstate_listener.go#L24](https://github.com/hyperledger-gerrit-archive/fabric/blob/62d39944a1d0ded0b0f5696b52c98eddd0f6ecc0/core/ledger/cceventmgmt/lsccstate_listener.go#L24)<br><strong>Comment</strong>: <pre>will fix</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/cceventmgmt/lsccstate_listener.go#L24](https://github.com/hyperledger-gerrit-archive/fabric/blob/62d39944a1d0ded0b0f5696b52c98eddd0f6ecc0/core/ledger/cceventmgmt/lsccstate_listener.go#L24)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/cceventmgmt/mgr.go#L40](https://github.com/hyperledger-gerrit-archive/fabric/blob/62d39944a1d0ded0b0f5696b52c98eddd0f6ecc0/core/ledger/cceventmgmt/mgr.go#L40)<br><strong>Comment</strong>: <pre>Why do we continually invent and reinvent the "singleton map of channel id to resource"?

Why is this not simply another resource attached to an existing singleton? (Or better yet, not a singleton)

I'm concerned that we have developed this anti-pattern in the peer codebase, and rather than eliminating it, we seem to be extending it.</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/cceventmgmt/mgr.go#L40](https://github.com/hyperledger-gerrit-archive/fabric/blob/62d39944a1d0ded0b0f5696b52c98eddd0f6ecc0/core/ledger/cceventmgmt/mgr.go#L40)<br><strong>Comment</strong>: <pre>These seems a profound statement to me which may not be true in all the contexts. If the resources are being shared across modules (e.g. the resource bundle you manage is used by others to check policies etc. and similarly, ledger is kept there for being used by chaincode), the shared use make sense.

The code here would be better well hidden in the ledger module. The ids in the map here can be well seen and ledger ids. For instance, if you look at the last field, this may not make sense at all in the peer code and is very contextual to this situation. Also, there are some complexities that would require additional work in the peer code (instead of simply registering something against channel)... for instance, some of the code here is actually used even before ledger has been opened for use (during ledger recovery) while the 'map' in the peer file is  is prepared with the ledger encapsulated in the 'chain'.</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/cceventmgmt/mgr.go#L65](https://github.com/hyperledger-gerrit-archive/fabric/blob/62d39944a1d0ded0b0f5696b52c98eddd0f6ecc0/core/ledger/cceventmgmt/mgr.go#L65)<br><strong>Comment</strong>: <pre>stored</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/cceventmgmt/mgr.go#L65](https://github.com/hyperledger-gerrit-archive/fabric/blob/62d39944a1d0ded0b0f5696b52c98eddd0f6ecc0/core/ledger/cceventmgmt/mgr.go#L65)<br><strong>Comment</strong>: <pre>will fix</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/cceventmgmt/mgr.go#L65](https://github.com/hyperledger-gerrit-archive/fabric/blob/62d39944a1d0ded0b0f5696b52c98eddd0f6ecc0/core/ledger/cceventmgmt/mgr.go#L65)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/cceventmgmt/testexports.go#L12](https://github.com/hyperledger-gerrit-archive/fabric/blob/62d39944a1d0ded0b0f5696b52c98eddd0f6ecc0/core/ledger/cceventmgmt/testexports.go#L12)<br><strong>Comment</strong>: <pre>I realize this is not a new pattern, but we should not have any test related code in a production package.  Especially not test related code which is exported.</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/cceventmgmt/testexports.go#L12](https://github.com/hyperledger-gerrit-archive/fabric/blob/62d39944a1d0ded0b0f5696b52c98eddd0f6ecc0/core/ledger/cceventmgmt/testexports.go#L12)<br><strong>Comment</strong>: <pre>A larger discussion on other similar comment</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/db_test.go#L247](https://github.com/hyperledger-gerrit-archive/fabric/blob/62d39944a1d0ded0b0f5696b52c98eddd0f6ecc0/core/ledger/kvledger/txmgmt/privacyenabledstate/db_test.go#L247)<br><strong>Comment</strong>: <pre>Why not stack this CR on top?</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/db_test.go#L247](https://github.com/hyperledger-gerrit-archive/fabric/blob/62d39944a1d0ded0b0f5696b52c98eddd0f6ecc0/core/ledger/kvledger/txmgmt/privacyenabledstate/db_test.go#L247)<br><strong>Comment</strong>: <pre>Will remove from here and submit later</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/kvledger/txmgmt/privacyenabledstate/db_test.go#L247](https://github.com/hyperledger-gerrit-archive/fabric/blob/62d39944a1d0ded0b0f5696b52c98eddd0f6ecc0/core/ledger/kvledger/txmgmt/privacyenabledstate/db_test.go#L247)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/statelistenermgmt/test_export.go#L12](https://github.com/hyperledger-gerrit-archive/fabric/blob/62d39944a1d0ded0b0f5696b52c98eddd0f6ecc0/core/ledger/statelistenermgmt/test_export.go#L12)<br><strong>Comment</strong>: <pre>Again, I question why we are including test hooks into our production binary?</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/statelistenermgmt/test_export.go#L12](https://github.com/hyperledger-gerrit-archive/fabric/blob/62d39944a1d0ded0b0f5696b52c98eddd0f6ecc0/core/ledger/statelistenermgmt/test_export.go#L12)<br><strong>Comment</strong>: <pre>so, what is the best strategy? move this to a subfolder named test? Does it have to be test or should just start with test (say testutil?)</pre><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [core/ledger/statelistenermgmt/test_export.go#L12](https://github.com/hyperledger-gerrit-archive/fabric/blob/62d39944a1d0ded0b0f5696b52c98eddd0f6ecc0/core/ledger/statelistenermgmt/test_export.go#L12)<br><strong>Comment</strong>: <pre>This is a perfect example of why the singleton pattern is terrible in general.  The only reason you need to export this is because you can't call the public Initialize method more than once when testing a package.

On the positive side, it looks like you only call this function once here https://gerrit.hyperledger.org/r/#/c/16549/8/core/ledger/kvledger/state_listener_test.go@30 

So why not just call statelistenermgmt.Initialize(statelistenermgmt.StateListeners{namespace: mockListener}) instead?</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/statelistenermgmt/test_export.go#L12](https://github.com/hyperledger-gerrit-archive/fabric/blob/62d39944a1d0ded0b0f5696b52c98eddd0f6ecc0/core/ledger/statelistenermgmt/test_export.go#L12)<br><strong>Comment</strong>: <pre>I am not sure if I understand the comment about singleton pattern in general but Yes Gari, you are right that the function is exposed so I can call in multiple tests. May be for now I can remove the 'Once' constraint which may not be as such a bad choice.

The other option is always mocking stuff and not using cross package code which is not always a better choice. These leaves all the even basic testing to the last stage of end-to-end test which does not cover much scenarios.

I think that we need to devise a middle strategy for writing tests across modules which have been very helpful in my experience.</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/statelistenermgmt/test_export.go#L12](https://github.com/hyperledger-gerrit-archive/fabric/blob/62d39944a1d0ded0b0f5696b52c98eddd0f6ecc0/core/ledger/statelistenermgmt/test_export.go#L12)<br><strong>Comment</strong>: <pre>Jason and Gari, thinking more about this - I am not convinced that there is any problem having these kind of basic initialization code in the package.

Because, first they would not be picked in the production binary as they are always referred from _test files ultimately and secondly at times they are just more than setting something - for instance, in the ledgermgmt package, similar functions do some more cleanup such as deletion of folders for leveldb (which we cannot expose as a regular function in ledger).

Also, as Jason pointed out this style is not unique to this CR,I would like to take this up as a bigger discussion then holding this CR for Alpha for this.</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/statelistenermgmt/test_export.go#L12](https://github.com/hyperledger-gerrit-archive/fabric/blob/62d39944a1d0ded0b0f5696b52c98eddd0f6ecc0/core/ledger/statelistenermgmt/test_export.go#L12)<br><strong>Comment</strong>: <pre>> I think that we need to devise a middle strategy for writing tests across modules which have been very helpful in my experience.

I just can't agree with this.  Unit tests are (by their very definition) for testing individual units of code.  The notion that I need to go manipulate some other package's namespace in order to test my unit of code is antithetical to the premise of unit testing.

If we want to write integration tests using the go test framework, that's fine, but we should place these say, in an integration tests folder.  One of the reasons we have such a fragile and tangled web of testing code in many packages is because we have simultaneously tried to hit high percentages of code coverage while not having a way to do non-integration tests.

I realize this is not a new pattern, but it is a new instance of it, and because of that, I will not -2, but I cannot in good conscience +2.</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/statelistenermgmt/test_export.go#L12](https://github.com/hyperledger-gerrit-archive/fabric/blob/62d39944a1d0ded0b0f5696b52c98eddd0f6ecc0/core/ledger/statelistenermgmt/test_export.go#L12)<br><strong>Comment</strong>: <pre>I am not helm bend hard on terminology. Even if you call it integration test and have it in separate folder, you would have to have these export functions. I completely look at it from a different perspective than code coverage. In mocking, certainly you limit your ability of testing and sometime you end up implementing whole lot in mocking which could be out of synch with the changes to the underlying module you actually depend on.

Just look at this CR which someone submitted for mocking out couch query at the chaincode layer (https://gerrit.hyperledger.org/r/#/c/16325/). I am not able to justify it in any manner. Who takes care of this being in sync with ledger query processing.

I think that your concern of code getting into production binary was genuine but that won;t happen.

Since, we do not have any hard guidelines for style of go testing, I find this concern very subjective.</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/statelistenermgmt/test_export.go#L12](https://github.com/hyperledger-gerrit-archive/fabric/blob/62d39944a1d0ded0b0f5696b52c98eddd0f6ecc0/core/ledger/statelistenermgmt/test_export.go#L12)<br><strong>Comment</strong>: <pre>I suspect we may be at a simple impasse where we must agree to disagree.

However, I would point out, if you take a look at the orderer package, we have integration tests where we spin up multiple copies of the orderer, along with client drivers, all within the same process, and all within the go unit test framework.  No where, do we need special 'TestSetup*' functions.  We simply pass in mock gRPC structures to the bootstrapping code (otherwise we would run into port binding conflicts), and away it goes.

There are some problems which we have to dodge, because of similar singleton structures in the  msp code, but you'll find exactly zero singletons in the entire orderer tree.  I know that the gossip code connects to the rest of the peer code through singletons (because there is no other option), but I do not believe there are any singletons in the actual codebase itself.

Golang singletons are not universally a bad idea, but I think they usually are, and certainly, and IMO, the peer codebase is much worse off for their presence.

But, back to the point at hand, I will not block this CR, but I cannot support it.  If another maintainer wishes to +2, I welcome them to.</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [core/ledger/statelistenermgmt/test_export.go#L12](https://github.com/hyperledger-gerrit-archive/fabric/blob/62d39944a1d0ded0b0f5696b52c98eddd0f6ecc0/core/ledger/statelistenermgmt/test_export.go#L12)<br><strong>Comment</strong>: <pre>> I know that the gossip code connects to the rest of the peer code through singletons (because there is no other option), but I do not believe there are any singletons in the actual codebase itself.

Wait, what? :) 
That's not true... gossip only depends on a committer instance and a MessageCryptoService (MSP-derived interface) and both are interfaces that are passed to the gossip constructor.

The reality is the opposite - the peer references gossip via a singleton, because gossip is initialized in peer/node/start.go but it joins channels via the core/peer/peer.go via the singleton method that returns gossip, but that has nothing to do with gossip and everything to do with how the peer is built.</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/statelistenermgmt/test_export.go#L12](https://github.com/hyperledger-gerrit-archive/fabric/blob/62d39944a1d0ded0b0f5696b52c98eddd0f6ecc0/core/ledger/statelistenermgmt/test_export.go#L12)<br><strong>Comment</strong>: <pre>> Wait, what? :) 
> That's not true... gossip only depends on a committer instance and a MessageCryptoService (MSP-derived interface) and both are interfaces that are passed to the gossip constructor.

Sorry if I have spoken incorrectly about the gossip code, I was trying to convey that singletons are not a design pattern utilized by the gossip component.</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [core/ledger/statelistenermgmt/test_export.go#L12](https://github.com/hyperledger-gerrit-archive/fabric/blob/62d39944a1d0ded0b0f5696b52c98eddd0f6ecc0/core/ledger/statelistenermgmt/test_export.go#L12)<br><strong>Comment</strong>: <pre>Oh, I misunderstood what you meant :)</pre></blockquote><h3>PatchSet Number: 9</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Uploader</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Created</strong>: 1/12/2018, 5:35:53 PM<br><strong>UnmergedRevision</strong>: [a40180c93593921d93c83519192f491abd060733](https://github.com/hyperledger-gerrit-archive/fabric/commit/a40180c93593921d93c83519192f491abd060733)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/12/2018, 6:54:36 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Approved</strong>: 1/12/2018, 7:03:58 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>CommentLine</strong>: [core/common/ccprovider/cc_statedb_artifacts_provider.go#L54](https://github.com/hyperledger-gerrit-archive/fabric/blob/a40180c93593921d93c83519192f491abd060733/core/common/ccprovider/cc_statedb_artifacts_provider.go#L54)<br><strong>Comment</strong>: <pre>The top level metadata directory has changed to META-INF, and will need to change here accordingly.
See https://gerrit.hyperledger.org/r/#/c/16697/ for more details.</pre></blockquote><h3>PatchSet Number: 10</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Uploader</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Created</strong>: 1/14/2018, 12:34:37 AM<br><strong>UnmergedRevision</strong>: [637e117a9c91c87db1b54c39f266bd78dcf91e90](https://github.com/hyperledger-gerrit-archive/fabric/commit/637e117a9c91c87db1b54c39f266bd78dcf91e90)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/14/2018, 12:46:12 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 11</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Uploader</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Created</strong>: 1/14/2018, 12:56:33 AM<br><strong>UnmergedRevision</strong>: [37fe4488d22da10baaa783ddca133c198cc9b991](https://github.com/hyperledger-gerrit-archive/fabric/commit/37fe4488d22da10baaa783ddca133c198cc9b991)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/14/2018, 1:25:19 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>Approved</strong>: 1/15/2018, 2:32:17 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>Approved</strong>: 1/14/2018, 4:38:14 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Jonathan Levi (HACERA) - jonathan@hacera.com<br><strong>CommentLine</strong>: [core/ledger/cceventmgmt/mgr.go#L36](https://github.com/hyperledger-gerrit-archive/fabric/blob/37fe4488d22da10baaa783ddca133c198cc9b991/core/ledger/cceventmgmt/mgr.go#L36)<br><strong>Comment</strong>: <pre>I'm (also) not a fan of such a top level lock at the Mgr level.

However, I understand Manish's comments regarding the scope, timing, and the lack project-level formal agreement/policy.

Jason, can you please "chime in"? Can we "live" with this? Shall we spend half a day or so on changing/testing before the "cut" ?</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/cceventmgmt/mgr.go#L36](https://github.com/hyperledger-gerrit-archive/fabric/blob/37fe4488d22da10baaa783ddca133c198cc9b991/core/ledger/cceventmgmt/mgr.go#L36)<br><strong>Comment</strong>: <pre>Jason and I discussed further on this and agree that we need to define certain project-level strategy for these kind of tasks. I have added more comments in the code here in the next patch.</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/cceventmgmt/mgr.go#L36](https://github.com/hyperledger-gerrit-archive/fabric/blob/37fe4488d22da10baaa783ddca133c198cc9b991/core/ledger/cceventmgmt/mgr.go#L36)<br><strong>Comment</strong>: <pre>Although I'd rather not see this pattern implemented again, because of the current state of the codebase, in particular, that the peer channel map may not be initialized when the maps here are referenced, I understand the difficulty in implementing it some other way.

I think we need to make it a priority to eliminate all of the singletons in the codebase.  We should be able to, as a bare minimum software engineering exercise, start multiple copies of the peer within the same process.  There are currently a lot of barriers to this, and this CR adds a new one, but it should be done.

So, in summary, although I feel that this code is going to have to be rewritten in the near future, in the interest of getting v1.1 out the door, I'm willing to set aside my concerns.</pre></blockquote><h3>PatchSet Number: 12</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Uploader</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Created</strong>: 1/15/2018, 11:44:19 AM<br><strong>UnmergedRevision</strong>: [9d914c4246a2d7f23533280da6ab63612b7c75fb](https://github.com/hyperledger-gerrit-archive/fabric/commit/9d914c4246a2d7f23533280da6ab63612b7c75fb)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/15/2018, 1:01:07 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [core/common/ccprovider/cc_statedb_artifacts_provider.go#L54](https://github.com/hyperledger-gerrit-archive/fabric/blob/9d914c4246a2d7f23533280da6ab63612b7c75fb/core/common/ccprovider/cc_statedb_artifacts_provider.go#L54)<br><strong>Comment</strong>: <pre>Shouldn't this be a constant?</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/common/ccprovider/cc_statedb_artifacts_provider.go#L54](https://github.com/hyperledger-gerrit-archive/fabric/blob/9d914c4246a2d7f23533280da6ab63612b7c75fb/core/common/ccprovider/cc_statedb_artifacts_provider.go#L54)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/cceventmgmt/defs.go#L30](https://github.com/hyperledger-gerrit-archive/fabric/blob/9d914c4246a2d7f23533280da6ab63612b7c75fb/core/ledger/cceventmgmt/defs.go#L30)<br><strong>Comment</strong>: <pre>Missing doc?</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/cceventmgmt/defs.go#L30](https://github.com/hyperledger-gerrit-archive/fabric/blob/9d914c4246a2d7f23533280da6ab63612b7c75fb/core/ledger/cceventmgmt/defs.go#L30)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [core/ledger/cceventmgmt/defs.go#L36](https://github.com/hyperledger-gerrit-archive/fabric/blob/9d914c4246a2d7f23533280da6ab63612b7c75fb/core/ledger/cceventmgmt/defs.go#L36)<br><strong>Comment</strong>: <pre>Missing doc?</pre><strong>Commenter</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>CommentLine</strong>: [core/ledger/cceventmgmt/defs.go#L36](https://github.com/hyperledger-gerrit-archive/fabric/blob/9d914c4246a2d7f23533280da6ab63612b7c75fb/core/ledger/cceventmgmt/defs.go#L36)<br><strong>Comment</strong>: <pre>Done</pre></blockquote><h3>PatchSet Number: 13</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Uploader</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Created</strong>: 1/15/2018, 2:05:51 PM<br><strong>UnmergedRevision</strong>: [70a1c1f41de2a0189af0c7a1fdf18bbb26d43ab5](https://github.com/hyperledger-gerrit-archive/fabric/commit/70a1c1f41de2a0189af0c7a1fdf18bbb26d43ab5)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/15/2018, 2:52:04 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 14</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Uploader</strong>: Manish Sethi - manish.sethi@gmail.com<br><strong>Created</strong>: 1/15/2018, 4:00:39 PM<br><strong>GitHubMergedRevision</strong>: [4fecdbd778725127cdab7ce02f6fd24194538234](https://github.com/hyperledger-gerrit-archive/fabric/commit/4fecdbd778725127cdab7ce02f6fd24194538234)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/15/2018, 4:25:13 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Approved</strong>: 1/15/2018, 5:07:29 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>MergedBy</strong>: Jason Yellick<br><strong>Merged</strong>: 1/15/2018, 5:08:38 PM<br><br><strong>Approver</strong>: David Enyeart - enyeart@us.ibm.com<br><strong>Approved</strong>: 1/15/2018, 4:26:51 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br></blockquote>
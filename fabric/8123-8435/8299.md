<strong>Project</strong>: fabric<br><strong>Branch</strong>: master<br><strong>ID</strong>: 8299<br><strong>Subject</strong>: [FAB-3155] LSCC security checks at validation time<br><strong>Status</strong>: ABANDONED<br><strong>Owner</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Assignee</strong>:<br><strong>Created</strong>: 4/20/2017, 6:39:15 AM<br><strong>LastUpdated</strong>: 4/23/2017, 10:58:21 AM<br><strong>CommitMessage</strong>:<br><pre>[FAB-3155] LSCC security checks at validation time

This change set is another piece required for FAB-3155; here we validate
the read-write set of a cc deploy/upgrade and make sure that it is
consistent with the invocation arguments.

This change set also introduces unit tests for the three change sets for
this jira item (FAB-3155).

Change-Id: I33d38dc008e6e7513322d0030faa083fd19b23bc
Signed-off-by: Alessandro Sorniotti <ale.linux@sopit.net>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 4/20/2017, 6:39:15 AM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/20/2017, 6:41:09 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/3982/ (1/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/20/2017, 6:42:01 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/9914/ (2/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/20/2017, 6:42:44 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/1449/ (3/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/20/2017, 7:43:37 AM<br><strong>Message</strong>: <pre>Patch Set 1: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/3982/ : FAILURE (skipped)

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/1449/ : FAILURE (skipped)

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/9914/ : SUCCESS</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 4/20/2017, 9:59:32 AM<br><strong>Message</strong>: <pre>Uploaded patch set 2.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/20/2017, 10:01:24 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/4000/ (1/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/20/2017, 10:02:26 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/9932/ (2/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/20/2017, 10:04:01 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/1467/ (3/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/20/2017, 10:55:31 AM<br><strong>Message</strong>: <pre>Patch Set 2: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/4000/ : FAILURE (skipped)

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/9932/ : FAILURE

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/1467/ : FAILURE (skipped)</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 4/20/2017, 11:27:34 AM<br><strong>Message</strong>: <pre>Patch Set 2:

reverify</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/20/2017, 11:28:53 AM<br><strong>Message</strong>: <pre>Patch Set 2: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/4008/ (1/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/20/2017, 11:29:15 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/9940/ (2/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/20/2017, 11:29:54 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/1475/ (3/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/20/2017, 12:28:42 PM<br><strong>Message</strong>: <pre>Patch Set 2: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/4008/ : FAILURE (skipped)

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/1475/ : FAILURE (skipped)

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/9940/ : SUCCESS</pre><strong>Reviewer</strong>: Elli Androulaki - lli@zurich.ibm.com<br><strong>Reviewed</strong>: 4/20/2017, 1:33:04 PM<br><strong>Message</strong>: <pre>Patch Set 2:

(1 comment)

Thanks Ale!
Looks good to me. Similar comments to the ones for the preceding CR. 
Moving on to your follow-up :)</pre><strong>Reviewer</strong>: Matthias Neugschwandtner - eug@zurich.ibm.com<br><strong>Reviewed</strong>: 4/20/2017, 1:35:30 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Looks good to me. Only thing is the same comment I had on 8253: validating upgrade, in my understanding not only the existing instantiation policy should be validated but also the "new" one.</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 4/20/2017, 3:43:51 PM<br><strong>Message</strong>: <pre>Patch Set 2:

(1 comment)</pre><strong>Reviewer</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Reviewed</strong>: 4/20/2017, 4:00:39 PM<br><strong>Message</strong>: <pre>Patch Set 2:

(2 comments)</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 4/21/2017, 3:01:13 AM<br><strong>Message</strong>: <pre>Uploaded patch set 3.</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 4/21/2017, 3:02:10 AM<br><strong>Message</strong>: <pre>Uploaded patch set 4: Commit message was updated.</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 4/21/2017, 3:03:07 AM<br><strong>Message</strong>: <pre>Patch Set 3:

(3 comments)

Thanks for your comments, I've addressed them, rebased, fixed tests and pushed again. 

@Binh: I've added a unit test to ensure that lscc can only do one putState upon deploy/upgrade, this way if this changes in the future, the unit test will fail and the developer can fix vscc as well. Thx for catching that!</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/21/2017, 3:24:27 AM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/4092/ (1/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/21/2017, 3:24:52 AM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/10024/ (2/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/21/2017, 3:25:37 AM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/1559/ (3/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/21/2017, 3:26:45 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/4093/ (1/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/21/2017, 3:33:52 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/10025/ (2/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/21/2017, 3:34:01 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/1560/ (3/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/21/2017, 4:02:19 AM<br><strong>Message</strong>: <pre>Patch Set 4: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/4093/ : FAILURE (skipped)

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/10025/ : FAILURE

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/1560/ : FAILURE (skipped)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/21/2017, 5:26:36 AM<br><strong>Message</strong>: <pre>Patch Set 3: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/4092/ : FAILURE (skipped)

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/10024/ : FAILURE

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/1559/ : FAILURE (skipped)</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 4/21/2017, 6:20:22 AM<br><strong>Message</strong>: <pre>Uploaded patch set 5.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/21/2017, 6:20:32 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/4115/ (1/3)</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 4/21/2017, 6:22:49 AM<br><strong>Message</strong>: <pre>Patch Set 5:

@maintainers: this change set is large, but pls note that there are 520 lines of tests and 45 lines of a mock implementation required for unit testing (and to avoid import cycles in tests). So the actual new code is very small</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/21/2017, 6:24:21 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/10047/ (2/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/21/2017, 6:25:04 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/1582/ (3/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/21/2017, 7:52:38 AM<br><strong>Message</strong>: <pre>Patch Set 5: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/4115/ : FAILURE (skipped)

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/1582/ : FAILURE (skipped)

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/10047/ : SUCCESS</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 4/21/2017, 9:21:53 AM<br><strong>Message</strong>: <pre>Patch Set 5:

(2 comments)</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 4/21/2017, 9:45:10 AM<br><strong>Message</strong>: <pre>Patch Set 5:

(2 comments)

Thanks, Murali! Pls see below!</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 4/21/2017, 9:56:48 AM<br><strong>Message</strong>: <pre>Patch Set 5:

(1 comment)</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 4/21/2017, 9:57:59 AM<br><strong>Message</strong>: <pre>Patch Set 5:

(1 comment)</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 4/21/2017, 10:07:49 AM<br><strong>Message</strong>: <pre>Patch Set 5:

(1 comment)

Thanks Yacov! See below!</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 4/21/2017, 10:13:05 AM<br><strong>Message</strong>: <pre>Patch Set 5:

(3 comments)</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 4/21/2017, 10:29:25 AM<br><strong>Message</strong>: <pre>Patch Set 5:

(3 comments)

Thanks, Murali! See below.</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 4/21/2017, 10:31:11 AM<br><strong>Message</strong>: <pre>Patch Set 5:

(1 comment)</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 4/21/2017, 10:33:02 AM<br><strong>Message</strong>: <pre>Patch Set 2:

(1 comment)</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 4/21/2017, 10:44:36 AM<br><strong>Message</strong>: <pre>Patch Set 5:

(2 comments)</pre><strong>Reviewer</strong>: Elli Androulaki - lli@zurich.ibm.com<br><strong>Reviewed</strong>: 4/21/2017, 11:58:27 AM<br><strong>Message</strong>: <pre>Patch Set 5: Code-Review+1

(2 comments)

Thanks Ale! A few comments that should not delay the CR from being merged (after its dependencies are merged). 

Since, it seems to me that comments have been addressed (based on your answers), unless i am missing anything, so I ll +1 it.</pre><strong>Reviewer</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Reviewed</strong>: 4/21/2017, 6:28:11 PM<br><strong>Message</strong>: <pre>Patch Set 5: Code-Review+2</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 4/23/2017, 3:16:26 AM<br><strong>Message</strong>: <pre>Uploaded patch set 6: Patch Set 5 was rebased.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/23/2017, 3:18:14 AM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/4317/ (1/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/23/2017, 3:18:42 AM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/10251/ (2/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/23/2017, 3:19:21 AM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/1784/ (3/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/23/2017, 3:31:08 AM<br><strong>Message</strong>: <pre>Patch Set 6: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/4317/ : FAILURE (skipped)

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/10251/ : FAILURE

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/1784/ : FAILURE (skipped)</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 4/23/2017, 3:33:56 AM<br><strong>Message</strong>: <pre>Uploaded patch set 7: Patch Set 6 was rebased.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/23/2017, 3:36:08 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/4322/ (1/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/23/2017, 3:36:08 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/10256/ (2/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/23/2017, 3:36:43 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/1789/ (3/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/23/2017, 5:27:55 AM<br><strong>Message</strong>: <pre>Patch Set 7: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-behave-x86_64/4322/ : FAILURE (skipped)

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/1789/ : FAILURE (skipped)

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/10256/ : SUCCESS</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 4/23/2017, 6:08:52 AM<br><strong>Message</strong>: <pre>Patch Set 7:

(1 comment)</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 4/23/2017, 6:10:22 AM<br><strong>Message</strong>: <pre>Patch Set 7:

(1 comment)</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 4/23/2017, 7:08:30 AM<br><strong>Message</strong>: <pre>Patch Set 7:

(1 comment)</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 4/23/2017, 8:56:44 AM<br><strong>Message</strong>: <pre>Patch Set 7:

(2 comments)

Thanks, Yacov! See below</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 4/23/2017, 8:58:54 AM<br><strong>Message</strong>: <pre>Patch Set 7:

(1 comment)</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 4/23/2017, 9:25:07 AM<br><strong>Message</strong>: <pre>Patch Set 7:

(1 comment)</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 4/23/2017, 9:34:50 AM<br><strong>Message</strong>: <pre>Patch Set 7:

(1 comment)</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 4/23/2017, 10:13:29 AM<br><strong>Message</strong>: <pre>Patch Set 7: Code-Review-1

(2 comments)</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 4/23/2017, 10:58:21 AM<br><strong>Message</strong>: <pre>Abandoned</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Created</strong>: 4/20/2017, 6:39:15 AM<br><strong>UnmergedRevision</strong>: [8da4fad40bcbf48391ff21ea2e9feadbb929fd16](https://github.com/hyperledger-gerrit-archive/fabric/commit/8da4fad40bcbf48391ff21ea2e9feadbb929fd16)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 4/20/2017, 7:43:37 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Created</strong>: 4/20/2017, 9:59:32 AM<br><strong>UnmergedRevision</strong>: [a71126e440fcd1590358e5b65785b688645c4b99](https://github.com/hyperledger-gerrit-archive/fabric/commit/a71126e440fcd1590358e5b65785b688645c4b99)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 4/20/2017, 12:28:42 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [/COMMIT_MSG#L9](https://github.com/hyperledger-gerrit-archive/fabric/blob/a71126e440fcd1590358e5b65785b688645c4b99//COMMIT_MSG#L9)<br><strong>Comment</strong>: <pre>what about https://gerrit.hyperledger.org/r/#/c/8305 ?</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [/COMMIT_MSG#L9](https://github.com/hyperledger-gerrit-archive/fabric/blob/a71126e440fcd1590358e5b65785b688645c4b99//COMMIT_MSG#L9)<br><strong>Comment</strong>: <pre>Ouch, true! Let me change this, thx</pre><strong>Commenter</strong>: Elli Androulaki - lli@zurich.ibm.com<br><strong>CommentLine</strong>: [core/scc/vscc/validator_onevalidsignature.go#L289](https://github.com/hyperledger-gerrit-archive/fabric/blob/a71126e440fcd1590358e5b65785b688645c4b99/core/scc/vscc/validator_onevalidsignature.go#L289)<br><strong>Comment</strong>: <pre>Same comment as in previous CR. Given the existence of init this can be > 1. But will check if this is covered by your follow up CR. :)</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [core/scc/vscc/validator_onevalidsignature.go#L241](https://github.com/hyperledger-gerrit-archive/fabric/blob/a71126e440fcd1590358e5b65785b688645c4b99/core/scc/vscc/validator_onevalidsignature.go#L241)<br><strong>Comment</strong>: <pre>I know this line isn't part of the change set but I'm putting this comment here for a reason: this function is now ~ 100 lines because you have made it bigger with the lines added below.
you have here a switch-case of something big and a default.
Is it possible to extract this whole block (case lcc.Upgrade or DEPLOY) to a different function?</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [core/scc/vscc/validator_onevalidsignature.go#L241](https://github.com/hyperledger-gerrit-archive/fabric/blob/a71126e440fcd1590358e5b65785b688645c4b99/core/scc/vscc/validator_onevalidsignature.go#L241)<br><strong>Comment</strong>: <pre>Yeah, I thought about doing this but as you know I've had to split this CR into 4 pieces and this way of working doesn't lend itself too well to splitting things into small functions etc, because the function is small in the first CR, it then grows and grows but major refactoring would make the CR too large etc.. :/ How about I do some refactoring after all the rebase craziness to get this merged?</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [core/scc/vscc/validator_onevalidsignature.go#L241](https://github.com/hyperledger-gerrit-archive/fabric/blob/a71126e440fcd1590358e5b65785b688645c4b99/core/scc/vscc/validator_onevalidsignature.go#L241)<br><strong>Comment</strong>: <pre>sounds good to me, if we're left with time.</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [core/scc/vscc/validator_onevalidsignature.go#L241](https://github.com/hyperledger-gerrit-archive/fabric/blob/a71126e440fcd1590358e5b65785b688645c4b99/core/scc/vscc/validator_onevalidsignature.go#L241)<br><strong>Comment</strong>: <pre>Thanks! Done</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [core/scc/vscc/validator_onevalidsignature.go#L322](https://github.com/hyperledger-gerrit-archive/fabric/blob/a71126e440fcd1590358e5b65785b688645c4b99/core/scc/vscc/validator_onevalidsignature.go#L322)<br><strong>Comment</strong>: <pre>In the case of Upgrade, the version would be different, wouldn't it?</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [core/scc/vscc/validator_onevalidsignature.go#L322](https://github.com/hyperledger-gerrit-archive/fabric/blob/a71126e440fcd1590358e5b65785b688645c4b99/core/scc/vscc/validator_onevalidsignature.go#L322)<br><strong>Comment</strong>: <pre>Here we're checking that what we write in the ledger is consistent with the arguments of the upgrade (and not something else that may result from an attack). What you are saying (and you are right there) is that what is in the ledger right now, before we commit this tx, is different from what's in this writeset. We don't check this fact yet, I've added it to the next patch set. THanks</pre></blockquote><h3>PatchSet Number: 3</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Created</strong>: 4/21/2017, 3:01:13 AM<br><strong>UnmergedRevision</strong>: [7c70bdf17258dda07075ee91da6a18d3e3f4a96a](https://github.com/hyperledger-gerrit-archive/fabric/commit/7c70bdf17258dda07075ee91da6a18d3e3f4a96a)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 4/21/2017, 5:26:36 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 4</h3><blockquote><strong>Type</strong>: NO_CODE_CHANGE<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Created</strong>: 4/21/2017, 3:02:10 AM<br><strong>UnmergedRevision</strong>: [f7143bd7b0c2105a500984117b932a5d6432caf5](https://github.com/hyperledger-gerrit-archive/fabric/commit/f7143bd7b0c2105a500984117b932a5d6432caf5)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 4/21/2017, 4:02:19 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 5</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Created</strong>: 4/21/2017, 6:20:22 AM<br><strong>UnmergedRevision</strong>: [ca123133d2dca9927d8d3bf88f1632f61876547e](https://github.com/hyperledger-gerrit-archive/fabric/commit/ca123133d2dca9927d8d3bf88f1632f61876547e)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 4/21/2017, 7:52:38 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Approved</strong>: 4/21/2017, 6:28:11 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Elli Androulaki - lli@zurich.ibm.com<br><strong>Approved</strong>: 4/21/2017, 11:58:27 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [common/mocks/ledger/queryexecutor.go#L1](https://github.com/hyperledger-gerrit-archive/fabric/blob/ca123133d2dca9927d8d3bf88f1632f61876547e/common/mocks/ledger/queryexecutor.go#L1)<br><strong>Comment</strong>: <pre>license header</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [common/mocks/ledger/queryexecutor.go#L1](https://github.com/hyperledger-gerrit-archive/fabric/blob/ca123133d2dca9927d8d3bf88f1632f61876547e/common/mocks/ledger/queryexecutor.go#L1)<br><strong>Comment</strong>: <pre>This one got through CI, so can you just add a license header in another change set?</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [common/mocks/ledger/queryexecutor.go#L1](https://github.com/hyperledger-gerrit-archive/fabric/blob/ca123133d2dca9927d8d3bf88f1632f61876547e/common/mocks/ledger/queryexecutor.go#L1)<br><strong>Comment</strong>: <pre>Thanks Yacov, I've just pushed http://gerrit.hyperledger.org/r/8351 with the missing license header!</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [core/scc/vscc/validator_onevalidsignature.go#L355](https://github.com/hyperledger-gerrit-archive/fabric/blob/ca123133d2dca9927d8d3bf88f1632f61876547e/core/scc/vscc/validator_onevalidsignature.go#L355)<br><strong>Comment</strong>: <pre>Not all peers may have the CC installed... Wouldn't you say a nil policy is an error (we at least need a default one).</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [core/scc/vscc/validator_onevalidsignature.go#L355](https://github.com/hyperledger-gerrit-archive/fabric/blob/ca123133d2dca9927d8d3bf88f1632f61876547e/core/scc/vscc/validator_onevalidsignature.go#L355)<br><strong>Comment</strong>: <pre>I had the same feeling but Elli corrected me and said that nil policy was acceptable.. @Elli, pls weigh in.</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [core/scc/vscc/validator_onevalidsignature.go#L355](https://github.com/hyperledger-gerrit-archive/fabric/blob/ca123133d2dca9927d8d3bf88f1632f61876547e/core/scc/vscc/validator_onevalidsignature.go#L355)<br><strong>Comment</strong>: <pre>Oh right. For backward compat, we may not have policy on the plain ChaincodeDeploymentSpec package... however that should be an exception. ie, for the SignedChaincodePackage we could ensure LSCC creates a default policy if not specified....this will be consistent with approach for other policies.

But we can enforce that in another CR... just so we don;t forget we should create a JIRA "don't allow nil InstantiationPolicy" for v1.1 ?</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [core/scc/vscc/validator_onevalidsignature.go#L355](https://github.com/hyperledger-gerrit-archive/fabric/blob/ca123133d2dca9927d8d3bf88f1632f61876547e/core/scc/vscc/validator_onevalidsignature.go#L355)<br><strong>Comment</strong>: <pre>Absolutely! I've created https://jira.hyperledger.org/browse/FAB-3304 to track that. Thanks!</pre><strong>Commenter</strong>: Elli Androulaki - lli@zurich.ibm.com<br><strong>CommentLine</strong>: [core/scc/vscc/validator_onevalidsignature.go#L355](https://github.com/hyperledger-gerrit-archive/fabric/blob/ca123133d2dca9927d8d3bf88f1632f61876547e/core/scc/vscc/validator_onevalidsignature.go#L355)<br><strong>Comment</strong>: <pre>So, regarding nil policy: we can allow it if we have a good default that takes context within a chain. It is the responsibility of the installer to provide a valid instantiation policy after all :)

Regarding the fixme: I am not sure it would make sense to retrieve anything from the FS at commitment time. If the peer indeed has cc locally stored with a different policy, then it just treats it as a different chaincode for which it will not be able (using FAB 3156) to provide endorsements for. Does this make sense?</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [core/scc/vscc/validator_onevalidsignature.go#L370](https://github.com/hyperledger-gerrit-archive/fabric/blob/ca123133d2dca9927d8d3bf88f1632f61876547e/core/scc/vscc/validator_onevalidsignature.go#L370)<br><strong>Comment</strong>: <pre>Check for curCd == nil ?</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [core/scc/vscc/validator_onevalidsignature.go#L370](https://github.com/hyperledger-gerrit-archive/fabric/blob/ca123133d2dca9927d8d3bf88f1632f61876547e/core/scc/vscc/validator_onevalidsignature.go#L370)<br><strong>Comment</strong>: <pre>Ouch yeah! We do check for that but in the refactoring, it ended up below.. that's no good.. Given that this CI run is successful (and CI runs are really unstable lately), mind if we handle it via http://gerrit.hyperledger.org/r/8353 ?</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [core/scc/vscc/validator_onevalidsignature.go#L370](https://github.com/hyperledger-gerrit-archive/fabric/blob/ca123133d2dca9927d8d3bf88f1632f61876547e/core/scc/vscc/validator_onevalidsignature.go#L370)<br><strong>Comment</strong>: <pre>Sure, makes complete sense.</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [core/scc/vscc/validator_onevalidsignature.go#L370](https://github.com/hyperledger-gerrit-archive/fabric/blob/ca123133d2dca9927d8d3bf88f1632f61876547e/core/scc/vscc/validator_onevalidsignature.go#L370)<br><strong>Comment</strong>: <pre>Thanks! It's already out!

Done</pre><strong>Commenter</strong>: Elli Androulaki - lli@zurich.ibm.com<br><strong>CommentLine</strong>: [core/scc/vscc/validator_onevalidsignature.go#L397](https://github.com/hyperledger-gerrit-archive/fabric/blob/ca123133d2dca9927d8d3bf88f1632f61876547e/core/scc/vscc/validator_onevalidsignature.go#L397)<br><strong>Comment</strong>: <pre>Maybe a picky comment, but would it make sense to check that version is not the only entry that was changed with this upgrade? On the other hand the instantiator plays the role of the admin for this chaincode and therefore it makes sense to trust it to do the right thing.</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [core/scc/vscc/validator_onevalidsignature.go#L410](https://github.com/hyperledger-gerrit-archive/fabric/blob/ca123133d2dca9927d8d3bf88f1632f61876547e/core/scc/vscc/validator_onevalidsignature.go#L410)<br><strong>Comment</strong>: <pre>This is called for both instantiate and upgrade ? If so the chaincode data won't be in the ledger (we are in the process of adding it with this TX right ?)</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [core/scc/vscc/validator_onevalidsignature.go#L410](https://github.com/hyperledger-gerrit-archive/fabric/blob/ca123133d2dca9927d8d3bf88f1632f61876547e/core/scc/vscc/validator_onevalidsignature.go#L410)<br><strong>Comment</strong>: <pre>Correct, we do expect that and can handle a nil output from GetState below on line 416.</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [core/scc/vscc/validator_onevalidsignature.go#L410](https://github.com/hyperledger-gerrit-archive/fabric/blob/ca123133d2dca9927d8d3bf88f1632f61876547e/core/scc/vscc/validator_onevalidsignature.go#L410)<br><strong>Comment</strong>: <pre>Right...my point was that it can be nil and line 370 in the Upgrade case does not check for nil and return error (complement of line 362). Let me add a comment there too.</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [core/scc/vscc/validator_onevalidsignature.go#L410](https://github.com/hyperledger-gerrit-archive/fabric/blob/ca123133d2dca9927d8d3bf88f1632f61876547e/core/scc/vscc/validator_onevalidsignature.go#L410)<br><strong>Comment</strong>: <pre>Gotcha now, thanks!! See above</pre></blockquote><h3>PatchSet Number: 6</h3><blockquote><strong>Type</strong>: TRIVIAL_REBASE<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Created</strong>: 4/23/2017, 3:16:26 AM<br><strong>UnmergedRevision</strong>: [a0d8d2b835804e3dde9671dd68a52591c199dbd5](https://github.com/hyperledger-gerrit-archive/fabric/commit/a0d8d2b835804e3dde9671dd68a52591c199dbd5)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 4/23/2017, 3:31:08 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 7</h3><blockquote><strong>Type</strong>: TRIVIAL_REBASE<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Created</strong>: 4/23/2017, 3:33:56 AM<br><strong>UnmergedRevision</strong>: [c1ce3c2755bfed430ef6331e907403e098f0188c](https://github.com/hyperledger-gerrit-archive/fabric/commit/c1ce3c2755bfed430ef6331e907403e098f0188c)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 4/23/2017, 5:27:55 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Approved</strong>: 4/23/2017, 10:13:29 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [core/scc/vscc/validator_onevalidsignature.go#L366](https://github.com/hyperledger-gerrit-archive/fabric/blob/c1ce3c2755bfed430ef6331e907403e098f0188c/core/scc/vscc/validator_onevalidsignature.go#L366)<br><strong>Comment</strong>: <pre>You invoke a method on curCd but it can be nil because in line 418 you return nil, nil

What am I missing? Maybe you should move the check in line 393 to here?</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [core/scc/vscc/validator_onevalidsignature.go#L366](https://github.com/hyperledger-gerrit-archive/fabric/blob/c1ce3c2755bfed430ef6331e907403e098f0188c/core/scc/vscc/validator_onevalidsignature.go#L366)<br><strong>Comment</strong>: <pre>ah you fixed it in a different change set. I don't understand though - why can't you squash them together? Isn't it dangerous to merge this without the other?</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [core/scc/vscc/validator_onevalidsignature.go#L366](https://github.com/hyperledger-gerrit-archive/fabric/blob/c1ce3c2755bfed430ef6331e907403e098f0188c/core/scc/vscc/validator_onevalidsignature.go#L366)<br><strong>Comment</strong>: <pre>Indeed, I fixed it in another change set. I wanted to actually push to this one, but a couple of days ago CI runs were *SO* bad that I preferred to push another CR instead of losing the +1 from the jobbuilder and risk another run.</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [core/scc/vscc/validator_onevalidsignature.go#L366](https://github.com/hyperledger-gerrit-archive/fabric/blob/c1ce3c2755bfed430ef6331e907403e098f0188c/core/scc/vscc/validator_onevalidsignature.go#L366)<br><strong>Comment</strong>: <pre>I understand the rational, however IMO pushing a change set that leads to possible crash of the peer isn't something that should be done in general.
IMO you should squash that with this change and also while you're at it refactor the nil, nil below :)</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [core/scc/vscc/validator_onevalidsignature.go#L418](https://github.com/hyperledger-gerrit-archive/fabric/blob/c1ce3c2755bfed430ef6331e907403e098f0188c/core/scc/vscc/validator_onevalidsignature.go#L418)<br><strong>Comment</strong>: <pre>is it possible to write the logic without having a function that returns nil, nil ? 
It is very confusing</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [core/scc/vscc/validator_onevalidsignature.go#L418](https://github.com/hyperledger-gerrit-archive/fabric/blob/c1ce3c2755bfed430ef6331e907403e098f0188c/core/scc/vscc/validator_onevalidsignature.go#L418)<br><strong>Comment</strong>: <pre>You'll notice that GetState has a similar signature.. it can return

- nil, err => something went wrong when trying to retrieve the key/value pair from the ledger
- nil, nil => retrieval from the ledger was successful, but that key was not assigned
- bytes, nil => retrieval from the ledger was successful, and there were bytes assigned to that key

I've just used the same semantics for this function as well.</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [core/scc/vscc/validator_onevalidsignature.go#L418](https://github.com/hyperledger-gerrit-archive/fabric/blob/c1ce3c2755bfed430ef6331e907403e098f0188c/core/scc/vscc/validator_onevalidsignature.go#L418)<br><strong>Comment</strong>: <pre>I know. I think that if we can avoid this pattern it can be beneficial.</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [core/scc/vscc/validator_onevalidsignature.go#L418](https://github.com/hyperledger-gerrit-archive/fabric/blob/c1ce3c2755bfed430ef6331e907403e098f0188c/core/scc/vscc/validator_onevalidsignature.go#L418)<br><strong>Comment</strong>: <pre>As nil is valid in one case (instantiate) and invalid in another (upgrade) the only way to avoid this is to pass if nil is expected or not and check. Its messy either way and can be argued either way.</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [core/scc/vscc/validator_onevalidsignature.go#L418](https://github.com/hyperledger-gerrit-archive/fabric/blob/c1ce3c2755bfed430ef6331e907403e098f0188c/core/scc/vscc/validator_onevalidsignature.go#L418)<br><strong>Comment</strong>: <pre>Agreed.. would you gents object to leaving it as is? At least we'd behave in a way similar to GetState.. Thx!</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [core/scc/vscc/validator_onevalidsignature.go#L418](https://github.com/hyperledger-gerrit-archive/fabric/blob/c1ce3c2755bfed430ef6331e907403e098f0188c/core/scc/vscc/validator_onevalidsignature.go#L418)<br><strong>Comment</strong>: <pre>IMO it's worth to extend this func with an addition bool argument that says whether bytes was nil or not.</pre></blockquote>
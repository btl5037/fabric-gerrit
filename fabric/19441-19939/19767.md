<strong>Project</strong>: fabric<br><strong>Branch</strong>: master<br><strong>ID</strong>: 19767<br><strong>Subject</strong>: [FAB-9102] CouchDB runner for test<br><strong>Status</strong>: MERGED<br><strong>Owner</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Assignee</strong>:<br><strong>Created</strong>: 3/26/2018, 1:25:47 PM<br><strong>LastUpdated</strong>: 4/21/2018, 8:43:11 AM<br><strong>CommitMessage</strong>:<br><pre>[FAB-9102] CouchDB runner for test

Provide a simple way to start and stop ephemeral docker containers that
host CloudDB. The runner enables multiple instances to run concurrently
and to have them exposed on ephemeral ports on the host when running
unit tests outside of a container.

Change-Id: I07f206db032d0cdbfca4f4b5fc0dd473058a67fc
Signed-off-by: Matthew Sykes <sykesmat@us.ibm.com>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Reviewed</strong>: 3/26/2018, 1:25:47 PM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/26/2018, 1:27:30 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/13437/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/26/2018, 1:28:21 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/21858/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 3/26/2018, 1:49:48 PM<br><strong>Message</strong>: <pre>Patch Set 1: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/21858/ : FAILURE

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-x86_64/21858/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-x86_64/21858

https://jenkins.hyperledger.org/job/fabric-verify-end-2-end-x86_64/13437/ : SUCCESS

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-end-2-end-x86_64/13437</pre><strong>Reviewer</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Reviewed</strong>: 3/26/2018, 3:34:40 PM<br><strong>Message</strong>: <pre>Patch Set 1: Code-Review-1

wip</pre><strong>Reviewer</strong>: Will Lahti - wtlahti@us.ibm.com<br><strong>Reviewed</strong>: 4/3/2018, 8:34:02 AM<br><strong>Message</strong>: <pre>Uploaded patch set 2.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/3/2018, 8:37:34 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/170/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/3/2018, 8:40:07 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Starting...</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/3/2018, 8:40:09 AM<br><strong>Message</strong>: <pre>Patch Set 2: F1-VerifyBuild-1

Trailing white spaces found</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/3/2018, 8:41:14 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/170/ : FAILURE (skipped)

You have a whitespace problem, probably a trailing space or two. ( https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/170/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/170</pre><strong>Reviewer</strong>: Will Lahti - wtlahti@us.ibm.com<br><strong>Reviewed</strong>: 4/4/2018, 11:45:55 AM<br><strong>Message</strong>: <pre>Patch Set 2: Code-Review-1

WIP</pre><strong>Reviewer</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Reviewed</strong>: 4/10/2018, 2:39:21 PM<br><strong>Message</strong>: <pre>Uploaded patch set 3.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/10/2018, 2:43:45 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/316/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/10/2018, 2:44:32 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/10/2018, 2:44:33 PM<br><strong>Message</strong>: <pre>Patch Set 3: F1-VerifyBuild-1

Trailing white spaces found</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/10/2018, 2:45:04 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/316/ : FAILURE (skipped)

You have a whitespace problem, probably a trailing space or two. ( https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/316/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/316</pre><strong>Reviewer</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Reviewed</strong>: 4/10/2018, 3:26:52 PM<br><strong>Message</strong>: <pre>Uploaded patch set 4.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/10/2018, 3:29:32 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/318/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/10/2018, 3:30:38 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/10/2018, 3:35:21 PM<br><strong>Message</strong>: <pre>Patch Set 4: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run SmokeTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/10/2018, 3:35:45 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/318/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/318</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/10/2018, 3:38:19 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/237/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/10/2018, 3:38:52 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Starting smoke tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/10/2018, 3:42:43 PM<br><strong>Message</strong>: <pre>Patch Set 4: F2-SmokeTest+1

Succeeded, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/10/2018, 3:44:19 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/827/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/10/2018, 3:44:46 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/10/2018, 4:00:44 PM<br><strong>Message</strong>: <pre>Patch Set 4: F3-UnitTest-1

Failed</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/10/2018, 4:01:09 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/827/ : FAILURE (skipped)

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/827/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/827

https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/237/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-smoke-tests-x86_64/237</pre><strong>Reviewer</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Reviewed</strong>: 4/10/2018, 4:15:51 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Run UnitTests

gossip TestMembershipConvergence</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/10/2018, 4:19:13 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/829/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/10/2018, 4:19:52 PM<br><strong>Message</strong>: <pre>Patch Set 4: -F3-UnitTest

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/10/2018, 4:34:07 PM<br><strong>Message</strong>: <pre>Patch Set 4: F3-UnitTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/10/2018, 4:34:42 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/829/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/829</pre><strong>Reviewer</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Reviewed</strong>: 4/11/2018, 1:55:07 PM<br><strong>Message</strong>: <pre>Topic set to local-unit-test</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 4/12/2018, 12:33:11 AM<br><strong>Message</strong>: <pre>Patch Set 4: Code-Review-1

(8 comments)</pre><strong>Reviewer</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Reviewed</strong>: 4/12/2018, 6:33:31 AM<br><strong>Message</strong>: <pre>Patch Set 4:

(8 comments)</pre><strong>Reviewer</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Reviewed</strong>: 4/12/2018, 7:34:26 AM<br><strong>Message</strong>: <pre>Uploaded patch set 5.</pre><strong>Reviewer</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Reviewed</strong>: 4/12/2018, 7:35:07 AM<br><strong>Message</strong>: <pre>Patch Set 5:

(8 comments)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 7:38:05 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/369/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 7:40:39 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 7:46:25 AM<br><strong>Message</strong>: <pre>Patch Set 5: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run SmokeTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 7:46:58 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/369/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/369</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 7:47:52 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/266/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 7:49:20 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Starting smoke tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 7:54:17 AM<br><strong>Message</strong>: <pre>Patch Set 5: F2-SmokeTest+1

Succeeded, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 7:58:20 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/863/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 7:59:51 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 8:14:18 AM<br><strong>Message</strong>: <pre>Patch Set 5: F3-UnitTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 8:14:43 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/266/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-smoke-tests-x86_64/266

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/863/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/863</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 4/12/2018, 8:30:26 AM<br><strong>Message</strong>: <pre>Patch Set 5:

(1 comment)</pre><strong>Reviewer</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Reviewed</strong>: 4/12/2018, 9:13:37 AM<br><strong>Message</strong>: <pre>Patch Set 5:

(1 comment)</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 4/12/2018, 2:01:41 PM<br><strong>Message</strong>: <pre>Patch Set 5: Code-Review-1

(3 comments)</pre><strong>Reviewer</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Reviewed</strong>: 4/12/2018, 2:09:04 PM<br><strong>Message</strong>: <pre>Patch Set 5:

(3 comments)</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 4/12/2018, 4:06:37 PM<br><strong>Message</strong>: <pre>Patch Set 5:

(3 comments)</pre><strong>Reviewer</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Reviewed</strong>: 4/12/2018, 6:01:17 PM<br><strong>Message</strong>: <pre>Uploaded patch set 6.</pre><strong>Reviewer</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Reviewed</strong>: 4/12/2018, 6:02:45 PM<br><strong>Message</strong>: <pre>Patch Set 6:

> Patch Set 5:
> 
> (1 comment)

I’m pretty sure I misunderstood your first comment. The default check shouldn’t be needed since the zero value for the port is 0 - giving an ephemeral host side port - which is exactly what I desire.

I added a test for the non-zero port.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 6:03:31 PM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/390/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 6:04:21 PM<br><strong>Message</strong>: <pre>Patch Set 6:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 6:08:48 PM<br><strong>Message</strong>: <pre>Patch Set 6: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run SmokeTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 6:09:10 PM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/390/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/390</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 6:12:54 PM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/280/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 6:13:34 PM<br><strong>Message</strong>: <pre>Patch Set 6:

Starting smoke tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 6:19:05 PM<br><strong>Message</strong>: <pre>Patch Set 6: F2-SmokeTest+1

Succeeded, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 6:22:35 PM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/886/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 6:23:36 PM<br><strong>Message</strong>: <pre>Patch Set 6:

Starting unit tests</pre><strong>Reviewer</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Reviewed</strong>: 4/12/2018, 6:30:27 PM<br><strong>Message</strong>: <pre>Uploaded patch set 7.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 6:34:03 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/391/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 6:34:50 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 6:39:35 PM<br><strong>Message</strong>: <pre>Patch Set 6: F3-UnitTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 6:39:59 PM<br><strong>Message</strong>: <pre>Patch Set 7: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run SmokeTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 6:40:14 PM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/280/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-smoke-tests-x86_64/280

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/886/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/886</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 6:40:22 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/391/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/391</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 6:42:04 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/281/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 6:43:03 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Starting smoke tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 6:46:39 PM<br><strong>Message</strong>: <pre>Patch Set 7: F2-SmokeTest+1

Succeeded, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 6:46:49 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/888/ (2/2)</pre><strong>Reviewer</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Reviewed</strong>: 4/12/2018, 6:47:58 PM<br><strong>Message</strong>: <pre>Patch Set 7:

(2 comments)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 6:47:58 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 7:01:53 PM<br><strong>Message</strong>: <pre>Patch Set 7: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/888/ : ABORTED

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/888/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/888

https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/281/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-smoke-tests-x86_64/281</pre><strong>Reviewer</strong>: Ry Jones - ry@linux.com<br><strong>Reviewed</strong>: 4/12/2018, 7:10:13 PM<br><strong>Message</strong>: <pre>Removed Verified-1 by Hyperledger Jobbuilder <jobbuilder@jenkins.hyperledger.org>
</pre><strong>Reviewer</strong>: Ry Jones - ry@linux.com<br><strong>Reviewed</strong>: 4/12/2018, 7:10:35 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Run UnitTest</pre><strong>Reviewer</strong>: Ry Jones - ry@linux.com<br><strong>Reviewed</strong>: 4/12/2018, 7:10:37 PM<br><strong>Message</strong>: <pre>Removed reviewer Ry Jones.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 7:12:17 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/889/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 7:13:13 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 7:21:39 PM<br><strong>Message</strong>: <pre>Patch Set 7: F3-UnitTest-1

Failed</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 7:22:16 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/889/ : FAILURE (skipped)

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/889/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/889</pre><strong>Reviewer</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Reviewed</strong>: 4/12/2018, 9:24:45 PM<br><strong>Message</strong>: <pre>Uploaded patch set 8.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 9:28:59 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/393/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 9:30:01 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 9:34:18 PM<br><strong>Message</strong>: <pre>Patch Set 8: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run SmokeTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 9:34:39 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/393/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/393</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 9:37:55 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/283/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 9:38:49 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Starting smoke tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 9:42:54 PM<br><strong>Message</strong>: <pre>Patch Set 8: F2-SmokeTest+1

Succeeded, Run UnitTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 9:45:50 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/892/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 9:46:47 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 10:02:56 PM<br><strong>Message</strong>: <pre>Patch Set 8: F3-UnitTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/12/2018, 10:03:33 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/283/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-smoke-tests-x86_64/283

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/892/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/892</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 4/13/2018, 10:53:16 AM<br><strong>Message</strong>: <pre>Patch Set 8: Code-Review+2</pre><strong>Reviewer</strong>: Christopher Ferris - chris.ferris@gmail.com<br><strong>Reviewed</strong>: 4/21/2018, 8:20:00 AM<br><strong>Message</strong>: <pre>Patch Set 8: Code-Review+2</pre><strong>Reviewer</strong>: Christopher Ferris - chris.ferris@gmail.com<br><strong>Reviewed</strong>: 4/21/2018, 8:20:06 AM<br><strong>Message</strong>: <pre>Change has been successfully merged by Christopher Ferris</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/21/2018, 8:21:28 AM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-merge-end-2-end-x86_64/2238/ (1/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/21/2018, 8:22:18 AM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-merge-x86_64/3569/ (2/2)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 4/21/2018, 8:43:11 AM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-merge-end-2-end-x86_64/2238/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-merge-end-2-end-x86_64/2238

https://jenkins.hyperledger.org/job/fabric-merge-x86_64/3569/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-merge-x86_64/3569</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Uploader</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Created</strong>: 3/26/2018, 1:25:47 PM<br><strong>UnmergedRevision</strong>: [efa0b780148f3f0707cf937449bac59c578ccebe](https://github.com/hyperledger-gerrit-archive/fabric/commit/efa0b780148f3f0707cf937449bac59c578ccebe)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 3/26/2018, 1:49:48 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Approved</strong>: 3/26/2018, 3:34:40 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Uploader</strong>: Will Lahti - wtlahti@us.ibm.com<br><strong>Created</strong>: 4/3/2018, 8:34:02 AM<br><strong>UnmergedRevision</strong>: [7861aa64e572e7717d681dd70b767236927a3943](https://github.com/hyperledger-gerrit-archive/fabric/commit/7861aa64e572e7717d681dd70b767236927a3943)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 4/3/2018, 8:40:09 AM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Will Lahti - wtlahti@us.ibm.com<br><strong>Approved</strong>: 4/4/2018, 11:45:55 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 3</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Uploader</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Created</strong>: 4/10/2018, 2:39:21 PM<br><strong>UnmergedRevision</strong>: [5c79ad9db6a87f311c2af10cebd621756b6a787a](https://github.com/hyperledger-gerrit-archive/fabric/commit/5c79ad9db6a87f311c2af10cebd621756b6a787a)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 4/10/2018, 2:44:33 PM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 4</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Uploader</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Created</strong>: 4/10/2018, 3:26:52 PM<br><strong>UnmergedRevision</strong>: [773f0f0fc331216bdaabb15c3566cca4bf105d1f](https://github.com/hyperledger-gerrit-archive/fabric/commit/773f0f0fc331216bdaabb15c3566cca4bf105d1f)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 4/10/2018, 3:35:21 PM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 4/10/2018, 3:35:21 PM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 4/10/2018, 3:42:43 PM<br><strong>Type</strong>: F2-SmokeTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 4/10/2018, 4:34:07 PM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Approved</strong>: 4/12/2018, 12:33:11 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L31](https://github.com/hyperledger-gerrit-archive/fabric/blob/773f0f0fc331216bdaabb15c3566cca4bf105d1f/integration/runner/couchdb.go#L31)<br><strong>Comment</strong>: <pre>Bit of a nit, but missing godoc?</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L31](https://github.com/hyperledger-gerrit-archive/fabric/blob/773f0f0fc331216bdaabb15c3566cca4bf105d1f/integration/runner/couchdb.go#L31)<br><strong>Comment</strong>: <pre>It's test code. Do we document test code?</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L31](https://github.com/hyperledger-gerrit-archive/fabric/blob/773f0f0fc331216bdaabb15c3566cca4bf105d1f/integration/runner/couchdb.go#L31)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L31](https://github.com/hyperledger-gerrit-archive/fabric/blob/773f0f0fc331216bdaabb15c3566cca4bf105d1f/integration/runner/couchdb.go#L31)<br><strong>Comment</strong>: <pre>As a rule, we have not enforced godoc requirements on test code.  This just stuck out to me as the rest of the functions seemed to be go-doced.  You're the process expert though, best practice to ignore doc-ing linter stuff in tests?</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L31](https://github.com/hyperledger-gerrit-archive/fabric/blob/773f0f0fc331216bdaabb15c3566cca4bf105d1f/integration/runner/couchdb.go#L31)<br><strong>Comment</strong>: <pre>In general, the linter is pointless. It identifies style issues. What matters are vet issues - which seem to be regularly ignored in our tests anyway.</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L31](https://github.com/hyperledger-gerrit-archive/fabric/blob/773f0f0fc331216bdaabb15c3566cca4bf105d1f/integration/runner/couchdb.go#L31)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L50](https://github.com/hyperledger-gerrit-archive/fabric/blob/773f0f0fc331216bdaabb15c3566cca4bf105d1f/integration/runner/couchdb.go#L50)<br><strong>Comment</strong>: <pre>It's likely my ifrit ignorance, but, why do these calls need to be synchronized? Naively, I would assume we expect the same go routine to call the 'Start()' and 'Stop()', and other internal synchronization seems to be done by channels.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L50](https://github.com/hyperledger-gerrit-archive/fabric/blob/773f0f0fc331216bdaabb15c3566cca4bf105d1f/integration/runner/couchdb.go#L50)<br><strong>Comment</strong>: <pre>Both of these fields are read and set via asynchronous go routines. They need serialization.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L50](https://github.com/hyperledger-gerrit-archive/fabric/blob/773f0f0fc331216bdaabb15c3566cca4bf105d1f/integration/runner/couchdb.go#L50)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L135](https://github.com/hyperledger-gerrit-archive/fabric/blob/773f0f0fc331216bdaabb15c3566cca4bf105d1f/integration/runner/couchdb.go#L135)<br><strong>Comment</strong>: <pre>Nit, but if the errors package is imported, might as well use `errors.Errorf` instead for the stack etc.?</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L135](https://github.com/hyperledger-gerrit-archive/fabric/blob/773f0f0fc331216bdaabb15c3566cca4bf105d1f/integration/runner/couchdb.go#L135)<br><strong>Comment</strong>: <pre>Why? It's test code.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L135](https://github.com/hyperledger-gerrit-archive/fabric/blob/773f0f0fc331216bdaabb15c3566cca4bf105d1f/integration/runner/couchdb.go#L135)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L154](https://github.com/hyperledger-gerrit-archive/fabric/blob/773f0f0fc331216bdaabb15c3566cca4bf105d1f/integration/runner/couchdb.go#L154)<br><strong>Comment</strong>: <pre>Why a "<-chan error" and not a "<- chan struct{}" (as the channel never seems to be written to).</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L154](https://github.com/hyperledger-gerrit-archive/fabric/blob/773f0f0fc331216bdaabb15c3566cca4bf105d1f/integration/runner/couchdb.go#L154)<br><strong>Comment</strong>: <pre>Can be a struct. Originally it returned an error.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L154](https://github.com/hyperledger-gerrit-archive/fabric/blob/773f0f0fc331216bdaabb15c3566cca4bf105d1f/integration/runner/couchdb.go#L154)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L161](https://github.com/hyperledger-gerrit-archive/fabric/blob/773f0f0fc331216bdaabb15c3566cca4bf105d1f/integration/runner/couchdb.go#L161)<br><strong>Comment</strong>: <pre>This will always wait for the first tick before attempting to connect.  Is that the desired behavior?</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L161](https://github.com/hyperledger-gerrit-archive/fabric/blob/773f0f0fc331216bdaabb15c3566cca4bf105d1f/integration/runner/couchdb.go#L161)<br><strong>Comment</strong>: <pre>It's appropriate for this polling.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L161](https://github.com/hyperledger-gerrit-archive/fabric/blob/773f0f0fc331216bdaabb15c3566cca4bf105d1f/integration/runner/couchdb.go#L161)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L176](https://github.com/hyperledger-gerrit-archive/fabric/blob/773f0f0fc331216bdaabb15c3566cca4bf105d1f/integration/runner/couchdb.go#L176)<br><strong>Comment</strong>: <pre>This looks like a race to me which could result in panic?

If both go routines end up in the ticker case at the same time, then the channel could double close?

It seems like the desired behavior here is if either of the address returns a success, then close the returned channel.  Why check both and not just one? Also, why not require both to return successfully?</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L176](https://github.com/hyperledger-gerrit-archive/fabric/blob/773f0f0fc331216bdaabb15c3566cca4bf105d1f/integration/runner/couchdb.go#L176)<br><strong>Comment</strong>: <pre>In 99% of cases, only host or container is accessible - not both. This ensures one is active and saves it. This makes it possible to use from the host or inside a container on the same network as the database.

I don't know why you believe there is anything that can result in a panic here. The two routines are running concurrently polling for readiness on two separate addresses. If either succeeds, the address is saved and the ready chan is closed. Closing the ready chan will ensure the other go routine select eventually exits.

When both routines successfully polls, the last one to set the address will win. It doesn't really matter who wins as address just returns a viable address.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L176](https://github.com/hyperledger-gerrit-archive/fabric/blob/773f0f0fc331216bdaabb15c3566cca4bf105d1f/integration/runner/couchdb.go#L176)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L176](https://github.com/hyperledger-gerrit-archive/fabric/blob/773f0f0fc331216bdaabb15c3566cca4bf105d1f/integration/runner/couchdb.go#L176)<br><strong>Comment</strong>: <pre>Maybe this is a sufficiently rare case that you do not care to handle it, but, as I see it, a crash _can_ happen here.

Here, I use go-ha for the go readyFunc(c.hostAddress) go routine, and go-ca for the c.containerAddress go routine.

go-ha waits on select
go-ca waits on select
ticker.C fires
go-ha wakes on select, enters ticker branch, blocks on http.Get
ticker.C fires
go-ca wakes on select, enters ticker branch, closes readyCh
go-ha returns from http.Get, closes readyCh -- PANIC

A similar failure could occur even if readyCh closes before go-ca wakes, so long as ticker.C fires.  When multiple channels are readable, select chooses randomly I believe.

A refactor like the following would solve the race.

 readyCh := make(chan struct{})
 readyHACh := make(chan struct{})
 readyCACh := make(chan struct{})

 readyFunc := func(addr string, lReadyCh chan struct{}) {
      .... // same as before, but close lReadyCh
 }

 go readyFunc(c.hostAddress, readyHACh)
 go readyFunc(c.containerAddress, readyCACh)
 go func() {
    select {
      case <-readyCACh:
      case <- readyHACh:
    }
    close(readyCh)
 }</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L176](https://github.com/hyperledger-gerrit-archive/fabric/blob/773f0f0fc331216bdaabb15c3566cca4bf105d1f/integration/runner/couchdb.go#L176)<br><strong>Comment</strong>: <pre>I wish you had just said that the channel could be closed twice - in which case I’d have agreed and fixed it. I missed that when transferring the code back and forth across authors and machines.

Will fix - but probably not as you’re suggesting.</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L176](https://github.com/hyperledger-gerrit-archive/fabric/blob/773f0f0fc331216bdaabb15c3566cca4bf105d1f/integration/runner/couchdb.go#L176)<br><strong>Comment</strong>: <pre>> I wish you had just said that the channel could be closed twice

Not a big deal, but, from my first comment: "then the channel could double close?"</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L176](https://github.com/hyperledger-gerrit-archive/fabric/blob/773f0f0fc331216bdaabb15c3566cca4bf105d1f/integration/runner/couchdb.go#L176)<br><strong>Comment</strong>: <pre>Avoided the race by checking both endpoints at the top level select (caller of this method) and using a context to handle cancelation and timeout.</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L182](https://github.com/hyperledger-gerrit-archive/fabric/blob/773f0f0fc331216bdaabb15c3566cca4bf105d1f/integration/runner/couchdb.go#L182)<br><strong>Comment</strong>: <pre>What is the rationale for making this channel buffered?</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L182](https://github.com/hyperledger-gerrit-archive/fabric/blob/773f0f0fc331216bdaabb15c3566cca4bf105d1f/integration/runner/couchdb.go#L182)<br><strong>Comment</strong>: <pre>None. It doesn't really matter.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L182](https://github.com/hyperledger-gerrit-archive/fabric/blob/773f0f0fc331216bdaabb15c3566cca4bf105d1f/integration/runner/couchdb.go#L182)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L192](https://github.com/hyperledger-gerrit-archive/fabric/blob/773f0f0fc331216bdaabb15c3566cca4bf105d1f/integration/runner/couchdb.go#L192)<br><strong>Comment</strong>: <pre>Perhaps it's my own ignorance, but it's a bit unclear what this is doing?

'getLogs()' sounds to me like it should return logs, but it seems to be setting the logging parameters for the docker client:

https://godoc.org/github.com/fsouza/go-dockerclient#Client.Logs

If the name is appropriate, a comment explaining what is going on here would be nice.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L192](https://github.com/hyperledger-gerrit-archive/fabric/blob/773f0f0fc331216bdaabb15c3566cca4bf105d1f/integration/runner/couchdb.go#L192)<br><strong>Comment</strong>: <pre>It's doing neither. It could be named streamLogs or similar.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L192](https://github.com/hyperledger-gerrit-archive/fabric/blob/773f0f0fc331216bdaabb15c3566cca4bf105d1f/integration/runner/couchdb.go#L192)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L192](https://github.com/hyperledger-gerrit-archive/fabric/blob/773f0f0fc331216bdaabb15c3566cca4bf105d1f/integration/runner/couchdb.go#L192)<br><strong>Comment</strong>: <pre>For my own edification, could you explain a little more what is going on here?  It is still not obvious to me.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L192](https://github.com/hyperledger-gerrit-archive/fabric/blob/773f0f0fc331216bdaabb15c3566cca4bf105d1f/integration/runner/couchdb.go#L192)<br><strong>Comment</strong>: <pre>It’s having the docker client setup a channel to stream logs to the writers hung off the runner. If no writers are set, there’s no need to stream logs.</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L192](https://github.com/hyperledger-gerrit-archive/fabric/blob/773f0f0fc331216bdaabb15c3566cca4bf105d1f/integration/runner/couchdb.go#L192)<br><strong>Comment</strong>: <pre>Done</pre></blockquote><h3>PatchSet Number: 5</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Uploader</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Created</strong>: 4/12/2018, 7:34:26 AM<br><strong>UnmergedRevision</strong>: [401b6f0b3d8c29018ad3cccd6fa68aa541749048](https://github.com/hyperledger-gerrit-archive/fabric/commit/401b6f0b3d8c29018ad3cccd6fa68aa541749048)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 4/12/2018, 7:46:25 AM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 4/12/2018, 7:46:25 AM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 4/12/2018, 7:54:17 AM<br><strong>Type</strong>: F2-SmokeTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 4/12/2018, 8:14:18 AM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Approved</strong>: 4/12/2018, 2:01:41 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L77](https://github.com/hyperledger-gerrit-archive/fabric/blob/401b6f0b3d8c29018ad3cccd6fa68aa541749048/integration/runner/couchdb.go#L77)<br><strong>Comment</strong>: <pre>IMO, you also need to add default value for c.HostPort among these</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L77](https://github.com/hyperledger-gerrit-archive/fabric/blob/401b6f0b3d8c29018ad3cccd6fa68aa541749048/integration/runner/couchdb.go#L77)<br><strong>Comment</strong>: <pre>Is that because it's needed by a use case that an ephemeral port returned by address doesn't resolve? I ask because I don't have that use case.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [integration/runner/couchdb.go#L77](https://github.com/hyperledger-gerrit-archive/fabric/blob/401b6f0b3d8c29018ad3cccd6fa68aa541749048/integration/runner/couchdb.go#L77)<br><strong>Comment</strong>: <pre>I think I misunderstood the original comment. The block shouldn’t be necessary since the zero value gives the default  behavior of an ephemeral host side port.

I added a test for a non-zero port.</pre></blockquote><h3>PatchSet Number: 6</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Uploader</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Created</strong>: 4/12/2018, 6:01:17 PM<br><strong>UnmergedRevision</strong>: [8f9e729c61105dc53afb54a4732c53ce6a24becc](https://github.com/hyperledger-gerrit-archive/fabric/commit/8f9e729c61105dc53afb54a4732c53ce6a24becc)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 4/12/2018, 6:08:48 PM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 4/12/2018, 6:08:48 PM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 4/12/2018, 6:19:05 PM<br><strong>Type</strong>: F2-SmokeTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 4/12/2018, 6:39:35 PM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 7</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Uploader</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Created</strong>: 4/12/2018, 6:30:27 PM<br><strong>UnmergedRevision</strong>: [114195f1f531370b568e5ce51da7ff66bc715091](https://github.com/hyperledger-gerrit-archive/fabric/commit/114195f1f531370b568e5ce51da7ff66bc715091)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 4/12/2018, 6:39:59 PM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 4/12/2018, 6:39:59 PM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 4/12/2018, 6:46:39 PM<br><strong>Type</strong>: F2-SmokeTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 4/12/2018, 7:21:39 PM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 8</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Uploader</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Created</strong>: 4/12/2018, 9:24:45 PM<br><strong>GitHubMergedRevision</strong>: [b1d761c32f77ccaae1135d36372d428ff4c8f57b](https://github.com/hyperledger-gerrit-archive/fabric/commit/b1d761c32f77ccaae1135d36372d428ff4c8f57b)<br><br><strong>Approver</strong>: Christopher Ferris - chris.ferris@gmail.com<br><strong>Approved</strong>: 4/21/2018, 8:20:00 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>MergedBy</strong>: Christopher Ferris<br><strong>Merged</strong>: 4/21/2018, 8:20:06 AM<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 4/12/2018, 9:34:18 PM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 4/12/2018, 9:34:18 PM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 4/12/2018, 9:42:54 PM<br><strong>Type</strong>: F2-SmokeTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 4/12/2018, 10:02:56 PM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Approved</strong>: 4/13/2018, 10:53:16 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br></blockquote>
<strong>Project</strong>: fabric<br><strong>Branch</strong>: master<br><strong>ID</strong>: 25393<br><strong>Subject</strong>: [FAB-11294] ProverPeerServer - List Tokens<br><strong>Status</strong>: ABANDONED<br><strong>Owner</strong>: Wenjian Qiao - wenjianq@gmail.com<br><strong>Assignee</strong>:<br><strong>Created</strong>: 8/9/2018, 11:05:52 PM<br><strong>LastUpdated</strong>: 9/3/2018, 2:59:04 AM<br><strong>CommitMessage</strong>:<br><pre>[FAB-11294] ProverPeerServer - List Tokens

This change-set does the following:
- Implement ListUnspentTokens in ProverPeerServer
- Add validation to command header
- Add temporary TokenOutput type until TMS finalizes it
- Add tests with grpc server and client

Change-Id: I655b9b1aedbec6c588249755b588ba73b04c8f49
Signed-off-by: Wenjian Qiao <wenjianq@gmail.com>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Wenjian Qiao - wenjianq@gmail.com<br><strong>Reviewed</strong>: 8/9/2018, 11:05:52 PM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/9/2018, 11:11:13 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/3765/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/9/2018, 11:11:29 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/9/2018, 11:13:41 PM<br><strong>Message</strong>: <pre>Patch Set 1: F1-VerifyBuild-1

code checks are failed</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/9/2018, 11:13:59 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/3765/ : FAILURE (skipped)

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/3765/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/3765</pre><strong>Reviewer</strong>: Wenjian Qiao - wenjianq@gmail.com<br><strong>Reviewed</strong>: 8/9/2018, 11:33:21 PM<br><strong>Message</strong>: <pre>Uploaded patch set 2.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/9/2018, 11:38:49 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/3767/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/9/2018, 11:39:07 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/9/2018, 11:47:08 PM<br><strong>Message</strong>: <pre>Patch Set 2: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run SmokeTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/9/2018, 11:47:41 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/3767/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/3767</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/9/2018, 11:50:53 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/2450/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/9/2018, 11:51:13 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Starting smoke tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/10/2018, 12:06:17 AM<br><strong>Message</strong>: <pre>Patch Set 2: F2-SmokeTest+1

Succeeded, Run UnitTest, Run IntegrationTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/10/2018, 12:09:22 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/3551/ (2/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/10/2018, 12:09:38 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/10/2018, 12:09:52 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/1161/ (3/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/10/2018, 12:10:32 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Starting Integration tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/10/2018, 12:22:25 AM<br><strong>Message</strong>: <pre>Patch Set 2: F3-UnitTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/10/2018, 12:27:09 AM<br><strong>Message</strong>: <pre>Patch Set 2: F3-IntegrationTest-1

Failed</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/10/2018, 12:27:30 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/1161/ : FAILURE (skipped)

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/1161/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-integration-tests-x86_64/1161

https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/2450/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-smoke-tests-x86_64/2450

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/3551/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/3551</pre><strong>Reviewer</strong>: Angelo De Caro - adc@zurich.ibm.com<br><strong>Reviewed</strong>: 8/10/2018, 8:02:38 AM<br><strong>Message</strong>: <pre>Patch Set 2:

(1 comment)</pre><strong>Reviewer</strong>: Angelo De Caro - adc@zurich.ibm.com<br><strong>Reviewed</strong>: 8/10/2018, 8:02:43 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Run IntegrationTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/10/2018, 8:06:38 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/1180/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/10/2018, 8:07:05 AM<br><strong>Message</strong>: <pre>Patch Set 2: -F3-IntegrationTest

Starting Integration tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/10/2018, 8:20:48 AM<br><strong>Message</strong>: <pre>Patch Set 2: F3-IntegrationTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/10/2018, 8:21:05 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/1180/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-integration-tests-x86_64/1180</pre><strong>Reviewer</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Reviewed</strong>: 8/10/2018, 3:34:47 PM<br><strong>Message</strong>: <pre>Patch Set 2:

(7 comments)</pre><strong>Reviewer</strong>: Wenjian Qiao - wenjianq@gmail.com<br><strong>Reviewed</strong>: 8/10/2018, 9:46:34 PM<br><strong>Message</strong>: <pre>Uploaded patch set 3.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/10/2018, 9:51:46 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/3805/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/10/2018, 9:52:05 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/10/2018, 9:59:55 PM<br><strong>Message</strong>: <pre>Patch Set 3: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run SmokeTest</pre><strong>Reviewer</strong>: Wenjian Qiao - wenjianq@gmail.com<br><strong>Reviewed</strong>: 8/10/2018, 10:00:02 PM<br><strong>Message</strong>: <pre>Patch Set 3:

(7 comments)

Code updated</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/10/2018, 10:00:23 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/3805/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/3805</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/10/2018, 10:02:08 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/2480/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/10/2018, 10:02:29 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Starting smoke tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/10/2018, 10:20:15 PM<br><strong>Message</strong>: <pre>Patch Set 3: F2-SmokeTest+1

Succeeded, Run UnitTest, Run IntegrationTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/10/2018, 10:22:58 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/3584/ (2/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/10/2018, 10:23:16 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/10/2018, 10:23:36 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/1193/ (3/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/10/2018, 10:24:24 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Starting Integration tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/10/2018, 10:37:48 PM<br><strong>Message</strong>: <pre>Patch Set 3: F3-UnitTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/10/2018, 10:48:42 PM<br><strong>Message</strong>: <pre>Patch Set 3: F3-IntegrationTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/10/2018, 10:49:23 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/2480/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-smoke-tests-x86_64/2480

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/3584/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/3584

https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/1193/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-integration-tests-x86_64/1193</pre><strong>Reviewer</strong>: Wenjian Qiao - wenjianq@gmail.com<br><strong>Reviewed</strong>: 8/13/2018, 11:38:10 AM<br><strong>Message</strong>: <pre>Uploaded patch set 4.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/13/2018, 11:40:59 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/3875/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/13/2018, 11:41:21 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/13/2018, 11:41:25 AM<br><strong>Message</strong>: <pre>Patch Set 4: F1-VerifyBuild-1

code checks are failed</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/13/2018, 11:41:47 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/3875/ : FAILURE (skipped)

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/3875/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/3875</pre><strong>Reviewer</strong>: Wenjian Qiao - wenjianq@gmail.com<br><strong>Reviewed</strong>: 8/13/2018, 1:59:40 PM<br><strong>Message</strong>: <pre>Uploaded patch set 5.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/13/2018, 2:02:26 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/3885/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/13/2018, 2:02:43 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/13/2018, 2:09:13 PM<br><strong>Message</strong>: <pre>Patch Set 5: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run SmokeTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/13/2018, 2:09:46 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/3885/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/3885</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/13/2018, 2:11:42 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/2535/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/13/2018, 2:12:01 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Starting smoke tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/13/2018, 2:28:07 PM<br><strong>Message</strong>: <pre>Patch Set 5: F2-SmokeTest+1

Succeeded, Run UnitTest, Run IntegrationTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/13/2018, 2:30:10 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/3643/ (2/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/13/2018, 2:30:28 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/13/2018, 2:30:51 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/1243/ (3/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/13/2018, 2:31:29 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Starting Integration tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/13/2018, 2:50:20 PM<br><strong>Message</strong>: <pre>Patch Set 5: F3-UnitTest-1

Failed</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/13/2018, 2:53:32 PM<br><strong>Message</strong>: <pre>Patch Set 5: F3-IntegrationTest-1

Failed</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/13/2018, 2:54:23 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/3643/ : FAILURE (skipped)

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/3643/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/3643

https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/1243/ : FAILURE (skipped)

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/1243/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-integration-tests-x86_64/1243

https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/2535/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-smoke-tests-x86_64/2535</pre><strong>Reviewer</strong>: Wenjian Qiao - wenjianq@gmail.com<br><strong>Reviewed</strong>: 8/14/2018, 9:07:14 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Run-IntegrationTest</pre><strong>Reviewer</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Reviewed</strong>: 8/14/2018, 3:16:36 PM<br><strong>Message</strong>: <pre>Patch Set 5: Code-Review-1

(15 comments)

I think we should have a face to face chat about the tests. I think they need to be a lot simpler than they are to read and maintain.</pre><strong>Reviewer</strong>: Wenjian Qiao - wenjianq@gmail.com<br><strong>Reviewed</strong>: 8/15/2018, 11:56:51 PM<br><strong>Message</strong>: <pre>Uploaded patch set 6.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/15/2018, 11:58:48 PM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/3998/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/15/2018, 11:59:06 PM<br><strong>Message</strong>: <pre>Patch Set 6:

Starting verify build</pre><strong>Reviewer</strong>: Wenjian Qiao - wenjianq@gmail.com<br><strong>Reviewed</strong>: 8/16/2018, 12:00:33 AM<br><strong>Message</strong>: <pre>Patch Set 6:

> (15 comments)
 > 
 > I think we should have a face to face chat about the tests. I think
 > they need to be a lot simpler than they are to read and maintain.

Matt, thank you for the comments. I have added prover_bdd_test.go using ginkgo. It has addressed your review comments.

Note that I manually pulled in patch set 18 from CR 25273 because this CR's immediate dependency CR 25343 has not been rebased yet.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/16/2018, 12:00:45 AM<br><strong>Message</strong>: <pre>Patch Set 6: F1-VerifyBuild-1

code checks are failed</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/16/2018, 12:01:18 AM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/3998/ : FAILURE (skipped)

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/3998/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/3998</pre><strong>Reviewer</strong>: Wenjian Qiao - wenjianq@gmail.com<br><strong>Reviewed</strong>: 8/16/2018, 11:57:21 AM<br><strong>Message</strong>: <pre>Uploaded patch set 7.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/16/2018, 12:01:48 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/4019/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/16/2018, 12:02:12 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/16/2018, 12:03:46 PM<br><strong>Message</strong>: <pre>Patch Set 7: F1-VerifyBuild-1

code checks are failed</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/16/2018, 12:04:19 PM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/4019/ : FAILURE (skipped)

No problems were identified. If you know why this problem occurred, please add a suitable Cause for it. ( https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/4019/ )

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/4019</pre><strong>Reviewer</strong>: Wenjian Qiao - wenjianq@gmail.com<br><strong>Reviewed</strong>: 8/16/2018, 12:37:28 PM<br><strong>Message</strong>: <pre>Uploaded patch set 8.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/16/2018, 12:37:38 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/4026/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/16/2018, 12:37:58 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Starting verify build</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/16/2018, 12:45:11 PM<br><strong>Message</strong>: <pre>Patch Set 8: F2-DocBuild+1 F1-VerifyBuild+1

Succeeded, Run SmokeTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/16/2018, 12:45:38 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-build-checks-x86_64/4026/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-build-checks-x86_64/4026</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/16/2018, 12:49:12 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/2618/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/16/2018, 12:49:32 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Starting smoke tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/16/2018, 1:04:45 PM<br><strong>Message</strong>: <pre>Patch Set 8: F2-SmokeTest+1

Succeeded, Run UnitTest, Run IntegrationTest</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/16/2018, 1:06:46 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/3751/ (2/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/16/2018, 1:07:04 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Starting unit tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/16/2018, 1:08:30 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/1331/ (3/3)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/16/2018, 1:09:00 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Starting Integration tests</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/16/2018, 1:21:38 PM<br><strong>Message</strong>: <pre>Patch Set 8: F3-UnitTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/16/2018, 1:25:29 PM<br><strong>Message</strong>: <pre>Patch Set 8: F3-IntegrationTest+1

Succeeded</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 8/16/2018, 1:26:05 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-smoke-tests-x86_64/2618/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-smoke-tests-x86_64/2618

https://jenkins.hyperledger.org/job/fabric-verify-unit-tests-x86_64/3751/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-unit-tests-x86_64/3751

https://jenkins.hyperledger.org/job/fabric-verify-integration-tests-x86_64/1331/ : SUCCESS (skipped)

Logs: https://logs.hyperledger.org/production/vex-yul-hyp-jenkins-3/fabric-verify-integration-tests-x86_64/1331</pre><strong>Reviewer</strong>: Wenjian Qiao - wenjianq@gmail.com<br><strong>Reviewed</strong>: 9/3/2018, 2:59:04 AM<br><strong>Message</strong>: <pre>Abandoned

Abandon this CR due to changes in dependency CRs. Re-implement it under https://gerrit.hyperledger.org/r/#/c/26052/</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Wenjian Qiao - wenjianq@gmail.com<br><strong>Uploader</strong>: Wenjian Qiao - wenjianq@gmail.com<br><strong>Created</strong>: 8/9/2018, 11:05:52 PM<br><strong>UnmergedRevision</strong>: [43344b9e0e0673a629d8a693842e7f9946a4f2cf](https://github.com/hyperledger-gerrit-archive/fabric/commit/43344b9e0e0673a629d8a693842e7f9946a4f2cf)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 8/9/2018, 11:13:41 PM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Wenjian Qiao - wenjianq@gmail.com<br><strong>Uploader</strong>: Wenjian Qiao - wenjianq@gmail.com<br><strong>Created</strong>: 8/9/2018, 11:33:21 PM<br><strong>UnmergedRevision</strong>: [b87acb55933673385160c967cb720aa6263d72ac](https://github.com/hyperledger-gerrit-archive/fabric/commit/b87acb55933673385160c967cb720aa6263d72ac)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 8/9/2018, 11:47:08 PM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 8/9/2018, 11:47:08 PM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 8/10/2018, 12:06:17 AM<br><strong>Type</strong>: F2-SmokeTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 8/10/2018, 8:20:48 AM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 8/10/2018, 12:22:25 AM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [protos/token/proverpeer.pb.go#L2](https://github.com/hyperledger-gerrit-archive/fabric/blob/b87acb55933673385160c967cb720aa6263d72ac/protos/token/proverpeer.pb.go#L2)<br><strong>Comment</strong>: <pre>I know it's a nit but every other generated proto shows the source as a relative path. If we have to update proto, when we regenerate, can we do it with the relative path?

Also, are we consistently using the version of protoc-gen that's in the build and managed by the makefile?</pre><strong>Commenter</strong>: Wenjian Qiao - wenjianq@gmail.com<br><strong>CommentLine</strong>: [protos/token/proverpeer.pb.go#L2](https://github.com/hyperledger-gerrit-archive/fabric/blob/b87acb55933673385160c967cb720aa6263d72ac/protos/token/proverpeer.pb.go#L2)<br><strong>Comment</strong>: <pre>Good catch. I have regenerated the .go file with relative path using the protoc-gen that's in the build.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [protos/token/proverpeer.proto#L55](https://github.com/hyperledger-gerrit-archive/fabric/blob/b87acb55933673385160c967cb720aa6263d72ac/protos/token/proverpeer.proto#L55)<br><strong>Comment</strong>: <pre>The name - Why isn't it simply UnspentTokens ?</pre><strong>Commenter</strong>: Wenjian Qiao - wenjianq@gmail.com<br><strong>CommentLine</strong>: [protos/token/proverpeer.proto#L55](https://github.com/hyperledger-gerrit-archive/fabric/blob/b87acb55933673385160c967cb720aa6263d72ac/protos/token/proverpeer.proto#L55)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [protos/token/proverpeer.proto#L56](https://github.com/hyperledger-gerrit-archive/fabric/blob/b87acb55933673385160c967cb720aa6263d72ac/protos/token/proverpeer.proto#L56)<br><strong>Comment</strong>: <pre>tokens?

The action is "list unspent tokens"; the result would be "unspent tokens"; within the struct should be tokens of type TokenOutput - right?</pre><strong>Commenter</strong>: Wenjian Qiao - wenjianq@gmail.com<br><strong>CommentLine</strong>: [protos/token/proverpeer.proto#L56](https://github.com/hyperledger-gerrit-archive/fabric/blob/b87acb55933673385160c967cb720aa6263d72ac/protos/token/proverpeer.proto#L56)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [protos/token/proverpeer.proto#L69](https://github.com/hyperledger-gerrit-archive/fabric/blob/b87acb55933673385160c967cb720aa6263d72ac/protos/token/proverpeer.proto#L69)<br><strong>Comment</strong>: <pre>I keep seeing this type in different CRs... I'm assuming they're all just merge conflicts that will disappear.</pre><strong>Commenter</strong>: Wenjian Qiao - wenjianq@gmail.com<br><strong>CommentLine</strong>: [protos/token/proverpeer.proto#L69](https://github.com/hyperledger-gerrit-archive/fabric/blob/b87acb55933673385160c967cb720aa6263d72ac/protos/token/proverpeer.proto#L69)<br><strong>Comment</strong>: <pre>TMS also defines this type so that it can return tokens. We will converge to the same type.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [token/server/msgvalidation.go#L22](https://github.com/hyperledger-gerrit-archive/fabric/blob/b87acb55933673385160c967cb720aa6263d72ac/token/server/msgvalidation.go#L22)<br><strong>Comment</strong>: <pre>this is not a big deal, would these make things better or worse?

token command header: invalid transaction type %d
token command header: channel ID is required
token command header: nonce is is required
token command header: invalid epoch %d</pre><strong>Commenter</strong>: Wenjian Qiao - wenjianq@gmail.com<br><strong>CommentLine</strong>: [token/server/msgvalidation.go#L22](https://github.com/hyperledger-gerrit-archive/fabric/blob/b87acb55933673385160c967cb720aa6263d72ac/token/server/msgvalidation.go#L22)<br><strong>Comment</strong>: <pre>I like the proposed format and have updated the code accordingly.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [token/server/msgvalidation.go#L36](https://github.com/hyperledger-gerrit-archive/fabric/blob/b87acb55933673385160c967cb720aa6263d72ac/token/server/msgvalidation.go#L36)<br><strong>Comment</strong>: <pre>unnecessary in go. len(nil) == 0</pre><strong>Commenter</strong>: Wenjian Qiao - wenjianq@gmail.com<br><strong>CommentLine</strong>: [token/server/msgvalidation.go#L36](https://github.com/hyperledger-gerrit-archive/fabric/blob/b87acb55933673385160c967cb720aa6263d72ac/token/server/msgvalidation.go#L36)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [token/server/proverpeer.go#L19](https://github.com/hyperledger-gerrit-archive/fabric/blob/b87acb55933673385160c967cb720aa6263d72ac/token/server/proverpeer.go#L19)<br><strong>Comment</strong>: <pre>why are we typing these constants? (Need to find the CR where these show up)</pre><strong>Commenter</strong>: Wenjian Qiao - wenjianq@gmail.com<br><strong>CommentLine</strong>: [token/server/proverpeer.go#L19](https://github.com/hyperledger-gerrit-archive/fabric/blob/b87acb55933673385160c967cb720aa6263d72ac/token/server/proverpeer.go#L19)<br><strong>Comment</strong>: <pre>These were introduced in https://gerrit.hyperledger.org/r/#/c/25273/</pre><strong>Commenter</strong>: Angelo De Caro - adc@zurich.ibm.com<br><strong>CommentLine</strong>: [token/server/proverpeer.go#L58](https://github.com/hyperledger-gerrit-archive/fabric/blob/b87acb55933673385160c967cb720aa6263d72ac/token/server/proverpeer.go#L58)<br><strong>Comment</strong>: <pre>Yes, this is an interesting validation we should already perform at https://gerrit.hyperledger.org/r/#/c/25273/</pre></blockquote><h3>PatchSet Number: 3</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Wenjian Qiao - wenjianq@gmail.com<br><strong>Uploader</strong>: Wenjian Qiao - wenjianq@gmail.com<br><strong>Created</strong>: 8/10/2018, 9:46:34 PM<br><strong>UnmergedRevision</strong>: [7f016ff0796fb06a1954de4d60fcda8803b66deb](https://github.com/hyperledger-gerrit-archive/fabric/commit/7f016ff0796fb06a1954de4d60fcda8803b66deb)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 8/10/2018, 9:59:55 PM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 8/10/2018, 9:59:55 PM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 8/10/2018, 10:20:15 PM<br><strong>Type</strong>: F2-SmokeTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 8/10/2018, 10:48:42 PM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 8/10/2018, 10:37:48 PM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 4</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Wenjian Qiao - wenjianq@gmail.com<br><strong>Uploader</strong>: Wenjian Qiao - wenjianq@gmail.com<br><strong>Created</strong>: 8/13/2018, 11:38:10 AM<br><strong>UnmergedRevision</strong>: [a5d136223530a776c0197d23ee5e4474a18f5003](https://github.com/hyperledger-gerrit-archive/fabric/commit/a5d136223530a776c0197d23ee5e4474a18f5003)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 8/13/2018, 11:41:25 AM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 5</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Wenjian Qiao - wenjianq@gmail.com<br><strong>Uploader</strong>: Wenjian Qiao - wenjianq@gmail.com<br><strong>Created</strong>: 8/13/2018, 1:59:40 PM<br><strong>UnmergedRevision</strong>: [664b10d64a59c2ed51bb63fbfc0c3b3d5fcedd90](https://github.com/hyperledger-gerrit-archive/fabric/commit/664b10d64a59c2ed51bb63fbfc0c3b3d5fcedd90)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 8/13/2018, 2:09:13 PM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 8/13/2018, 2:09:13 PM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 8/13/2018, 2:28:07 PM<br><strong>Type</strong>: F2-SmokeTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 8/13/2018, 2:53:32 PM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 8/13/2018, 2:50:20 PM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>Approved</strong>: 8/14/2018, 3:16:36 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [protos/token/proverpeer.proto#L69](https://github.com/hyperledger-gerrit-archive/fabric/blob/664b10d64a59c2ed51bb63fbfc0c3b3d5fcedd90/protos/token/proverpeer.proto#L69)<br><strong>Comment</strong>: <pre>https://developers.google.com/protocol-buffers/docs/style#message-and-field-names

lower case, underscore separated names for fields

That said, I'm pretty sure this is actually going to land in a different CR.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [token/server/msgvalidation.go#L15](https://github.com/hyperledger-gerrit-archive/fabric/blob/664b10d64a59c2ed51bb63fbfc0c3b3d5fcedd90/token/server/msgvalidation.go#L15)<br><strong>Comment</strong>: <pre>This is good. In future CRs, we should considering making this a `Validate() error` function on the token header.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [token/server/proverpeer.go#L149](https://github.com/hyperledger-gerrit-archive/fabric/blob/664b10d64a59c2ed51bb63fbfc0c3b3d5fcedd90/token/server/proverpeer.go#L149)<br><strong>Comment</strong>: <pre>This implementation is racing with what Angelo is doing. There are a number of comments pending on CR 25273 that also apply here since this is building on that.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [token/server/proverpeer.go#L171](https://github.com/hyperledger-gerrit-archive/fabric/blob/664b10d64a59c2ed51bb63fbfc0c3b3d5fcedd90/token/server/proverpeer.go#L171)<br><strong>Comment</strong>: <pre>I'm seeing this function (or its analog) in most CRs. A future CR should extract these conversion/transform blocks into exported functions.

We can decide if we want them to be methods on the structs in the token package or implemented as pure funcs - ultimately depends on who the intended consumers are and if the proto dependency is only needed for this.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [token/server/proverpeer_grpc_test.go#L0](https://github.com/hyperledger-gerrit-archive/fabric/blob/664b10d64a59c2ed51bb63fbfc0c3b3d5fcedd90/token/server/proverpeer_grpc_test.go#L0)<br><strong>Comment</strong>: <pre>We should talk about this. This looks like it wants to be integration test but can't be.

This test is also written in the same style as much of ledger and peer - which is not really a good thing. The knowledge about the setup and the assertions are spread over too much of a surface area and are far too hidden.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [token/server/proverpeer_grpc_test.go#L29](https://github.com/hyperledger-gerrit-archive/fabric/blob/664b10d64a59c2ed51bb63fbfc0c3b3d5fcedd90/token/server/proverpeer_grpc_test.go#L29)<br><strong>Comment</strong>: <pre>nope. use ephemeral ports and 127.0.0.1

Why?
1. Reserved ports eventually conflict with someone - especially on machines that run concurrent builds.
2. Depending on where you're running, "localhost" can resolve as 127.0.0.1 or ::1. In most cases it doesn't matter but, every once in a while, the difference will bite us.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [token/server/proverpeer_grpc_test.go#L56](https://github.com/hyperledger-gerrit-archive/fabric/blob/664b10d64a59c2ed51bb63fbfc0c3b3d5fcedd90/token/server/proverpeer_grpc_test.go#L56)<br><strong>Comment</strong>: <pre>don't listen in inaddrany if you can avoid it. Listen on 127.0.0.1:0, use the returned listener, and get the port that we're bound to.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [token/server/proverpeer_grpc_test.go#L68](https://github.com/hyperledger-gerrit-archive/fabric/blob/664b10d64a59c2ed51bb63fbfc0c3b3d5fcedd90/token/server/proverpeer_grpc_test.go#L68)<br><strong>Comment</strong>: <pre>the "port" arg should have been the address. The address comes from the listener. There's no need to do the string munging.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [token/server/proverpeer_grpc_test.go#L79](https://github.com/hyperledger-gerrit-archive/fabric/blob/664b10d64a59c2ed51bb63fbfc0c3b3d5fcedd90/token/server/proverpeer_grpc_test.go#L79)<br><strong>Comment</strong>: <pre>This isn't a scalable way to build mocks. It's also unfortunate that you're returning the interfaces from what is logically a constructor as we are now missing any way to make assertions against the fakes that we setup.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [token/server/proverpeer_grpc_test.go#L109](https://github.com/hyperledger-gerrit-archive/fabric/blob/664b10d64a59c2ed51bb63fbfc0c3b3d5fcedd90/token/server/proverpeer_grpc_test.go#L109)<br><strong>Comment</strong>: <pre>a hidden hard-coded port.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [token/server/proverpeer_grpc_test.go#L130](https://github.com/hyperledger-gerrit-archive/fabric/blob/664b10d64a59c2ed51bb63fbfc0c3b3d5fcedd90/token/server/proverpeer_grpc_test.go#L130)<br><strong>Comment</strong>: <pre>assertions should be done against literals to avoid false success when the production code modifies types that are passed by reference; byte slices are passed by reference.

This appears to be true everywhere assertSuccessResponse is used.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [token/server/proverpeer_grpc_test.go#L130](https://github.com/hyperledger-gerrit-archive/fabric/blob/664b10d64a59c2ed51bb63fbfc0c3b3d5fcedd90/token/server/proverpeer_grpc_test.go#L130)<br><strong>Comment</strong>: <pre>I don't know where this function is but it's not here - that makes it *really* hard to maintain these tests.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [token/server/proverpeer_grpc_test.go#L170](https://github.com/hyperledger-gerrit-archive/fabric/blob/664b10d64a59c2ed51bb63fbfc0c3b3d5fcedd90/token/server/proverpeer_grpc_test.go#L170)<br><strong>Comment</strong>: <pre>let's talk about using a different matching library.

Expect(err).To(MatchError(ContainSubstring("transactor_wild_error")))
or
Expect(err).To(MatchError(MatchRegex("rpc error:.*transactor_wild_error")))</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [token/server/proverpeer_test.go#L142](https://github.com/hyperledger-gerrit-archive/fabric/blob/664b10d64a59c2ed51bb63fbfc0c3b3d5fcedd90/token/server/proverpeer_test.go#L142)<br><strong>Comment</strong>: <pre>There's a lot of duplication between these test. We should discuss table driven tests or moving to ginkgo.</pre><strong>Commenter</strong>: Matthew Sykes - sykesmat@us.ibm.com<br><strong>CommentLine</strong>: [token/server/tms.go#L35](https://github.com/hyperledger-gerrit-archive/fabric/blob/664b10d64a59c2ed51bb63fbfc0c3b3d5fcedd90/token/server/tms.go#L35)<br><strong>Comment</strong>: <pre>nope. slice; arrays are different in go</pre></blockquote><h3>PatchSet Number: 6</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Wenjian Qiao - wenjianq@gmail.com<br><strong>Uploader</strong>: Wenjian Qiao - wenjianq@gmail.com<br><strong>Created</strong>: 8/15/2018, 11:56:51 PM<br><strong>UnmergedRevision</strong>: [57c3de1095f9a8d7fc1e76f148a66ecfa6f6bb52](https://github.com/hyperledger-gerrit-archive/fabric/commit/57c3de1095f9a8d7fc1e76f148a66ecfa6f6bb52)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 8/16/2018, 12:00:45 AM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 7</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Wenjian Qiao - wenjianq@gmail.com<br><strong>Uploader</strong>: Wenjian Qiao - wenjianq@gmail.com<br><strong>Created</strong>: 8/16/2018, 11:57:21 AM<br><strong>UnmergedRevision</strong>: [ec34b606dfb0f6de1709467b00a22758613bd61f](https://github.com/hyperledger-gerrit-archive/fabric/commit/ec34b606dfb0f6de1709467b00a22758613bd61f)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 8/16/2018, 12:03:46 PM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 8</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Wenjian Qiao - wenjianq@gmail.com<br><strong>Uploader</strong>: Wenjian Qiao - wenjianq@gmail.com<br><strong>Created</strong>: 8/16/2018, 12:37:28 PM<br><strong>UnmergedRevision</strong>: [95d1a0def3532e009830cef19d8eec8120ac7dad](https://github.com/hyperledger-gerrit-archive/fabric/commit/95d1a0def3532e009830cef19d8eec8120ac7dad)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 8/16/2018, 12:45:11 PM<br><strong>Type</strong>: F1-VerifyBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 8/16/2018, 12:45:11 PM<br><strong>Type</strong>: F2-DocBuild<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 8/16/2018, 1:04:45 PM<br><strong>Type</strong>: F2-SmokeTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 8/16/2018, 1:25:29 PM<br><strong>Type</strong>: F3-IntegrationTest<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 8/16/2018, 1:21:38 PM<br><strong>Type</strong>: F3-UnitTest<br><strong>Value</strong>: 1<br><br></blockquote>
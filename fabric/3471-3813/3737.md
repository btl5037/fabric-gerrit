<strong>Project</strong>: fabric<br><strong>Branch</strong>: master<br><strong>ID</strong>: 3737<br><strong>Subject</strong>: [FAB-872] Gossip multiChannel support<br><strong>Status</strong>: MERGED<br><strong>Owner</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Assignee</strong>:<br><strong>Created</strong>: 1/8/2017, 5:46:06 AM<br><strong>LastUpdated</strong>: 1/9/2017, 1:29:47 PM<br><strong>CommitMessage</strong>:<br><pre>[FAB-872] Gossip multiChannel support

This commit links gossip/channel To the gossip implementation, and:
1) Adds routing logic to the gossip dissemination function
   that disseminates messages according to the message channel
   and whether it should be routed only in the organization or not.
2) Changes the gossip.Gossip API to accomodate to multi-channel changes
3) Changes the gossip tests to accomodate to multi-channel environment
4) Adds tests that ensure that peers do NOT get blocks of channels
    they haven't joined them with a JoinChannel invocation.
5) Adds a test that disseminates blocks from all peers to all peers.
6) Since I have lots of tests now, made them run in parallel, to save time

Change-Id: Ibe6ad886def11e18f2be70b80dd19e4e8395b16f
Signed-off-by: Yacov Manevich <yacovm@il.ibm.com>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 1/8/2017, 5:46:06 AM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/8/2017, 5:47:46 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4793/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/8/2017, 5:50:39 AM<br><strong>Message</strong>: <pre>Patch Set 1: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4793/ : FAILURE</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 1/8/2017, 5:53:06 AM<br><strong>Message</strong>: <pre>Uploaded patch set 2.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/8/2017, 5:54:12 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4794/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/8/2017, 5:57:03 AM<br><strong>Message</strong>: <pre>Patch Set 2: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4794/ : FAILURE</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 1/8/2017, 5:57:35 AM<br><strong>Message</strong>: <pre>Uploaded patch set 3.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/8/2017, 5:58:51 AM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4795/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/8/2017, 6:39:14 AM<br><strong>Message</strong>: <pre>Patch Set 3: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4795/ : SUCCESS</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 1/8/2017, 7:07:14 AM<br><strong>Message</strong>: <pre>Patch Set 3:

(2 comments)</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 1/8/2017, 7:29:07 AM<br><strong>Message</strong>: <pre>Uploaded patch set 4.</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 1/8/2017, 7:29:19 AM<br><strong>Message</strong>: <pre>Patch Set 3:

(2 comments)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/8/2017, 7:30:38 AM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4797/</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 1/8/2017, 7:32:32 AM<br><strong>Message</strong>: <pre>Uploaded patch set 5.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/8/2017, 7:33:20 AM<br><strong>Message</strong>: <pre>Patch Set 4: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4797/ : FAILURE</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/8/2017, 7:34:38 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4798/</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 1/8/2017, 7:42:10 AM<br><strong>Message</strong>: <pre>Patch Set 5: Code-Review+1</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/8/2017, 8:11:43 AM<br><strong>Message</strong>: <pre>Patch Set 5: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4798/ : SUCCESS</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 1/9/2017, 3:45:52 AM<br><strong>Message</strong>: <pre>Patch Set 5:

reverify</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 1/9/2017, 3:45:59 AM<br><strong>Message</strong>: <pre>Patch Set 6: Patch Set 5 was rebased</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2017, 3:47:11 AM<br><strong>Message</strong>: <pre>Patch Set 5: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4838/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2017, 3:48:46 AM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4839/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2017, 4:28:49 AM<br><strong>Message</strong>: <pre>Patch Set 5: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4838/ : SUCCESS</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2017, 4:31:35 AM<br><strong>Message</strong>: <pre>Patch Set 6: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4839/ : SUCCESS</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 1/9/2017, 4:48:52 AM<br><strong>Message</strong>: <pre>Uploaded patch set 7.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2017, 4:52:54 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4845/</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 1/9/2017, 4:59:58 AM<br><strong>Message</strong>: <pre>Patch Set 8: Patch Set 7 was rebased</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2017, 5:04:09 AM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4846/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2017, 5:34:53 AM<br><strong>Message</strong>: <pre>Patch Set 8: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4846/ : SUCCESS</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2017, 5:36:32 AM<br><strong>Message</strong>: <pre>Patch Set 7: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4845/ : SUCCESS</pre><strong>Reviewer</strong>: Gabor Hosszu - gabor@digitalasset.com<br><strong>Reviewed</strong>: 1/9/2017, 10:20:27 AM<br><strong>Message</strong>: <pre>Patch Set 8:

(2 comments)</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 1/9/2017, 10:25:10 AM<br><strong>Message</strong>: <pre>Patch Set 8: Code-Review+1</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 1/9/2017, 10:49:04 AM<br><strong>Message</strong>: <pre>Patch Set 8:

(2 comments)</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 1/9/2017, 10:49:56 AM<br><strong>Message</strong>: <pre>Patch Set 8:

(1 comment)</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 1/9/2017, 11:17:58 AM<br><strong>Message</strong>: <pre>Uploaded patch set 9.</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 1/9/2017, 11:18:04 AM<br><strong>Message</strong>: <pre>Patch Set 10: Patch Set 9 was rebased</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 1/9/2017, 11:18:51 AM<br><strong>Message</strong>: <pre>Patch Set 10:

(5 comments)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2017, 11:20:18 AM<br><strong>Message</strong>: <pre>Patch Set 9:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4862/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2017, 11:23:46 AM<br><strong>Message</strong>: <pre>Patch Set 10:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4863/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2017, 12:03:43 PM<br><strong>Message</strong>: <pre>Patch Set 10: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4863/ : SUCCESS</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2017, 12:07:58 PM<br><strong>Message</strong>: <pre>Patch Set 9: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4862/ : SUCCESS</pre><strong>Reviewer</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Reviewed</strong>: 1/9/2017, 12:27:53 PM<br><strong>Message</strong>: <pre>Patch Set 8:

(3 comments)

I have some questions; otherwise LGTM</pre><strong>Reviewer</strong>: Gabor Hosszu - gabor@digitalasset.com<br><strong>Reviewed</strong>: 1/9/2017, 12:32:51 PM<br><strong>Message</strong>: <pre>Patch Set 10: Code-Review+2</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 1/9/2017, 12:39:09 PM<br><strong>Message</strong>: <pre>Patch Set 8:

(3 comments)</pre><strong>Reviewer</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Reviewed</strong>: 1/9/2017, 12:53:19 PM<br><strong>Message</strong>: <pre>Patch Set 10: Code-Review+2</pre><strong>Reviewer</strong>: Gerrit Code Review - gerrit@hyperledger.org<br><strong>Reviewed</strong>: 1/9/2017, 12:53:24 PM<br><strong>Message</strong>: <pre>Change has been successfully merged by Binh Nguyen</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2017, 12:54:09 PM<br><strong>Message</strong>: <pre>Patch Set 10:

Build Started https://jenkins.hyperledger.org/job/fabric-merge-x86_64/692/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/9/2017, 1:29:47 PM<br><strong>Message</strong>: <pre>Patch Set 10:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-merge-x86_64/692/ : SUCCESS</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: YACOVM - YACOVM@il.ibm.com<br><strong>Uploader</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Created</strong>: 1/8/2017, 5:46:06 AM<br><strong>UnmergedRevision</strong>: [469b53736ea6abf83ae9cc4f6a4c6ab958ef9525](https://github.com/hyperledger-gerrit-archive/fabric/commit/469b53736ea6abf83ae9cc4f6a4c6ab958ef9525)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/8/2017, 5:50:39 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: YACOVM - YACOVM@il.ibm.com<br><strong>Uploader</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Created</strong>: 1/8/2017, 5:53:06 AM<br><strong>UnmergedRevision</strong>: [01f32795a4670f9c3a7c4431f07f8e6834c45700](https://github.com/hyperledger-gerrit-archive/fabric/commit/01f32795a4670f9c3a7c4431f07f8e6834c45700)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/8/2017, 5:57:03 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 3</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: YACOVM - YACOVM@il.ibm.com<br><strong>Uploader</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Created</strong>: 1/8/2017, 5:57:35 AM<br><strong>UnmergedRevision</strong>: [3d6a6e7aedd08264e030cfc7d0892dfff32907f3](https://github.com/hyperledger-gerrit-archive/fabric/commit/3d6a6e7aedd08264e030cfc7d0892dfff32907f3)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/8/2017, 6:39:14 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [core/committer/noopssinglechain/client.go#L198](https://github.com/hyperledger-gerrit-archive/fabric/blob/3d6a6e7aedd08264e030cfc7d0892dfff32907f3/core/committer/noopssinglechain/client.go#L198)<br><strong>Comment</strong>: <pre>I think this should be service.GetGossipService().PeersOfChannel(d.chainID)?</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [core/committer/noopssinglechain/client.go#L198](https://github.com/hyperledger-gerrit-archive/fabric/blob/3d6a6e7aedd08264e030cfc7d0892dfff32907f3/core/committer/noopssinglechain/client.go#L198)<br><strong>Comment</strong>: <pre>Oh, right. Thanks.</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/chanstate.go#L68](https://github.com/hyperledger-gerrit-archive/fabric/blob/3d6a6e7aedd08264e030cfc7d0892dfff32907f3/gossip/gossip/chanstate.go#L68)<br><strong>Comment</strong>: <pre>I think this could be simply reduce to:

   return cs.channels[string(chainID)]</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/chanstate.go#L68](https://github.com/hyperledger-gerrit-archive/fabric/blob/3d6a6e7aedd08264e030cfc7d0892dfff32907f3/gossip/gossip/chanstate.go#L68)<br><strong>Comment</strong>: <pre>Indeed much better!</pre></blockquote><h3>PatchSet Number: 4</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: YACOVM - YACOVM@il.ibm.com<br><strong>Uploader</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Created</strong>: 1/8/2017, 7:29:07 AM<br><strong>UnmergedRevision</strong>: [5d9a719043d574672ff2a67dd7f7f30e647c84f4](https://github.com/hyperledger-gerrit-archive/fabric/commit/5d9a719043d574672ff2a67dd7f7f30e647c84f4)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/8/2017, 7:33:20 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 5</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: YACOVM - YACOVM@il.ibm.com<br><strong>Uploader</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Created</strong>: 1/8/2017, 7:32:32 AM<br><strong>UnmergedRevision</strong>: [9547b018f14a6d025a35ffdcb9d6e6a8b260d64d](https://github.com/hyperledger-gerrit-archive/fabric/commit/9547b018f14a6d025a35ffdcb9d6e6a8b260d64d)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/9/2017, 4:28:49 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Approved</strong>: 1/8/2017, 7:42:10 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 6</h3><blockquote><strong>Type</strong>: TRIVIAL_REBASE<br><strong>Author</strong>: YACOVM - YACOVM@il.ibm.com<br><strong>Uploader</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Created</strong>: 1/9/2017, 3:45:59 AM<br><strong>UnmergedRevision</strong>: [8d355d9fcd4cfd964921256e84d810abbe596313](https://github.com/hyperledger-gerrit-archive/fabric/commit/8d355d9fcd4cfd964921256e84d810abbe596313)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/9/2017, 4:31:35 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 7</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: YACOVM - YACOVM@il.ibm.com<br><strong>Uploader</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Created</strong>: 1/9/2017, 4:48:52 AM<br><strong>UnmergedRevision</strong>: [215c660a0605a84b3e7204e489ed326b99966c0e](https://github.com/hyperledger-gerrit-archive/fabric/commit/215c660a0605a84b3e7204e489ed326b99966c0e)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/9/2017, 5:36:32 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 8</h3><blockquote><strong>Type</strong>: TRIVIAL_REBASE<br><strong>Author</strong>: YACOVM - YACOVM@il.ibm.com<br><strong>Uploader</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Created</strong>: 1/9/2017, 4:59:58 AM<br><strong>UnmergedRevision</strong>: [5f4394bc832cdf685d74159e813646af3e27aaf4](https://github.com/hyperledger-gerrit-archive/fabric/commit/5f4394bc832cdf685d74159e813646af3e27aaf4)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/9/2017, 5:34:53 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Approved</strong>: 1/9/2017, 10:25:10 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Gabor Hosszu - gabor@digitalasset.com<br><strong>CommentLine</strong>: [/COMMIT_MSG#L10](https://github.com/hyperledger-gerrit-archive/fabric/blob/5f4394bc832cdf685d74159e813646af3e27aaf4//COMMIT_MSG#L10)<br><strong>Comment</strong>: <pre>1..5, 7 where is number 6? :)</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [/COMMIT_MSG#L10](https://github.com/hyperledger-gerrit-archive/fabric/blob/5f4394bc832cdf685d74159e813646af3e27aaf4//COMMIT_MSG#L10)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [gossip/filter/filter.go#L46](https://github.com/hyperledger-gerrit-archive/fabric/blob/5f4394bc832cdf685d74159e813646af3e27aaf4/gossip/filter/filter.go#L46)<br><strong>Comment</strong>: <pre><= k is better...says if the size is right don't randomize.

Will note that this works as written - thanks for the clarification on GetRandomIndices-  we just don't have to randomize if == k</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/filter/filter.go#L46](https://github.com/hyperledger-gerrit-archive/fabric/blob/5f4394bc832cdf685d74159e813646af3e27aaf4/gossip/filter/filter.go#L46)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Gabor Hosszu - gabor@digitalasset.com<br><strong>CommentLine</strong>: [gossip/filter/filter.go#L58](https://github.com/hyperledger-gerrit-archive/fabric/blob/5f4394bc832cdf685d74159e813646af3e27aaf4/gossip/filter/filter.go#L58)<br><strong>Comment</strong>: <pre>here, CombineRoutingFilters could be called instead of this loop</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/filter/filter.go#L58](https://github.com/hyperledger-gerrit-archive/fabric/blob/5f4394bc832cdf685d74159e813646af3e27aaf4/gossip/filter/filter.go#L58)<br><strong>Comment</strong>: <pre>Good idea. Done</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [gossip/gossip/batcher.go#L50](https://github.com/hyperledger-gerrit-archive/fabric/blob/5f4394bc832cdf685d74159e813646af3e27aaf4/gossip/gossip/batcher.go#L50)<br><strong>Comment</strong>: <pre>Just wonder why should we panic here but not default it to 0 or any other sensible value? However, if we really have to exit the peer because of something irrecoverable at this point, then that is fine.</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/batcher.go#L50](https://github.com/hyperledger-gerrit-archive/fabric/blob/5f4394bc832cdf685d74159e813646af3e27aaf4/gossip/gossip/batcher.go#L50)<br><strong>Comment</strong>: <pre>0 isn't a sensible value, it would slow gossip considerably. 
I think that if a person configured the peer incorrectly, and the panic message emits a meaningful reason such as this, it's good enough.</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [gossip/gossip/chanstate.go#L73](https://github.com/hyperledger-gerrit-archive/fabric/blob/5f4394bc832cdf685d74159e813646af3e27aaf4/gossip/gossip/chanstate.go#L73)<br><strong>Comment</strong>: <pre>chainID is defined in protos/common as string, so you should consider changing to string next iteration of gossip/common to avoid this</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/chanstate.go#L73](https://github.com/hyperledger-gerrit-archive/fabric/blob/5f4394bc832cdf685d74159e813646af3e27aaf4/gossip/gossip/chanstate.go#L73)<br><strong>Comment</strong>: <pre>Will consider, thanks.</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [gossip/gossip/gossip_impl.go#L324](https://github.com/hyperledger-gerrit-archive/fabric/blob/5f4394bc832cdf685d74159e813646af3e27aaf4/gossip/gossip/gossip_impl.go#L324)<br><strong>Comment</strong>: <pre>I am assuming that this blockMsg is an internal gossip message, not the block from orderer. Otherwise, this logic should not be here. Please confirm.</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/gossip/gossip_impl.go#L324](https://github.com/hyperledger-gerrit-archive/fabric/blob/5f4394bc832cdf685d74159e813646af3e27aaf4/gossip/gossip/gossip_impl.go#L324)<br><strong>Comment</strong>: <pre>it's a gossip message that carries a block.
The Payload field is a wrapper to the block. This message says that we got a gossip message that is supposed to contain a block, but it has no block inside of it.</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [gossip/integration/integration.go#L35](https://github.com/hyperledger-gerrit-archive/fabric/blob/5f4394bc832cdf685d74159e813646af3e27aaf4/gossip/integration/integration.go#L35)<br><strong>Comment</strong>: <pre>perhaps a more descriptive name than ORG1 to indicate this is temporary ?</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/integration/integration.go#L35](https://github.com/hyperledger-gerrit-archive/fabric/blob/5f4394bc832cdf685d74159e813646af3e27aaf4/gossip/integration/integration.go#L35)<br><strong>Comment</strong>: <pre>I added a comment, the channel name isn't that important.</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [gossip/service/gossip_service.go#L124](https://github.com/hyperledger-gerrit-archive/fabric/blob/5f4394bc832cdf685d74159e813646af3e27aaf4/gossip/service/gossip_service.go#L124)<br><strong>Comment</strong>: <pre>Understand this is not part of the changeset...but seems like this method shoukd have debug message...</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/service/gossip_service.go#L124](https://github.com/hyperledger-gerrit-archive/fabric/blob/5f4394bc832cdf685d74159e813646af3e27aaf4/gossip/service/gossip_service.go#L124)<br><strong>Comment</strong>: <pre>Added an INFO one</pre></blockquote><h3>PatchSet Number: 9</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: YACOVM - YACOVM@il.ibm.com<br><strong>Uploader</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Created</strong>: 1/9/2017, 11:17:58 AM<br><strong>UnmergedRevision</strong>: [6cadfd322a944cfcb23df7f1a4a6e489fb065ce0](https://github.com/hyperledger-gerrit-archive/fabric/commit/6cadfd322a944cfcb23df7f1a4a6e489fb065ce0)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/9/2017, 12:07:58 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 10</h3><blockquote><strong>Type</strong>: TRIVIAL_REBASE<br><strong>Author</strong>: YACOVM - YACOVM@il.ibm.com<br><strong>Uploader</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Created</strong>: 1/9/2017, 11:18:04 AM<br><strong>GitHubMergedRevision</strong>: [fdf2f7ad409cd820daabe2440b54860e1f9fcae7](https://github.com/hyperledger-gerrit-archive/fabric/commit/fdf2f7ad409cd820daabe2440b54860e1f9fcae7)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/9/2017, 12:03:43 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Gabor Hosszu - gabor@digitalasset.com<br><strong>Approved</strong>: 1/9/2017, 12:32:51 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Approved</strong>: 1/9/2017, 12:53:19 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>MergedBy</strong>: Binh Nguyen<br><strong>Merged</strong>: 1/9/2017, 12:53:24 PM<br><br></blockquote>
<strong>Project</strong>: fabric<br><strong>Branch</strong>: master<br><strong>ID</strong>: 3209<br><strong>Subject</strong>: FAB-1357 simpl. cc API param passing using a ctxt obj<br><strong>Status</strong>: MERGED<br><strong>Owner</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Assignee</strong>:<br><strong>Created</strong>: 12/12/2016, 12:43:29 AM<br><strong>LastUpdated</strong>: 12/12/2016, 4:56:39 PM<br><strong>CommitMessage</strong>:<br><pre>FAB-1357 simpl. cc API param passing using a ctxt obj

https://jira.hyperledger.org/browse/FAB-1357

List of parameters to many of the chaincode APIs is growing
   . chaincode name
   . chain ID
   . version (needed for upgrade)
   . Proposal
   . txid

Before getting into the meat of upgrade, simplify the APIs
using a CCContext structure. In addition to cleaning and
simplifying APIs, this will make the upgrade CR easier to
follow

Change-Id: Ic7ea5f4e082d347cda3072fc2e39077006d866c1
Signed-off-by: Srinivasan Muralidharan <muralisr@us.ibm.com>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 12/12/2016, 12:43:29 AM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/12/2016, 12:45:49 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3902/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/12/2016, 1:14:29 AM<br><strong>Message</strong>: <pre>Patch Set 1: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3902/ : SUCCESS</pre><strong>Reviewer</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Reviewed</strong>: 12/12/2016, 11:25:25 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(2 comments)</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 12/12/2016, 12:01:13 PM<br><strong>Message</strong>: <pre>Patch Set 1:

(2 comments)</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 12/12/2016, 12:05:29 PM<br><strong>Message</strong>: <pre>Uploaded patch set 2.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/12/2016, 12:09:47 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3956/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/12/2016, 12:40:17 PM<br><strong>Message</strong>: <pre>Patch Set 2: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3956/ : SUCCESS</pre><strong>Reviewer</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Reviewed</strong>: 12/12/2016, 1:13:18 PM<br><strong>Message</strong>: <pre>Patch Set 2: Code-Review+2</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 12/12/2016, 4:09:38 PM<br><strong>Message</strong>: <pre>Patch Set 2: Code-Review+1

(2 comments)

+1 but had a few comments / questions</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 12/12/2016, 4:25:17 PM<br><strong>Message</strong>: <pre>Patch Set 2:

(2 comments)</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 12/12/2016, 4:27:25 PM<br><strong>Message</strong>: <pre>Patch Set 2: Code-Review+2

(2 comments)</pre><strong>Reviewer</strong>: Gerrit Code Review - gerrit@hyperledger.org<br><strong>Reviewed</strong>: 12/12/2016, 4:27:29 PM<br><strong>Message</strong>: <pre>Change has been successfully merged by Gari Singh</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/12/2016, 4:30:48 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-merge-x86_64/555/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/12/2016, 4:56:39 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-merge-x86_64/555/ : FAILURE</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Srinivasan Muralidharan - muralisr@us.ibm.com<br><strong>Uploader</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Created</strong>: 12/12/2016, 12:43:29 AM<br><strong>UnmergedRevision</strong>: [4b3ea229bb8d92da6a0e012ed2c563b086c23c1b](https://github.com/hyperledger-gerrit-archive/fabric/commit/4b3ea229bb8d92da6a0e012ed2c563b086c23c1b)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/12/2016, 1:14:29 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [core/chaincode/chaincode_support.go#L90](https://github.com/hyperledger-gerrit-archive/fabric/blob/4b3ea229bb8d92da6a0e012ed2c563b086c23c1b/core/chaincode/chaincode_support.go#L90)<br><strong>Comment</strong>: <pre>this is a nit, but should probably make this "canonicalName" to make it clearer?</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [core/chaincode/chaincode_support.go#L90](https://github.com/hyperledger-gerrit-archive/fabric/blob/4b3ea229bb8d92da6a0e012ed2c563b086c23c1b/core/chaincode/chaincode_support.go#L90)<br><strong>Comment</strong>: <pre>That's what I should have done... :-) Can I do that in the next CR please ?</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [core/chaincode/chaincode_support.go#L96](https://github.com/hyperledger-gerrit-archive/fabric/blob/4b3ea229bb8d92da6a0e012ed2c563b086c23c1b/core/chaincode/chaincode_support.go#L96)<br><strong>Comment</strong>: <pre>Shouldn't we default to a version to make it easier? ie version = 1.00</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [core/chaincode/chaincode_support.go#L96](https://github.com/hyperledger-gerrit-archive/fabric/blob/4b3ea229bb8d92da6a0e012ed2c563b086c23c1b/core/chaincode/chaincode_support.go#L96)<br><strong>Comment</strong>: <pre>Good point... I did check my next CR in the works on Upgrade and it always uses a non empty version (even for invokes).  In that CR, I'll also panic if version is empty.</pre><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [core/chaincode/chaincode_support.go#L96](https://github.com/hyperledger-gerrit-archive/fabric/blob/4b3ea229bb8d92da6a0e012ed2c563b086c23c1b/core/chaincode/chaincode_support.go#L96)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [core/chaincode/lccc.go#L292](https://github.com/hyperledger-gerrit-archive/fabric/blob/4b3ea229bb8d92da6a0e012ed2c563b086c23c1b/core/chaincode/lccc.go#L292)<br><strong>Comment</strong>: <pre>I don't follow this one. Transaction ID is generated by the app/sdk.</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [core/chaincode/lccc.go#L292](https://github.com/hyperledger-gerrit-archive/fabric/blob/4b3ea229bb8d92da6a0e012ed2c563b086c23c1b/core/chaincode/lccc.go#L292)<br><strong>Comment</strong>: <pre>This is old comment and misleading. Note that later down the code you'll see deploy() is not called in lccc but in the endorser. So this code is not excercised. I left it in here as a reminder that the clean way (or at least an alternative way) would be to deploy from lccc itself.
I'll remove the comment.</pre><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [core/chaincode/multichains_test.go#L44](https://github.com/hyperledger-gerrit-archive/fabric/blob/4b3ea229bb8d92da6a0e012ed2c563b086c23c1b/core/chaincode/multichains_test.go#L44)<br><strong>Comment</strong>: <pre>is this just to prove that the API basically works?  At some when chains are fully implemented I imagine you'll need to actually make sure you invoked against the correct chain?</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [core/chaincode/multichains_test.go#L44](https://github.com/hyperledger-gerrit-archive/fabric/blob/4b3ea229bb8d92da6a0e012ed2c563b086c23c1b/core/chaincode/multichains_test.go#L44)<br><strong>Comment</strong>: <pre>Correct, this is just to test multichain from the chaincode framework (outside of endorser etc)..basically created many ledgers and run chaincodes on them. This goes through (1) multi ledger creation (2) syscc setup for each chain (3) creating images and containers for each chaincode on the chain and (4) running invoke against them.

The next CR (for upgrade) will also add version.</pre><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [core/chaincode/multichains_test.go#L44](https://github.com/hyperledger-gerrit-archive/fabric/blob/4b3ea229bb8d92da6a0e012ed2c563b086c23c1b/core/chaincode/multichains_test.go#L44)<br><strong>Comment</strong>: <pre>Done</pre></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Srinivasan Muralidharan - muralisr@us.ibm.com<br><strong>Uploader</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Created</strong>: 12/12/2016, 12:05:29 PM<br><strong>GitHubMergedRevision</strong>: [7f5184037fe522784303e620334edd8991e713fb](https://github.com/hyperledger-gerrit-archive/fabric/commit/7f5184037fe522784303e620334edd8991e713fb)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/12/2016, 12:40:17 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Approved</strong>: 12/12/2016, 1:13:18 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Approved</strong>: 12/12/2016, 4:27:25 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>MergedBy</strong>: Gari Singh<br><strong>Merged</strong>: 12/12/2016, 4:27:29 PM<br><br></blockquote>
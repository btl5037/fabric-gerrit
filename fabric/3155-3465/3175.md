<strong>Project</strong>: fabric<br><strong>Branch</strong>: master<br><strong>ID</strong>: 3175<br><strong>Subject</strong>: [FAB-1288]: Expose gossip API for cscc.<br><strong>Status</strong>: MERGED<br><strong>Owner</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Assignee</strong>:<br><strong>Created</strong>: 12/11/2016, 8:31:51 AM<br><strong>LastUpdated</strong>: 12/12/2016, 11:41:52 AM<br><strong>CommitMessage</strong>:<br><pre>[FAB-1288]: Expose gossip API for cscc.

Add gossip service entity to encapsulate gossip + state instance.
Make service instance a singelton and add JoinChannel method so
cscc will be able to leverage it.

Change-Id: I38233781276d538f861e472a427a1df12887c887
Signed-off-by: Artem Barger <bartem@il.ibm.com>
Signed-off-by: Yacov Manevich <yacovm@il.ibm.com>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 12/11/2016, 8:31:51 AM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 12/11/2016, 8:56:26 AM<br><strong>Message</strong>: <pre>Patch Set 1:

reverify</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 12/11/2016, 9:17:16 AM<br><strong>Message</strong>: <pre>Patch Set 1: Code-Review-1

(4 comments)</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 12/11/2016, 9:22:32 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(5 comments)</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 12/11/2016, 9:37:59 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(9 comments)</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 12/11/2016, 9:39:01 AM<br><strong>Message</strong>: <pre>Uploaded patch set 2.</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 12/11/2016, 9:49:04 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(2 comments)</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 12/11/2016, 9:50:00 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(1 comment)</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 12/11/2016, 9:54:05 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(1 comment)</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 12/11/2016, 9:59:58 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(1 comment)</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 12/11/2016, 10:05:10 AM<br><strong>Message</strong>: <pre>Patch Set 2: Code-Review-1

(2 comments)</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 12/11/2016, 10:19:19 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(2 comments)</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 12/11/2016, 10:26:22 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(1 comment)</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 12/11/2016, 10:38:50 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(1 comment)</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 12/11/2016, 11:10:53 AM<br><strong>Message</strong>: <pre>Patch Set 2:

(1 comment)

reverify</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/11/2016, 12:23:21 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3842/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/11/2016, 12:23:59 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3844/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/11/2016, 12:25:33 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3848/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/11/2016, 12:29:09 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3860/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/11/2016, 12:45:57 PM<br><strong>Message</strong>: <pre>Patch Set 1: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3844/ : FAILURE</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/11/2016, 12:45:59 PM<br><strong>Message</strong>: <pre>Patch Set 2: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3848/ : FAILURE</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/11/2016, 12:46:50 PM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3842/ : FAILURE</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/11/2016, 12:48:59 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3860/ : FAILURE</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/11/2016, 3:00:06 PM<br><strong>Message</strong>: <pre>Patch Set 2: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3872/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/11/2016, 3:03:24 PM<br><strong>Message</strong>: <pre>Patch Set 2: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3872/ : FAILURE</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 12/11/2016, 5:55:30 PM<br><strong>Message</strong>: <pre>Uploaded patch set 3.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/11/2016, 5:59:10 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3878/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/11/2016, 6:02:20 PM<br><strong>Message</strong>: <pre>Patch Set 3: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3878/ : FAILURE</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 12/11/2016, 6:12:16 PM<br><strong>Message</strong>: <pre>Patch Set 1:

(1 comment)</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 12/11/2016, 6:13:35 PM<br><strong>Message</strong>: <pre>Uploaded patch set 4.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/11/2016, 6:16:11 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3879/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/11/2016, 6:19:06 PM<br><strong>Message</strong>: <pre>Patch Set 4: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3879/ : FAILURE</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 12/11/2016, 6:57:10 PM<br><strong>Message</strong>: <pre>Uploaded patch set 5.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/11/2016, 6:58:15 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3881/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/11/2016, 7:01:09 PM<br><strong>Message</strong>: <pre>Patch Set 5: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3881/ : FAILURE</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 12/12/2016, 2:29:31 AM<br><strong>Message</strong>: <pre>Uploaded patch set 6.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/12/2016, 2:34:11 AM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3913/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/12/2016, 2:39:33 AM<br><strong>Message</strong>: <pre>Patch Set 6: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3913/ : FAILURE</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 12/12/2016, 3:07:10 AM<br><strong>Message</strong>: <pre>Uploaded patch set 7.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/12/2016, 3:10:49 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3916/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/12/2016, 3:44:24 AM<br><strong>Message</strong>: <pre>Patch Set 7: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3916/ : SUCCESS</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 12/12/2016, 6:20:49 AM<br><strong>Message</strong>: <pre>Patch Set 7: Code-Review-1

please see comment here:   https://jira.hyperledger.org/browse/FAB-1288?focusedCommentId=20063&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-20063

I am giving this a -1 for now because there is no way to tell whether or not this meets the intended design as I don't know the intended design</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 12/12/2016, 7:26:18 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Well, since no new functionality was added and the whole indent of current CR was to expose gossip to upper layers in form of singleton. 

Also please see my explanations in FAB-1288.</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 12/12/2016, 7:29:19 AM<br><strong>Message</strong>: <pre>Patch Set 7: -Code-Review

I'll remove my -1 for now given Artem's comment.  I added an additional comment to the related JIRA entry.  I feel things are going to get confusing fast here - but maybe that's just me</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 12/12/2016, 8:11:36 AM<br><strong>Message</strong>: <pre>Patch Set 7:

> I'll remove my -1 for now given Artem's comment.  I added an
 > additional comment to the related JIRA entry.  I feel things are
 > going to get confusing fast here - but maybe that's just me

Good point Gari... also let me add this. https://jira.hyperledger.org/browse/FAB-1038 deals with where Gossip leaves and committer begins. Currently Gossip is responsible for calling committer as the layer responsible for handling blocks from orderer. With JoinChannel gossip exposes the reverse flow - from peer to gossip. It would be nice to have diagram of all the interactions of gossip (correct me if wrong  Artem .. this is what I think you suggest in 1288 I think ?) ... will also note this in that JIRA</pre><strong>Reviewer</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Reviewed</strong>: 12/12/2016, 8:23:28 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Yes, Murali you are correct, already added diagram clarifying this into FAB and also point to JIRA item you just mentioned.</pre><strong>Reviewer</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Reviewed</strong>: 12/12/2016, 9:57:44 AM<br><strong>Message</strong>: <pre>Patch Set 7: Code-Review+2

(1 comment)

I m fine getting this code in to integrate today since gossip already connects with orderer. If we encounter issues, we can comment out calls into other more complex gossip functions to get the base working.</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 12/12/2016, 11:03:34 AM<br><strong>Message</strong>: <pre>Patch Set 7: Code-Review+2

Based, on Gari's, Binh's comments and Artems notes on relevant notes on JIRA indicating follow up work (re comments with Yacov and Gari), LGTM.</pre><strong>Reviewer</strong>: Gerrit Code Review - gerrit@hyperledger.org<br><strong>Reviewed</strong>: 12/12/2016, 11:03:43 AM<br><strong>Message</strong>: <pre>Change has been successfully merged by Srinivasan Muralidharan</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/12/2016, 11:06:07 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-merge-x86_64/547/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/12/2016, 11:41:52 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-merge-x86_64/547/ : SUCCESS</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Uploader</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Created</strong>: 12/11/2016, 8:31:51 AM<br><strong>UnmergedRevision</strong>: [e4f933ea5dcb0b84852b0aa446641fe4e9edb7f8](https://github.com/hyperledger-gerrit-archive/fabric/commit/e4f933ea5dcb0b84852b0aa446641fe4e9edb7f8)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/11/2016, 12:45:57 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Approved</strong>: 12/11/2016, 9:17:16 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/service/gossip_service.go#L43](https://github.com/hyperledger-gerrit-archive/fabric/blob/e4f933ea5dcb0b84852b0aa446641fe4e9edb7f8/gossip/service/gossip_service.go#L43)<br><strong>Comment</strong>: <pre>I don't think it's a good idea to include this gossip.Gossip interface inside GossipService.
gossip/state/state.go uses this gossip.Gossip.
IMO we should decouple internal APIs from "public" APIs (public as in the peer is external to gossip).
Unless we can support all method invocations of gossip.Gossip and they have a reason to invoke the methods defined there, this gossip.Gossip should not be a part of GossipService.</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/service/gossip_service.go#L43](https://github.com/hyperledger-gerrit-archive/fabric/blob/e4f933ea5dcb0b84852b0aa446641fe4e9edb7f8/gossip/service/gossip_service.go#L43)<br><strong>Comment</strong>: <pre>Currently my main goal is to make this change as less intrusive as possible, hence I'd like to keep GossipService instance interchangeable with gossip.Gossip instance, by actually decorating it.</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/service/gossip_service.go#L43](https://github.com/hyperledger-gerrit-archive/fabric/blob/e4f933ea5dcb0b84852b0aa446641fe4e9edb7f8/gossip/service/gossip_service.go#L43)<br><strong>Comment</strong>: <pre>That's exactly my point. I don't think it should be interchangeable at all. The peer has no reason currently to use any of the methods of gossip.Gossip:
- Send,Gossip and Accept all use *proto.GossipMessage and there is no type that we support that can be sent anywhere. If in the future there will be need for such a thing, I think this should be discussed and added in a separate commit that declares this need and reasoning should be mentioned in JIRa.
- GetPeers() - who uses this?
- UpdateMetadata() is currently called by gossip/state, so who can use this in the peer layer?</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/service/gossip_service.go#L43](https://github.com/hyperledger-gerrit-archive/fabric/blob/e4f933ea5dcb0b84852b0aa446641fe4e9edb7f8/gossip/service/gossip_service.go#L43)<br><strong>Comment</strong>: <pre>GossipService doesn't add anything new or expose any additional API's, the only thing it does is encapsulates gossip + state layer and provides exactly same capabilities as public gossip API, which by the way already available.

As I said this commit aims to be non intrusive and only provide the CSCC ability to interact with gossip layer.

To your point I believe that public gossip API is also need to be refactored and methods such:

* GetPeers
* UpdateMetadata

abstracted out, but this IMO should be handled separately.</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/service/gossip_service.go#L43](https://github.com/hyperledger-gerrit-archive/fabric/blob/e4f933ea5dcb0b84852b0aa446641fe4e9edb7f8/gossip/service/gossip_service.go#L43)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/service/gossip_service.go#L43](https://github.com/hyperledger-gerrit-archive/fabric/blob/e4f933ea5dcb0b84852b0aa446641fe4e9edb7f8/gossip/service/gossip_service.go#L43)<br><strong>Comment</strong>: <pre>I think you've raised an important point, so to follow up on it I've created new JIRA story: https://jira.hyperledger.org/browse/FAB-1356.</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/service/gossip_service.go#L46](https://github.com/hyperledger-gerrit-archive/fabric/blob/e4f933ea5dcb0b84852b0aa446641fe4e9edb7f8/gossip/service/gossip_service.go#L46)<br><strong>Comment</strong>: <pre>committer</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/service/gossip_service.go#L46](https://github.com/hyperledger-gerrit-archive/fabric/blob/e4f933ea5dcb0b84852b0aa446641fe4e9edb7f8/gossip/service/gossip_service.go#L46)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/service/gossip_service.go#L48](https://github.com/hyperledger-gerrit-archive/fabric/blob/e4f933ea5dcb0b84852b0aa446641fe4e9edb7f8/gossip/service/gossip_service.go#L48)<br><strong>Comment</strong>: <pre>Do we need this method?</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/service/gossip_service.go#L48](https://github.com/hyperledger-gerrit-archive/fabric/blob/e4f933ea5dcb0b84852b0aa446641fe4e9edb7f8/gossip/service/gossip_service.go#L48)<br><strong>Comment</strong>: <pre>In case you'd like to get block from the ledger I guess you will need it,</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/service/gossip_service.go#L48](https://github.com/hyperledger-gerrit-archive/fabric/blob/e4f933ea5dcb0b84852b0aa446641fe4e9edb7f8/gossip/service/gossip_service.go#L48)<br><strong>Comment</strong>: <pre>Can't they just go to the ledger for that?</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/service/gossip_service.go#L48](https://github.com/hyperledger-gerrit-archive/fabric/blob/e4f933ea5dcb0b84852b0aa446641fe4e9edb7f8/gossip/service/gossip_service.go#L48)<br><strong>Comment</strong>: <pre>Ledger is encapsulated into committer and committer into gossip state layer.</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/service/gossip_service.go#L50](https://github.com/hyperledger-gerrit-archive/fabric/blob/e4f933ea5dcb0b84852b0aa446641fe4e9edb7f8/gossip/service/gossip_service.go#L50)<br><strong>Comment</strong>: <pre>I'm not sure that's the best name for what this method is doing. The word "payload" doesn't mean anything to the one using this object.</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/service/gossip_service.go#L50](https://github.com/hyperledger-gerrit-archive/fabric/blob/e4f933ea5dcb0b84852b0aa446641fe4e9edb7f8/gossip/service/gossip_service.go#L50)<br><strong>Comment</strong>: <pre>I agree, but this aligned with methods names in GossipStateProvider, hence I'd like to take naming refactoring out of the scope of current commit.</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/service/gossip_service.go#L50](https://github.com/hyperledger-gerrit-archive/fabric/blob/e4f933ea5dcb0b84852b0aa446641fe4e9edb7f8/gossip/service/gossip_service.go#L50)<br><strong>Comment</strong>: <pre>Please refer to JIRA: https://jira.hyperledger.org/browse/FAB-1354 to follow up on your comment here.</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [gossip/service/gossip_service.go#L95](https://github.com/hyperledger-gerrit-archive/fabric/blob/e4f933ea5dcb0b84852b0aa446641fe4e9edb7f8/gossip/service/gossip_service.go#L95)<br><strong>Comment</strong>: <pre>Unmarshal should be encapsulated by functions and put into fabric/protos/utils. In fact there may be functions for these there (check out ExtractEnvelope* there please).</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/service/gossip_service.go#L95](https://github.com/hyperledger-gerrit-archive/fabric/blob/e4f933ea5dcb0b84852b0aa446641fe4e9edb7f8/gossip/service/gossip_service.go#L95)<br><strong>Comment</strong>: <pre>Yes, you are right, but since there is a pending work from Binh, which already doing that, see https://gerrit.hyperledger.org/r/#/c/2697/2/protos/utils/blockutils.go, I wrote here a place holder keeping in mind to refactor it, once 2697 will be merged.</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [gossip/service/gossip_service.go#L95](https://github.com/hyperledger-gerrit-archive/fabric/blob/e4f933ea5dcb0b84852b0aa446641fe4e9edb7f8/gossip/service/gossip_service.go#L95)<br><strong>Comment</strong>: <pre>In that case can we open a JIRA for that so it doesn't get lost please ?</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/service/gossip_service.go#L95](https://github.com/hyperledger-gerrit-archive/fabric/blob/e4f933ea5dcb0b84852b0aa446641fe4e9edb7f8/gossip/service/gossip_service.go#L95)<br><strong>Comment</strong>: <pre>Not sure, it worth open JIRA to address an issue with not yet committed code. Probably a comment will do it?</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/service/gossip_service.go#L95](https://github.com/hyperledger-gerrit-archive/fabric/blob/e4f933ea5dcb0b84852b0aa446641fe4e9edb7f8/gossip/service/gossip_service.go#L95)<br><strong>Comment</strong>: <pre>https://jira.hyperledger.org/browse/FAB-1355</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [gossip/service/gossip_service.go#L96](https://github.com/hyperledger-gerrit-archive/fabric/blob/e4f933ea5dcb0b84852b0aa446641fe4e9edb7f8/gossip/service/gossip_service.go#L96)<br><strong>Comment</strong>: <pre>Can a chain be an empty string?</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/service/gossip_service.go#L96](https://github.com/hyperledger-gerrit-archive/fabric/blob/e4f933ea5dcb0b84852b0aa446641fe4e9edb7f8/gossip/service/gossip_service.go#L96)<br><strong>Comment</strong>: <pre>No, I do not think it could be an empty string, will add a check.</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [gossip/service/gossip_service_test.go#L28](https://github.com/hyperledger-gerrit-archive/fabric/blob/e4f933ea5dcb0b84852b0aa446641fe4e9edb7f8/gossip/service/gossip_service_test.go#L28)<br><strong>Comment</strong>: <pre>dont we need tests for JoinChannel ?</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [gossip/service/gossip_service_test.go#L28](https://github.com/hyperledger-gerrit-archive/fabric/blob/e4f933ea5dcb0b84852b0aa446641fe4e9edb7f8/gossip/service/gossip_service_test.go#L28)<br><strong>Comment</strong>: <pre>Right now JoinChannel is only a stub, once gossip will deliver support for multi chain appropriate test will be added. Currently JoinChannel exposed to allow to write flows for CSCC.</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [peer/node/start.go#L176](https://github.com/hyperledger-gerrit-archive/fabric/blob/e4f933ea5dcb0b84852b0aa446641fe4e9edb7f8/peer/node/start.go#L176)<br><strong>Comment</strong>: <pre>I'd also add a comment - now that we have clearly separated the gossip deliver side - that this section would go away from start and into CSCC ?</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [peer/node/start.go#L176](https://github.com/hyperledger-gerrit-archive/fabric/blob/e4f933ea5dcb0b84852b0aa446641fe4e9edb7f8/peer/node/start.go#L176)<br><strong>Comment</strong>: <pre>Yes, I think so.</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [peer/node/start.go#L186](https://github.com/hyperledger-gerrit-archive/fabric/blob/e4f933ea5dcb0b84852b0aa446641fe4e9edb7f8/peer/node/start.go#L186)<br><strong>Comment</strong>: <pre>Can we look at err from JoinChannel and return with a comment to the effect "Is orderer running and visible from this peer ?"</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [peer/node/start.go#L186](https://github.com/hyperledger-gerrit-archive/fabric/blob/e4f933ea5dcb0b84852b0aa446641fe4e9edb7f8/peer/node/start.go#L186)<br><strong>Comment</strong>: <pre>Right now, it will exit with panic in case of failure.</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [peer/node/start.go#L186](https://github.com/hyperledger-gerrit-archive/fabric/blob/e4f933ea5dcb0b84852b0aa446641fe4e9edb7f8/peer/node/start.go#L186)<br><strong>Comment</strong>: <pre>Hmmm, I don't see a panic in JoinChannel...am I missing something ?</pre><strong>Commenter</strong>: Artem Barger - bartem@il.ibm.com<br><strong>CommentLine</strong>: [peer/node/start.go#L186](https://github.com/hyperledger-gerrit-archive/fabric/blob/e4f933ea5dcb0b84852b0aa446641fe4e9edb7f8/peer/node/start.go#L186)<br><strong>Comment</strong>: <pre>DeliveryService is implemented inside client.go, at lines 153-156, there is JoinChannel implementation, specifically I'm referring to line: 155.</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [peer/node/start.go#L186](https://github.com/hyperledger-gerrit-archive/fabric/blob/e4f933ea5dcb0b84852b0aa446641fe4e9edb7f8/peer/node/start.go#L186)<br><strong>Comment</strong>: <pre>Thanks I was looking at the wrong JoinChannel... looks right now.</pre></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Uploader</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Created</strong>: 12/11/2016, 9:39:01 AM<br><strong>UnmergedRevision</strong>: [778e20879e8db36ef5574ed8a32282358882890c](https://github.com/hyperledger-gerrit-archive/fabric/commit/778e20879e8db36ef5574ed8a32282358882890c)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/11/2016, 3:03:24 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Approved</strong>: 12/11/2016, 10:05:10 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 3</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Uploader</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Created</strong>: 12/11/2016, 5:55:30 PM<br><strong>UnmergedRevision</strong>: [5f976c0ec846c1f5846ee180bd655971d10da95b](https://github.com/hyperledger-gerrit-archive/fabric/commit/5f976c0ec846c1f5846ee180bd655971d10da95b)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/11/2016, 6:02:20 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 4</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Uploader</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Created</strong>: 12/11/2016, 6:13:35 PM<br><strong>UnmergedRevision</strong>: [e045847a71ee619c39e6b5c819b5ef1316d9675d](https://github.com/hyperledger-gerrit-archive/fabric/commit/e045847a71ee619c39e6b5c819b5ef1316d9675d)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/11/2016, 6:19:06 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 5</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Uploader</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Created</strong>: 12/11/2016, 6:57:10 PM<br><strong>UnmergedRevision</strong>: [b0797574ace7d23dcfcf574f8beaf686012f2f7d](https://github.com/hyperledger-gerrit-archive/fabric/commit/b0797574ace7d23dcfcf574f8beaf686012f2f7d)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/11/2016, 7:01:09 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 6</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Uploader</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Created</strong>: 12/12/2016, 2:29:31 AM<br><strong>UnmergedRevision</strong>: [1ab33503c2e5843ba912b42fd894abbaa89bd8d9](https://github.com/hyperledger-gerrit-archive/fabric/commit/1ab33503c2e5843ba912b42fd894abbaa89bd8d9)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/12/2016, 2:39:33 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 7</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Artem Barger - bartem@il.ibm.com<br><strong>Uploader</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Created</strong>: 12/12/2016, 3:07:10 AM<br><strong>GitHubMergedRevision</strong>: [8417c0ec8c268677e87e28ccefd2301305c1ef43](https://github.com/hyperledger-gerrit-archive/fabric/commit/8417c0ec8c268677e87e28ccefd2301305c1ef43)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/12/2016, 3:44:24 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Approved</strong>: 12/12/2016, 9:57:44 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Approved</strong>: 12/12/2016, 11:03:34 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>MergedBy</strong>: Srinivasan Muralidharan<br><strong>Merged</strong>: 12/12/2016, 11:03:43 AM<br><br><h2>Comments</h2><strong>Commenter</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>CommentLine</strong>: [peer/node/start.go#L185](https://github.com/hyperledger-gerrit-archive/fabric/blob/8417c0ec8c268677e87e28ccefd2301305c1ef43/peer/node/start.go#L185)<br><strong>Comment</strong>: <pre>Just a note here that we'll remove this code when we integrate cscc</pre></blockquote>
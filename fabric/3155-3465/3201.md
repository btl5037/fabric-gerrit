<strong>Project</strong>: fabric<br><strong>Branch</strong>: master<br><strong>ID</strong>: 3201<br><strong>Subject</strong>: [FAB-1364] Switch to provisional bootstrapper<br><strong>Status</strong>: MERGED<br><strong>Owner</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Assignee</strong>:<br><strong>Created</strong>: 12/12/2016, 12:22:46 AM<br><strong>LastUpdated</strong>: 12/15/2016, 6:15:19 PM<br><strong>CommitMessage</strong>:<br><pre>[FAB-1364] Switch to provisional bootstrapper

https://jira.hyperledger.org/browse/FAB-1364

All consenters read several of their config settings (think sharedconfig)
from the genesis block that is generated by a bootstrapper. The only
bootstrapper available so far is the static one. However, when testing we
need to be able to modify several of these config values on the fly.

Therefore the bootstrapper should be able to read a config object (which
is itself created by reading the orderer.yaml file and -if set- its
associated ENV vars).

An example of that would be the KafkaBrokers value. For unit tests the
"right" value is "127.0.0.1:9092", whereas for the current Docker
Compose-based BDD tests the right value is "kafka0:9092".

Since this bootstrapper is no longer static, renaming the package seemed
appropriate. For production we will need to introduce file-based
bootstrapper that reads the genesis block created by the genesis block
tool.

This changeset allows the bootstrapper to generate the appropriate
genesis blocks (with their own custom keys) for all know consenters
types: solo, kafka, sbft (though sbft for now just short-circuits to the
solo case).

The new bootstrapper is built in a way that makes further extensions
easier, and minimizes code duplication by creating the appropriate
structs and doing the necessary embeddings.

The test that inspected the block's Data field was removed. It was a
tautological test, serving no good purpose, and was also hard to
maintain.

Finally, this changeset updates the bootstrap helper signature by
removing the error return; while the error return can be useful if the
expectation is that the caller will be able to resort to a different
bootstrapper if the first one fails, etc. one could that this amount of
flexibility is unnecessary, and complicates the code needlessly. The
bootstrapper should simply panic if the wrong settings have been passed
to it, and the user should read the fine manual.

Change-Id: I6aef9b19dbf9a39652d2d6b3ccbefc794e3001df
Signed-off-by: Kostas Christidis <kostas@christidis.io>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Reviewed</strong>: 12/12/2016, 12:22:46 AM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/12/2016, 12:25:09 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3898/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/12/2016, 1:01:13 AM<br><strong>Message</strong>: <pre>Patch Set 1: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/3898/ : SUCCESS</pre><strong>Reviewer</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>Reviewed</strong>: 12/13/2016, 11:11:47 AM<br><strong>Message</strong>: <pre>Patch Set 1: Code-Review+1</pre><strong>Reviewer</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Reviewed</strong>: 12/13/2016, 1:40:16 PM<br><strong>Message</strong>: <pre>Uploaded patch set 2.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/13/2016, 1:41:52 PM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4007/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/13/2016, 1:53:13 PM<br><strong>Message</strong>: <pre>Patch Set 2: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4007/ : FAILURE</pre><strong>Reviewer</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Reviewed</strong>: 12/13/2016, 2:21:37 PM<br><strong>Message</strong>: <pre>Patch Set 2:

reverify</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/13/2016, 2:25:01 PM<br><strong>Message</strong>: <pre>Patch Set 2: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4020/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/13/2016, 2:31:44 PM<br><strong>Message</strong>: <pre>Patch Set 2: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4020/ : FAILURE</pre><strong>Reviewer</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Reviewed</strong>: 12/13/2016, 4:34:21 PM<br><strong>Message</strong>: <pre>Uploaded patch set 3.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/13/2016, 4:35:54 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4034/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/13/2016, 4:41:55 PM<br><strong>Message</strong>: <pre>Patch Set 3: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4034/ : FAILURE</pre><strong>Reviewer</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Reviewed</strong>: 12/13/2016, 5:32:55 PM<br><strong>Message</strong>: <pre>Patch Set 3:

reverify</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/13/2016, 5:35:00 PM<br><strong>Message</strong>: <pre>Patch Set 3: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4043/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/13/2016, 5:43:17 PM<br><strong>Message</strong>: <pre>Patch Set 3: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4043/ : FAILURE</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 12/13/2016, 7:32:04 PM<br><strong>Message</strong>: <pre>Patch Set 3:

(4 comments)</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 12/13/2016, 7:40:11 PM<br><strong>Message</strong>: <pre>Patch Set 3:

(2 comments)</pre><strong>Reviewer</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Reviewed</strong>: 12/13/2016, 8:16:53 PM<br><strong>Message</strong>: <pre>Uploaded patch set 4.</pre><strong>Reviewer</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Reviewed</strong>: 12/13/2016, 8:17:17 PM<br><strong>Message</strong>: <pre>Patch Set 3:

(6 comments)</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/13/2016, 8:18:18 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4056/</pre><strong>Reviewer</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Reviewed</strong>: 12/13/2016, 8:20:38 PM<br><strong>Message</strong>: <pre>Uploaded patch set 5.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/13/2016, 8:21:34 PM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4061/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/13/2016, 8:31:09 PM<br><strong>Message</strong>: <pre>Patch Set 4: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4056/ : FAILURE</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/13/2016, 8:32:53 PM<br><strong>Message</strong>: <pre>Patch Set 5: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4061/ : FAILURE</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/14/2016, 12:55:20 AM<br><strong>Message</strong>: <pre>Patch Set 5: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4081/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/14/2016, 1:02:53 AM<br><strong>Message</strong>: <pre>Patch Set 5: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4081/ : FAILURE</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 12/14/2016, 10:02:22 AM<br><strong>Message</strong>: <pre>Patch Set 3:

(1 comment)</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 12/14/2016, 10:02:49 AM<br><strong>Message</strong>: <pre>Patch Set 5: Code-Review+2

reverify</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/14/2016, 10:06:10 AM<br><strong>Message</strong>: <pre>Patch Set 5: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4104/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/14/2016, 10:18:53 AM<br><strong>Message</strong>: <pre>Patch Set 5: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4104/ : FAILURE</pre><strong>Reviewer</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Reviewed</strong>: 12/14/2016, 2:42:15 PM<br><strong>Message</strong>: <pre>Patch Set 5:

reverify</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/14/2016, 2:44:33 PM<br><strong>Message</strong>: <pre>Patch Set 5: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4126/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/14/2016, 2:52:37 PM<br><strong>Message</strong>: <pre>Patch Set 5: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4126/ : FAILURE</pre><strong>Reviewer</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Reviewed</strong>: 12/14/2016, 3:00:51 PM<br><strong>Message</strong>: <pre>Patch Set 5:

reverify for the love of God</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/14/2016, 3:05:31 PM<br><strong>Message</strong>: <pre>Patch Set 5: -Verified

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4131/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/14/2016, 3:12:15 PM<br><strong>Message</strong>: <pre>Patch Set 5: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4131/ : FAILURE</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 12/14/2016, 3:31:00 PM<br><strong>Message</strong>: <pre>Patch Set 5:

perhaps something got fixed and you need to rebase, Kostas ? I see it failing in the same place..</pre><strong>Reviewer</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Reviewed</strong>: 12/14/2016, 3:40:43 PM<br><strong>Message</strong>: <pre>Uploaded patch set 6: Patch Set 5 was rebased.</pre><strong>Reviewer</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Reviewed</strong>: 12/14/2016, 3:41:50 PM<br><strong>Message</strong>: <pre>Patch Set 6:

> perhaps something got fixed and you need to rebase, Kostas ? I see
 > it failing in the same place..

I had assumed incorrectly that it would pick up the change, but rebasing was needed. Thanks Murali (and Ry).</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/14/2016, 3:42:15 PM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4134/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/14/2016, 3:50:56 PM<br><strong>Message</strong>: <pre>Patch Set 6: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4134/ : FAILURE</pre><strong>Reviewer</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Reviewed</strong>: 12/15/2016, 1:36:34 AM<br><strong>Message</strong>: <pre>Uploaded patch set 7.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/15/2016, 1:38:17 AM<br><strong>Message</strong>: <pre>Patch Set 7:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4146/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/15/2016, 2:22:20 AM<br><strong>Message</strong>: <pre>Patch Set 7: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4146/ : SUCCESS</pre><strong>Reviewer</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>Reviewed</strong>: 12/15/2016, 9:32:08 AM<br><strong>Message</strong>: <pre>Patch Set 7:

(1 comment)</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 12/15/2016, 10:54:44 AM<br><strong>Message</strong>: <pre>Patch Set 7: Code-Review+2</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 12/15/2016, 10:56:20 AM<br><strong>Message</strong>: <pre>Patch Set 7:

(1 comment)</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 12/15/2016, 1:03:16 PM<br><strong>Message</strong>: <pre>Patch Set 7: Code-Review-1

(3 comments)

a few small ones.</pre><strong>Reviewer</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Reviewed</strong>: 12/15/2016, 4:27:23 PM<br><strong>Message</strong>: <pre>Uploaded patch set 8.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/15/2016, 4:29:47 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4200/</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 12/15/2016, 4:30:01 PM<br><strong>Message</strong>: <pre>Patch Set 8: Code-Review+2</pre><strong>Reviewer</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Reviewed</strong>: 12/15/2016, 4:30:43 PM<br><strong>Message</strong>: <pre>Patch Set 8:

(3 comments)</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 12/15/2016, 4:33:19 PM<br><strong>Message</strong>: <pre>Patch Set 8:

> (3 comments)

Ok. seemed like a good idea :-)</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 12/15/2016, 4:33:34 PM<br><strong>Message</strong>: <pre>Patch Set 8:

waiting for CI to V+1</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/15/2016, 5:02:35 PM<br><strong>Message</strong>: <pre>Patch Set 8: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4200/ : SUCCESS</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 12/15/2016, 5:16:01 PM<br><strong>Message</strong>: <pre>Patch Set 8: Code-Review+1

(2 comments)

My comment are really for future reference (although perhaps I misunderstand something).  I'll +1 for now and see if my comments were off base</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 12/15/2016, 5:19:31 PM<br><strong>Message</strong>: <pre>Patch Set 3:

(1 comment)</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 12/15/2016, 5:21:10 PM<br><strong>Message</strong>: <pre>Patch Set 3:

(2 comments)</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 12/15/2016, 5:21:18 PM<br><strong>Message</strong>: <pre>Patch Set 8: Code-Review+2</pre><strong>Reviewer</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Reviewed</strong>: 12/15/2016, 5:27:51 PM<br><strong>Message</strong>: <pre>Patch Set 3:

(1 comment)</pre><strong>Reviewer</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Reviewed</strong>: 12/15/2016, 5:28:26 PM<br><strong>Message</strong>: <pre>Patch Set 3:

> (2 comments)

Ah, we posted our updates around the same time. Cool.</pre><strong>Reviewer</strong>: Gerrit Code Review - gerrit@hyperledger.org<br><strong>Reviewed</strong>: 12/15/2016, 5:29:50 PM<br><strong>Message</strong>: <pre>Change has been successfully merged by Srinivasan Muralidharan</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/15/2016, 5:33:06 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Started https://jenkins.hyperledger.org/job/fabric-merge-x86_64/589/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/15/2016, 6:15:19 PM<br><strong>Message</strong>: <pre>Patch Set 8:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-merge-x86_64/589/ : SUCCESS</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Uploader</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Created</strong>: 12/12/2016, 12:22:46 AM<br><strong>UnmergedRevision</strong>: [1990a81275cf2f933dbfcbe87d83021b271907b3](https://github.com/hyperledger-gerrit-archive/fabric/commit/1990a81275cf2f933dbfcbe87d83021b271907b3)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/12/2016, 1:01:13 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>Approved</strong>: 12/13/2016, 11:11:47 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Uploader</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Created</strong>: 12/13/2016, 1:40:16 PM<br><strong>UnmergedRevision</strong>: [4aa9bdb5c39b006bfbdc48e5455c449212f4382d](https://github.com/hyperledger-gerrit-archive/fabric/commit/4aa9bdb5c39b006bfbdc48e5455c449212f4382d)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/13/2016, 2:31:44 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 3</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Uploader</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Created</strong>: 12/13/2016, 4:34:21 PM<br><strong>UnmergedRevision</strong>: [6a0b0b445bda15494b9a14372072be964fa87ba6](https://github.com/hyperledger-gerrit-archive/fabric/commit/6a0b0b445bda15494b9a14372072be964fa87ba6)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/13/2016, 5:43:17 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [common/configtx/manager_test.go#L29](https://github.com/hyperledger-gerrit-archive/fabric/blob/6a0b0b445bda15494b9a14372072be964fa87ba6/common/configtx/manager_test.go#L29)<br><strong>Comment</strong>: <pre>Why this change? This isn't exported or used outside the local test.</pre><strong>Commenter</strong>: Kostas Christidis - kostas@gmail.com<br><strong>CommentLine</strong>: [common/configtx/manager_test.go#L29](https://github.com/hyperledger-gerrit-archive/fabric/blob/6a0b0b445bda15494b9a14372072be964fa87ba6/common/configtx/manager_test.go#L29)<br><strong>Comment</strong>: <pre>Fixed, good catch. (Most likely a victim of a global search I did for ChainID.)</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [common/configtx/manager_test.go#L29](https://github.com/hyperledger-gerrit-archive/fabric/blob/6a0b0b445bda15494b9a14372072be964fa87ba6/common/configtx/manager_test.go#L29)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [orderer/common/bootstrap/provisional/provisional.go#L51](https://github.com/hyperledger-gerrit-archive/fabric/blob/6a0b0b445bda15494b9a14372072be964fa87ba6/orderer/common/bootstrap/provisional/provisional.go#L51)<br><strong>Comment</strong>: <pre>Just like epoch below, is there a reason why this is not a constant?</pre><strong>Commenter</strong>: Kostas Christidis - kostas@gmail.com<br><strong>CommentLine</strong>: [orderer/common/bootstrap/provisional/provisional.go#L51](https://github.com/hyperledger-gerrit-archive/fabric/blob/6a0b0b445bda15494b9a14372072be964fa87ba6/orderer/common/bootstrap/provisional/provisional.go#L51)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [orderer/common/bootstrap/provisional/provisional.go#L52](https://github.com/hyperledger-gerrit-archive/fabric/blob/6a0b0b445bda15494b9a14372072be964fa87ba6/orderer/common/bootstrap/provisional/provisional.go#L52)<br><strong>Comment</strong>: <pre>I guess the idea here is that there may be some other use? But epoch must always be 0 at genesis, so unless this is intended to be repurposed into a more generic config transaction framework, I'd say it's unnecessary.</pre><strong>Commenter</strong>: Kostas Christidis - kostas@gmail.com<br><strong>CommentLine</strong>: [orderer/common/bootstrap/provisional/provisional.go#L52](https://github.com/hyperledger-gerrit-archive/fabric/blob/6a0b0b445bda15494b9a14372072be964fa87ba6/orderer/common/bootstrap/provisional/provisional.go#L52)<br><strong>Comment</strong>: <pre>lastModified and epoch being constants is the right call. Done</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [orderer/common/bootstrap/provisional/provisional.go#L83](https://github.com/hyperledger-gerrit-archive/fabric/blob/6a0b0b445bda15494b9a14372072be964fa87ba6/orderer/common/bootstrap/provisional/provisional.go#L83)<br><strong>Comment</strong>: <pre>Do you think we should define sbft here as well? (You defined the constant above)  SBFT does depend on the provisional genesis, but, it's generally broken so maybe the panic is better, just thought I'd point it out.</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [orderer/common/bootstrap/provisional/provisional.go#L83](https://github.com/hyperledger-gerrit-archive/fabric/blob/6a0b0b445bda15494b9a14372072be964fa87ba6/orderer/common/bootstrap/provisional/provisional.go#L83)<br><strong>Comment</strong>: <pre>I see, it was the duplicate case above, I missed it, my mistake.</pre><strong>Commenter</strong>: Kostas Christidis - kostas@gmail.com<br><strong>CommentLine</strong>: [orderer/common/bootstrap/provisional/provisional.go#L83](https://github.com/hyperledger-gerrit-archive/fabric/blob/6a0b0b445bda15494b9a14372072be964fa87ba6/orderer/common/bootstrap/provisional/provisional.go#L83)<br><strong>Comment</strong>: <pre>Yup. Eventually I expect the sbft case to become separate.</pre><strong>Commenter</strong>: Kostas Christidis - kostas@gmail.com<br><strong>CommentLine</strong>: [orderer/common/bootstrap/provisional/provisional.go#L83](https://github.com/hyperledger-gerrit-archive/fabric/blob/6a0b0b445bda15494b9a14372072be964fa87ba6/orderer/common/bootstrap/provisional/provisional.go#L83)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [undefined#L83](https://github.com/hyperledger-gerrit-archive/fabric/blob/6a0b0b445bda15494b9a14372072be964fa87ba6/undefined#L83)<br><strong>Comment</strong>: <pre>Out of curiosity, was this just a linting error?</pre><strong>Commenter</strong>: Kostas Christidis - kostas@gmail.com<br><strong>CommentLine</strong>: [undefined#L83](https://github.com/hyperledger-gerrit-archive/fabric/blob/6a0b0b445bda15494b9a14372072be964fa87ba6/undefined#L83)<br><strong>Comment</strong>: <pre>Correct. The Close() method returns an error.</pre><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [peer/node/start.go#L42](https://github.com/hyperledger-gerrit-archive/fabric/blob/6a0b0b445bda15494b9a14372072be964fa87ba6/peer/node/start.go#L42)<br><strong>Comment</strong>: <pre>related to my test comment below, I would certainly hope we could remove these from the peer once config stuff really works</pre><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [peer/node/start.go#L42](https://github.com/hyperledger-gerrit-archive/fabric/blob/6a0b0b445bda15494b9a14372072be964fa87ba6/peer/node/start.go#L42)<br><strong>Comment</strong>: <pre>Done - somehow got on a wrong revision</pre><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [peer/node/start.go#L181](https://github.com/hyperledger-gerrit-archive/fabric/blob/6a0b0b445bda15494b9a14372072be964fa87ba6/peer/node/start.go#L181)<br><strong>Comment</strong>: <pre>You've done a nice job being able to mock / test the orderer and yet when it comes to the peer we continue to hardcode values rather than either do things via a test flag or some other type of injection.  I'm just flagging this here for future reference as it's not directly related to this CR</pre><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [peer/node/start.go#L181](https://github.com/hyperledger-gerrit-archive/fabric/blob/6a0b0b445bda15494b9a14372072be964fa87ba6/peer/node/start.go#L181)<br><strong>Comment</strong>: <pre>ok - looks like https://gerrit.hyperledger.org/r/#/c/3241  addresses this so seems if we approve and merge that may need to rebase and adjust this changeset?</pre><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [peer/node/start.go#L181](https://github.com/hyperledger-gerrit-archive/fabric/blob/6a0b0b445bda15494b9a14372072be964fa87ba6/peer/node/start.go#L181)<br><strong>Comment</strong>: <pre>Done - I was on the wrong revision</pre><strong>Commenter</strong>: Kostas Christidis - kostas@gmail.com<br><strong>CommentLine</strong>: [peer/node/start.go#L181](https://github.com/hyperledger-gerrit-archive/fabric/blob/6a0b0b445bda15494b9a14372072be964fa87ba6/peer/node/start.go#L181)<br><strong>Comment</strong>: <pre>If you look at https://gerrit.hyperledger.org/r/#/c/3315/ (and read: https://hyperledgerproject.slack.com/archives/fabric-peer-dev/p1481767486000095 for context) you'll see me trying to correct this.

Also note that I rebased this changeset here last night, on top of changeset 3315 specifically so as to avoid injecting this dependency. (i.e. the latest version of this file does not call into the bootstrapper package.)</pre></blockquote><h3>PatchSet Number: 4</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Uploader</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Created</strong>: 12/13/2016, 8:16:53 PM<br><strong>UnmergedRevision</strong>: [71b09d5ecd6c91ca18a96c1233d1adb1eee2afa2](https://github.com/hyperledger-gerrit-archive/fabric/commit/71b09d5ecd6c91ca18a96c1233d1adb1eee2afa2)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/13/2016, 8:31:09 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 5</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Uploader</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Created</strong>: 12/13/2016, 8:20:38 PM<br><strong>UnmergedRevision</strong>: [88b16580e09ac5c2715fcf5eac6e200cf16f6d8a](https://github.com/hyperledger-gerrit-archive/fabric/commit/88b16580e09ac5c2715fcf5eac6e200cf16f6d8a)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/14/2016, 3:12:15 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Approved</strong>: 12/14/2016, 10:02:49 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 6</h3><blockquote><strong>Type</strong>: TRIVIAL_REBASE<br><strong>Author</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Uploader</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Created</strong>: 12/14/2016, 3:40:43 PM<br><strong>UnmergedRevision</strong>: [082a5106acdda1c7404c3e4da49ae98c34c94c26](https://github.com/hyperledger-gerrit-archive/fabric/commit/082a5106acdda1c7404c3e4da49ae98c34c94c26)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/14/2016, 3:50:56 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 7</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Uploader</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Created</strong>: 12/15/2016, 1:36:34 AM<br><strong>UnmergedRevision</strong>: [cb22b9152e6877824a99b95dd94e28cf8fe375f9](https://github.com/hyperledger-gerrit-archive/fabric/commit/cb22b9152e6877824a99b95dd94e28cf8fe375f9)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/15/2016, 2:22:20 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Approved</strong>: 12/15/2016, 10:54:44 AM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Approved</strong>: 12/15/2016, 1:03:16 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [orderer/common/bootstrap/provisional/item.go#L88](https://github.com/hyperledger-gerrit-archive/fabric/blob/cb22b9152e6877824a99b95dd94e28cf8fe375f9/orderer/common/bootstrap/provisional/item.go#L88)<br><strong>Comment</strong>: <pre>A nit...scope for a common createSignedConfigurationItem(...) with 3 params and wrappers for calling them ?</pre><strong>Commenter</strong>: Kostas Christidis - kostas@gmail.com<br><strong>CommentLine</strong>: [orderer/common/bootstrap/provisional/item.go#L88](https://github.com/hyperledger-gerrit-archive/fabric/blob/cb22b9152e6877824a99b95dd94e28cf8fe375f9/orderer/common/bootstrap/provisional/item.go#L88)<br><strong>Comment</strong>: <pre>I see the repetition in the last 3 lines of every function here, but you'll see that lines 84 and 85 are already calls to wrapper functions, and line 86 is a one-line return.

*If* I get you right, you're suggesting `makeSignedConfigurationItem(header, item, signatures)` function.

If that were the case, we'd be dealing with a single line that is 300-characters long, effectively a concatenation of all three calls into one.

I'm not sure that's the right way to go.</pre><strong>Commenter</strong>: Tuan Dang - tuan.dang.27613@gmail.com<br><strong>CommentLine</strong>: [orderer/main.go#L85](https://github.com/hyperledger-gerrit-archive/fabric/blob/cb22b9152e6877824a99b95dd94e28cf8fe375f9/orderer/main.go#L85)<br><strong>Comment</strong>: <pre>Should this switch stmt be in main() ?  If I add more bootstrap methods, I can do it once at the top and pass it to the various LaunchXXX calls</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [orderer/main.go#L85](https://github.com/hyperledger-gerrit-archive/fabric/blob/cb22b9152e6877824a99b95dd94e28cf8fe375f9/orderer/main.go#L85)<br><strong>Comment</strong>: <pre>The LaunchXXX calls should be going away.  We will only have one init path, and the contents of the genesis block determine which consenter is actually started.</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [orderer/sbft/backend/backend_test.go#L73](https://github.com/hyperledger-gerrit-archive/fabric/blob/cb22b9152e6877824a99b95dd94e28cf8fe375f9/orderer/sbft/backend/backend_test.go#L73)<br><strong>Comment</strong>: <pre>should this be using consensusTypeSbft ?</pre><strong>Commenter</strong>: Kostas Christidis - kostas@gmail.com<br><strong>CommentLine</strong>: [orderer/sbft/backend/backend_test.go#L73](https://github.com/hyperledger-gerrit-archive/fabric/blob/cb22b9152e6877824a99b95dd94e28cf8fe375f9/orderer/sbft/backend/backend_test.go#L73)<br><strong>Comment</strong>: <pre>Done</pre><strong>Commenter</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>CommentLine</strong>: [orderer/sbft/main.go#L128](https://github.com/hyperledger-gerrit-archive/fabric/blob/cb22b9152e6877824a99b95dd94e28cf8fe375f9/orderer/sbft/main.go#L128)<br><strong>Comment</strong>: <pre>should this be using consensusTypeSbft ?</pre><strong>Commenter</strong>: Kostas Christidis - kostas@gmail.com<br><strong>CommentLine</strong>: [orderer/sbft/main.go#L128](https://github.com/hyperledger-gerrit-archive/fabric/blob/cb22b9152e6877824a99b95dd94e28cf8fe375f9/orderer/sbft/main.go#L128)<br><strong>Comment</strong>: <pre>Done</pre></blockquote><h3>PatchSet Number: 8</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Uploader</strong>: Kostas Christidis - kostas@gmail.com<br><strong>Created</strong>: 12/15/2016, 4:27:23 PM<br><strong>GitHubMergedRevision</strong>: [71a3389fd15aea469b0940c0dcd252440825be75](https://github.com/hyperledger-gerrit-archive/fabric/commit/71a3389fd15aea469b0940c0dcd252440825be75)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/15/2016, 5:02:35 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Approved</strong>: 12/15/2016, 4:30:01 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>MergedBy</strong>: Srinivasan Muralidharan<br><strong>Merged</strong>: 12/15/2016, 5:29:50 PM<br><br><strong>Approver</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Approved</strong>: 12/15/2016, 5:21:18 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br></blockquote>
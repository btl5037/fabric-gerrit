<strong>Project</strong>: fabric<br><strong>Branch</strong>: master<br><strong>ID</strong>: 3371<br><strong>Subject</strong>: Integration of MSP into cauthdsl<br><strong>Status</strong>: MERGED<br><strong>Owner</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Assignee</strong>:<br><strong>Created</strong>: 12/16/2016, 11:34:13 AM<br><strong>LastUpdated</strong>: 1/13/2017, 3:47:09 AM<br><strong>CommitMessage</strong>:<br><pre>Integration of MSP into cauthdsl

This change set introduces a more flexible way of describing the identity
associated to a policy. So far we had support for serializing the
certificate associated to the identity. We introduce a new structure that
supports that and 3 other ways of listing identities: i) the admin of an
MSP, ii) the CA of an MSP and iii) a valid certificate for an MSP.

Furthermore, policy evaluation is now performed using the MSP infrastructure:
cauthdsl receives a policy principal and an Identity instance and then it can
use the interfaces offered by the MSP to check whether the identity satisfies
the principal and whether the signature verifies. The semantics of policy
verification has somewhat changed: an identity (and its signature) can be used
to satisfy only a single principal. This has the benefit of better dealing
with the policy "two signatures from org0", but it has the downside that a
single identity can no longer be used to satisfy two principals (e.g. if
we need signatures from an identity with attribute A and one with attribute
B, a single signature from an identity with both attributes would not be
sufficient).

Change-Id: Id18a5933e341781334080965b5d04dc07d4f1b99
Signed-off-by: Alessandro Sorniotti <ale.linux@sopit.net>
</pre><h1>Comments</h1><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 12/16/2016, 11:34:13 AM<br><strong>Message</strong>: <pre>Uploaded patch set 1.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/16/2016, 11:35:19 AM<br><strong>Message</strong>: <pre>Patch Set 1:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4225/</pre><strong>Reviewer</strong>: Elli Androulaki - lli@zurich.ibm.com<br><strong>Reviewed</strong>: 12/16/2016, 11:39:58 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(4 comments)

Thanks Ale!
You may find some comments, but referring mostly on the naming of the fields :)</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 12/16/2016, 11:42:55 AM<br><strong>Message</strong>: <pre>Patch Set 1:

(4 comments)

Thanks, see below!</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 12/16/2016, 12:01:13 PM<br><strong>Message</strong>: <pre>Patch Set 1: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4225/ : FAILURE</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 12/16/2016, 12:21:17 PM<br><strong>Message</strong>: <pre>Patch Set 1: Code-Review-1

Waiting for Elli's code to go in first so I can rebase and use it</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 1/6/2017, 11:53:52 AM<br><strong>Message</strong>: <pre>Uploaded patch set 2.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/6/2017, 11:55:11 AM<br><strong>Message</strong>: <pre>Patch Set 2:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4768/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/6/2017, 12:37:12 PM<br><strong>Message</strong>: <pre>Patch Set 2: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4768/ : SUCCESS</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 1/6/2017, 1:22:48 PM<br><strong>Message</strong>: <pre>Patch Set 2:

(1 comment)</pre><strong>Reviewer</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>Reviewed</strong>: 1/6/2017, 2:05:47 PM<br><strong>Message</strong>: <pre>Patch Set 2:

(5 comments)

So overall this looks pretty good but a reference to an existing or to a new JIRA entry is in order which better documents this functionality provided here

Perhaps some of it can be doe inline by adding to comments (e.g. in proto file), but it might help to create/update a JIRA entry which explains what all this stuff means</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 1/6/2017, 2:59:55 PM<br><strong>Message</strong>: <pre>Patch Set 2:

(1 comment)</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 1/6/2017, 3:00:59 PM<br><strong>Message</strong>: <pre>Patch Set 2:

(1 comment)

Thanks Jason, see below.

@Gari: thanks for your comments, I'll respond asap (I also want to switch to using MSPRole that elli has defined in chain-config.proto first)</pre><strong>Reviewer</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>Reviewed</strong>: 1/6/2017, 6:57:46 PM<br><strong>Message</strong>: <pre>Patch Set 2:

(1 comment)</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 1/8/2017, 3:50:14 PM<br><strong>Message</strong>: <pre>Uploaded patch set 3.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/8/2017, 3:54:12 PM<br><strong>Message</strong>: <pre>Patch Set 3:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4816/</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 1/8/2017, 4:13:21 PM<br><strong>Message</strong>: <pre>Uploaded patch set 4.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/8/2017, 4:17:27 PM<br><strong>Message</strong>: <pre>Patch Set 4:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4817/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/8/2017, 4:35:01 PM<br><strong>Message</strong>: <pre>Patch Set 3: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4816/ : FAILURE</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/8/2017, 5:24:51 PM<br><strong>Message</strong>: <pre>Patch Set 4: Verified-1

Build Failed 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/4817/ : FAILURE</pre><strong>Reviewer</strong>: Elli Androulaki - lli@zurich.ibm.com<br><strong>Reviewed</strong>: 1/9/2017, 12:35:43 PM<br><strong>Message</strong>: <pre>Patch Set 4:

(3 comments)

Thanks Ale!
Just one comment below.
With kind regards,
Elli</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 1/12/2017, 10:43:35 AM<br><strong>Message</strong>: <pre>Uploaded patch set 5.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/12/2017, 10:44:42 AM<br><strong>Message</strong>: <pre>Patch Set 5:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/5073/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/12/2017, 11:21:12 AM<br><strong>Message</strong>: <pre>Patch Set 5: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/5073/ : SUCCESS</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 1/12/2017, 11:42:12 AM<br><strong>Message</strong>: <pre>Uploaded patch set 6.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/12/2017, 11:45:10 AM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-verify-x86_64/5076/</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 1/12/2017, 11:46:33 AM<br><strong>Message</strong>: <pre>Patch Set 6:

(7 comments)

Thanks for your comments - pls have a look at the new change-set. It's ready to be merged now as far as I'm concerned.</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/12/2017, 12:22:28 PM<br><strong>Message</strong>: <pre>Patch Set 6: Verified+1

Build Successful 

https://jenkins.hyperledger.org/job/fabric-verify-x86_64/5076/ : SUCCESS</pre><strong>Reviewer</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Reviewed</strong>: 1/12/2017, 4:53:08 PM<br><strong>Message</strong>: <pre>Patch Set 6: Code-Review+2

(2 comments)

A few comments, but good to go as is</pre><strong>Reviewer</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Reviewed</strong>: 1/12/2017, 5:21:57 PM<br><strong>Message</strong>: <pre>Patch Set 6: Code-Review+2</pre><strong>Reviewer</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Reviewed</strong>: 1/12/2017, 5:58:06 PM<br><strong>Message</strong>: <pre>Patch Set 6: Code-Review+2</pre><strong>Reviewer</strong>: Gerrit Code Review - gerrit@hyperledger.org<br><strong>Reviewed</strong>: 1/12/2017, 5:58:11 PM<br><strong>Message</strong>: <pre>Change has been successfully merged by Binh Nguyen</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/12/2017, 6:01:52 PM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-merge-x86_64/733/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/12/2017, 6:50:10 PM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Failed 

https://jenkins.hyperledger.org/job/fabric-merge-x86_64/733/ : FAILURE</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/12/2017, 10:36:28 PM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Started https://jenkins.hyperledger.org/job/fabric-merge-x86_64/734/</pre><strong>Reviewer</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Reviewed</strong>: 1/12/2017, 11:38:52 PM<br><strong>Message</strong>: <pre>Patch Set 6:

Build Successful 

https://jenkins.hyperledger.org/job/fabric-merge-x86_64/734/ : SUCCESS</pre><strong>Reviewer</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Reviewed</strong>: 1/13/2017, 3:47:09 AM<br><strong>Message</strong>: <pre>Patch Set 6:

(2 comments)

Thanks for your comments, pls see below.</pre><h1>PatchSets</h1><h3>PatchSet Number: 1</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Created</strong>: 12/16/2016, 11:34:13 AM<br><strong>UnmergedRevision</strong>: [354e6abab16343724042b1c8d3dc49e93aba2bfa](https://github.com/hyperledger-gerrit-archive/fabric/commit/354e6abab16343724042b1c8d3dc49e93aba2bfa)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 12/16/2016, 12:01:13 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br><strong>Approver</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Approved</strong>: 12/16/2016, 12:21:17 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Elli Androulaki - lli@zurich.ibm.com<br><strong>CommentLine</strong>: [protos/common/configuration.proto#L87](https://github.com/hyperledger-gerrit-archive/fabric/blob/354e6abab16343724042b1c8d3dc49e93aba2bfa/protos/common/configuration.proto#L87)<br><strong>Comment</strong>: <pre>Don't we need to include the MSP identifier this principal corresponds to?</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [protos/common/configuration.proto#L87](https://github.com/hyperledger-gerrit-archive/fabric/blob/354e6abab16343724042b1c8d3dc49e93aba2bfa/protos/common/configuration.proto#L87)<br><strong>Comment</strong>: <pre>All we need is the bytes of the principal. If it's a serialized identity, the MSP ID is inside. If it's any of the others, the MSP ID *IS* the Principal field.</pre><strong>Commenter</strong>: Elli Androulaki - lli@zurich.ibm.com<br><strong>CommentLine</strong>: [protos/common/configuration.proto#L90](https://github.com/hyperledger-gerrit-archive/fabric/blob/354e6abab16343724042b1c8d3dc49e93aba2bfa/protos/common/configuration.proto#L90)<br><strong>Comment</strong>: <pre>I would call this "Identity" as this represents "certificate" within a generic MSP definition.</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [protos/common/configuration.proto#L90](https://github.com/hyperledger-gerrit-archive/fabric/blob/354e6abab16343724042b1c8d3dc49e93aba2bfa/protos/common/configuration.proto#L90)<br><strong>Comment</strong>: <pre>Good point - will rename</pre><strong>Commenter</strong>: Elli Androulaki - lli@zurich.ibm.com<br><strong>CommentLine</strong>: [protos/common/configuration.proto#L94](https://github.com/hyperledger-gerrit-archive/fabric/blob/354e6abab16343724042b1c8d3dc49e93aba2bfa/protos/common/configuration.proto#L94)<br><strong>Comment</strong>: <pre>So, why would we need this? It seems to be that MSPAdmin suffice no? Especially as it is not compulsory that an MSP have a CA :)</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [protos/common/configuration.proto#L94](https://github.com/hyperledger-gerrit-archive/fabric/blob/354e6abab16343724042b1c8d3dc49e93aba2bfa/protos/common/configuration.proto#L94)<br><strong>Comment</strong>: <pre>Yeah, good point, I also debated whether we needed it or not.. I can remove it.</pre><strong>Commenter</strong>: Elli Androulaki - lli@zurich.ibm.com<br><strong>CommentLine</strong>: [protos/common/configuration.proto#L96](https://github.com/hyperledger-gerrit-archive/fabric/blob/354e6abab16343724042b1c8d3dc49e93aba2bfa/protos/common/configuration.proto#L96)<br><strong>Comment</strong>: <pre>Shall we call this "Member"?</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [protos/common/configuration.proto#L96](https://github.com/hyperledger-gerrit-archive/fabric/blob/354e6abab16343724042b1c8d3dc49e93aba2bfa/protos/common/configuration.proto#L96)<br><strong>Comment</strong>: <pre>We could. I went for Valid because that's the name of the method that MSP exposes, so I thought it would be good to be consistent.</pre><strong>Commenter</strong>: Elli Androulaki - lli@zurich.ibm.com<br><strong>CommentLine</strong>: [protos/common/configuration.proto#L96](https://github.com/hyperledger-gerrit-archive/fabric/blob/354e6abab16343724042b1c8d3dc49e93aba2bfa/protos/common/configuration.proto#L96)<br><strong>Comment</strong>: <pre>Right, but it is not really intuitive IMHO...</pre></blockquote><h3>PatchSet Number: 2</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Created</strong>: 1/6/2017, 11:53:52 AM<br><strong>UnmergedRevision</strong>: [5d4651b502ff91ef1de96e44692f02a97710aa91](https://github.com/hyperledger-gerrit-archive/fabric/commit/5d4651b502ff91ef1de96e44692f02a97710aa91)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/6/2017, 12:37:12 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [common/cauthdsl/cauthdsl.go#L79](https://github.com/hyperledger-gerrit-archive/fabric/blob/5d4651b502ff91ef1de96e44692f02a97710aa91/common/cauthdsl/cauthdsl.go#L79)<br><strong>Comment</strong>: <pre>Why does this only support certificate based? I would think we could modify the `VerifySignature` to take instead of a bytes ID a `*cb.PolicyPrincipal` and not have this requirement?  Especially as the VerifySignature is going to need to be provided by the MSP manager regardless?</pre><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [common/cauthdsl/cauthdsl.go#L79](https://github.com/hyperledger-gerrit-archive/fabric/blob/5d4651b502ff91ef1de96e44692f02a97710aa91/common/cauthdsl/cauthdsl.go#L79)<br><strong>Comment</strong>: <pre>So if the policy type is *cb.SignaturePolicy_SignedBy, one could assume that it means an explicit "identity" and in that case I could see why one might assume that this should/would  only work for cb.PolicyPrincipal_Certificate.

But I think signed by could also refer any PolicyPrincipleType as well.  I posted a comment / question in configuration.proto asking for an explanation of what actually goes in the Principal bytes of the PolicyPrinciple as well</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [common/cauthdsl/cauthdsl.go#L79](https://github.com/hyperledger-gerrit-archive/fabric/blob/5d4651b502ff91ef1de96e44692f02a97710aa91/common/cauthdsl/cauthdsl.go#L79)<br><strong>Comment</strong>: <pre>On second thought, it seems like we need a second method from the MSP manager.  Something along the lines of:

SatisfiesPrincipal(identity []bytes, *cb.PolicyPrincipal) bool

And then some way to evaluate a signature for a particular principal?

Because in general, the 'creator' identity will not be expressed as a PolicyPrincipal, right? (So we cannot do a simple equality check)</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [common/cauthdsl/cauthdsl.go#L79](https://github.com/hyperledger-gerrit-archive/fabric/blob/5d4651b502ff91ef1de96e44692f02a97710aa91/common/cauthdsl/cauthdsl.go#L79)<br><strong>Comment</strong>: <pre>That's a good point. My view (and please weigh in if you think I'm on the wrong track) is that MSP should only give us the tools to determine whether identities are trusted and whether an identity's signature over a message is correct. The policy code uses this as a building block and builds something on top.

If signedByID.Type is a Certificate, we don't need to determine whether the identity is trusted, we just have to match the identity byte-by-byte and then verify the signature. If it's a of type MSPValid we need to ask the MSP to verify the identity and then check the signature. If it's of type MSPAdmin, we need to ask the MSP whether the identity is one of the admins of that MSP and then verify the signature. 

All this to say that VerifySignature is the common piece, but there's an additional bit of work to do to determine whether the identity is the one we expect (based on the type). I wouldn't squeeze this into VerifySignature but I would keep it outside, in this function. In this drop I only handle the certificate case, but I plan to add cases for the other types in a subsequent drop. Does this make sense?

Also, note that here we're still talking about policies of type cb.Policy_SIGNATURE. For policies of type cb.Policy_MSP we'll hand the policy, signatures, identities and messages to the MSP and it will make the determination. This will come in yet another drop.</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [common/cauthdsl/cauthdsl.go#L79](https://github.com/hyperledger-gerrit-archive/fabric/blob/5d4651b502ff91ef1de96e44692f02a97710aa91/common/cauthdsl/cauthdsl.go#L79)<br><strong>Comment</strong>: <pre>Fixed, as discussed I've implemented a SatisfiesPrincipal function in the MSP/Identity and this logic has disappeared from here</pre><strong>Commenter</strong>: Yacov Manevich - yacovm@il.ibm.com<br><strong>CommentLine</strong>: [common/cauthdsl/cauthdsl_builder.go#L56](https://github.com/hyperledger-gerrit-archive/fabric/blob/5d4651b502ff91ef1de96e44692f02a97710aa91/common/cauthdsl/cauthdsl_builder.go#L56)<br><strong>Comment</strong>: <pre>no need for the , _</pre><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [protos/common/configuration.proto#L96](https://github.com/hyperledger-gerrit-archive/fabric/blob/5d4651b502ff91ef1de96e44692f02a97710aa91/protos/common/configuration.proto#L96)<br><strong>Comment</strong>: <pre>So this means that we could use an arbitrary certificate which is not actually issued / trusted by any of the MSPs of the channel members?</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [protos/common/configuration.proto#L96](https://github.com/hyperledger-gerrit-archive/fabric/blob/5d4651b502ff91ef1de96e44692f02a97710aa91/protos/common/configuration.proto#L96)<br><strong>Comment</strong>: <pre>I'm not using this message definition anymore</pre><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [protos/common/configuration.proto#L100](https://github.com/hyperledger-gerrit-archive/fabric/blob/5d4651b502ff91ef1de96e44692f02a97710aa91/protos/common/configuration.proto#L100)<br><strong>Comment</strong>: <pre>and this means that the principal is actually any of of the root certificates - i.e. signed by the actual root CA key?</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [protos/common/configuration.proto#L100](https://github.com/hyperledger-gerrit-archive/fabric/blob/5d4651b502ff91ef1de96e44692f02a97710aa91/protos/common/configuration.proto#L100)<br><strong>Comment</strong>: <pre>I'm not using this message definition anymore</pre><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [protos/common/configuration.proto#L102](https://github.com/hyperledger-gerrit-archive/fabric/blob/5d4651b502ff91ef1de96e44692f02a97710aa91/protos/common/configuration.proto#L102)<br><strong>Comment</strong>: <pre>and this is basically any valid certificate issued by any of the root CAs for an MSP?</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [protos/common/configuration.proto#L102](https://github.com/hyperledger-gerrit-archive/fabric/blob/5d4651b502ff91ef1de96e44692f02a97710aa91/protos/common/configuration.proto#L102)<br><strong>Comment</strong>: <pre>I'm not using this message definition anymore</pre><strong>Commenter</strong>: Gari Singh - gari.r.singh@gmail.com<br><strong>CommentLine</strong>: [protos/common/configuration.proto#L108](https://github.com/hyperledger-gerrit-archive/fabric/blob/5d4651b502ff91ef1de96e44692f02a97710aa91/protos/common/configuration.proto#L108)<br><strong>Comment</strong>: <pre>Could you document what the "bytes" are for each of the PolicyPrincipleTypes?</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [protos/common/configuration.proto#L108](https://github.com/hyperledger-gerrit-archive/fabric/blob/5d4651b502ff91ef1de96e44692f02a97710aa91/protos/common/configuration.proto#L108)<br><strong>Comment</strong>: <pre>I'm not using this message definition anymore (sorry for the obnoxious copy-paste responses :P )</pre></blockquote><h3>PatchSet Number: 3</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Created</strong>: 1/8/2017, 3:50:14 PM<br><strong>UnmergedRevision</strong>: [e89130199283e5f1b5fa284bcd9e63260b2606f9](https://github.com/hyperledger-gerrit-archive/fabric/commit/e89130199283e5f1b5fa284bcd9e63260b2606f9)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/8/2017, 4:35:01 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br></blockquote><h3>PatchSet Number: 4</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Created</strong>: 1/8/2017, 4:13:21 PM<br><strong>UnmergedRevision</strong>: [b38e2666cbc523326cc0f23a667600b46424c24c](https://github.com/hyperledger-gerrit-archive/fabric/commit/b38e2666cbc523326cc0f23a667600b46424c24c)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/8/2017, 5:24:51 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: -1<br><br><h2>Comments</h2><strong>Commenter</strong>: Elli Androulaki - lli@zurich.ibm.com<br><strong>CommentLine</strong>: [common/cauthdsl/cauthdsl.go#L96](https://github.com/hyperledger-gerrit-archive/fabric/blob/b38e2666cbc523326cc0f23a667600b46424c24c/common/cauthdsl/cauthdsl.go#L96)<br><strong>Comment</strong>: <pre>Cute. Same comment as below for moving SatisfiesPrincipal to the MSP interface.</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [common/cauthdsl/cauthdsl.go#L96](https://github.com/hyperledger-gerrit-archive/fabric/blob/b38e2666cbc523326cc0f23a667600b46424c24c/common/cauthdsl/cauthdsl.go#L96)<br><strong>Comment</strong>: <pre>:)</pre><strong>Commenter</strong>: Elli Androulaki - lli@zurich.ibm.com<br><strong>CommentLine</strong>: [msp/msp.go#L146](https://github.com/hyperledger-gerrit-archive/fabric/blob/b38e2666cbc523326cc0f23a667600b46424c24c/msp/msp.go#L146)<br><strong>Comment</strong>: <pre>+1 for this function, but shall we move it to the MSP better? 
In this case we could pass as parameters a list of MSPPrincipals, and/or enhance it with message/signature pairs. In this way we can allow for arbitrary MSP (admin/membership) definitions, without externalizing any of it and keep the modularity of the component.</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [msp/msp.go#L146](https://github.com/hyperledger-gerrit-archive/fabric/blob/b38e2666cbc523326cc0f23a667600b46424c24c/msp/msp.go#L146)<br><strong>Comment</strong>: <pre>That's a pretty good idea - done</pre></blockquote><h3>PatchSet Number: 5</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Created</strong>: 1/12/2017, 10:43:35 AM<br><strong>UnmergedRevision</strong>: [5475ec216fe9186e146c6445e28586c3fce3464e](https://github.com/hyperledger-gerrit-archive/fabric/commit/5475ec216fe9186e146c6445e28586c3fce3464e)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/12/2017, 11:21:12 AM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br></blockquote><h3>PatchSet Number: 6</h3><blockquote><strong>Type</strong>: REWORK<br><strong>Author</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Uploader</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>Created</strong>: 1/12/2017, 11:42:12 AM<br><strong>GitHubMergedRevision</strong>: [bf2fd1d63adbf510b6f2a7874f2667a109c44d98](https://github.com/hyperledger-gerrit-archive/fabric/commit/bf2fd1d63adbf510b6f2a7874f2667a109c44d98)<br><br><strong>Approver</strong>: Hyperledger Jobbuilder - jobbuilder@jenkins.hyperledger.org<br><strong>Approved</strong>: 1/12/2017, 12:22:28 PM<br><strong>Type</strong>: Verified<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>Approved</strong>: 1/12/2017, 4:53:08 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>Approver</strong>: Binh Nguyen - binh1010010110@gmail.com<br><strong>Approved</strong>: 1/12/2017, 5:58:06 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><strong>MergedBy</strong>: Binh Nguyen<br><strong>Merged</strong>: 1/12/2017, 5:58:10 PM<br><br><strong>Approver</strong>: Srinivasan Muralidharan - srinivasan.muralidharan99@gmail.com<br><strong>Approved</strong>: 1/12/2017, 5:21:57 PM<br><strong>Type</strong>: Code-Review<br><strong>Value</strong>: 1<br><br><h2>Comments</h2><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [common/cauthdsl/cauthdsl.go#L96](https://github.com/hyperledger-gerrit-archive/fabric/blob/bf2fd1d63adbf510b6f2a7874f2667a109c44d98/common/cauthdsl/cauthdsl.go#L96)<br><strong>Comment</strong>: <pre>Just to clarify.  You do not mean "Remove the code below", you mean "Move the code below to the tests, right?

I still think mock structures are the way to go for testing here.</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [common/cauthdsl/cauthdsl.go#L96](https://github.com/hyperledger-gerrit-archive/fabric/blob/bf2fd1d63adbf510b6f2a7874f2667a109c44d98/common/cauthdsl/cauthdsl.go#L96)<br><strong>Comment</strong>: <pre>You are absolutely right and as a matter of fact, this code was originally in cauthdsl_test.go, I had to move it here so that the config manager code could see it.</pre><strong>Commenter</strong>: Jason Yellick - jyellick@us.ibm.com<br><strong>CommentLine</strong>: [protos/common/configuration.proto#L20](https://github.com/hyperledger-gerrit-archive/fabric/blob/bf2fd1d63adbf510b6f2a7874f2667a109c44d98/protos/common/configuration.proto#L20)<br><strong>Comment</strong>: <pre>Not related to this changeset, but I'd really like to see this proto renamed to a better name, maybe msp.proto or msp-support.proto or something? I think that's all that is in there.</pre><strong>Commenter</strong>: Alessandro Sorniotti - ale.linux@sopit.net<br><strong>CommentLine</strong>: [protos/common/configuration.proto#L20](https://github.com/hyperledger-gerrit-archive/fabric/blob/bf2fd1d63adbf510b6f2a7874f2667a109c44d98/protos/common/configuration.proto#L20)<br><strong>Comment</strong>: <pre>yeah, I was actually thinking this myself - I'll check with Elli who picked the name.</pre></blockquote>